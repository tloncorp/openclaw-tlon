"use strict";var vF=Object.defineProperty;var SF=(e,t,n)=>t in e?vF(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var P=(e,t,n)=>SF(e,typeof t!="symbol"?t+"":t,n);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});var yt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function CF(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ya={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */Ya.exports;(function(e,t){(function(){var n,r="4.17.23",s=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",u="Expected a function",c="Invalid `variable` option passed into `_.template`",d="__lodash_hash_undefined__",f=500,m="__lodash_placeholder__",y=1,w=2,E=4,F=1,I=2,T=1,$=2,V=4,H=8,Q=16,te=32,ge=64,De=128,rt=256,Je=512,fr=30,Xi="...",ti=800,Hs=16,ni=1,_i=2,Gs=3,er=1/0,An=9007199254740991,tr=17976931348623157e292,pn=NaN,He=4294967295,St=He-1,gn=He>>>1,dr=[["ary",De],["bind",T],["bindKey",$],["curry",H],["curryRight",Q],["flip",Je],["partial",te],["partialRight",ge],["rearg",rt]],zt="[object Arguments]",hr="[object Array]",ri="[object AsyncFunction]",Wt="[object Boolean]",nr="[object Date]",Rr="[object DOMException]",Tr="[object Error]",pr="[object Function]",Fn="[object GeneratorFunction]",Ct="[object Map]",Pr="[object Number]",qs="[object Null]",rn="[object Object]",Ii="[object Promise]",js="[object Proxy]",mn="[object RegExp]",Bt="[object Set]",kt="[object String]",gr="[object Symbol]",be="[object Undefined]",ut="[object WeakMap]",S="[object WeakSet]",g="[object ArrayBuffer]",h="[object DataView]",p="[object Float32Array]",v="[object Float64Array]",C="[object Int8Array]",B="[object Int16Array]",R="[object Int32Array]",q="[object Uint8Array]",ae="[object Uint8ClampedArray]",de="[object Uint16Array]",ce="[object Uint32Array]",me=/\b__p \+= '';/g,sn=/\b(__p \+=) '' \+/g,Kt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Yi=/&(?:amp|lt|gt|quot|#39);/g,Qi=/[&<>"']/g,Wb=RegExp(Yi.source),Kb=RegExp(Qi.source),Vb=/<%-([\s\S]+?)%>/g,Zb=/<%([\s\S]+?)%>/g,dh=/<%=([\s\S]+?)%>/g,Jb=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Xb=/^\w*$/,Yb=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Hu=/[\\^$.*+?()[\]{}|]/g,Qb=RegExp(Hu.source),Gu=/^\s+/,eE=/\s/,tE=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,nE=/\{\n\/\* \[wrapped with (.+)\] \*/,rE=/,? & /,iE=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,sE=/[()=,{}\[\]\/\s]/,oE=/\\(\\)?/g,aE=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,hh=/\w*$/,uE=/^[-+]0x[0-9a-f]+$/i,cE=/^0b[01]+$/i,lE=/^\[object .+?Constructor\]$/,fE=/^0o[0-7]+$/i,dE=/^(?:0|[1-9]\d*)$/,hE=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,qo=/($^)/,pE=/['\n\r\u2028\u2029\\]/g,jo="\\ud800-\\udfff",gE="\\u0300-\\u036f",mE="\\ufe20-\\ufe2f",yE="\\u20d0-\\u20ff",ph=gE+mE+yE,gh="\\u2700-\\u27bf",mh="a-z\\xdf-\\xf6\\xf8-\\xff",DE="\\xac\\xb1\\xd7\\xf7",wE="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",bE="\\u2000-\\u206f",EE=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",yh="A-Z\\xc0-\\xd6\\xd8-\\xde",Dh="\\ufe0e\\ufe0f",wh=DE+wE+bE+EE,qu="['’]",vE="["+jo+"]",bh="["+wh+"]",Wo="["+ph+"]",Eh="\\d+",SE="["+gh+"]",vh="["+mh+"]",Sh="[^"+jo+wh+Eh+gh+mh+yh+"]",ju="\\ud83c[\\udffb-\\udfff]",CE="(?:"+Wo+"|"+ju+")",Ch="[^"+jo+"]",Wu="(?:\\ud83c[\\udde6-\\uddff]){2}",Ku="[\\ud800-\\udbff][\\udc00-\\udfff]",es="["+yh+"]",xh="\\u200d",Ah="(?:"+vh+"|"+Sh+")",xE="(?:"+es+"|"+Sh+")",Fh="(?:"+qu+"(?:d|ll|m|re|s|t|ve))?",_h="(?:"+qu+"(?:D|LL|M|RE|S|T|VE))?",Ih=CE+"?",Bh="["+Dh+"]?",AE="(?:"+xh+"(?:"+[Ch,Wu,Ku].join("|")+")"+Bh+Ih+")*",FE="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",_E="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",kh=Bh+Ih+AE,IE="(?:"+[SE,Wu,Ku].join("|")+")"+kh,BE="(?:"+[Ch+Wo+"?",Wo,Wu,Ku,vE].join("|")+")",kE=RegExp(qu,"g"),RE=RegExp(Wo,"g"),Vu=RegExp(ju+"(?="+ju+")|"+BE+kh,"g"),TE=RegExp([es+"?"+vh+"+"+Fh+"(?="+[bh,es,"$"].join("|")+")",xE+"+"+_h+"(?="+[bh,es+Ah,"$"].join("|")+")",es+"?"+Ah+"+"+Fh,es+"+"+_h,_E,FE,Eh,IE].join("|"),"g"),PE=RegExp("["+xh+jo+ph+Dh+"]"),NE=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,OE=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],UE=-1,nt={};nt[p]=nt[v]=nt[C]=nt[B]=nt[R]=nt[q]=nt[ae]=nt[de]=nt[ce]=!0,nt[zt]=nt[hr]=nt[g]=nt[Wt]=nt[h]=nt[nr]=nt[Tr]=nt[pr]=nt[Ct]=nt[Pr]=nt[rn]=nt[mn]=nt[Bt]=nt[kt]=nt[ut]=!1;var et={};et[zt]=et[hr]=et[g]=et[h]=et[Wt]=et[nr]=et[p]=et[v]=et[C]=et[B]=et[R]=et[Ct]=et[Pr]=et[rn]=et[mn]=et[Bt]=et[kt]=et[gr]=et[q]=et[ae]=et[de]=et[ce]=!0,et[Tr]=et[pr]=et[ut]=!1;var ME={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},$E={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},LE={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},zE={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},HE=parseFloat,GE=parseInt,Rh=typeof yt=="object"&&yt&&yt.Object===Object&&yt,qE=typeof self=="object"&&self&&self.Object===Object&&self,Ht=Rh||qE||Function("return this")(),Zu=t&&!t.nodeType&&t,Bi=Zu&&!0&&e&&!e.nodeType&&e,Th=Bi&&Bi.exports===Zu,Ju=Th&&Rh.process,$n=function(){try{var U=Bi&&Bi.require&&Bi.require("util").types;return U||Ju&&Ju.binding&&Ju.binding("util")}catch{}}(),Ph=$n&&$n.isArrayBuffer,Nh=$n&&$n.isDate,Oh=$n&&$n.isMap,Uh=$n&&$n.isRegExp,Mh=$n&&$n.isSet,$h=$n&&$n.isTypedArray;function _n(U,j,G){switch(G.length){case 0:return U.call(j);case 1:return U.call(j,G[0]);case 2:return U.call(j,G[0],G[1]);case 3:return U.call(j,G[0],G[1],G[2])}return U.apply(j,G)}function jE(U,j,G,le){for(var Ce=-1,qe=U==null?0:U.length;++Ce<qe;){var Rt=U[Ce];j(le,Rt,G(Rt),U)}return le}function Ln(U,j){for(var G=-1,le=U==null?0:U.length;++G<le&&j(U[G],G,U)!==!1;);return U}function WE(U,j){for(var G=U==null?0:U.length;G--&&j(U[G],G,U)!==!1;);return U}function Lh(U,j){for(var G=-1,le=U==null?0:U.length;++G<le;)if(!j(U[G],G,U))return!1;return!0}function ii(U,j){for(var G=-1,le=U==null?0:U.length,Ce=0,qe=[];++G<le;){var Rt=U[G];j(Rt,G,U)&&(qe[Ce++]=Rt)}return qe}function Ko(U,j){var G=U==null?0:U.length;return!!G&&ts(U,j,0)>-1}function Xu(U,j,G){for(var le=-1,Ce=U==null?0:U.length;++le<Ce;)if(G(j,U[le]))return!0;return!1}function it(U,j){for(var G=-1,le=U==null?0:U.length,Ce=Array(le);++G<le;)Ce[G]=j(U[G],G,U);return Ce}function si(U,j){for(var G=-1,le=j.length,Ce=U.length;++G<le;)U[Ce+G]=j[G];return U}function Yu(U,j,G,le){var Ce=-1,qe=U==null?0:U.length;for(le&&qe&&(G=U[++Ce]);++Ce<qe;)G=j(G,U[Ce],Ce,U);return G}function KE(U,j,G,le){var Ce=U==null?0:U.length;for(le&&Ce&&(G=U[--Ce]);Ce--;)G=j(G,U[Ce],Ce,U);return G}function Qu(U,j){for(var G=-1,le=U==null?0:U.length;++G<le;)if(j(U[G],G,U))return!0;return!1}var VE=ec("length");function ZE(U){return U.split("")}function JE(U){return U.match(iE)||[]}function zh(U,j,G){var le;return G(U,function(Ce,qe,Rt){if(j(Ce,qe,Rt))return le=qe,!1}),le}function Vo(U,j,G,le){for(var Ce=U.length,qe=G+(le?1:-1);le?qe--:++qe<Ce;)if(j(U[qe],qe,U))return qe;return-1}function ts(U,j,G){return j===j?u1(U,j,G):Vo(U,Hh,G)}function XE(U,j,G,le){for(var Ce=G-1,qe=U.length;++Ce<qe;)if(le(U[Ce],j))return Ce;return-1}function Hh(U){return U!==U}function Gh(U,j){var G=U==null?0:U.length;return G?nc(U,j)/G:pn}function ec(U){return function(j){return j==null?n:j[U]}}function tc(U){return function(j){return U==null?n:U[j]}}function qh(U,j,G,le,Ce){return Ce(U,function(qe,Rt,Xe){G=le?(le=!1,qe):j(G,qe,Rt,Xe)}),G}function YE(U,j){var G=U.length;for(U.sort(j);G--;)U[G]=U[G].value;return U}function nc(U,j){for(var G,le=-1,Ce=U.length;++le<Ce;){var qe=j(U[le]);qe!==n&&(G=G===n?qe:G+qe)}return G}function rc(U,j){for(var G=-1,le=Array(U);++G<U;)le[G]=j(G);return le}function QE(U,j){return it(j,function(G){return[G,U[G]]})}function jh(U){return U&&U.slice(0,Zh(U)+1).replace(Gu,"")}function In(U){return function(j){return U(j)}}function ic(U,j){return it(j,function(G){return U[G]})}function Ws(U,j){return U.has(j)}function Wh(U,j){for(var G=-1,le=U.length;++G<le&&ts(j,U[G],0)>-1;);return G}function Kh(U,j){for(var G=U.length;G--&&ts(j,U[G],0)>-1;);return G}function e1(U,j){for(var G=U.length,le=0;G--;)U[G]===j&&++le;return le}var t1=tc(ME),n1=tc($E);function r1(U){return"\\"+zE[U]}function i1(U,j){return U==null?n:U[j]}function ns(U){return PE.test(U)}function s1(U){return NE.test(U)}function o1(U){for(var j,G=[];!(j=U.next()).done;)G.push(j.value);return G}function sc(U){var j=-1,G=Array(U.size);return U.forEach(function(le,Ce){G[++j]=[Ce,le]}),G}function Vh(U,j){return function(G){return U(j(G))}}function oi(U,j){for(var G=-1,le=U.length,Ce=0,qe=[];++G<le;){var Rt=U[G];(Rt===j||Rt===m)&&(U[G]=m,qe[Ce++]=G)}return qe}function Zo(U){var j=-1,G=Array(U.size);return U.forEach(function(le){G[++j]=le}),G}function a1(U){var j=-1,G=Array(U.size);return U.forEach(function(le){G[++j]=[le,le]}),G}function u1(U,j,G){for(var le=G-1,Ce=U.length;++le<Ce;)if(U[le]===j)return le;return-1}function c1(U,j,G){for(var le=G+1;le--;)if(U[le]===j)return le;return le}function rs(U){return ns(U)?f1(U):VE(U)}function rr(U){return ns(U)?d1(U):ZE(U)}function Zh(U){for(var j=U.length;j--&&eE.test(U.charAt(j)););return j}var l1=tc(LE);function f1(U){for(var j=Vu.lastIndex=0;Vu.test(U);)++j;return j}function d1(U){return U.match(Vu)||[]}function h1(U){return U.match(TE)||[]}var p1=function U(j){j=j==null?Ht:is.defaults(Ht.Object(),j,is.pick(Ht,OE));var G=j.Array,le=j.Date,Ce=j.Error,qe=j.Function,Rt=j.Math,Xe=j.Object,oc=j.RegExp,g1=j.String,zn=j.TypeError,Jo=G.prototype,m1=qe.prototype,ss=Xe.prototype,Xo=j["__core-js_shared__"],Yo=m1.toString,je=ss.hasOwnProperty,y1=0,Jh=function(){var i=/[^.]+$/.exec(Xo&&Xo.keys&&Xo.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""}(),Qo=ss.toString,D1=Yo.call(Xe),w1=Ht._,b1=oc("^"+Yo.call(je).replace(Hu,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ea=Th?j.Buffer:n,ai=j.Symbol,ta=j.Uint8Array,Xh=ea?ea.allocUnsafe:n,na=Vh(Xe.getPrototypeOf,Xe),Yh=Xe.create,Qh=ss.propertyIsEnumerable,ra=Jo.splice,ep=ai?ai.isConcatSpreadable:n,Ks=ai?ai.iterator:n,ki=ai?ai.toStringTag:n,ia=function(){try{var i=Oi(Xe,"defineProperty");return i({},"",{}),i}catch{}}(),E1=j.clearTimeout!==Ht.clearTimeout&&j.clearTimeout,v1=le&&le.now!==Ht.Date.now&&le.now,S1=j.setTimeout!==Ht.setTimeout&&j.setTimeout,sa=Rt.ceil,oa=Rt.floor,ac=Xe.getOwnPropertySymbols,C1=ea?ea.isBuffer:n,tp=j.isFinite,x1=Jo.join,A1=Vh(Xe.keys,Xe),Tt=Rt.max,Vt=Rt.min,F1=le.now,_1=j.parseInt,np=Rt.random,I1=Jo.reverse,uc=Oi(j,"DataView"),Vs=Oi(j,"Map"),cc=Oi(j,"Promise"),os=Oi(j,"Set"),Zs=Oi(j,"WeakMap"),Js=Oi(Xe,"create"),aa=Zs&&new Zs,as={},B1=Ui(uc),k1=Ui(Vs),R1=Ui(cc),T1=Ui(os),P1=Ui(Zs),ua=ai?ai.prototype:n,Xs=ua?ua.valueOf:n,rp=ua?ua.toString:n;function x(i){if(ct(i)&&!Ae(i)&&!(i instanceof Oe)){if(i instanceof Hn)return i;if(je.call(i,"__wrapped__"))return ig(i)}return new Hn(i)}var us=function(){function i(){}return function(a){if(!st(a))return{};if(Yh)return Yh(a);i.prototype=a;var l=new i;return i.prototype=n,l}}();function ca(){}function Hn(i,a){this.__wrapped__=i,this.__actions__=[],this.__chain__=!!a,this.__index__=0,this.__values__=n}x.templateSettings={escape:Vb,evaluate:Zb,interpolate:dh,variable:"",imports:{_:x}},x.prototype=ca.prototype,x.prototype.constructor=x,Hn.prototype=us(ca.prototype),Hn.prototype.constructor=Hn;function Oe(i){this.__wrapped__=i,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=He,this.__views__=[]}function N1(){var i=new Oe(this.__wrapped__);return i.__actions__=yn(this.__actions__),i.__dir__=this.__dir__,i.__filtered__=this.__filtered__,i.__iteratees__=yn(this.__iteratees__),i.__takeCount__=this.__takeCount__,i.__views__=yn(this.__views__),i}function O1(){if(this.__filtered__){var i=new Oe(this);i.__dir__=-1,i.__filtered__=!0}else i=this.clone(),i.__dir__*=-1;return i}function U1(){var i=this.__wrapped__.value(),a=this.__dir__,l=Ae(i),D=a<0,b=l?i.length:0,A=Zv(0,b,this.__views__),k=A.start,O=A.end,M=O-k,Z=D?O:k-1,J=this.__iteratees__,ee=J.length,oe=0,ye=Vt(M,this.__takeCount__);if(!l||!D&&b==M&&ye==M)return Fp(i,this.__actions__);var Ee=[];e:for(;M--&&oe<ye;){Z+=a;for(var ke=-1,ve=i[Z];++ke<ee;){var Pe=J[ke],Me=Pe.iteratee,Rn=Pe.type,un=Me(ve);if(Rn==_i)ve=un;else if(!un){if(Rn==ni)continue e;break e}}Ee[oe++]=ve}return Ee}Oe.prototype=us(ca.prototype),Oe.prototype.constructor=Oe;function Ri(i){var a=-1,l=i==null?0:i.length;for(this.clear();++a<l;){var D=i[a];this.set(D[0],D[1])}}function M1(){this.__data__=Js?Js(null):{},this.size=0}function $1(i){var a=this.has(i)&&delete this.__data__[i];return this.size-=a?1:0,a}function L1(i){var a=this.__data__;if(Js){var l=a[i];return l===d?n:l}return je.call(a,i)?a[i]:n}function z1(i){var a=this.__data__;return Js?a[i]!==n:je.call(a,i)}function H1(i,a){var l=this.__data__;return this.size+=this.has(i)?0:1,l[i]=Js&&a===n?d:a,this}Ri.prototype.clear=M1,Ri.prototype.delete=$1,Ri.prototype.get=L1,Ri.prototype.has=z1,Ri.prototype.set=H1;function Nr(i){var a=-1,l=i==null?0:i.length;for(this.clear();++a<l;){var D=i[a];this.set(D[0],D[1])}}function G1(){this.__data__=[],this.size=0}function q1(i){var a=this.__data__,l=la(a,i);if(l<0)return!1;var D=a.length-1;return l==D?a.pop():ra.call(a,l,1),--this.size,!0}function j1(i){var a=this.__data__,l=la(a,i);return l<0?n:a[l][1]}function W1(i){return la(this.__data__,i)>-1}function K1(i,a){var l=this.__data__,D=la(l,i);return D<0?(++this.size,l.push([i,a])):l[D][1]=a,this}Nr.prototype.clear=G1,Nr.prototype.delete=q1,Nr.prototype.get=j1,Nr.prototype.has=W1,Nr.prototype.set=K1;function Or(i){var a=-1,l=i==null?0:i.length;for(this.clear();++a<l;){var D=i[a];this.set(D[0],D[1])}}function V1(){this.size=0,this.__data__={hash:new Ri,map:new(Vs||Nr),string:new Ri}}function Z1(i){var a=va(this,i).delete(i);return this.size-=a?1:0,a}function J1(i){return va(this,i).get(i)}function X1(i){return va(this,i).has(i)}function Y1(i,a){var l=va(this,i),D=l.size;return l.set(i,a),this.size+=l.size==D?0:1,this}Or.prototype.clear=V1,Or.prototype.delete=Z1,Or.prototype.get=J1,Or.prototype.has=X1,Or.prototype.set=Y1;function Ti(i){var a=-1,l=i==null?0:i.length;for(this.__data__=new Or;++a<l;)this.add(i[a])}function Q1(i){return this.__data__.set(i,d),this}function ev(i){return this.__data__.has(i)}Ti.prototype.add=Ti.prototype.push=Q1,Ti.prototype.has=ev;function ir(i){var a=this.__data__=new Nr(i);this.size=a.size}function tv(){this.__data__=new Nr,this.size=0}function nv(i){var a=this.__data__,l=a.delete(i);return this.size=a.size,l}function rv(i){return this.__data__.get(i)}function iv(i){return this.__data__.has(i)}function sv(i,a){var l=this.__data__;if(l instanceof Nr){var D=l.__data__;if(!Vs||D.length<s-1)return D.push([i,a]),this.size=++l.size,this;l=this.__data__=new Or(D)}return l.set(i,a),this.size=l.size,this}ir.prototype.clear=tv,ir.prototype.delete=nv,ir.prototype.get=rv,ir.prototype.has=iv,ir.prototype.set=sv;function ip(i,a){var l=Ae(i),D=!l&&Mi(i),b=!l&&!D&&di(i),A=!l&&!D&&!b&&ds(i),k=l||D||b||A,O=k?rc(i.length,g1):[],M=O.length;for(var Z in i)(a||je.call(i,Z))&&!(k&&(Z=="length"||b&&(Z=="offset"||Z=="parent")||A&&(Z=="buffer"||Z=="byteLength"||Z=="byteOffset")||Lr(Z,M)))&&O.push(Z);return O}function sp(i){var a=i.length;return a?i[bc(0,a-1)]:n}function ov(i,a){return Sa(yn(i),Pi(a,0,i.length))}function av(i){return Sa(yn(i))}function lc(i,a,l){(l!==n&&!sr(i[a],l)||l===n&&!(a in i))&&Ur(i,a,l)}function Ys(i,a,l){var D=i[a];(!(je.call(i,a)&&sr(D,l))||l===n&&!(a in i))&&Ur(i,a,l)}function la(i,a){for(var l=i.length;l--;)if(sr(i[l][0],a))return l;return-1}function uv(i,a,l,D){return ui(i,function(b,A,k){a(D,b,l(b),k)}),D}function op(i,a){return i&&yr(a,Nt(a),i)}function cv(i,a){return i&&yr(a,wn(a),i)}function Ur(i,a,l){a=="__proto__"&&ia?ia(i,a,{configurable:!0,enumerable:!0,value:l,writable:!0}):i[a]=l}function fc(i,a){for(var l=-1,D=a.length,b=G(D),A=i==null;++l<D;)b[l]=A?n:jc(i,a[l]);return b}function Pi(i,a,l){return i===i&&(l!==n&&(i=i<=l?i:l),a!==n&&(i=i>=a?i:a)),i}function Gn(i,a,l,D,b,A){var k,O=a&y,M=a&w,Z=a&E;if(l&&(k=b?l(i,D,b,A):l(i)),k!==n)return k;if(!st(i))return i;var J=Ae(i);if(J){if(k=Xv(i),!O)return yn(i,k)}else{var ee=Zt(i),oe=ee==pr||ee==Fn;if(di(i))return Bp(i,O);if(ee==rn||ee==zt||oe&&!b){if(k=M||oe?{}:Zp(i),!O)return M?Lv(i,cv(k,i)):$v(i,op(k,i))}else{if(!et[ee])return b?i:{};k=Yv(i,ee,O)}}A||(A=new ir);var ye=A.get(i);if(ye)return ye;A.set(i,k),Cg(i)?i.forEach(function(ve){k.add(Gn(ve,a,l,ve,i,A))}):vg(i)&&i.forEach(function(ve,Pe){k.set(Pe,Gn(ve,a,l,Pe,i,A))});var Ee=Z?M?kc:Bc:M?wn:Nt,ke=J?n:Ee(i);return Ln(ke||i,function(ve,Pe){ke&&(Pe=ve,ve=i[Pe]),Ys(k,Pe,Gn(ve,a,l,Pe,i,A))}),k}function lv(i){var a=Nt(i);return function(l){return ap(l,i,a)}}function ap(i,a,l){var D=l.length;if(i==null)return!D;for(i=Xe(i);D--;){var b=l[D],A=a[b],k=i[b];if(k===n&&!(b in i)||!A(k))return!1}return!0}function up(i,a,l){if(typeof i!="function")throw new zn(u);return so(function(){i.apply(n,l)},a)}function Qs(i,a,l,D){var b=-1,A=Ko,k=!0,O=i.length,M=[],Z=a.length;if(!O)return M;l&&(a=it(a,In(l))),D?(A=Xu,k=!1):a.length>=s&&(A=Ws,k=!1,a=new Ti(a));e:for(;++b<O;){var J=i[b],ee=l==null?J:l(J);if(J=D||J!==0?J:0,k&&ee===ee){for(var oe=Z;oe--;)if(a[oe]===ee)continue e;M.push(J)}else A(a,ee,D)||M.push(J)}return M}var ui=Np(mr),cp=Np(hc,!0);function fv(i,a){var l=!0;return ui(i,function(D,b,A){return l=!!a(D,b,A),l}),l}function fa(i,a,l){for(var D=-1,b=i.length;++D<b;){var A=i[D],k=a(A);if(k!=null&&(O===n?k===k&&!kn(k):l(k,O)))var O=k,M=A}return M}function dv(i,a,l,D){var b=i.length;for(l=Be(l),l<0&&(l=-l>b?0:b+l),D=D===n||D>b?b:Be(D),D<0&&(D+=b),D=l>D?0:Ag(D);l<D;)i[l++]=a;return i}function lp(i,a){var l=[];return ui(i,function(D,b,A){a(D,b,A)&&l.push(D)}),l}function Gt(i,a,l,D,b){var A=-1,k=i.length;for(l||(l=eS),b||(b=[]);++A<k;){var O=i[A];a>0&&l(O)?a>1?Gt(O,a-1,l,D,b):si(b,O):D||(b[b.length]=O)}return b}var dc=Op(),fp=Op(!0);function mr(i,a){return i&&dc(i,a,Nt)}function hc(i,a){return i&&fp(i,a,Nt)}function da(i,a){return ii(a,function(l){return zr(i[l])})}function Ni(i,a){a=li(a,i);for(var l=0,D=a.length;i!=null&&l<D;)i=i[Dr(a[l++])];return l&&l==D?i:n}function dp(i,a,l){var D=a(i);return Ae(i)?D:si(D,l(i))}function on(i){return i==null?i===n?be:qs:ki&&ki in Xe(i)?Vv(i):aS(i)}function pc(i,a){return i>a}function hv(i,a){return i!=null&&je.call(i,a)}function pv(i,a){return i!=null&&a in Xe(i)}function gv(i,a,l){return i>=Vt(a,l)&&i<Tt(a,l)}function gc(i,a,l){for(var D=l?Xu:Ko,b=i[0].length,A=i.length,k=A,O=G(A),M=1/0,Z=[];k--;){var J=i[k];k&&a&&(J=it(J,In(a))),M=Vt(J.length,M),O[k]=!l&&(a||b>=120&&J.length>=120)?new Ti(k&&J):n}J=i[0];var ee=-1,oe=O[0];e:for(;++ee<b&&Z.length<M;){var ye=J[ee],Ee=a?a(ye):ye;if(ye=l||ye!==0?ye:0,!(oe?Ws(oe,Ee):D(Z,Ee,l))){for(k=A;--k;){var ke=O[k];if(!(ke?Ws(ke,Ee):D(i[k],Ee,l)))continue e}oe&&oe.push(Ee),Z.push(ye)}}return Z}function mv(i,a,l,D){return mr(i,function(b,A,k){a(D,l(b),A,k)}),D}function eo(i,a,l){a=li(a,i),i=Qp(i,a);var D=i==null?i:i[Dr(jn(a))];return D==null?n:_n(D,i,l)}function hp(i){return ct(i)&&on(i)==zt}function yv(i){return ct(i)&&on(i)==g}function Dv(i){return ct(i)&&on(i)==nr}function to(i,a,l,D,b){return i===a?!0:i==null||a==null||!ct(i)&&!ct(a)?i!==i&&a!==a:wv(i,a,l,D,to,b)}function wv(i,a,l,D,b,A){var k=Ae(i),O=Ae(a),M=k?hr:Zt(i),Z=O?hr:Zt(a);M=M==zt?rn:M,Z=Z==zt?rn:Z;var J=M==rn,ee=Z==rn,oe=M==Z;if(oe&&di(i)){if(!di(a))return!1;k=!0,J=!1}if(oe&&!J)return A||(A=new ir),k||ds(i)?Wp(i,a,l,D,b,A):Wv(i,a,M,l,D,b,A);if(!(l&F)){var ye=J&&je.call(i,"__wrapped__"),Ee=ee&&je.call(a,"__wrapped__");if(ye||Ee){var ke=ye?i.value():i,ve=Ee?a.value():a;return A||(A=new ir),b(ke,ve,l,D,A)}}return oe?(A||(A=new ir),Kv(i,a,l,D,b,A)):!1}function bv(i){return ct(i)&&Zt(i)==Ct}function mc(i,a,l,D){var b=l.length,A=b,k=!D;if(i==null)return!A;for(i=Xe(i);b--;){var O=l[b];if(k&&O[2]?O[1]!==i[O[0]]:!(O[0]in i))return!1}for(;++b<A;){O=l[b];var M=O[0],Z=i[M],J=O[1];if(k&&O[2]){if(Z===n&&!(M in i))return!1}else{var ee=new ir;if(D)var oe=D(Z,J,M,i,a,ee);if(!(oe===n?to(J,Z,F|I,D,ee):oe))return!1}}return!0}function pp(i){if(!st(i)||nS(i))return!1;var a=zr(i)?b1:lE;return a.test(Ui(i))}function Ev(i){return ct(i)&&on(i)==mn}function vv(i){return ct(i)&&Zt(i)==Bt}function Sv(i){return ct(i)&&Ia(i.length)&&!!nt[on(i)]}function gp(i){return typeof i=="function"?i:i==null?bn:typeof i=="object"?Ae(i)?Dp(i[0],i[1]):yp(i):Ug(i)}function yc(i){if(!io(i))return A1(i);var a=[];for(var l in Xe(i))je.call(i,l)&&l!="constructor"&&a.push(l);return a}function Cv(i){if(!st(i))return oS(i);var a=io(i),l=[];for(var D in i)D=="constructor"&&(a||!je.call(i,D))||l.push(D);return l}function Dc(i,a){return i<a}function mp(i,a){var l=-1,D=Dn(i)?G(i.length):[];return ui(i,function(b,A,k){D[++l]=a(b,A,k)}),D}function yp(i){var a=Tc(i);return a.length==1&&a[0][2]?Xp(a[0][0],a[0][1]):function(l){return l===i||mc(l,i,a)}}function Dp(i,a){return Nc(i)&&Jp(a)?Xp(Dr(i),a):function(l){var D=jc(l,i);return D===n&&D===a?Wc(l,i):to(a,D,F|I)}}function ha(i,a,l,D,b){i!==a&&dc(a,function(A,k){if(b||(b=new ir),st(A))xv(i,a,k,l,ha,D,b);else{var O=D?D(Uc(i,k),A,k+"",i,a,b):n;O===n&&(O=A),lc(i,k,O)}},wn)}function xv(i,a,l,D,b,A,k){var O=Uc(i,l),M=Uc(a,l),Z=k.get(M);if(Z){lc(i,l,Z);return}var J=A?A(O,M,l+"",i,a,k):n,ee=J===n;if(ee){var oe=Ae(M),ye=!oe&&di(M),Ee=!oe&&!ye&&ds(M);J=M,oe||ye||Ee?Ae(O)?J=O:dt(O)?J=yn(O):ye?(ee=!1,J=Bp(M,!0)):Ee?(ee=!1,J=kp(M,!0)):J=[]:oo(M)||Mi(M)?(J=O,Mi(O)?J=Fg(O):(!st(O)||zr(O))&&(J=Zp(M))):ee=!1}ee&&(k.set(M,J),b(J,M,D,A,k),k.delete(M)),lc(i,l,J)}function wp(i,a){var l=i.length;if(l)return a+=a<0?l:0,Lr(a,l)?i[a]:n}function bp(i,a,l){a.length?a=it(a,function(A){return Ae(A)?function(k){return Ni(k,A.length===1?A[0]:A)}:A}):a=[bn];var D=-1;a=it(a,In(we()));var b=mp(i,function(A,k,O){var M=it(a,function(Z){return Z(A)});return{criteria:M,index:++D,value:A}});return YE(b,function(A,k){return Mv(A,k,l)})}function Av(i,a){return Ep(i,a,function(l,D){return Wc(i,D)})}function Ep(i,a,l){for(var D=-1,b=a.length,A={};++D<b;){var k=a[D],O=Ni(i,k);l(O,k)&&no(A,li(k,i),O)}return A}function Fv(i){return function(a){return Ni(a,i)}}function wc(i,a,l,D){var b=D?XE:ts,A=-1,k=a.length,O=i;for(i===a&&(a=yn(a)),l&&(O=it(i,In(l)));++A<k;)for(var M=0,Z=a[A],J=l?l(Z):Z;(M=b(O,J,M,D))>-1;)O!==i&&ra.call(O,M,1),ra.call(i,M,1);return i}function vp(i,a){for(var l=i?a.length:0,D=l-1;l--;){var b=a[l];if(l==D||b!==A){var A=b;Lr(b)?ra.call(i,b,1):Sc(i,b)}}return i}function bc(i,a){return i+oa(np()*(a-i+1))}function _v(i,a,l,D){for(var b=-1,A=Tt(sa((a-i)/(l||1)),0),k=G(A);A--;)k[D?A:++b]=i,i+=l;return k}function Ec(i,a){var l="";if(!i||a<1||a>An)return l;do a%2&&(l+=i),a=oa(a/2),a&&(i+=i);while(a);return l}function Te(i,a){return Mc(Yp(i,a,bn),i+"")}function Iv(i){return sp(hs(i))}function Bv(i,a){var l=hs(i);return Sa(l,Pi(a,0,l.length))}function no(i,a,l,D){if(!st(i))return i;a=li(a,i);for(var b=-1,A=a.length,k=A-1,O=i;O!=null&&++b<A;){var M=Dr(a[b]),Z=l;if(M==="__proto__"||M==="constructor"||M==="prototype")return i;if(b!=k){var J=O[M];Z=D?D(J,M,O):n,Z===n&&(Z=st(J)?J:Lr(a[b+1])?[]:{})}Ys(O,M,Z),O=O[M]}return i}var Sp=aa?function(i,a){return aa.set(i,a),i}:bn,kv=ia?function(i,a){return ia(i,"toString",{configurable:!0,enumerable:!1,value:Vc(a),writable:!0})}:bn;function Rv(i){return Sa(hs(i))}function qn(i,a,l){var D=-1,b=i.length;a<0&&(a=-a>b?0:b+a),l=l>b?b:l,l<0&&(l+=b),b=a>l?0:l-a>>>0,a>>>=0;for(var A=G(b);++D<b;)A[D]=i[D+a];return A}function Tv(i,a){var l;return ui(i,function(D,b,A){return l=a(D,b,A),!l}),!!l}function pa(i,a,l){var D=0,b=i==null?D:i.length;if(typeof a=="number"&&a===a&&b<=gn){for(;D<b;){var A=D+b>>>1,k=i[A];k!==null&&!kn(k)&&(l?k<=a:k<a)?D=A+1:b=A}return b}return vc(i,a,bn,l)}function vc(i,a,l,D){var b=0,A=i==null?0:i.length;if(A===0)return 0;a=l(a);for(var k=a!==a,O=a===null,M=kn(a),Z=a===n;b<A;){var J=oa((b+A)/2),ee=l(i[J]),oe=ee!==n,ye=ee===null,Ee=ee===ee,ke=kn(ee);if(k)var ve=D||Ee;else Z?ve=Ee&&(D||oe):O?ve=Ee&&oe&&(D||!ye):M?ve=Ee&&oe&&!ye&&(D||!ke):ye||ke?ve=!1:ve=D?ee<=a:ee<a;ve?b=J+1:A=J}return Vt(A,St)}function Cp(i,a){for(var l=-1,D=i.length,b=0,A=[];++l<D;){var k=i[l],O=a?a(k):k;if(!l||!sr(O,M)){var M=O;A[b++]=k===0?0:k}}return A}function xp(i){return typeof i=="number"?i:kn(i)?pn:+i}function Bn(i){if(typeof i=="string")return i;if(Ae(i))return it(i,Bn)+"";if(kn(i))return rp?rp.call(i):"";var a=i+"";return a=="0"&&1/i==-er?"-0":a}function ci(i,a,l){var D=-1,b=Ko,A=i.length,k=!0,O=[],M=O;if(l)k=!1,b=Xu;else if(A>=s){var Z=a?null:qv(i);if(Z)return Zo(Z);k=!1,b=Ws,M=new Ti}else M=a?[]:O;e:for(;++D<A;){var J=i[D],ee=a?a(J):J;if(J=l||J!==0?J:0,k&&ee===ee){for(var oe=M.length;oe--;)if(M[oe]===ee)continue e;a&&M.push(ee),O.push(J)}else b(M,ee,l)||(M!==O&&M.push(ee),O.push(J))}return O}function Sc(i,a){a=li(a,i);var l=-1,D=a.length;if(!D)return!0;for(var b=i==null||typeof i!="object"&&typeof i!="function";++l<D;){var A=a[l];if(typeof A=="string"){if(A==="__proto__"&&!je.call(i,"__proto__"))return!1;if(A==="constructor"&&l+1<D&&typeof a[l+1]=="string"&&a[l+1]==="prototype"){if(b&&l===0)continue;return!1}}}var k=Qp(i,a);return k==null||delete k[Dr(jn(a))]}function Ap(i,a,l,D){return no(i,a,l(Ni(i,a)),D)}function ga(i,a,l,D){for(var b=i.length,A=D?b:-1;(D?A--:++A<b)&&a(i[A],A,i););return l?qn(i,D?0:A,D?A+1:b):qn(i,D?A+1:0,D?b:A)}function Fp(i,a){var l=i;return l instanceof Oe&&(l=l.value()),Yu(a,function(D,b){return b.func.apply(b.thisArg,si([D],b.args))},l)}function Cc(i,a,l){var D=i.length;if(D<2)return D?ci(i[0]):[];for(var b=-1,A=G(D);++b<D;)for(var k=i[b],O=-1;++O<D;)O!=b&&(A[b]=Qs(A[b]||k,i[O],a,l));return ci(Gt(A,1),a,l)}function _p(i,a,l){for(var D=-1,b=i.length,A=a.length,k={};++D<b;){var O=D<A?a[D]:n;l(k,i[D],O)}return k}function xc(i){return dt(i)?i:[]}function Ac(i){return typeof i=="function"?i:bn}function li(i,a){return Ae(i)?i:Nc(i,a)?[i]:rg(We(i))}var Pv=Te;function fi(i,a,l){var D=i.length;return l=l===n?D:l,!a&&l>=D?i:qn(i,a,l)}var Ip=E1||function(i){return Ht.clearTimeout(i)};function Bp(i,a){if(a)return i.slice();var l=i.length,D=Xh?Xh(l):new i.constructor(l);return i.copy(D),D}function Fc(i){var a=new i.constructor(i.byteLength);return new ta(a).set(new ta(i)),a}function Nv(i,a){var l=a?Fc(i.buffer):i.buffer;return new i.constructor(l,i.byteOffset,i.byteLength)}function Ov(i){var a=new i.constructor(i.source,hh.exec(i));return a.lastIndex=i.lastIndex,a}function Uv(i){return Xs?Xe(Xs.call(i)):{}}function kp(i,a){var l=a?Fc(i.buffer):i.buffer;return new i.constructor(l,i.byteOffset,i.length)}function Rp(i,a){if(i!==a){var l=i!==n,D=i===null,b=i===i,A=kn(i),k=a!==n,O=a===null,M=a===a,Z=kn(a);if(!O&&!Z&&!A&&i>a||A&&k&&M&&!O&&!Z||D&&k&&M||!l&&M||!b)return 1;if(!D&&!A&&!Z&&i<a||Z&&l&&b&&!D&&!A||O&&l&&b||!k&&b||!M)return-1}return 0}function Mv(i,a,l){for(var D=-1,b=i.criteria,A=a.criteria,k=b.length,O=l.length;++D<k;){var M=Rp(b[D],A[D]);if(M){if(D>=O)return M;var Z=l[D];return M*(Z=="desc"?-1:1)}}return i.index-a.index}function Tp(i,a,l,D){for(var b=-1,A=i.length,k=l.length,O=-1,M=a.length,Z=Tt(A-k,0),J=G(M+Z),ee=!D;++O<M;)J[O]=a[O];for(;++b<k;)(ee||b<A)&&(J[l[b]]=i[b]);for(;Z--;)J[O++]=i[b++];return J}function Pp(i,a,l,D){for(var b=-1,A=i.length,k=-1,O=l.length,M=-1,Z=a.length,J=Tt(A-O,0),ee=G(J+Z),oe=!D;++b<J;)ee[b]=i[b];for(var ye=b;++M<Z;)ee[ye+M]=a[M];for(;++k<O;)(oe||b<A)&&(ee[ye+l[k]]=i[b++]);return ee}function yn(i,a){var l=-1,D=i.length;for(a||(a=G(D));++l<D;)a[l]=i[l];return a}function yr(i,a,l,D){var b=!l;l||(l={});for(var A=-1,k=a.length;++A<k;){var O=a[A],M=D?D(l[O],i[O],O,l,i):n;M===n&&(M=i[O]),b?Ur(l,O,M):Ys(l,O,M)}return l}function $v(i,a){return yr(i,Pc(i),a)}function Lv(i,a){return yr(i,Kp(i),a)}function ma(i,a){return function(l,D){var b=Ae(l)?jE:uv,A=a?a():{};return b(l,i,we(D,2),A)}}function cs(i){return Te(function(a,l){var D=-1,b=l.length,A=b>1?l[b-1]:n,k=b>2?l[2]:n;for(A=i.length>3&&typeof A=="function"?(b--,A):n,k&&an(l[0],l[1],k)&&(A=b<3?n:A,b=1),a=Xe(a);++D<b;){var O=l[D];O&&i(a,O,D,A)}return a})}function Np(i,a){return function(l,D){if(l==null)return l;if(!Dn(l))return i(l,D);for(var b=l.length,A=a?b:-1,k=Xe(l);(a?A--:++A<b)&&D(k[A],A,k)!==!1;);return l}}function Op(i){return function(a,l,D){for(var b=-1,A=Xe(a),k=D(a),O=k.length;O--;){var M=k[i?O:++b];if(l(A[M],M,A)===!1)break}return a}}function zv(i,a,l){var D=a&T,b=ro(i);function A(){var k=this&&this!==Ht&&this instanceof A?b:i;return k.apply(D?l:this,arguments)}return A}function Up(i){return function(a){a=We(a);var l=ns(a)?rr(a):n,D=l?l[0]:a.charAt(0),b=l?fi(l,1).join(""):a.slice(1);return D[i]()+b}}function ls(i){return function(a){return Yu(Ng(Pg(a).replace(kE,"")),i,"")}}function ro(i){return function(){var a=arguments;switch(a.length){case 0:return new i;case 1:return new i(a[0]);case 2:return new i(a[0],a[1]);case 3:return new i(a[0],a[1],a[2]);case 4:return new i(a[0],a[1],a[2],a[3]);case 5:return new i(a[0],a[1],a[2],a[3],a[4]);case 6:return new i(a[0],a[1],a[2],a[3],a[4],a[5]);case 7:return new i(a[0],a[1],a[2],a[3],a[4],a[5],a[6])}var l=us(i.prototype),D=i.apply(l,a);return st(D)?D:l}}function Hv(i,a,l){var D=ro(i);function b(){for(var A=arguments.length,k=G(A),O=A,M=fs(b);O--;)k[O]=arguments[O];var Z=A<3&&k[0]!==M&&k[A-1]!==M?[]:oi(k,M);if(A-=Z.length,A<l)return Hp(i,a,ya,b.placeholder,n,k,Z,n,n,l-A);var J=this&&this!==Ht&&this instanceof b?D:i;return _n(J,this,k)}return b}function Mp(i){return function(a,l,D){var b=Xe(a);if(!Dn(a)){var A=we(l,3);a=Nt(a),l=function(O){return A(b[O],O,b)}}var k=i(a,l,D);return k>-1?b[A?a[k]:k]:n}}function $p(i){return $r(function(a){var l=a.length,D=l,b=Hn.prototype.thru;for(i&&a.reverse();D--;){var A=a[D];if(typeof A!="function")throw new zn(u);if(b&&!k&&Ea(A)=="wrapper")var k=new Hn([],!0)}for(D=k?D:l;++D<l;){A=a[D];var O=Ea(A),M=O=="wrapper"?Rc(A):n;M&&Oc(M[0])&&M[1]==(De|H|te|rt)&&!M[4].length&&M[9]==1?k=k[Ea(M[0])].apply(k,M[3]):k=A.length==1&&Oc(A)?k[O]():k.thru(A)}return function(){var Z=arguments,J=Z[0];if(k&&Z.length==1&&Ae(J))return k.plant(J).value();for(var ee=0,oe=l?a[ee].apply(this,Z):J;++ee<l;)oe=a[ee].call(this,oe);return oe}})}function ya(i,a,l,D,b,A,k,O,M,Z){var J=a&De,ee=a&T,oe=a&$,ye=a&(H|Q),Ee=a&Je,ke=oe?n:ro(i);function ve(){for(var Pe=arguments.length,Me=G(Pe),Rn=Pe;Rn--;)Me[Rn]=arguments[Rn];if(ye)var un=fs(ve),Tn=e1(Me,un);if(D&&(Me=Tp(Me,D,b,ye)),A&&(Me=Pp(Me,A,k,ye)),Pe-=Tn,ye&&Pe<Z){var ht=oi(Me,un);return Hp(i,a,ya,ve.placeholder,l,Me,ht,O,M,Z-Pe)}var or=ee?l:this,Gr=oe?or[i]:i;return Pe=Me.length,O?Me=uS(Me,O):Ee&&Pe>1&&Me.reverse(),J&&M<Pe&&(Me.length=M),this&&this!==Ht&&this instanceof ve&&(Gr=ke||ro(Gr)),Gr.apply(or,Me)}return ve}function Lp(i,a){return function(l,D){return mv(l,i,a(D),{})}}function Da(i,a){return function(l,D){var b;if(l===n&&D===n)return a;if(l!==n&&(b=l),D!==n){if(b===n)return D;typeof l=="string"||typeof D=="string"?(l=Bn(l),D=Bn(D)):(l=xp(l),D=xp(D)),b=i(l,D)}return b}}function _c(i){return $r(function(a){return a=it(a,In(we())),Te(function(l){var D=this;return i(a,function(b){return _n(b,D,l)})})})}function wa(i,a){a=a===n?" ":Bn(a);var l=a.length;if(l<2)return l?Ec(a,i):a;var D=Ec(a,sa(i/rs(a)));return ns(a)?fi(rr(D),0,i).join(""):D.slice(0,i)}function Gv(i,a,l,D){var b=a&T,A=ro(i);function k(){for(var O=-1,M=arguments.length,Z=-1,J=D.length,ee=G(J+M),oe=this&&this!==Ht&&this instanceof k?A:i;++Z<J;)ee[Z]=D[Z];for(;M--;)ee[Z++]=arguments[++O];return _n(oe,b?l:this,ee)}return k}function zp(i){return function(a,l,D){return D&&typeof D!="number"&&an(a,l,D)&&(l=D=n),a=Hr(a),l===n?(l=a,a=0):l=Hr(l),D=D===n?a<l?1:-1:Hr(D),_v(a,l,D,i)}}function ba(i){return function(a,l){return typeof a=="string"&&typeof l=="string"||(a=Wn(a),l=Wn(l)),i(a,l)}}function Hp(i,a,l,D,b,A,k,O,M,Z){var J=a&H,ee=J?k:n,oe=J?n:k,ye=J?A:n,Ee=J?n:A;a|=J?te:ge,a&=~(J?ge:te),a&V||(a&=-4);var ke=[i,a,b,ye,ee,Ee,oe,O,M,Z],ve=l.apply(n,ke);return Oc(i)&&eg(ve,ke),ve.placeholder=D,tg(ve,i,a)}function Ic(i){var a=Rt[i];return function(l,D){if(l=Wn(l),D=D==null?0:Vt(Be(D),292),D&&tp(l)){var b=(We(l)+"e").split("e"),A=a(b[0]+"e"+(+b[1]+D));return b=(We(A)+"e").split("e"),+(b[0]+"e"+(+b[1]-D))}return a(l)}}var qv=os&&1/Zo(new os([,-0]))[1]==er?function(i){return new os(i)}:Xc;function Gp(i){return function(a){var l=Zt(a);return l==Ct?sc(a):l==Bt?a1(a):QE(a,i(a))}}function Mr(i,a,l,D,b,A,k,O){var M=a&$;if(!M&&typeof i!="function")throw new zn(u);var Z=D?D.length:0;if(Z||(a&=-97,D=b=n),k=k===n?k:Tt(Be(k),0),O=O===n?O:Be(O),Z-=b?b.length:0,a&ge){var J=D,ee=b;D=b=n}var oe=M?n:Rc(i),ye=[i,a,l,D,b,J,ee,A,k,O];if(oe&&sS(ye,oe),i=ye[0],a=ye[1],l=ye[2],D=ye[3],b=ye[4],O=ye[9]=ye[9]===n?M?0:i.length:Tt(ye[9]-Z,0),!O&&a&(H|Q)&&(a&=-25),!a||a==T)var Ee=zv(i,a,l);else a==H||a==Q?Ee=Hv(i,a,O):(a==te||a==(T|te))&&!b.length?Ee=Gv(i,a,l,D):Ee=ya.apply(n,ye);var ke=oe?Sp:eg;return tg(ke(Ee,ye),i,a)}function qp(i,a,l,D){return i===n||sr(i,ss[l])&&!je.call(D,l)?a:i}function jp(i,a,l,D,b,A){return st(i)&&st(a)&&(A.set(a,i),ha(i,a,n,jp,A),A.delete(a)),i}function jv(i){return oo(i)?n:i}function Wp(i,a,l,D,b,A){var k=l&F,O=i.length,M=a.length;if(O!=M&&!(k&&M>O))return!1;var Z=A.get(i),J=A.get(a);if(Z&&J)return Z==a&&J==i;var ee=-1,oe=!0,ye=l&I?new Ti:n;for(A.set(i,a),A.set(a,i);++ee<O;){var Ee=i[ee],ke=a[ee];if(D)var ve=k?D(ke,Ee,ee,a,i,A):D(Ee,ke,ee,i,a,A);if(ve!==n){if(ve)continue;oe=!1;break}if(ye){if(!Qu(a,function(Pe,Me){if(!Ws(ye,Me)&&(Ee===Pe||b(Ee,Pe,l,D,A)))return ye.push(Me)})){oe=!1;break}}else if(!(Ee===ke||b(Ee,ke,l,D,A))){oe=!1;break}}return A.delete(i),A.delete(a),oe}function Wv(i,a,l,D,b,A,k){switch(l){case h:if(i.byteLength!=a.byteLength||i.byteOffset!=a.byteOffset)return!1;i=i.buffer,a=a.buffer;case g:return!(i.byteLength!=a.byteLength||!A(new ta(i),new ta(a)));case Wt:case nr:case Pr:return sr(+i,+a);case Tr:return i.name==a.name&&i.message==a.message;case mn:case kt:return i==a+"";case Ct:var O=sc;case Bt:var M=D&F;if(O||(O=Zo),i.size!=a.size&&!M)return!1;var Z=k.get(i);if(Z)return Z==a;D|=I,k.set(i,a);var J=Wp(O(i),O(a),D,b,A,k);return k.delete(i),J;case gr:if(Xs)return Xs.call(i)==Xs.call(a)}return!1}function Kv(i,a,l,D,b,A){var k=l&F,O=Bc(i),M=O.length,Z=Bc(a),J=Z.length;if(M!=J&&!k)return!1;for(var ee=M;ee--;){var oe=O[ee];if(!(k?oe in a:je.call(a,oe)))return!1}var ye=A.get(i),Ee=A.get(a);if(ye&&Ee)return ye==a&&Ee==i;var ke=!0;A.set(i,a),A.set(a,i);for(var ve=k;++ee<M;){oe=O[ee];var Pe=i[oe],Me=a[oe];if(D)var Rn=k?D(Me,Pe,oe,a,i,A):D(Pe,Me,oe,i,a,A);if(!(Rn===n?Pe===Me||b(Pe,Me,l,D,A):Rn)){ke=!1;break}ve||(ve=oe=="constructor")}if(ke&&!ve){var un=i.constructor,Tn=a.constructor;un!=Tn&&"constructor"in i&&"constructor"in a&&!(typeof un=="function"&&un instanceof un&&typeof Tn=="function"&&Tn instanceof Tn)&&(ke=!1)}return A.delete(i),A.delete(a),ke}function $r(i){return Mc(Yp(i,n,ag),i+"")}function Bc(i){return dp(i,Nt,Pc)}function kc(i){return dp(i,wn,Kp)}var Rc=aa?function(i){return aa.get(i)}:Xc;function Ea(i){for(var a=i.name+"",l=as[a],D=je.call(as,a)?l.length:0;D--;){var b=l[D],A=b.func;if(A==null||A==i)return b.name}return a}function fs(i){var a=je.call(x,"placeholder")?x:i;return a.placeholder}function we(){var i=x.iteratee||Zc;return i=i===Zc?gp:i,arguments.length?i(arguments[0],arguments[1]):i}function va(i,a){var l=i.__data__;return tS(a)?l[typeof a=="string"?"string":"hash"]:l.map}function Tc(i){for(var a=Nt(i),l=a.length;l--;){var D=a[l],b=i[D];a[l]=[D,b,Jp(b)]}return a}function Oi(i,a){var l=i1(i,a);return pp(l)?l:n}function Vv(i){var a=je.call(i,ki),l=i[ki];try{i[ki]=n;var D=!0}catch{}var b=Qo.call(i);return D&&(a?i[ki]=l:delete i[ki]),b}var Pc=ac?function(i){return i==null?[]:(i=Xe(i),ii(ac(i),function(a){return Qh.call(i,a)}))}:Yc,Kp=ac?function(i){for(var a=[];i;)si(a,Pc(i)),i=na(i);return a}:Yc,Zt=on;(uc&&Zt(new uc(new ArrayBuffer(1)))!=h||Vs&&Zt(new Vs)!=Ct||cc&&Zt(cc.resolve())!=Ii||os&&Zt(new os)!=Bt||Zs&&Zt(new Zs)!=ut)&&(Zt=function(i){var a=on(i),l=a==rn?i.constructor:n,D=l?Ui(l):"";if(D)switch(D){case B1:return h;case k1:return Ct;case R1:return Ii;case T1:return Bt;case P1:return ut}return a});function Zv(i,a,l){for(var D=-1,b=l.length;++D<b;){var A=l[D],k=A.size;switch(A.type){case"drop":i+=k;break;case"dropRight":a-=k;break;case"take":a=Vt(a,i+k);break;case"takeRight":i=Tt(i,a-k);break}}return{start:i,end:a}}function Jv(i){var a=i.match(nE);return a?a[1].split(rE):[]}function Vp(i,a,l){a=li(a,i);for(var D=-1,b=a.length,A=!1;++D<b;){var k=Dr(a[D]);if(!(A=i!=null&&l(i,k)))break;i=i[k]}return A||++D!=b?A:(b=i==null?0:i.length,!!b&&Ia(b)&&Lr(k,b)&&(Ae(i)||Mi(i)))}function Xv(i){var a=i.length,l=new i.constructor(a);return a&&typeof i[0]=="string"&&je.call(i,"index")&&(l.index=i.index,l.input=i.input),l}function Zp(i){return typeof i.constructor=="function"&&!io(i)?us(na(i)):{}}function Yv(i,a,l){var D=i.constructor;switch(a){case g:return Fc(i);case Wt:case nr:return new D(+i);case h:return Nv(i,l);case p:case v:case C:case B:case R:case q:case ae:case de:case ce:return kp(i,l);case Ct:return new D;case Pr:case kt:return new D(i);case mn:return Ov(i);case Bt:return new D;case gr:return Uv(i)}}function Qv(i,a){var l=a.length;if(!l)return i;var D=l-1;return a[D]=(l>1?"& ":"")+a[D],a=a.join(l>2?", ":" "),i.replace(tE,`{
/* [wrapped with `+a+`] */
`)}function eS(i){return Ae(i)||Mi(i)||!!(ep&&i&&i[ep])}function Lr(i,a){var l=typeof i;return a=a??An,!!a&&(l=="number"||l!="symbol"&&dE.test(i))&&i>-1&&i%1==0&&i<a}function an(i,a,l){if(!st(l))return!1;var D=typeof a;return(D=="number"?Dn(l)&&Lr(a,l.length):D=="string"&&a in l)?sr(l[a],i):!1}function Nc(i,a){if(Ae(i))return!1;var l=typeof i;return l=="number"||l=="symbol"||l=="boolean"||i==null||kn(i)?!0:Xb.test(i)||!Jb.test(i)||a!=null&&i in Xe(a)}function tS(i){var a=typeof i;return a=="string"||a=="number"||a=="symbol"||a=="boolean"?i!=="__proto__":i===null}function Oc(i){var a=Ea(i),l=x[a];if(typeof l!="function"||!(a in Oe.prototype))return!1;if(i===l)return!0;var D=Rc(l);return!!D&&i===D[0]}function nS(i){return!!Jh&&Jh in i}var rS=Xo?zr:Qc;function io(i){var a=i&&i.constructor,l=typeof a=="function"&&a.prototype||ss;return i===l}function Jp(i){return i===i&&!st(i)}function Xp(i,a){return function(l){return l==null?!1:l[i]===a&&(a!==n||i in Xe(l))}}function iS(i){var a=Fa(i,function(D){return l.size===f&&l.clear(),D}),l=a.cache;return a}function sS(i,a){var l=i[1],D=a[1],b=l|D,A=b<(T|$|De),k=D==De&&l==H||D==De&&l==rt&&i[7].length<=a[8]||D==(De|rt)&&a[7].length<=a[8]&&l==H;if(!(A||k))return i;D&T&&(i[2]=a[2],b|=l&T?0:V);var O=a[3];if(O){var M=i[3];i[3]=M?Tp(M,O,a[4]):O,i[4]=M?oi(i[3],m):a[4]}return O=a[5],O&&(M=i[5],i[5]=M?Pp(M,O,a[6]):O,i[6]=M?oi(i[5],m):a[6]),O=a[7],O&&(i[7]=O),D&De&&(i[8]=i[8]==null?a[8]:Vt(i[8],a[8])),i[9]==null&&(i[9]=a[9]),i[0]=a[0],i[1]=b,i}function oS(i){var a=[];if(i!=null)for(var l in Xe(i))a.push(l);return a}function aS(i){return Qo.call(i)}function Yp(i,a,l){return a=Tt(a===n?i.length-1:a,0),function(){for(var D=arguments,b=-1,A=Tt(D.length-a,0),k=G(A);++b<A;)k[b]=D[a+b];b=-1;for(var O=G(a+1);++b<a;)O[b]=D[b];return O[a]=l(k),_n(i,this,O)}}function Qp(i,a){return a.length<2?i:Ni(i,qn(a,0,-1))}function uS(i,a){for(var l=i.length,D=Vt(a.length,l),b=yn(i);D--;){var A=a[D];i[D]=Lr(A,l)?b[A]:n}return i}function Uc(i,a){if(!(a==="constructor"&&typeof i[a]=="function")&&a!="__proto__")return i[a]}var eg=ng(Sp),so=S1||function(i,a){return Ht.setTimeout(i,a)},Mc=ng(kv);function tg(i,a,l){var D=a+"";return Mc(i,Qv(D,cS(Jv(D),l)))}function ng(i){var a=0,l=0;return function(){var D=F1(),b=Hs-(D-l);if(l=D,b>0){if(++a>=ti)return arguments[0]}else a=0;return i.apply(n,arguments)}}function Sa(i,a){var l=-1,D=i.length,b=D-1;for(a=a===n?D:a;++l<a;){var A=bc(l,b),k=i[A];i[A]=i[l],i[l]=k}return i.length=a,i}var rg=iS(function(i){var a=[];return i.charCodeAt(0)===46&&a.push(""),i.replace(Yb,function(l,D,b,A){a.push(b?A.replace(oE,"$1"):D||l)}),a});function Dr(i){if(typeof i=="string"||kn(i))return i;var a=i+"";return a=="0"&&1/i==-er?"-0":a}function Ui(i){if(i!=null){try{return Yo.call(i)}catch{}try{return i+""}catch{}}return""}function cS(i,a){return Ln(dr,function(l){var D="_."+l[0];a&l[1]&&!Ko(i,D)&&i.push(D)}),i.sort()}function ig(i){if(i instanceof Oe)return i.clone();var a=new Hn(i.__wrapped__,i.__chain__);return a.__actions__=yn(i.__actions__),a.__index__=i.__index__,a.__values__=i.__values__,a}function lS(i,a,l){(l?an(i,a,l):a===n)?a=1:a=Tt(Be(a),0);var D=i==null?0:i.length;if(!D||a<1)return[];for(var b=0,A=0,k=G(sa(D/a));b<D;)k[A++]=qn(i,b,b+=a);return k}function fS(i){for(var a=-1,l=i==null?0:i.length,D=0,b=[];++a<l;){var A=i[a];A&&(b[D++]=A)}return b}function dS(){var i=arguments.length;if(!i)return[];for(var a=G(i-1),l=arguments[0],D=i;D--;)a[D-1]=arguments[D];return si(Ae(l)?yn(l):[l],Gt(a,1))}var hS=Te(function(i,a){return dt(i)?Qs(i,Gt(a,1,dt,!0)):[]}),pS=Te(function(i,a){var l=jn(a);return dt(l)&&(l=n),dt(i)?Qs(i,Gt(a,1,dt,!0),we(l,2)):[]}),gS=Te(function(i,a){var l=jn(a);return dt(l)&&(l=n),dt(i)?Qs(i,Gt(a,1,dt,!0),n,l):[]});function mS(i,a,l){var D=i==null?0:i.length;return D?(a=l||a===n?1:Be(a),qn(i,a<0?0:a,D)):[]}function yS(i,a,l){var D=i==null?0:i.length;return D?(a=l||a===n?1:Be(a),a=D-a,qn(i,0,a<0?0:a)):[]}function DS(i,a){return i&&i.length?ga(i,we(a,3),!0,!0):[]}function wS(i,a){return i&&i.length?ga(i,we(a,3),!0):[]}function bS(i,a,l,D){var b=i==null?0:i.length;return b?(l&&typeof l!="number"&&an(i,a,l)&&(l=0,D=b),dv(i,a,l,D)):[]}function sg(i,a,l){var D=i==null?0:i.length;if(!D)return-1;var b=l==null?0:Be(l);return b<0&&(b=Tt(D+b,0)),Vo(i,we(a,3),b)}function og(i,a,l){var D=i==null?0:i.length;if(!D)return-1;var b=D-1;return l!==n&&(b=Be(l),b=l<0?Tt(D+b,0):Vt(b,D-1)),Vo(i,we(a,3),b,!0)}function ag(i){var a=i==null?0:i.length;return a?Gt(i,1):[]}function ES(i){var a=i==null?0:i.length;return a?Gt(i,er):[]}function vS(i,a){var l=i==null?0:i.length;return l?(a=a===n?1:Be(a),Gt(i,a)):[]}function SS(i){for(var a=-1,l=i==null?0:i.length,D={};++a<l;){var b=i[a];D[b[0]]=b[1]}return D}function ug(i){return i&&i.length?i[0]:n}function CS(i,a,l){var D=i==null?0:i.length;if(!D)return-1;var b=l==null?0:Be(l);return b<0&&(b=Tt(D+b,0)),ts(i,a,b)}function xS(i){var a=i==null?0:i.length;return a?qn(i,0,-1):[]}var AS=Te(function(i){var a=it(i,xc);return a.length&&a[0]===i[0]?gc(a):[]}),FS=Te(function(i){var a=jn(i),l=it(i,xc);return a===jn(l)?a=n:l.pop(),l.length&&l[0]===i[0]?gc(l,we(a,2)):[]}),_S=Te(function(i){var a=jn(i),l=it(i,xc);return a=typeof a=="function"?a:n,a&&l.pop(),l.length&&l[0]===i[0]?gc(l,n,a):[]});function IS(i,a){return i==null?"":x1.call(i,a)}function jn(i){var a=i==null?0:i.length;return a?i[a-1]:n}function BS(i,a,l){var D=i==null?0:i.length;if(!D)return-1;var b=D;return l!==n&&(b=Be(l),b=b<0?Tt(D+b,0):Vt(b,D-1)),a===a?c1(i,a,b):Vo(i,Hh,b,!0)}function kS(i,a){return i&&i.length?wp(i,Be(a)):n}var RS=Te(cg);function cg(i,a){return i&&i.length&&a&&a.length?wc(i,a):i}function TS(i,a,l){return i&&i.length&&a&&a.length?wc(i,a,we(l,2)):i}function PS(i,a,l){return i&&i.length&&a&&a.length?wc(i,a,n,l):i}var NS=$r(function(i,a){var l=i==null?0:i.length,D=fc(i,a);return vp(i,it(a,function(b){return Lr(b,l)?+b:b}).sort(Rp)),D});function OS(i,a){var l=[];if(!(i&&i.length))return l;var D=-1,b=[],A=i.length;for(a=we(a,3);++D<A;){var k=i[D];a(k,D,i)&&(l.push(k),b.push(D))}return vp(i,b),l}function $c(i){return i==null?i:I1.call(i)}function US(i,a,l){var D=i==null?0:i.length;return D?(l&&typeof l!="number"&&an(i,a,l)?(a=0,l=D):(a=a==null?0:Be(a),l=l===n?D:Be(l)),qn(i,a,l)):[]}function MS(i,a){return pa(i,a)}function $S(i,a,l){return vc(i,a,we(l,2))}function LS(i,a){var l=i==null?0:i.length;if(l){var D=pa(i,a);if(D<l&&sr(i[D],a))return D}return-1}function zS(i,a){return pa(i,a,!0)}function HS(i,a,l){return vc(i,a,we(l,2),!0)}function GS(i,a){var l=i==null?0:i.length;if(l){var D=pa(i,a,!0)-1;if(sr(i[D],a))return D}return-1}function qS(i){return i&&i.length?Cp(i):[]}function jS(i,a){return i&&i.length?Cp(i,we(a,2)):[]}function WS(i){var a=i==null?0:i.length;return a?qn(i,1,a):[]}function KS(i,a,l){return i&&i.length?(a=l||a===n?1:Be(a),qn(i,0,a<0?0:a)):[]}function VS(i,a,l){var D=i==null?0:i.length;return D?(a=l||a===n?1:Be(a),a=D-a,qn(i,a<0?0:a,D)):[]}function ZS(i,a){return i&&i.length?ga(i,we(a,3),!1,!0):[]}function JS(i,a){return i&&i.length?ga(i,we(a,3)):[]}var XS=Te(function(i){return ci(Gt(i,1,dt,!0))}),YS=Te(function(i){var a=jn(i);return dt(a)&&(a=n),ci(Gt(i,1,dt,!0),we(a,2))}),QS=Te(function(i){var a=jn(i);return a=typeof a=="function"?a:n,ci(Gt(i,1,dt,!0),n,a)});function eC(i){return i&&i.length?ci(i):[]}function tC(i,a){return i&&i.length?ci(i,we(a,2)):[]}function nC(i,a){return a=typeof a=="function"?a:n,i&&i.length?ci(i,n,a):[]}function Lc(i){if(!(i&&i.length))return[];var a=0;return i=ii(i,function(l){if(dt(l))return a=Tt(l.length,a),!0}),rc(a,function(l){return it(i,ec(l))})}function lg(i,a){if(!(i&&i.length))return[];var l=Lc(i);return a==null?l:it(l,function(D){return _n(a,n,D)})}var rC=Te(function(i,a){return dt(i)?Qs(i,a):[]}),iC=Te(function(i){return Cc(ii(i,dt))}),sC=Te(function(i){var a=jn(i);return dt(a)&&(a=n),Cc(ii(i,dt),we(a,2))}),oC=Te(function(i){var a=jn(i);return a=typeof a=="function"?a:n,Cc(ii(i,dt),n,a)}),aC=Te(Lc);function uC(i,a){return _p(i||[],a||[],Ys)}function cC(i,a){return _p(i||[],a||[],no)}var lC=Te(function(i){var a=i.length,l=a>1?i[a-1]:n;return l=typeof l=="function"?(i.pop(),l):n,lg(i,l)});function fg(i){var a=x(i);return a.__chain__=!0,a}function fC(i,a){return a(i),i}function Ca(i,a){return a(i)}var dC=$r(function(i){var a=i.length,l=a?i[0]:0,D=this.__wrapped__,b=function(A){return fc(A,i)};return a>1||this.__actions__.length||!(D instanceof Oe)||!Lr(l)?this.thru(b):(D=D.slice(l,+l+(a?1:0)),D.__actions__.push({func:Ca,args:[b],thisArg:n}),new Hn(D,this.__chain__).thru(function(A){return a&&!A.length&&A.push(n),A}))});function hC(){return fg(this)}function pC(){return new Hn(this.value(),this.__chain__)}function gC(){this.__values__===n&&(this.__values__=xg(this.value()));var i=this.__index__>=this.__values__.length,a=i?n:this.__values__[this.__index__++];return{done:i,value:a}}function mC(){return this}function yC(i){for(var a,l=this;l instanceof ca;){var D=ig(l);D.__index__=0,D.__values__=n,a?b.__wrapped__=D:a=D;var b=D;l=l.__wrapped__}return b.__wrapped__=i,a}function DC(){var i=this.__wrapped__;if(i instanceof Oe){var a=i;return this.__actions__.length&&(a=new Oe(this)),a=a.reverse(),a.__actions__.push({func:Ca,args:[$c],thisArg:n}),new Hn(a,this.__chain__)}return this.thru($c)}function wC(){return Fp(this.__wrapped__,this.__actions__)}var bC=ma(function(i,a,l){je.call(i,l)?++i[l]:Ur(i,l,1)});function EC(i,a,l){var D=Ae(i)?Lh:fv;return l&&an(i,a,l)&&(a=n),D(i,we(a,3))}function vC(i,a){var l=Ae(i)?ii:lp;return l(i,we(a,3))}var SC=Mp(sg),CC=Mp(og);function xC(i,a){return Gt(xa(i,a),1)}function AC(i,a){return Gt(xa(i,a),er)}function FC(i,a,l){return l=l===n?1:Be(l),Gt(xa(i,a),l)}function dg(i,a){var l=Ae(i)?Ln:ui;return l(i,we(a,3))}function hg(i,a){var l=Ae(i)?WE:cp;return l(i,we(a,3))}var _C=ma(function(i,a,l){je.call(i,l)?i[l].push(a):Ur(i,l,[a])});function IC(i,a,l,D){i=Dn(i)?i:hs(i),l=l&&!D?Be(l):0;var b=i.length;return l<0&&(l=Tt(b+l,0)),Ba(i)?l<=b&&i.indexOf(a,l)>-1:!!b&&ts(i,a,l)>-1}var BC=Te(function(i,a,l){var D=-1,b=typeof a=="function",A=Dn(i)?G(i.length):[];return ui(i,function(k){A[++D]=b?_n(a,k,l):eo(k,a,l)}),A}),kC=ma(function(i,a,l){Ur(i,l,a)});function xa(i,a){var l=Ae(i)?it:mp;return l(i,we(a,3))}function RC(i,a,l,D){return i==null?[]:(Ae(a)||(a=a==null?[]:[a]),l=D?n:l,Ae(l)||(l=l==null?[]:[l]),bp(i,a,l))}var TC=ma(function(i,a,l){i[l?0:1].push(a)},function(){return[[],[]]});function PC(i,a,l){var D=Ae(i)?Yu:qh,b=arguments.length<3;return D(i,we(a,4),l,b,ui)}function NC(i,a,l){var D=Ae(i)?KE:qh,b=arguments.length<3;return D(i,we(a,4),l,b,cp)}function OC(i,a){var l=Ae(i)?ii:lp;return l(i,_a(we(a,3)))}function UC(i){var a=Ae(i)?sp:Iv;return a(i)}function MC(i,a,l){(l?an(i,a,l):a===n)?a=1:a=Be(a);var D=Ae(i)?ov:Bv;return D(i,a)}function $C(i){var a=Ae(i)?av:Rv;return a(i)}function LC(i){if(i==null)return 0;if(Dn(i))return Ba(i)?rs(i):i.length;var a=Zt(i);return a==Ct||a==Bt?i.size:yc(i).length}function zC(i,a,l){var D=Ae(i)?Qu:Tv;return l&&an(i,a,l)&&(a=n),D(i,we(a,3))}var HC=Te(function(i,a){if(i==null)return[];var l=a.length;return l>1&&an(i,a[0],a[1])?a=[]:l>2&&an(a[0],a[1],a[2])&&(a=[a[0]]),bp(i,Gt(a,1),[])}),Aa=v1||function(){return Ht.Date.now()};function GC(i,a){if(typeof a!="function")throw new zn(u);return i=Be(i),function(){if(--i<1)return a.apply(this,arguments)}}function pg(i,a,l){return a=l?n:a,a=i&&a==null?i.length:a,Mr(i,De,n,n,n,n,a)}function gg(i,a){var l;if(typeof a!="function")throw new zn(u);return i=Be(i),function(){return--i>0&&(l=a.apply(this,arguments)),i<=1&&(a=n),l}}var zc=Te(function(i,a,l){var D=T;if(l.length){var b=oi(l,fs(zc));D|=te}return Mr(i,D,a,l,b)}),mg=Te(function(i,a,l){var D=T|$;if(l.length){var b=oi(l,fs(mg));D|=te}return Mr(a,D,i,l,b)});function yg(i,a,l){a=l?n:a;var D=Mr(i,H,n,n,n,n,n,a);return D.placeholder=yg.placeholder,D}function Dg(i,a,l){a=l?n:a;var D=Mr(i,Q,n,n,n,n,n,a);return D.placeholder=Dg.placeholder,D}function wg(i,a,l){var D,b,A,k,O,M,Z=0,J=!1,ee=!1,oe=!0;if(typeof i!="function")throw new zn(u);a=Wn(a)||0,st(l)&&(J=!!l.leading,ee="maxWait"in l,A=ee?Tt(Wn(l.maxWait)||0,a):A,oe="trailing"in l?!!l.trailing:oe);function ye(ht){var or=D,Gr=b;return D=b=n,Z=ht,k=i.apply(Gr,or),k}function Ee(ht){return Z=ht,O=so(Pe,a),J?ye(ht):k}function ke(ht){var or=ht-M,Gr=ht-Z,Mg=a-or;return ee?Vt(Mg,A-Gr):Mg}function ve(ht){var or=ht-M,Gr=ht-Z;return M===n||or>=a||or<0||ee&&Gr>=A}function Pe(){var ht=Aa();if(ve(ht))return Me(ht);O=so(Pe,ke(ht))}function Me(ht){return O=n,oe&&D?ye(ht):(D=b=n,k)}function Rn(){O!==n&&Ip(O),Z=0,D=M=b=O=n}function un(){return O===n?k:Me(Aa())}function Tn(){var ht=Aa(),or=ve(ht);if(D=arguments,b=this,M=ht,or){if(O===n)return Ee(M);if(ee)return Ip(O),O=so(Pe,a),ye(M)}return O===n&&(O=so(Pe,a)),k}return Tn.cancel=Rn,Tn.flush=un,Tn}var qC=Te(function(i,a){return up(i,1,a)}),jC=Te(function(i,a,l){return up(i,Wn(a)||0,l)});function WC(i){return Mr(i,Je)}function Fa(i,a){if(typeof i!="function"||a!=null&&typeof a!="function")throw new zn(u);var l=function(){var D=arguments,b=a?a.apply(this,D):D[0],A=l.cache;if(A.has(b))return A.get(b);var k=i.apply(this,D);return l.cache=A.set(b,k)||A,k};return l.cache=new(Fa.Cache||Or),l}Fa.Cache=Or;function _a(i){if(typeof i!="function")throw new zn(u);return function(){var a=arguments;switch(a.length){case 0:return!i.call(this);case 1:return!i.call(this,a[0]);case 2:return!i.call(this,a[0],a[1]);case 3:return!i.call(this,a[0],a[1],a[2])}return!i.apply(this,a)}}function KC(i){return gg(2,i)}var VC=Pv(function(i,a){a=a.length==1&&Ae(a[0])?it(a[0],In(we())):it(Gt(a,1),In(we()));var l=a.length;return Te(function(D){for(var b=-1,A=Vt(D.length,l);++b<A;)D[b]=a[b].call(this,D[b]);return _n(i,this,D)})}),Hc=Te(function(i,a){var l=oi(a,fs(Hc));return Mr(i,te,n,a,l)}),bg=Te(function(i,a){var l=oi(a,fs(bg));return Mr(i,ge,n,a,l)}),ZC=$r(function(i,a){return Mr(i,rt,n,n,n,a)});function JC(i,a){if(typeof i!="function")throw new zn(u);return a=a===n?a:Be(a),Te(i,a)}function XC(i,a){if(typeof i!="function")throw new zn(u);return a=a==null?0:Tt(Be(a),0),Te(function(l){var D=l[a],b=fi(l,0,a);return D&&si(b,D),_n(i,this,b)})}function YC(i,a,l){var D=!0,b=!0;if(typeof i!="function")throw new zn(u);return st(l)&&(D="leading"in l?!!l.leading:D,b="trailing"in l?!!l.trailing:b),wg(i,a,{leading:D,maxWait:a,trailing:b})}function QC(i){return pg(i,1)}function ex(i,a){return Hc(Ac(a),i)}function tx(){if(!arguments.length)return[];var i=arguments[0];return Ae(i)?i:[i]}function nx(i){return Gn(i,E)}function rx(i,a){return a=typeof a=="function"?a:n,Gn(i,E,a)}function ix(i){return Gn(i,y|E)}function sx(i,a){return a=typeof a=="function"?a:n,Gn(i,y|E,a)}function ox(i,a){return a==null||ap(i,a,Nt(a))}function sr(i,a){return i===a||i!==i&&a!==a}var ax=ba(pc),ux=ba(function(i,a){return i>=a}),Mi=hp(function(){return arguments}())?hp:function(i){return ct(i)&&je.call(i,"callee")&&!Qh.call(i,"callee")},Ae=G.isArray,cx=Ph?In(Ph):yv;function Dn(i){return i!=null&&Ia(i.length)&&!zr(i)}function dt(i){return ct(i)&&Dn(i)}function lx(i){return i===!0||i===!1||ct(i)&&on(i)==Wt}var di=C1||Qc,fx=Nh?In(Nh):Dv;function dx(i){return ct(i)&&i.nodeType===1&&!oo(i)}function hx(i){if(i==null)return!0;if(Dn(i)&&(Ae(i)||typeof i=="string"||typeof i.splice=="function"||di(i)||ds(i)||Mi(i)))return!i.length;var a=Zt(i);if(a==Ct||a==Bt)return!i.size;if(io(i))return!yc(i).length;for(var l in i)if(je.call(i,l))return!1;return!0}function px(i,a){return to(i,a)}function gx(i,a,l){l=typeof l=="function"?l:n;var D=l?l(i,a):n;return D===n?to(i,a,n,l):!!D}function Gc(i){if(!ct(i))return!1;var a=on(i);return a==Tr||a==Rr||typeof i.message=="string"&&typeof i.name=="string"&&!oo(i)}function mx(i){return typeof i=="number"&&tp(i)}function zr(i){if(!st(i))return!1;var a=on(i);return a==pr||a==Fn||a==ri||a==js}function Eg(i){return typeof i=="number"&&i==Be(i)}function Ia(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=An}function st(i){var a=typeof i;return i!=null&&(a=="object"||a=="function")}function ct(i){return i!=null&&typeof i=="object"}var vg=Oh?In(Oh):bv;function yx(i,a){return i===a||mc(i,a,Tc(a))}function Dx(i,a,l){return l=typeof l=="function"?l:n,mc(i,a,Tc(a),l)}function wx(i){return Sg(i)&&i!=+i}function bx(i){if(rS(i))throw new Ce(o);return pp(i)}function Ex(i){return i===null}function vx(i){return i==null}function Sg(i){return typeof i=="number"||ct(i)&&on(i)==Pr}function oo(i){if(!ct(i)||on(i)!=rn)return!1;var a=na(i);if(a===null)return!0;var l=je.call(a,"constructor")&&a.constructor;return typeof l=="function"&&l instanceof l&&Yo.call(l)==D1}var qc=Uh?In(Uh):Ev;function Sx(i){return Eg(i)&&i>=-An&&i<=An}var Cg=Mh?In(Mh):vv;function Ba(i){return typeof i=="string"||!Ae(i)&&ct(i)&&on(i)==kt}function kn(i){return typeof i=="symbol"||ct(i)&&on(i)==gr}var ds=$h?In($h):Sv;function Cx(i){return i===n}function xx(i){return ct(i)&&Zt(i)==ut}function Ax(i){return ct(i)&&on(i)==S}var Fx=ba(Dc),_x=ba(function(i,a){return i<=a});function xg(i){if(!i)return[];if(Dn(i))return Ba(i)?rr(i):yn(i);if(Ks&&i[Ks])return o1(i[Ks]());var a=Zt(i),l=a==Ct?sc:a==Bt?Zo:hs;return l(i)}function Hr(i){if(!i)return i===0?i:0;if(i=Wn(i),i===er||i===-er){var a=i<0?-1:1;return a*tr}return i===i?i:0}function Be(i){var a=Hr(i),l=a%1;return a===a?l?a-l:a:0}function Ag(i){return i?Pi(Be(i),0,He):0}function Wn(i){if(typeof i=="number")return i;if(kn(i))return pn;if(st(i)){var a=typeof i.valueOf=="function"?i.valueOf():i;i=st(a)?a+"":a}if(typeof i!="string")return i===0?i:+i;i=jh(i);var l=cE.test(i);return l||fE.test(i)?GE(i.slice(2),l?2:8):uE.test(i)?pn:+i}function Fg(i){return yr(i,wn(i))}function Ix(i){return i?Pi(Be(i),-An,An):i===0?i:0}function We(i){return i==null?"":Bn(i)}var Bx=cs(function(i,a){if(io(a)||Dn(a)){yr(a,Nt(a),i);return}for(var l in a)je.call(a,l)&&Ys(i,l,a[l])}),_g=cs(function(i,a){yr(a,wn(a),i)}),ka=cs(function(i,a,l,D){yr(a,wn(a),i,D)}),kx=cs(function(i,a,l,D){yr(a,Nt(a),i,D)}),Rx=$r(fc);function Tx(i,a){var l=us(i);return a==null?l:op(l,a)}var Px=Te(function(i,a){i=Xe(i);var l=-1,D=a.length,b=D>2?a[2]:n;for(b&&an(a[0],a[1],b)&&(D=1);++l<D;)for(var A=a[l],k=wn(A),O=-1,M=k.length;++O<M;){var Z=k[O],J=i[Z];(J===n||sr(J,ss[Z])&&!je.call(i,Z))&&(i[Z]=A[Z])}return i}),Nx=Te(function(i){return i.push(n,jp),_n(Ig,n,i)});function Ox(i,a){return zh(i,we(a,3),mr)}function Ux(i,a){return zh(i,we(a,3),hc)}function Mx(i,a){return i==null?i:dc(i,we(a,3),wn)}function $x(i,a){return i==null?i:fp(i,we(a,3),wn)}function Lx(i,a){return i&&mr(i,we(a,3))}function zx(i,a){return i&&hc(i,we(a,3))}function Hx(i){return i==null?[]:da(i,Nt(i))}function Gx(i){return i==null?[]:da(i,wn(i))}function jc(i,a,l){var D=i==null?n:Ni(i,a);return D===n?l:D}function qx(i,a){return i!=null&&Vp(i,a,hv)}function Wc(i,a){return i!=null&&Vp(i,a,pv)}var jx=Lp(function(i,a,l){a!=null&&typeof a.toString!="function"&&(a=Qo.call(a)),i[a]=l},Vc(bn)),Wx=Lp(function(i,a,l){a!=null&&typeof a.toString!="function"&&(a=Qo.call(a)),je.call(i,a)?i[a].push(l):i[a]=[l]},we),Kx=Te(eo);function Nt(i){return Dn(i)?ip(i):yc(i)}function wn(i){return Dn(i)?ip(i,!0):Cv(i)}function Vx(i,a){var l={};return a=we(a,3),mr(i,function(D,b,A){Ur(l,a(D,b,A),D)}),l}function Zx(i,a){var l={};return a=we(a,3),mr(i,function(D,b,A){Ur(l,b,a(D,b,A))}),l}var Jx=cs(function(i,a,l){ha(i,a,l)}),Ig=cs(function(i,a,l,D){ha(i,a,l,D)}),Xx=$r(function(i,a){var l={};if(i==null)return l;var D=!1;a=it(a,function(A){return A=li(A,i),D||(D=A.length>1),A}),yr(i,kc(i),l),D&&(l=Gn(l,y|w|E,jv));for(var b=a.length;b--;)Sc(l,a[b]);return l});function Yx(i,a){return Bg(i,_a(we(a)))}var Qx=$r(function(i,a){return i==null?{}:Av(i,a)});function Bg(i,a){if(i==null)return{};var l=it(kc(i),function(D){return[D]});return a=we(a),Ep(i,l,function(D,b){return a(D,b[0])})}function eA(i,a,l){a=li(a,i);var D=-1,b=a.length;for(b||(b=1,i=n);++D<b;){var A=i==null?n:i[Dr(a[D])];A===n&&(D=b,A=l),i=zr(A)?A.call(i):A}return i}function tA(i,a,l){return i==null?i:no(i,a,l)}function nA(i,a,l,D){return D=typeof D=="function"?D:n,i==null?i:no(i,a,l,D)}var kg=Gp(Nt),Rg=Gp(wn);function rA(i,a,l){var D=Ae(i),b=D||di(i)||ds(i);if(a=we(a,4),l==null){var A=i&&i.constructor;b?l=D?new A:[]:st(i)?l=zr(A)?us(na(i)):{}:l={}}return(b?Ln:mr)(i,function(k,O,M){return a(l,k,O,M)}),l}function iA(i,a){return i==null?!0:Sc(i,a)}function sA(i,a,l){return i==null?i:Ap(i,a,Ac(l))}function oA(i,a,l,D){return D=typeof D=="function"?D:n,i==null?i:Ap(i,a,Ac(l),D)}function hs(i){return i==null?[]:ic(i,Nt(i))}function aA(i){return i==null?[]:ic(i,wn(i))}function uA(i,a,l){return l===n&&(l=a,a=n),l!==n&&(l=Wn(l),l=l===l?l:0),a!==n&&(a=Wn(a),a=a===a?a:0),Pi(Wn(i),a,l)}function cA(i,a,l){return a=Hr(a),l===n?(l=a,a=0):l=Hr(l),i=Wn(i),gv(i,a,l)}function lA(i,a,l){if(l&&typeof l!="boolean"&&an(i,a,l)&&(a=l=n),l===n&&(typeof a=="boolean"?(l=a,a=n):typeof i=="boolean"&&(l=i,i=n)),i===n&&a===n?(i=0,a=1):(i=Hr(i),a===n?(a=i,i=0):a=Hr(a)),i>a){var D=i;i=a,a=D}if(l||i%1||a%1){var b=np();return Vt(i+b*(a-i+HE("1e-"+((b+"").length-1))),a)}return bc(i,a)}var fA=ls(function(i,a,l){return a=a.toLowerCase(),i+(l?Tg(a):a)});function Tg(i){return Kc(We(i).toLowerCase())}function Pg(i){return i=We(i),i&&i.replace(hE,t1).replace(RE,"")}function dA(i,a,l){i=We(i),a=Bn(a);var D=i.length;l=l===n?D:Pi(Be(l),0,D);var b=l;return l-=a.length,l>=0&&i.slice(l,b)==a}function hA(i){return i=We(i),i&&Kb.test(i)?i.replace(Qi,n1):i}function pA(i){return i=We(i),i&&Qb.test(i)?i.replace(Hu,"\\$&"):i}var gA=ls(function(i,a,l){return i+(l?"-":"")+a.toLowerCase()}),mA=ls(function(i,a,l){return i+(l?" ":"")+a.toLowerCase()}),yA=Up("toLowerCase");function DA(i,a,l){i=We(i),a=Be(a);var D=a?rs(i):0;if(!a||D>=a)return i;var b=(a-D)/2;return wa(oa(b),l)+i+wa(sa(b),l)}function wA(i,a,l){i=We(i),a=Be(a);var D=a?rs(i):0;return a&&D<a?i+wa(a-D,l):i}function bA(i,a,l){i=We(i),a=Be(a);var D=a?rs(i):0;return a&&D<a?wa(a-D,l)+i:i}function EA(i,a,l){return l||a==null?a=0:a&&(a=+a),_1(We(i).replace(Gu,""),a||0)}function vA(i,a,l){return(l?an(i,a,l):a===n)?a=1:a=Be(a),Ec(We(i),a)}function SA(){var i=arguments,a=We(i[0]);return i.length<3?a:a.replace(i[1],i[2])}var CA=ls(function(i,a,l){return i+(l?"_":"")+a.toLowerCase()});function xA(i,a,l){return l&&typeof l!="number"&&an(i,a,l)&&(a=l=n),l=l===n?He:l>>>0,l?(i=We(i),i&&(typeof a=="string"||a!=null&&!qc(a))&&(a=Bn(a),!a&&ns(i))?fi(rr(i),0,l):i.split(a,l)):[]}var AA=ls(function(i,a,l){return i+(l?" ":"")+Kc(a)});function FA(i,a,l){return i=We(i),l=l==null?0:Pi(Be(l),0,i.length),a=Bn(a),i.slice(l,l+a.length)==a}function _A(i,a,l){var D=x.templateSettings;l&&an(i,a,l)&&(a=n),i=We(i),a=ka({},a,D,qp);var b=ka({},a.imports,D.imports,qp),A=Nt(b),k=ic(b,A),O,M,Z=0,J=a.interpolate||qo,ee="__p += '",oe=oc((a.escape||qo).source+"|"+J.source+"|"+(J===dh?aE:qo).source+"|"+(a.evaluate||qo).source+"|$","g"),ye="//# sourceURL="+(je.call(a,"sourceURL")?(a.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++UE+"]")+`
`;i.replace(oe,function(ve,Pe,Me,Rn,un,Tn){return Me||(Me=Rn),ee+=i.slice(Z,Tn).replace(pE,r1),Pe&&(O=!0,ee+=`' +
__e(`+Pe+`) +
'`),un&&(M=!0,ee+=`';
`+un+`;
__p += '`),Me&&(ee+=`' +
((__t = (`+Me+`)) == null ? '' : __t) +
'`),Z=Tn+ve.length,ve}),ee+=`';
`;var Ee=je.call(a,"variable")&&a.variable;if(!Ee)ee=`with (obj) {
`+ee+`
}
`;else if(sE.test(Ee))throw new Ce(c);ee=(M?ee.replace(me,""):ee).replace(sn,"$1").replace(Kt,"$1;"),ee="function("+(Ee||"obj")+`) {
`+(Ee?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(O?", __e = _.escape":"")+(M?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ee+`return __p
}`;var ke=Og(function(){return qe(A,ye+"return "+ee).apply(n,k)});if(ke.source=ee,Gc(ke))throw ke;return ke}function IA(i){return We(i).toLowerCase()}function BA(i){return We(i).toUpperCase()}function kA(i,a,l){if(i=We(i),i&&(l||a===n))return jh(i);if(!i||!(a=Bn(a)))return i;var D=rr(i),b=rr(a),A=Wh(D,b),k=Kh(D,b)+1;return fi(D,A,k).join("")}function RA(i,a,l){if(i=We(i),i&&(l||a===n))return i.slice(0,Zh(i)+1);if(!i||!(a=Bn(a)))return i;var D=rr(i),b=Kh(D,rr(a))+1;return fi(D,0,b).join("")}function TA(i,a,l){if(i=We(i),i&&(l||a===n))return i.replace(Gu,"");if(!i||!(a=Bn(a)))return i;var D=rr(i),b=Wh(D,rr(a));return fi(D,b).join("")}function PA(i,a){var l=fr,D=Xi;if(st(a)){var b="separator"in a?a.separator:b;l="length"in a?Be(a.length):l,D="omission"in a?Bn(a.omission):D}i=We(i);var A=i.length;if(ns(i)){var k=rr(i);A=k.length}if(l>=A)return i;var O=l-rs(D);if(O<1)return D;var M=k?fi(k,0,O).join(""):i.slice(0,O);if(b===n)return M+D;if(k&&(O+=M.length-O),qc(b)){if(i.slice(O).search(b)){var Z,J=M;for(b.global||(b=oc(b.source,We(hh.exec(b))+"g")),b.lastIndex=0;Z=b.exec(J);)var ee=Z.index;M=M.slice(0,ee===n?O:ee)}}else if(i.indexOf(Bn(b),O)!=O){var oe=M.lastIndexOf(b);oe>-1&&(M=M.slice(0,oe))}return M+D}function NA(i){return i=We(i),i&&Wb.test(i)?i.replace(Yi,l1):i}var OA=ls(function(i,a,l){return i+(l?" ":"")+a.toUpperCase()}),Kc=Up("toUpperCase");function Ng(i,a,l){return i=We(i),a=l?n:a,a===n?s1(i)?h1(i):JE(i):i.match(a)||[]}var Og=Te(function(i,a){try{return _n(i,n,a)}catch(l){return Gc(l)?l:new Ce(l)}}),UA=$r(function(i,a){return Ln(a,function(l){l=Dr(l),Ur(i,l,zc(i[l],i))}),i});function MA(i){var a=i==null?0:i.length,l=we();return i=a?it(i,function(D){if(typeof D[1]!="function")throw new zn(u);return[l(D[0]),D[1]]}):[],Te(function(D){for(var b=-1;++b<a;){var A=i[b];if(_n(A[0],this,D))return _n(A[1],this,D)}})}function $A(i){return lv(Gn(i,y))}function Vc(i){return function(){return i}}function LA(i,a){return i==null||i!==i?a:i}var zA=$p(),HA=$p(!0);function bn(i){return i}function Zc(i){return gp(typeof i=="function"?i:Gn(i,y))}function GA(i){return yp(Gn(i,y))}function qA(i,a){return Dp(i,Gn(a,y))}var jA=Te(function(i,a){return function(l){return eo(l,i,a)}}),WA=Te(function(i,a){return function(l){return eo(i,l,a)}});function Jc(i,a,l){var D=Nt(a),b=da(a,D);l==null&&!(st(a)&&(b.length||!D.length))&&(l=a,a=i,i=this,b=da(a,Nt(a)));var A=!(st(l)&&"chain"in l)||!!l.chain,k=zr(i);return Ln(b,function(O){var M=a[O];i[O]=M,k&&(i.prototype[O]=function(){var Z=this.__chain__;if(A||Z){var J=i(this.__wrapped__),ee=J.__actions__=yn(this.__actions__);return ee.push({func:M,args:arguments,thisArg:i}),J.__chain__=Z,J}return M.apply(i,si([this.value()],arguments))})}),i}function KA(){return Ht._===this&&(Ht._=w1),this}function Xc(){}function VA(i){return i=Be(i),Te(function(a){return wp(a,i)})}var ZA=_c(it),JA=_c(Lh),XA=_c(Qu);function Ug(i){return Nc(i)?ec(Dr(i)):Fv(i)}function YA(i){return function(a){return i==null?n:Ni(i,a)}}var QA=zp(),eF=zp(!0);function Yc(){return[]}function Qc(){return!1}function tF(){return{}}function nF(){return""}function rF(){return!0}function iF(i,a){if(i=Be(i),i<1||i>An)return[];var l=He,D=Vt(i,He);a=we(a),i-=He;for(var b=rc(D,a);++l<i;)a(l);return b}function sF(i){return Ae(i)?it(i,Dr):kn(i)?[i]:yn(rg(We(i)))}function oF(i){var a=++y1;return We(i)+a}var aF=Da(function(i,a){return i+a},0),uF=Ic("ceil"),cF=Da(function(i,a){return i/a},1),lF=Ic("floor");function fF(i){return i&&i.length?fa(i,bn,pc):n}function dF(i,a){return i&&i.length?fa(i,we(a,2),pc):n}function hF(i){return Gh(i,bn)}function pF(i,a){return Gh(i,we(a,2))}function gF(i){return i&&i.length?fa(i,bn,Dc):n}function mF(i,a){return i&&i.length?fa(i,we(a,2),Dc):n}var yF=Da(function(i,a){return i*a},1),DF=Ic("round"),wF=Da(function(i,a){return i-a},0);function bF(i){return i&&i.length?nc(i,bn):0}function EF(i,a){return i&&i.length?nc(i,we(a,2)):0}return x.after=GC,x.ary=pg,x.assign=Bx,x.assignIn=_g,x.assignInWith=ka,x.assignWith=kx,x.at=Rx,x.before=gg,x.bind=zc,x.bindAll=UA,x.bindKey=mg,x.castArray=tx,x.chain=fg,x.chunk=lS,x.compact=fS,x.concat=dS,x.cond=MA,x.conforms=$A,x.constant=Vc,x.countBy=bC,x.create=Tx,x.curry=yg,x.curryRight=Dg,x.debounce=wg,x.defaults=Px,x.defaultsDeep=Nx,x.defer=qC,x.delay=jC,x.difference=hS,x.differenceBy=pS,x.differenceWith=gS,x.drop=mS,x.dropRight=yS,x.dropRightWhile=DS,x.dropWhile=wS,x.fill=bS,x.filter=vC,x.flatMap=xC,x.flatMapDeep=AC,x.flatMapDepth=FC,x.flatten=ag,x.flattenDeep=ES,x.flattenDepth=vS,x.flip=WC,x.flow=zA,x.flowRight=HA,x.fromPairs=SS,x.functions=Hx,x.functionsIn=Gx,x.groupBy=_C,x.initial=xS,x.intersection=AS,x.intersectionBy=FS,x.intersectionWith=_S,x.invert=jx,x.invertBy=Wx,x.invokeMap=BC,x.iteratee=Zc,x.keyBy=kC,x.keys=Nt,x.keysIn=wn,x.map=xa,x.mapKeys=Vx,x.mapValues=Zx,x.matches=GA,x.matchesProperty=qA,x.memoize=Fa,x.merge=Jx,x.mergeWith=Ig,x.method=jA,x.methodOf=WA,x.mixin=Jc,x.negate=_a,x.nthArg=VA,x.omit=Xx,x.omitBy=Yx,x.once=KC,x.orderBy=RC,x.over=ZA,x.overArgs=VC,x.overEvery=JA,x.overSome=XA,x.partial=Hc,x.partialRight=bg,x.partition=TC,x.pick=Qx,x.pickBy=Bg,x.property=Ug,x.propertyOf=YA,x.pull=RS,x.pullAll=cg,x.pullAllBy=TS,x.pullAllWith=PS,x.pullAt=NS,x.range=QA,x.rangeRight=eF,x.rearg=ZC,x.reject=OC,x.remove=OS,x.rest=JC,x.reverse=$c,x.sampleSize=MC,x.set=tA,x.setWith=nA,x.shuffle=$C,x.slice=US,x.sortBy=HC,x.sortedUniq=qS,x.sortedUniqBy=jS,x.split=xA,x.spread=XC,x.tail=WS,x.take=KS,x.takeRight=VS,x.takeRightWhile=ZS,x.takeWhile=JS,x.tap=fC,x.throttle=YC,x.thru=Ca,x.toArray=xg,x.toPairs=kg,x.toPairsIn=Rg,x.toPath=sF,x.toPlainObject=Fg,x.transform=rA,x.unary=QC,x.union=XS,x.unionBy=YS,x.unionWith=QS,x.uniq=eC,x.uniqBy=tC,x.uniqWith=nC,x.unset=iA,x.unzip=Lc,x.unzipWith=lg,x.update=sA,x.updateWith=oA,x.values=hs,x.valuesIn=aA,x.without=rC,x.words=Ng,x.wrap=ex,x.xor=iC,x.xorBy=sC,x.xorWith=oC,x.zip=aC,x.zipObject=uC,x.zipObjectDeep=cC,x.zipWith=lC,x.entries=kg,x.entriesIn=Rg,x.extend=_g,x.extendWith=ka,Jc(x,x),x.add=aF,x.attempt=Og,x.camelCase=fA,x.capitalize=Tg,x.ceil=uF,x.clamp=uA,x.clone=nx,x.cloneDeep=ix,x.cloneDeepWith=sx,x.cloneWith=rx,x.conformsTo=ox,x.deburr=Pg,x.defaultTo=LA,x.divide=cF,x.endsWith=dA,x.eq=sr,x.escape=hA,x.escapeRegExp=pA,x.every=EC,x.find=SC,x.findIndex=sg,x.findKey=Ox,x.findLast=CC,x.findLastIndex=og,x.findLastKey=Ux,x.floor=lF,x.forEach=dg,x.forEachRight=hg,x.forIn=Mx,x.forInRight=$x,x.forOwn=Lx,x.forOwnRight=zx,x.get=jc,x.gt=ax,x.gte=ux,x.has=qx,x.hasIn=Wc,x.head=ug,x.identity=bn,x.includes=IC,x.indexOf=CS,x.inRange=cA,x.invoke=Kx,x.isArguments=Mi,x.isArray=Ae,x.isArrayBuffer=cx,x.isArrayLike=Dn,x.isArrayLikeObject=dt,x.isBoolean=lx,x.isBuffer=di,x.isDate=fx,x.isElement=dx,x.isEmpty=hx,x.isEqual=px,x.isEqualWith=gx,x.isError=Gc,x.isFinite=mx,x.isFunction=zr,x.isInteger=Eg,x.isLength=Ia,x.isMap=vg,x.isMatch=yx,x.isMatchWith=Dx,x.isNaN=wx,x.isNative=bx,x.isNil=vx,x.isNull=Ex,x.isNumber=Sg,x.isObject=st,x.isObjectLike=ct,x.isPlainObject=oo,x.isRegExp=qc,x.isSafeInteger=Sx,x.isSet=Cg,x.isString=Ba,x.isSymbol=kn,x.isTypedArray=ds,x.isUndefined=Cx,x.isWeakMap=xx,x.isWeakSet=Ax,x.join=IS,x.kebabCase=gA,x.last=jn,x.lastIndexOf=BS,x.lowerCase=mA,x.lowerFirst=yA,x.lt=Fx,x.lte=_x,x.max=fF,x.maxBy=dF,x.mean=hF,x.meanBy=pF,x.min=gF,x.minBy=mF,x.stubArray=Yc,x.stubFalse=Qc,x.stubObject=tF,x.stubString=nF,x.stubTrue=rF,x.multiply=yF,x.nth=kS,x.noConflict=KA,x.noop=Xc,x.now=Aa,x.pad=DA,x.padEnd=wA,x.padStart=bA,x.parseInt=EA,x.random=lA,x.reduce=PC,x.reduceRight=NC,x.repeat=vA,x.replace=SA,x.result=eA,x.round=DF,x.runInContext=U,x.sample=UC,x.size=LC,x.snakeCase=CA,x.some=zC,x.sortedIndex=MS,x.sortedIndexBy=$S,x.sortedIndexOf=LS,x.sortedLastIndex=zS,x.sortedLastIndexBy=HS,x.sortedLastIndexOf=GS,x.startCase=AA,x.startsWith=FA,x.subtract=wF,x.sum=bF,x.sumBy=EF,x.template=_A,x.times=iF,x.toFinite=Hr,x.toInteger=Be,x.toLength=Ag,x.toLower=IA,x.toNumber=Wn,x.toSafeInteger=Ix,x.toString=We,x.toUpper=BA,x.trim=kA,x.trimEnd=RA,x.trimStart=TA,x.truncate=PA,x.unescape=NA,x.uniqueId=oF,x.upperCase=OA,x.upperFirst=Kc,x.each=dg,x.eachRight=hg,x.first=ug,Jc(x,function(){var i={};return mr(x,function(a,l){je.call(x.prototype,l)||(i[l]=a)}),i}(),{chain:!1}),x.VERSION=r,Ln(["bind","bindKey","curry","curryRight","partial","partialRight"],function(i){x[i].placeholder=x}),Ln(["drop","take"],function(i,a){Oe.prototype[i]=function(l){l=l===n?1:Tt(Be(l),0);var D=this.__filtered__&&!a?new Oe(this):this.clone();return D.__filtered__?D.__takeCount__=Vt(l,D.__takeCount__):D.__views__.push({size:Vt(l,He),type:i+(D.__dir__<0?"Right":"")}),D},Oe.prototype[i+"Right"]=function(l){return this.reverse()[i](l).reverse()}}),Ln(["filter","map","takeWhile"],function(i,a){var l=a+1,D=l==ni||l==Gs;Oe.prototype[i]=function(b){var A=this.clone();return A.__iteratees__.push({iteratee:we(b,3),type:l}),A.__filtered__=A.__filtered__||D,A}}),Ln(["head","last"],function(i,a){var l="take"+(a?"Right":"");Oe.prototype[i]=function(){return this[l](1).value()[0]}}),Ln(["initial","tail"],function(i,a){var l="drop"+(a?"":"Right");Oe.prototype[i]=function(){return this.__filtered__?new Oe(this):this[l](1)}}),Oe.prototype.compact=function(){return this.filter(bn)},Oe.prototype.find=function(i){return this.filter(i).head()},Oe.prototype.findLast=function(i){return this.reverse().find(i)},Oe.prototype.invokeMap=Te(function(i,a){return typeof i=="function"?new Oe(this):this.map(function(l){return eo(l,i,a)})}),Oe.prototype.reject=function(i){return this.filter(_a(we(i)))},Oe.prototype.slice=function(i,a){i=Be(i);var l=this;return l.__filtered__&&(i>0||a<0)?new Oe(l):(i<0?l=l.takeRight(-i):i&&(l=l.drop(i)),a!==n&&(a=Be(a),l=a<0?l.dropRight(-a):l.take(a-i)),l)},Oe.prototype.takeRightWhile=function(i){return this.reverse().takeWhile(i).reverse()},Oe.prototype.toArray=function(){return this.take(He)},mr(Oe.prototype,function(i,a){var l=/^(?:filter|find|map|reject)|While$/.test(a),D=/^(?:head|last)$/.test(a),b=x[D?"take"+(a=="last"?"Right":""):a],A=D||/^find/.test(a);b&&(x.prototype[a]=function(){var k=this.__wrapped__,O=D?[1]:arguments,M=k instanceof Oe,Z=O[0],J=M||Ae(k),ee=function(Pe){var Me=b.apply(x,si([Pe],O));return D&&oe?Me[0]:Me};J&&l&&typeof Z=="function"&&Z.length!=1&&(M=J=!1);var oe=this.__chain__,ye=!!this.__actions__.length,Ee=A&&!oe,ke=M&&!ye;if(!A&&J){k=ke?k:new Oe(this);var ve=i.apply(k,O);return ve.__actions__.push({func:Ca,args:[ee],thisArg:n}),new Hn(ve,oe)}return Ee&&ke?i.apply(this,O):(ve=this.thru(ee),Ee?D?ve.value()[0]:ve.value():ve)})}),Ln(["pop","push","shift","sort","splice","unshift"],function(i){var a=Jo[i],l=/^(?:push|sort|unshift)$/.test(i)?"tap":"thru",D=/^(?:pop|shift)$/.test(i);x.prototype[i]=function(){var b=arguments;if(D&&!this.__chain__){var A=this.value();return a.apply(Ae(A)?A:[],b)}return this[l](function(k){return a.apply(Ae(k)?k:[],b)})}}),mr(Oe.prototype,function(i,a){var l=x[a];if(l){var D=l.name+"";je.call(as,D)||(as[D]=[]),as[D].push({name:a,func:l})}}),as[ya(n,$).name]=[{name:"wrapper",func:n}],Oe.prototype.clone=N1,Oe.prototype.reverse=O1,Oe.prototype.value=U1,x.prototype.at=dC,x.prototype.chain=hC,x.prototype.commit=pC,x.prototype.next=gC,x.prototype.plant=yC,x.prototype.reverse=DC,x.prototype.toJSON=x.prototype.valueOf=x.prototype.value=wC,x.prototype.first=x.prototype.head,Ks&&(x.prototype[Ks]=mC),x},is=p1();Bi?((Bi.exports=is)._=is,Zu._=is):Ht._=is}).call(yt)})(Ya,Ya.exports);var Jl=Ya.exports;const Xl=CF(Jl);function wy(){return typeof __DEV__<"u"?__DEV__:typeof process<"u"&&process.env?process.env.NODE_ENV!=="production":!1}function fn(e,t=!0){const n=`[${e}]`;return{log:(...r)=>t&&console.log(n,...r),warn:(...r)=>t&&console.warn(n,...r),error:(...r)=>console.error(n,...r),debug:(...r)=>t&&console.debug(n,...r),crumb:(...r)=>t&&console.log(n,"[crumb]",...r),trackError:(r,s)=>console.error(n,"[error]",r,s),trackEvent:(r,s)=>t&&console.log(n,"[event]",r,s),sensorsLog:(...r)=>t&&console.log(n,"[sensors]",...r)}}function xF(e){return e.replace(/\n/g,"\\n")}function by(e){if(process.env.NODE_ENV!=="production")return e()}var Ke=(e=>(e.InviteShared="Invite Link Shared",e.OnboardingSessionRevived="Onboarding Session Revived",e.AppInstalled="App Installed",e.AppUpdated="App Updated",e.AppActive="App Active",e.LoggedInBeforeSignup="Logged In Without Signing Up",e.FailedSignupOTP="Failed to send Signup OTP",e.FailedLoginOTP="Failed to send Login OTP",e.InvitedUserFailedInventoryCheck="Invited User Failed Inventory Check",e.PersonalInvitePressed="Personal Invite Shown",e.ChannelTemplateSetup="Channel Created from Template",e.ChannelLoadComplete="Channel Load Complete",e.SessionInitialized="Session Initialized",e.NodeNotRunning="Node Not Running",e.NodeUnderMaintenance="Node Under Maintenance",e.LoginDebug="Login Debug",e.LoginAnomaly="Login Anomaly",e.ExpectedHostingError="Expected Hosting API Error",e.UnexpectedHostingError="Unexpected Hosting API Response",e.NodeWaitReport="Node Wait Report",e.InviteError="Invite Error",e.InviteDebug="Invite Debug",e.InviteButtonShown="Invite Button Shown",e.InitializedNewInvite="Initialized New Invite",e.DebugLogs="Debug Logs",e.DebugGroupCreate="Create Group Debug",e.DebugAttestation="Attestation Debug",e.DebugContactMatching="Contact Matching Debug",e.ErrorContactMatching="Contact Matching Error",e.AppError="App Error",e.AuthenticatedNodeStopped="Node Stopped While Logged In",e.Scry="Scry",e.ScryNoun="Scry Noun",e.Poke="Poke",e.NativeDbDebug="Native DB Debug",e.Thread="Thread",e.TrackedPoke="TrackedPoke",e.ErrorDatabaseQuery="Database Query Error",e.ErrorTrackedPokeTimeout="Error Tracked Poke Timeout",e.ErrorThread="Thread Error",e.ErrorSubscribeOnceTimeout="Error Subscribe Once Timeout",e.ErrorNativeDb="Native DB Error",e.InitDataFetched="Init Data Fetched",e.InitDataWritten="Init Data Written",e.LatestPostsFetched="Latest Posts Fetched",e.LatestPostsWritten="Latest Posts Written",e.SubscriptionsEstablished="Subscriptions Established",e.AuthFailedToGetCode="Failed to get access code",e.AuthForcedLogout="Auth Forced Logout",e.NodeConnectionDebug="Node Connection Debug",e.NodeConnectionError="Node Connection Error",e.SyncDiscontinuity="Sync Discontinuity",e.OnNetworkInvite="Sent On Network Group Invite",e.UserLoggedIn="User Logged In",e.NodeAuthSaved="Node Auth Saved",e.ErrorNodeResumePush="Node Resume Push Error",e.AnalyticsDigest="Usage Digest Report",e.WebAppOpened="Web App Opened",e.WebConsoleError="Web Console Error",e.WayfindingDebug="Wayfinding Debug",e.AttachmentUploadSuccess="Attachment Upload Success",e.ActionContactAdded="Contact Added",e.ActionContactRemoved="Contact Removed",e.ActionRemoveContactSuggestion="Removed Contact Suggestion",e.ActionContactEdited="Contact Edited",e.ActionUpdatedProfile="Updated Profile",e.ActionSendPost="Sent Post",e.ActionForwardPost="Forwarded Post",e.ActionForwardGroup="Forwarded Group",e.ActionStartedDM="Started DM",e.ActionSendPostRetry="Retried Post Send",e.ActionHidePost="Hid Post",e.ActionSendReply="Sent Thread Reply",e.ActionDeletePost="Deleted Post",e.ActionReact="Reacted to Post",e.ActionUnreact="Removed Reaction from Post ",e.ActionRespondToDMInvite="Responded to DM Invite",e.ActionBlockUser="Blocked User",e.ActionUnblockUser="Unblocked User",e.ActionCustomizeDM="Customized DM",e.ActionJoinGroup="Joined Group",e.ActionCancelGroupJoin="Cancelled Group Join",e.ActionCustomizedGroup="Customized Group",e.ActionDeleteGroup="Deleted Group",e.ActionKickUser="Kicked User",e.ActionBanUser="Banned User",e.ActionUnbanUser="Unbanned User",e.ActionCreateGroup="Created Group",e.ActionAcceptJoinRequest="Accepted Request to Join Group",e.ActionRejectJoinRequest="Rejected Request to Join Group",e.ActionAcceptGroupInvite="Accepted Group Invite",e.ActionRejectGroupInvite="Rejected Group Invite",e.ActionUpdatedGroupPrivacy="Updated Group Privacy",e.ActionLeaveGroup="Left Group",e.ActionAddedRole="Added Group Role",e.ActionRemovedRole="Removed Group Role",e.ActionUpdatedRole="Updated Group Role",e.ActionAddMemberRole="Added Members to Group Role",e.ActionRemoveMemberRole="Removed Members from Group Role",e.ActionVisitedGroup="Viewed Group",e.ActionRequestGroupInvite="Requested Group Invite",e.ActionCreateChannel="Created Channel",e.ActionDeleteChannel="Deleted Channel",e.ActionUpdatedChannel="Updated Channel",e.ActionPinChat="Pinned Chat",e.ActionUnpinChat="Unpinned Chat",e.ActionVisitedChannel="Viewed Channel",e.ActionTappedChat="Tapped Chatlist Item",e.ActionJoinChannel="Joined Channel",e.ActionMoveChannel="Moved Channel",e.ActionUpdateChannelWriters="Updated Channel Writers",e.ActionAddedNavSection="Added Navigation Section",e.ActionUpdatedNavSection="Updated Navigation Section",e.ActionDeletedNavSection="Deleted Navigation Section",e.ActionUpdatedGroupNavigation="Updated Group Navigation",e.ActionViewProfileGroup="Viewed Pinned Profile Group",e.ActionSelectActivityEvent="Tapped Activity Event",e.ActionsNotifPermsChecked="Checked Notification Permissions",e.ActionNotifPermsSettingsOpened="Opened Notification Settings from Nag",e.ActionNotifPermsGrantedFromNag="Granted Notification Permission from Nag",e.ActionInitiateTwitterAttest="Initiated Twitter Attestation",e.ActionConfirmTwitterAttest="Confirmed Twitter Attestation",e.ActionInitiatePhoneAttest="Initiated Phone Attestation",e.ActionCheckAttestSig="Checked Attestation Signature",e.ActionRevokeAttestation="Revoked Attestation",e.ActionUpdateAttestDiscoverability="Updated Attestation Discoverability",e.ActionConfirmPhoneAttest="Confirmed Phone Attestation",e.ActionGroupChannelSelected="Tapped group channel",e.ActionTappedPushNotif="Tapped Push Notification",e.ActionDeferredDeepLink="Installed with Deferred Deeplink Invite",e.ActionContactBookSkipped="Skipped Syncing Contact Book",e.ActionContactBookPermRequested="Contact Book Requesting Permission",e.ActionContactBookPermGranted="Contact Book Permission Granted",e.ActionContactBookPermDenied="Contact Book Permission Denied",e.ActionContactBookInviteShown="Contact Book Invite Shown",e.ActionContactBookInviteSent="Contact Book Invite Sent",e.FetchLinkMetadata="Fetched Link Metadata",e.ActionCalmSettingsUpdate="Calm Settings Updated",e.ActionThemeUpdate="Theme Setting Updated",e.DebugSystemContacts="System Contacts Debug",e.GroupJoinComplete="Group Join Complete",e.PersonalInviteLinkReady="Personal Invite Link Ready",e.ErrorSendPost="Error Sending Post",e.ErrorSendReply="Error Sending Thread Reply",e.ErrorReact="Error Reacting to Post",e.ErrorUnreact="Error Removing Reaction from Post",e.ErrorPushNotifNavigate="Error Navigating to Push Channel",e.ErrorDigestFailed="Error Preparing Usage Digest",e.ErrorSyncStartHighPriority="Error Start Sync: High Priority",e.ErrorSyncStartLowPriority="Error Start Sync: Low Priority",e.ErrorVerifyingPersonalInvite="Error Verifying DM Invite Link",e.ErrorAttestation="Attestation Error",e.ErrorNounParse="Error Parsing Noun",e.ErrorNotificationService="Notification Service Error",e.ErrorCreateGroup="Error Creating Group",e.ErrorWayfinding="Wayfinding Error",e.ErrorSystemContacts="System Contacts Error",e.ErrorCalmSettingsUpdate="Error Updating Calm Settings",e.ErrorThemeUpdate="Error Updating Theme Setting",e.ErrorApi="API Error",e.ErrorFetchLinkMetadata="Error Fetching Link Metadata",e))(Ke||{}),Yl=(e=>(e.Critical="Critical",e.High="High",e.Medium="Medium",e.Low="Low",e))(Yl||{}),$g;(e=>{function t(n){switch(n.uploadState.status){case"success":return n.uploadState.remoteUri;case"uploading":return n.uploadState.localUri}}e.uri=t})($g||($g={}));var Lg;(e=>{function t(n){return AF(n.uploadState)}e.uri=t})(Lg||(Lg={}));exports.AttachmentUtils=void 0;(e=>{(o=>{function u(I){return{type:"image",asset:I}}o.fromImagePickerAsset=u;function c(I){return{type:"file",file:I}}o.fromFile=c;function d(I){switch(I.type){case"image":return I.asset.uri;case"file":return URL.createObjectURL(I.file);case"fileUri":return I.localUri}}o.createLocalUri=d;function f(I){return I.filter(T=>T.type==="image").map(T=>T.asset)}o.extractImagePickerAssets=f;const m=Jl.memoize(I=>Jl.uniqueId("File"));function y(I){return(()=>{switch(I.type){case"image":return I.asset.uri;case"file":return m(I.file);case"fileUri":return I.localUri}})()}o.extractKey=y;function w(I,T){if(I.type!==T.type)return!1;switch(I.type){case"image":return I.asset.uri===T.asset.uri;case"file":return I.file===T.file;case"fileUri":return I.localUri===T.localUri}}o.equivalent=w;function E(I,T){if(T.status==="error")return null;switch(I.type){case"image":return{type:"image",file:I.asset,uploadState:T};case"file":return{type:"file",localFile:I.file,size:I.file.size,mimeType:I.file.type,name:I.file.name,uploadState:T};case"fileUri":return{type:"file",localFile:I.localUri,name:I.name,size:I.size,mimeType:I.type,uploadState:T}}}o.toFinalizedAttachment=E;function F(I){switch(I.type){case"image":return{type:"image",file:I.asset,uploadState:{status:"uploading",localUri:I.asset.uri}};case"file":return{type:"file",localFile:I.file,size:I.file.size,mimeType:I.file.type,name:I.file.name,uploadState:{status:"uploading",localUri:d(I)}};case"fileUri":return{type:"file",localFile:I.localUri,size:I.size,mimeType:I.mimeType,name:I.name,uploadState:{status:"uploading",localUri:I.localUri}}}}o.toLocalFinalizedAttachment=F})(e.UploadIntent||(e.UploadIntent={}));function t(o){switch(o.type){case"image":return{needsUpload:!0,type:"image",asset:o.file};case"file":return o.localFile instanceof File?{needsUpload:!0,type:"file",file:o.localFile}:{needsUpload:!0,type:"fileUri",localUri:o.localFile,name:o.name,size:o.size,mimeType:o.mimeType};case"text":case"link":case"reference":return{needsUpload:!1,finalized:o}}}e.toUploadIntent=t;function n(o){switch(o.type){case"image":return{type:"image",file:o.asset};case"file":return{type:"file",localFile:o.file,size:o.file.size,mimeType:o.file.type};case"fileUri":return{type:"file",localFile:o.localUri,name:o.name,size:o.size,mimeType:o.mimeType}}}e.fromUploadIntent=n;function r(o,u){const c=t(o);if(c.needsUpload){if(u==null||u.status!=="success")return null;switch(c.type){case"image":return{type:"image",file:c.asset,uploadState:u};case"file":return{type:"file",localFile:c.file,size:c.file.size,name:c.file.name,mimeType:c.file.type,uploadState:u};case"fileUri":return{type:"file",localFile:c.localUri,size:c.size,name:c.name,mimeType:c.mimeType,uploadState:u}}}else return c.finalized}e.toSuccessfulFinalizedAttachment=r;function s(o){return o.type==="file"&&o.localFile instanceof File&&typeof URL.createObjectURL=="function"?{...o,localFile:URL.createObjectURL(o.localFile),name:o.localFile.name,size:o.localFile.size,mimeType:o.localFile.type}:o}e.makeSerializable=s})(exports.AttachmentUtils||(exports.AttachmentUtils={}));function AF(e){switch(e.status){case"success":return e.remoteUri;case"uploading":return e.localUri}}const ws="tlonEnv",el={DEV_SHIP_URL:"",INVITE_PROVIDER:"~wannec-dansen",NOTIFY_PROVIDER:"~wannec-dansen",NOTIFY_SERVICE:"notify",POST_HOG_API_KEY:"",API_URL:"https://api.tlon.io",API_AUTH_USERNAME:void 0,API_AUTH_PASSWORD:void 0,RECAPTCHA_SITE_KEY:"",SHIP_URL_PATTERN:"https://{shipId}.tlon.network",DEFAULT_LURE:"",DEFAULT_PRIORITY_TOKEN:"",DEFAULT_TLON_LOGIN_EMAIL:"",DEFAULT_TLON_LOGIN_PASSWORD:"",DEFAULT_INVITE_LINK_URL:"",DEFAULT_SHIP_LOGIN_URL:"",DEFAULT_SHIP_LOGIN_ACCESS_CODE:"",DEFAULT_ONBOARDING_PASSWORD:"",DEFAULT_ONBOARDING_TLON_EMAIL:"",DEFAULT_ONBOARDING_NICKNAME:"",DEFAULT_ONBOARDING_PHONE_NUMBER:void 0,ENABLED_LOGGERS:[],IGNORE_COSMOS:!1,TLON_EMPLOYEE_GROUP:"~natnex-ronret/tlon",BRANCH_KEY:"",BRANCH_DOMAIN:"tlon.network",INVITE_SERVICE_ENDPOINT:"https://invite.tlon.io",INVITE_SERVICE_IS_DEV:!1,GIT_HASH:"",DISABLE_SPLASH_MODAL:!1,AUTOMATED_TEST:!1,OPENROUTER_API_KEY:""};function Ei(){return typeof window<"u"&&window[ws]?{...el,...window[ws]}:typeof global<"u"&&global[ws]?{...el,...global[ws]}:el}function FF(e){typeof window<"u"?window[ws]={...Ei(),...e}:typeof global<"u"&&(global[ws]={...Ei(),...e})}function _F(){const e=Ei();return!!e.OPENROUTER_API_KEY&&e.OPENROUTER_API_KEY.length>0}const IF=[{id:"book-club",title:"Book Club",subtitle:"Discuss your latest reads",description:"A group for discussing books and literature",icon:"📚",channels:[{type:"chat",title:"Book chat",description:"Discuss books and literature"},{type:"gallery",title:"Now reading",description:"Share what you're currently reading"},{type:"notebook",title:"Reviews",description:"Write and share book reviews"}]},{id:"cooking-club",title:"Cooking Club",subtitle:"Share recipes and cooking tips",description:"A group for food lovers and home cooks",icon:"🍳",channels:[{type:"chat",title:"Food talk",description:"Chat about cooking and food"},{type:"gallery",title:"Meal pics",description:"Share photos of your culinary creations"},{type:"notebook",title:"Recipes",description:"Collect and share your favorite recipes"}]},{id:"music",title:"Music",subtitle:"Share and discover new tunes",description:"A group for music lovers and audiophiles",icon:"🎵",channels:[{type:"chat",title:"Tune talk",description:"Discuss music and artists"},{type:"gallery",title:"Now listening",description:"Share what you're listening to"},{type:"notebook",title:"Playlists",description:"Curate and share playlists"}]},{id:"running-club",title:"Running Club",subtitle:"Track your runs and stay motivated",description:"A group for runners of all levels",icon:"🏃",channels:[{type:"chat",title:"Run chat",description:"Chat about running and training"},{type:"gallery",title:"Run pics",description:"Share photos from your runs"},{type:"notebook",title:"Goals",description:"Track your running goals and progress"}]},{id:"cinema-club",title:"Cinema Club",subtitle:"Discuss and review films",description:"A group for movie enthusiasts and film buffs",icon:"🎬",channels:[{type:"chat",title:"Film chat",description:"Discuss movies and cinema"},{type:"gallery",title:"Now watching",description:"Share what you're currently watching"},{type:"notebook",title:"Reviews",description:"Write and share film reviews"}]},{id:"garden-club",title:"Garden Club",subtitle:"Grow together",description:"A group for gardeners and plant enthusiasts",icon:"🌱",channels:[{type:"chat",title:"Garden talk",description:"Chat about gardening and plants"},{type:"gallery",title:"Plant pics",description:"Share photos of your garden and plants"},{type:"notebook",title:"Tips, plans and schedules",description:"Share gardening tips and track your plans"}]}],BF={id:"basic-group",title:"Basic Group",subtitle:"A basic group with essential channels",description:"A basic group with essential channels",icon:"✨",channels:[{type:"chat",title:"Chat",description:"General chat"},{type:"gallery",title:"Gallery",description:"Share images"},{type:"notebook",title:"Notebook",description:"Share notes"}]},kF=[...IF,BF];kF.reduce((e,t)=>(e[t.id]=t,e),{});function zg(e){return e.endsWith("tlon.network")||e.endsWith(".test.tlon.systems")}var Hg;(e=>{function t(s){return{...s,attachments:s.attachments.map(exports.AttachmentUtils.makeSerializable)}}e.serialize=t;function n(s){if(typeof s!="object"||s===null)return!1;const o=s;return!(!(typeof o.channelId=="string"&&Array.isArray(o.content)&&Array.isArray(o.attachments)&&typeof o.channelType=="string")||o.replyToPostId!==null&&typeof o.replyToPostId!="string")}e.isValid=n;function r(s){for(const o of s.attachments)if(o.type==="file"&&typeof o.localFile=="string"&&o.localFile.startsWith("blob:"))try{URL.revokeObjectURL(o.localFile)}catch{}}e.revokeBlobUrls=r})(Hg||(Hg={}));const RF={slug:"tm-wayfinding-group"};function TF(e){let t=!0,[n,r,s]=e.split("..");r=r||"0.0.0",s=s||"0000";let[o,u,c]=n.slice(1).split(".");o.at(-1)==="-"&&(o=o.slice(0,-1),t=!1);const[d,f,m]=r.split("."),y=s.split(".").map(w=>BigInt("0x"+w));return $F({pos:t,year:BigInt(o),month:BigInt(u),time:{day:BigInt(c),hour:BigInt(d),minute:BigInt(f),second:BigInt(m),ms:y}})}function PF(e){const t={day:0n,hour:0n,minute:0n,second:0n,ms:[]};e=e.slice(1);let[n,r]=e.split("..");return r=r||"0000",t.ms=r.split(".").map(s=>BigInt("0x"+s)),n.split(".").forEach(s=>{switch(s[0]){case"d":t.day+=BigInt(s.slice(1));break;case"h":t.hour+=BigInt(s.slice(1));break;case"m":t.minute+=BigInt(s.slice(1));break;case"s":t.second+=BigInt(s.slice(1));break;default:throw new Error("bad dr: "+e)}}),r=r||"0000",Cy(t)}function NF(e){const{pos:t,year:n,month:r,time:s}=zF(e);let o=`~${n}${t?"":"-"}.${r}.${s.day}`;return(s.hour!==0n||s.minute!==0n||s.second!==0n||s.ms.length!==0)&&(o=o+`..${s.hour.toString().padStart(2,"0")}.${s.minute.toString().padStart(2,"0")}.${s.second.toString().padStart(2,"0")}`,s.ms.length!==0&&(o=o+`..${s.ms.map(u=>u.toString(16).padStart(4,"0")).join(".")}`)),o}function OF(e){if(e===0n)return"~s0";const{day:t,hour:n,minute:r,second:s,ms:o}=xy(e);let u=[];return t!==0n&&u.push("d"+t.toString()),n!==0n&&u.push("h"+n.toString()),r!==0n&&u.push("m"+r.toString()),s!==0n&&u.push("s"+s.toString()),o.length!==0&&(u.length===0&&u.push("s0"),u.push("."+o.map(c=>c.toString(16).padStart(4,"0")).join("."))),"~"+u.join(".")}function UF(e){const n=Ql/2000n+(e-Ey);return Math.round(Number(n*1000n/Ql))}function MF(e){const t=BigInt(e)*Ql/1000n;return Ey+t}const Ey=BigInt("170141184475152167957503069145530368000"),Ql=BigInt("18446744073709551616"),Do=BigInt("292277024400");function Ra(e){return e%4n===0n&&e%100n!==0n||e%400n===0n}const vy=[31,28,31,30,31,30,31,31,30,31,30,31],Sy=[31,29,31,30,31,30,31,31,30,31,30,31],ef=86400n,tf=3600n,nf=60n,Gg=146097n,Ta=36524n;function $F(e){const t=e.pos?Do+BigInt(e.year):Do-(BigInt(e.year)-1n),n=(()=>{let r=Ra(t)?Sy:vy,s=e.time.day-1n,o=e.month-1n;for(;o!==0n;){const[d,...f]=r;s=s+BigInt(d),o=o-1n,r=f}let u=!0,c=t;for(;u==!0;)if(c%4n!==0n)c=c-1n,s=s+(Ra(c)?366n:365n);else if(c%100n!==0n)c=c-4n,s=s+(Ra(c)?1461n:1460n);else if(c%400n!==0n)c=c-100n,s=s+(Ra(c)?36525n:36524n);else{let d=c/400n;s=s+d*(4n*36524n+1n),u=!1}return s})();return e.time.day=n,Cy(e.time)}function Cy(e){let t=e.second+ef*e.day+tf*e.hour+nf*e.minute,n=e.ms,r=0n,s=3n;for(;n.length!==0;){const[o,...u]=n;r=r+(o<<16n*s),n=u,s-=1n}return r|t<<64n}function xy(e){let t=e>>64n;const s=(BigInt("0xffffffffffffffff")&e).toString(16).padStart(16,"0").match(/.{4}/g).map(d=>BigInt("0x"+d));for(;s.at(-1)===0n;)s.pop();let o=t/ef;t=t%ef;let u=t/tf;t=t%tf;let c=t/nf;return t=t%nf,{ms:s,day:o,minute:c,hour:u,second:t}}function LF(e){let t=0n,n=0n,r=!1;t=e/Gg,e=e%Gg,e<Ta+1n?r=!0:(r=!1,n=1n,e=e-(Ta+1n),n=n+e/Ta,e=e%Ta);let s=t*400n+n*100n,o=!0;for(;o==!0;){let u=r?366n:365n;if(!(e<u))s=s+1n,e=e-u,r=s%4n===0n;else{o=!1;let c=!0,d=0n;for(;c;){let m=BigInt((r?Sy:vy)[Number(d)]);if(e<m)return[s,d+1n,e+1n];d=d+1n,e=e-m}}}return[0n,0n,0n]}function zF(e){const t=xy(e),[n,r,s]=LF(t.day);t.day=s;const o=n>Do,u=o?n-Do:Do+1n-n;return{pos:o,year:u,month:r,time:t}}const HF=(e,t)=>{const n=Number(t&0xffn),r=Number((t&0xff00n)/256n),s=String.fromCharCode(n)+String.fromCharCode(r);return BigInt(GF(s,e))},GF=(e,t)=>{let n,r,s,o,u,c,d,f;for(n=e.length&3,r=e.length-n,s=t,u=3432918353,c=461845907,f=0;f<r;)d=e.charCodeAt(f)&255|(e.charCodeAt(++f)&255)<<8|(e.charCodeAt(++f)&255)<<16|(e.charCodeAt(++f)&255)<<24,++f,d=(d&65535)*u+(((d>>>16)*u&65535)<<16)&4294967295,d=d<<15|d>>>17,d=(d&65535)*c+(((d>>>16)*c&65535)<<16)&4294967295,s^=d,s=s<<13|s>>>19,o=(s&65535)*5+(((s>>>16)*5&65535)<<16)&4294967295,s=(o&65535)+27492+(((o>>>16)+58964&65535)<<16);switch(d=0,n){case 3:d^=(e.charCodeAt(f+2)&255)<<16;case 2:d^=(e.charCodeAt(f+1)&255)<<8;case 1:d^=e.charCodeAt(f)&255,d=(d&65535)*u+(((d>>>16)*u&65535)<<16)&4294967295,d=d<<15|d>>>17,d=(d&65535)*c+(((d>>>16)*c&65535)<<16)&4294967295,s^=d}return s^=e.length,s^=s>>>16,s=(s&65535)*2246822507+(((s>>>16)*2246822507&65535)<<16)&4294967295,s^=s>>>13,s=(s&65535)*3266489909+(((s>>>16)*3266489909&65535)<<16)&4294967295,s^=s>>>16,s>>>0},Kf=(e,t)=>HF([3077398253,3995603712,2243735041,1261992695][e],t),qF=e=>{const t=n=>{const r=n&0xffffffffn,s=n&0xffffffff00000000n;return n>=0x10000n&&n<=0xffffffffn?0x10000n+Ay(n-0x10000n):n>=0x100000000n&&n<=0xffffffffffffffffn?s|t(r):n};return t(e)},jF=e=>{const t=n=>{const r=n&0xffffffffn,s=n&0xffffffff00000000n;return n>=0x10000n&&n<=0xffffffffn?0x10000n+_y(n-0x10000n):n>=0x100000000n&&n<=0xffffffffffffffffn?s|t(r):n};return t(BigInt(e))},Ay=e=>Fy(4,65535n,65536n,0xffffffffn,Kf,e),Fy=(e,t,n,r,s,o)=>{const u=rf(e,t,n,s,o);return u<r?u:rf(e,t,n,s,u)},rf=(e,t,n,r,s)=>{const o=(d,f,m)=>{if(d>e)return e%2!==0||m===t?t*m+f:t*f+m;{const y=BigInt(r(d-1,m).toString()),w=d%2!==0?(f+y)%t:(f+y)%n;return o(d+1,m,w)}},u=s%t,c=s/t;return o(1,u,c)},_y=e=>Iy(4,65535n,65536n,0xffffffffn,Kf,e),Iy=(e,t,n,r,s,o)=>{const u=sf(e,t,n,s,o);return u<r?u:sf(e,t,n,s,u)},sf=(e,t,n,r,s)=>{const o=(m,y,w)=>{if(m<1)return t*w+y;{const E=r(m-1,y),F=m%2!==0?(w+t-E%t)%t:(w+n-E%n)%n;return o(m-1,F,y)}},u=e%2!==0?s/t:s%t,c=e%2!==0?s%t:s/t;return o(e,c===t?u:c,c===t?c:u)};var By={F:Kf,fe:rf,Fe:Fy,feis:Ay,fein:qF,fen:sf,Fen:Iy,tail:_y,fynd:jF};const ky=/^~([a-z]{3}|([a-z]{6}(\-[a-z]{6}){0,3}(\-(\-[a-z]{6}){4})*))$/;function WF(e){const t=Ty(e),n=o=>o.toString(2).padStart(8,"0"),r=t.reduce((o,u,c)=>c%2!==0||t.length===1?o+n(Cr.indexOf(u)):o+n(Is.indexOf(u)),""),s=BigInt("0b"+r);return By.fynd(s)}function KF(e){if(!ky.test(e)||!JF(e))return null;const t=WF(e);return e===Ry(t)?t:null}function Ry(e){const t=By.fein(e),n=Math.ceil(t.toString(16).length/2),r=Math.ceil(t.toString(16).length/4);function s(o,u,c){const d=o&0xffffn,f=Is[Number(d>>8n)],m=Cr[Number(d&0xffn)],y=u&3?"-":u===0?"":"--",w=f+m+y+c;return u===r?c:s(o>>16n,u+1,w)}return"~"+(n<=1?Cr[Number(t)]:s(t,0,""))}const VF=`
dozmarbinwansamlitsighidfidlissogdirwacsabwissibrigsoldopmodfoglidhopdardorlorhodfolrintogsilmirholpaslacrovlivdalsatlibtabhanticpidtorbolfosdotlosdilforpilramtirwintadbicdifrocwidbisdasmidloprilnardapmolsanlocnovsitnidtipsicropwitnatpanminritpodmottamtolsavposnapnopsomfinfonbanmorworsipronnorbotwicsocwatdolmagpicdavbidbaltimtasmalligsivtagpadsaldivdactansidfabtarmonranniswolmispallasdismaprabtobrollatlonnodnavfignomnibpagsopralbilhaddocridmocpacravripfaltodtiltinhapmicfanpattaclabmogsimsonpinlomrictapfirhasbosbatpochactidhavsaplindibhosdabbitbarracparloddosbortochilmactomdigfilfasmithobharmighinradmashalraglagfadtopmophabnilnosmilfopfamdatnoldinhatnacrisfotribhocnimlarfitwalrapsarnalmoslandondanladdovrivbacpollaptalpitnambonrostonfodponsovnocsorlavmatmipfip`,ZF=`
zodnecbudwessevpersutletfulpensytdurwepserwylsunrypsyxdyrnuphebpeglupdepdysputlughecryttyvsydnexlunmeplutseppesdelsulpedtemledtulmetwenbynhexfebpyldulhetmevruttylwydtepbesdexsefwycburderneppurrysrebdennutsubpetrulsynregtydsupsemwynrecmegnetsecmulnymtevwebsummutnyxrextebfushepbenmuswyxsymselrucdecwexsyrwetdylmynmesdetbetbeltuxtugmyrpelsyptermebsetdutdegtexsurfeltudnuxruxrenwytnubmedlytdusnebrumtynseglyxpunresredfunrevrefmectedrusbexlebduxrynnumpyxrygryxfeptyrtustyclegnemfermertenlusnussyltecmexpubrymtucfyllepdebbermughuttunbylsudpemdevlurdefbusbeprunmelpexdytbyttyplevmylwedducfurfexnulluclennerlexrupnedlecrydlydfenwelnydhusrelrudneshesfetdesretdunlernyrsebhulrylludremlysfynwerrycsugnysnyllyndyndemluxfedsedbecmunlyrtesmudnytbyrsenwegfyrmurtelreptegpecnelnevfes`,Is=VF.match(/.{1,3}/g),Cr=ZF.match(/.{1,3}/g);function Ty(e){return e.replace(/[\^~-]/g,"").match(/.{1,3}/g)||[]}function JF(e){const t=Ty(e);return!(t.length%2!==0&&t.length!==1)&&t.every((n,r)=>r%2!==0||t.length===1?Cr.includes(n):Is.includes(n))}function XF(e){const t=e.toString(16),n=t.length,r=Buffer.from(t.padStart(n+n%2,"0"),"hex"),s=r.length%2!==0&&r.length>1?[[r[0]]].concat(qg(Array.from(r.slice(1)),2)):qg(Array.from(r),2),o=d=>d[1]===void 0?Cr[d[0]]:Is[d[0]]+Cr[d[1]],u=d=>d[1]===void 0?Cr[d[0]]:Is[d[0]]+Cr[d[1]],c=d=>d.length%2!==0&&s.length>1?o(d):u(d);return s.reduce((d,f)=>d+(d===".~"?"":"-")+c(f),".~")}function YF(e){const t=e.slice(2).split("-"),n=s=>{if(s<0)throw new Error("malformed @q");return s.toString(16).padStart(2,"0")},r=t.map((s,o)=>{let u=e2(3,s);return u[1]===""&&o===0?n(Cr.indexOf(u[0])):n(Is.indexOf(u[0]))+n(Cr.indexOf(u[1]))});return BigInt("0x"+(e.length===0?"00":r.join("")))}function QF(e){try{return YF(e)}catch{return null}}function qg(e,t){let n=[],r=[n];for(let s=0;s<e.length;s++)n.length<t?n.push(e[s]):(n=[e[s]],r.push(n));return r}function e2(e,t){return[t.slice(0,e),t.slice(e)]}function t2(e,t){return e=Py(e),n2(t.slice(e.l.length),e.w,e.p)}function Pa(e,t){return e=Py(e),e.l+o2(u2(t,BigInt(e.w),BigInt(e.p)))}function Py(e){return e==="h"?{w:5,p:10,l:".~~"}:e==="s"?{w:8,p:23,l:"."}:e==="d"?{w:11,p:52,l:".~"}:e==="q"?{w:15,p:112,l:".~~~"}:e}function Qa(e){return 2n**e-1n}function n2(e,t,n){if(e==="nan")return r2(t,n);if(e==="inf")return jg(!0,t,n);if(e==="-inf")return jg(!1,t,n);let r=0,s=!0;e[r]==="-"&&(s=!1,r++);let o="";for(;e[r]!=="."&&e[r]!=="e"&&e[r]!==void 0;)o+=e[r++];e[r]==="."&&r++;let u="";for(;e[r]!=="e"&&e[r]!==void 0;)u+=e[r++];e[r]==="e"&&r++;let c=!0;e[r]==="-"&&(c=!1,r++);let d="";for(;e[r]!==void 0;)d+=e[r++];return BigInt("0b"+i2(t,n,s,o,u,c,Number(d)))}function r2(e,t){return Qa(BigInt(e+1))<<BigInt(t-1)}function jg(e,t,n){return Qa(BigInt(e?t:t+1))<<BigInt(n)}function i2(e,t,n,r,s,o,u){return u!==0&&(o?(r=r+s.padEnd(u,"0").slice(0,u),s=s.slice(u)):(s=r.padStart(u,"0").slice(-u)+s,r=r.slice(0,-u))),s2(t,e,n,BigInt(r),BigInt(s.length),BigInt(s))}function s2(e,t,n,r,s,o){function u(ge){return console.warn(ge),1}const c=2**(t-1)-1,d=-c+1,f=c,m=d-e,y=2*c+1+e+3,w=new Array(y),E=10n**s;var F=0,I=!n,T,$,V,H,Q,te;for(T=y;T;w[--T]=0);for(T=c+2;r&&T;w[--T]=r&1n,r=r>>1n);for(T=c+1;o>0n&&T<y;(w[++T]=(o*=2n)>=E?1:0)&&(o=o-E));for(T=-1;++T<y&&!w[T];);if(w[($=e-1+(T=(F=c+1-T)>=d&&F<=f?T+1:c+1-(F=d-1)))+1]){if(!(V=w[$]))for(H=$+2;!V&&H<y;V=w[H++]);for(H=$+1;V&&--H>=0;(w[H]=(w[H]?0:1)-0)&&(V=0));}for(T=T-2<0?-1:T-3;++T<y&&!w[T];);for((F=c+1-T)>=d&&F<=f?++T:F<d&&(F!=c+1-y&&F<m&&u("r.construct underflow"),T=c+1-(F=d-1)),r&&(u(r?"r.construct overflow":"r.construct"),F=f+1,T=c+2),te=Math.abs(F+c),H=t+1,Q="";--H;Q=(te&1)+Q,te=te>>=1);return(I?"1":"0")+Q+w.slice(T,T+e).join("")}function o2(e){if(e.t==="n")return"nan";if(e.t==="i")return e.s?"inf":"-inf";let t;return e.e-4>0||e.e+2<0?t=1:(t=e.e+1,e.e=0),(e.s?"":"-")+a2(t,e.a)+(e.e===0?"":"e"+e.e.toString())}function a2(e,t){const n=Math.abs(e);if(e<=0)return"0."+"".padEnd(n,"0")+t;{const r=t.length;return n>=r?t+"".padEnd(n-r,"0"):t.slice(0,n)+"."+t.slice(n)}}function u2(e,t,n){const r=Qa(n),s=Qa(t),o=e&r,u=e>>BigInt(n)&s,c=(e>>BigInt(t+n)&1n)===0n;let d,f,m,y;if(u===s)return o===0n?{t:"i",s:c}:{t:"n"};u!==0n?(d=1n<<BigInt(n)|o,f=u-(2n**(t-1n)-1n)-n,m=Number(n),y=u!==1n&&o===0n):(d=o,f=1n-(2n**(t-1n)-1n)-n,m=d.toString(2).length-1,y=!1);const w=(2n**n).toString(10).length+1,E=c2(d,Number(f),m,y,"unique",0,w);return{t:"d",s:c,e:E.outExponent,a:E.digits}}function c2(e,t,n,r,s,o,u){const c=BigInt(t);let d=0,f=new Array(u).fill("0"),m=0;if(e===0n)return f[0]="0",m=0,{digits:f.slice(0,1).join(""),outExponent:m};let y,w,E,F;r?t>0?(w=4n*e,w<<=c,y=4n,E=1n<<c,F=1n<<c+1n):(w=4n*e,y=1n<<-c+2n,E=1n,F=2n):t>0?(w=2n*e,w<<=c,y=2n,E=1n<<c,F=E):(w=2n*e,y=1n<<BigInt(-t+1),E=1n,F=E);let T=Math.ceil((n+t)*.3010299956639812-.69);if(T>0)y*=BigInt(10)**BigInt(T);else if(T<0){const De=BigInt(10)**BigInt(-T);w*=De,E*=De,F!==E&&(F*=E)}w>=y?T+=1:(w*=10n,E*=10n,F!==E&&(F*=10n));let $=T-u;m=T-1;let V=!1,H=!1,Q=0;for(;;){T-=1,Q=Number(w/y),w=w%y;let De=w+F;if(V=w<E,H=De>y,V||H||T===$)break;f[d]=String.fromCharCode(48+Q),d+=1,w*=10n,E*=10n,F!==E&&(F*=10n)}let te=V;if(V===H){w*=2n;let De=w<y?-1:w>y?1:0;te=De<0,De===0&&(te=(Q&1)===0)}if(te)f[d]=String.fromCharCode(48+Q),d+=1;else if(Q===9)for(;;){if(d===0){f[d]="1",d+=1,m+=1;break}if(d-=1,f[d]!=="9"){f[d]=String.fromCharCode(f[d].charCodeAt(0)+1),d+=1;break}}else f[d]=String.fromCharCode(48+Q+1),d+=1;return{digits:f.slice(0,d).join(""),outExponent:m}}function Kn(e,t,n,r,s){s===void 0&&(s=!1);const o=r===0?t:`${t}${n}{0,${r-1}}`,u=r===0?`${n}*`:`(\\.${n}{${r}})*`;return new RegExp(`^${s?"\\-\\-?":""}${e}(0|${o}${u})$`)}function Na(e){return new RegExp(`^\\.~{${e}}(nan|\\-?(inf|(0|[1-9][0-9]*)(\\.[0-9]+)?(e\\-?(0|[1-9][0-9]*))?))$`)}const lt={c:/^~\-((~[0-9a-fA-F]+\.)|(~[~\.])|[0-9a-z\-\._])*$/,da:/^~(0|[1-9][0-9]*)\-?\.0*([1-9]|1[0-2])\.0*[1-9][0-9]*(\.\.([0-9]+)\.([0-9]+)\.([0-9]+)(\.(\.[0-9a-f]{4})+)?)?$/,dr:/^~((d|h|m|s)(0|[1-9][0-9]*))(\.(d|h|m|s)(0|[1-9][0-9]*))*(\.(\.[0-9a-f]{4})+)?$/,f:/^\.(y|n)$/,if:/^(\.(0|[1-9][0-9]{0,2})){4}$/,is:/^(\.(0|[1-9a-fA-F][0-9a-fA-F]{0,3})){8}$/,n:/^~$/,p:ky,q:/^\.~(([a-z]{3}|[a-z]{6})(\-[a-z]{6})*)$/,rd:Na(1),rh:Na(2),rq:Na(3),rs:Na(0),sb:Kn("0b","1","[01]",4,!0),sd:Kn("","[1-9]","[0-9]",3,!0),si:Kn("0i","[1-9]","[0-9]",0,!0),sv:Kn("0v","[1-9a-v]","[0-9a-v]",5,!0),sw:Kn("0w","[1-9a-zA-Z~-]","[0-9a-zA-Z~-]",5,!0),sx:Kn("0x","[1-9a-f]","[0-9a-f]",4,!0),t:/^~~((~[0-9a-fA-F]+\.)|(~[~\.])|[0-9a-z\-\._])*$/,ta:/^~\.[0-9a-z\-\.~_]*$/,tas:/^[a-z][a-z0-9\-]*$/,ub:Kn("0b","1","[01]",4),ud:Kn("","[1-9]","[0-9]",3),ui:Kn("0i","[1-9]","[0-9]",0),uv:Kn("0v","[1-9a-v]","[0-9a-v]",5),uw:Kn("0w","[1-9a-zA-Z~-]","[0-9a-zA-Z~-]",5),ux:Kn("0x","[1-9a-f]","[0-9a-f]",4)},Vf=l2;function l2(e,t){const n=Ny(e,t);if(!n)throw new Error("slav: failed to parse @"+e+" from string: "+t);return n}const f2=Ny;function Ny(e,t){if(e in lt&&!lt[e].test(t))return null;const n=Oy(t);return n&&n.type==="dime"&&n.aura===e?n.atom:null}function Oy(e){if(e==="")return null;const t=e[0];if(t>="a"&&t<="z")return lt.tas.test(e)?{type:"dime",aura:"tas",atom:Oa(e)}:null;if(t>="0"&&t<="9"){const n=Wg(e);return n?{type:"dime",...n}:null}else if(t==="-"){let n=!0;e[1]=="-"?e=e.slice(2):(e=e.slice(1),n=!1);const r=Wg(e);return r?(n?r.atom=2n*r.atom:r.atom!==0n&&(r.atom=1n+2n*(r.atom-1n)),{type:"dime",aura:r.aura.replace("u","s"),atom:r.atom}):null}else if(t==="."){if(e===".y")return{type:"dime",aura:"f",atom:0n};if(e===".n")return{type:"dime",aura:"f",atom:1n};if(lt.is.test(e)){const n=e.slice(1).split(".").reduce((r,s)=>r+s.padStart(4,"0"),"");return{type:"dime",aura:"is",atom:BigInt("0x"+n)}}else{if(lt.if.test(e))return{type:"dime",aura:"if",atom:e.slice(1).split(".").reduce((r,s,o)=>r+(BigInt(s)<<BigInt(8*(3-o))),0n)};if(e[1]==="~"&&(lt.rd.test(e)||lt.rh.test(e)||lt.rq.test(e))||lt.rs.test(e)){let n=0;for(;e[n+1]==="~";)n++;let r;switch(n){case 0:r="rs";break;case 1:r="rd";break;case 2:r="rh";break;case 3:r="rq";break;default:throw new Error("parsing invalid @r*")}return{type:"dime",aura:r,atom:t2(r[1],e)}}else if(e[1]==="~"&&lt.q.test(e)){const n=QF(e);return n===null?null:{type:"dime",aura:"q",atom:n}}else if(e[1]==="_"&&/^\.(_([0-9a-zA-Z\-\.]|~\-|~~)+)*__$/.test(e)){const n=e.slice(1,-2).split("_").slice(1).map(r=>(r=r.replaceAll("~-","_").replaceAll("~~","~"),Oy(r)));return n.some(r=>r===null)?null:{type:"many",list:n}}}return null}else if(t==="~"){if(e==="~")return{type:"dime",aura:"n",atom:0n};if(lt.da.test(e))return{type:"dime",aura:"da",atom:TF(e)};if(lt.dr.test(e))return{type:"dime",aura:"dr",atom:PF(e)};if(lt.p.test(e)){const n=KF(e);return n===null?null:{type:"dime",aura:"p",atom:n}}else{if(e[1]==="."&&lt.ta.test(e))return{type:"dime",aura:"ta",atom:Oa(e.slice(2))};if(e[1]==="~"&&lt.t.test(e))return{type:"dime",aura:"t",atom:Oa(Kg(e.slice(2)))};if(e[1]==="-"&&lt.c.test(e))return/^~\-~[0-9a-f]+\.$/.test(e)?{type:"dime",aura:"c",atom:BigInt("0x"+e.slice(3,-1))}:{type:"dime",aura:"c",atom:Oa(Kg(e.slice(2)))}}return e[1]==="0"&&/^~0[0-9a-v]+$/.test(e)?{type:"blob",jam:of(5,Uy,e.slice(2))}:null}return null}function Wg(e){switch(e.slice(0,2)){case"0b":return lt.ub.test(e)?{aura:"ub",atom:BigInt(e.replaceAll(".",""))}:null;case"0c":return console.log("aura-js: @uc parsing unsupported (bisk)"),null;case"0i":return lt.ui.test(e)?{aura:"ui",atom:BigInt(e.slice(2))}:null;case"0x":return lt.ux.test(e)?{aura:"ux",atom:BigInt(e.replaceAll(".",""))}:null;case"0v":return lt.uv.test(e)?{aura:"uv",atom:of(5,Uy,e.slice(2))}:null;case"0w":return lt.uw.test(e)?{aura:"uw",atom:of(6,d2,e.slice(2))}:null;default:return lt.ud.test(e)?{aura:"ud",atom:BigInt(e.replaceAll(".",""))}:null}}function Kg(e){let t="",n=0;for(;n<e.length;)switch(e[n]){case".":t=t+" ",n++;continue;case"~":switch(e[++n]){case"~":t=t+"~",n++;continue;case".":t=t+".",n++;continue;default:let r=0;do r=r<<4|Number.parseInt(e[n++],16);while(e[n]!==".");t=t+String.fromCodePoint(r),n++;continue}default:t=t+e[n++];continue}return t}function Oa(e){return h2(new TextEncoder().encode(e))}const d2="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-~",Uy="0123456789abcdefghijklmnopqrstuv";function of(e,t,n){let r=0n;const s=BigInt(e);for(;n!=="";)n[0]!=="."&&(r=(r<<s)+BigInt(t.indexOf(n[0]))),n=n.slice(1);return r}function h2(e){if(e.length===0)return 0n;if(typeof Buffer<"u")return BigInt("0x"+Buffer.from(e.reverse()).toString("hex"));let t,n=[];for(var r=e.length-1;r>=0;--r)t=e[r],n.push(t<16?"0"+t.toString(16):t.toString(16));return BigInt("0x"+n.join(""))}const nn=p2;function p2(e,t){return af({type:"dime",aura:e,atom:t})}function af(e){switch(e.type){case"blob":return"~0"+e.jam.toString(32);case"many":return"."+e.list.reduce((t,n)=>t+"_"+y2(af(n)),"")+"__";case"dime":switch(e.aura[0]){case"c":return e.atom<0x7fn?"~-"+Vg(String.fromCharCode(Number(e.atom))):"~-~"+e.atom.toString(16)+".";case"d":switch(e.aura[1]){case"a":return NF(e.atom);case"r":return OF(e.atom);default:return ao(e.atom)}case"f":switch(e.atom){case 0n:return".y";case 1n:return".n";default:return ao(e.atom)}case"n":return"~";case"i":switch(e.aura[1]){case"f":return"."+Zg(e.atom,1,4,10);case"s":return"."+Zg(e.atom,2,8,16);default:return ao(e.atom)}case"p":return Ry(e.atom);case"q":return XF(e.atom);case"r":switch(e.aura[1]){case"d":return Pa("d",e.atom);case"h":return Pa("h",e.atom);case"q":return Pa("q",e.atom);case"s":return Pa("s",e.atom);default:return ao(e.atom)}case"u":switch(e.aura[1]){case"c":throw new Error("aura-js: @uc rendering unsupported");case"b":return"0b"+uo(e.atom.toString(2),4);case"i":return"0i"+g2(1,e.atom);case"x":return"0x"+uo(e.atom.toString(16),4);case"v":return"0v"+uo(e.atom.toString(32),5);case"w":return"0w"+uo(w2(6,D2,e.atom),5);default:return uo(e.atom.toString(10),3)}case"s":const t=e.atom&1n;return e.atom=t+(e.atom>>1n),e.aura=e.aura.replace("s","u"),(t===0n?"--":"-")+af(e);case"t":return e.aura[1]==="a"?e.aura[2]==="s"?tl(e.atom):"~."+tl(e.atom):"~~"+Vg(tl(e.atom));default:return ao(e.atom)}}}function g2(e,t){return t.toString(10).padStart(e,"0")}function m2(e,t){return t.toString(16).padStart(e,"0")}function ao(e){return"0x"+m2(1,e)}function y2(e){return e.replaceAll("~","~~").replaceAll("_","~-")}function Vg(e){let t="";for(let n=0;n<e.length;n+=1){const r=e[n];let s="";switch(r){case" ":s=".";break;case".":s="~.";break;case"~":s="~~";break;default:{const o=e.codePointAt(n);if(!o)break;o>65535&&(n+=1),o>=97&&o<=122||o>=48&&o<=57||r==="-"?s=r:s=`~${o.toString(16)}.`}}t+=s}return t}const D2="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-~";function w2(e,t,n){if(n===0n)return t[0];let r="";const s=BigInt(e);for(;n!==0n;)r=t[Number(BigInt.asUintN(e,n))]+r,n=n>>s;return r}function uo(e,t){return e.replace(new RegExp(`(?=(?:.{${t}})+$)(?!^)`,"g"),".")}function Zg(e,t,n,r){r===void 0&&(r=10);let s="";const o=8n*BigInt(t),u=(1n<<o)-1n;for(;n-- >0;)s!==""&&(s="."+s),s=(e&u).toString(r)+s,e=e>>o;return s}function tl(e){return new TextDecoder("utf-8").decode(b2(e).reverse())}function b2(e){if(e===0n)return new Uint8Array(0);const t=e.toString(16),n=t.length%2===0?t:"0"+t,r=n.length/2,s=new Uint8Array(r);for(let o=0;o<n.length;o+=2){const u=n.slice(o,o+2),c=parseInt(u,16)<<24>>24;s[o/2]=c}return s}const ur={toUnix:UF,fromUnix:MF};function eu(e){const t=e.toString(16),n=t.length%2===0?t:"0"+t,r=n.length/2,s=new Uint8Array(r);for(let o=0;o<n.length;o+=2){const u=n.slice(o,o+2),c=parseInt(u,16)<<24>>24;s[o/2]=c}return s}const Ua=[],Ma=[],Jg=[];let co=0;function Fo(e){if(e===0n)return 0;let t=0;for(;co===t&&(Ua.push(32<<co),Ma.push(BigInt(Ua[co])),Jg.push(1n<<Ma[co]),co++),!(e<Jg[t]);)t++;if(!t)return 32-Math.clz32(Number(e));t--;let n=Ua[t],r=e>>Ma[t];for(;t--;){let s=r>>Ma[t];s&&(n+=Ua[t],r=s)}return n+32-Math.clz32(Number(r))}function E2(e,t){return(e&BigInt(1)<<BigInt(t))!==BigInt(0)}function Zf(e,t){if(t===16)return BigInt("0x"+(e||"0"));if(t===10)return BigInt(e||"0");let n=BigInt(0);const r=BigInt(t),s=e.length;for(let o=0;o<s;o++){const u=parseInt(e.charAt(o),t);if(isNaN(u))throw new Error(`Invalid character for radix ${t}: '${e.charAt(o)}'`);n=n*r+BigInt(u)}return n}function v2(e,t,n){let r,s,o,u,c,d,f,m,y;if(t===0n?(y=new Uint8Array(0),e=e||0):(y=eu(t),e=e||y.length),y.length<e){const w=new Uint8Array(e-y.length),E=new Uint8Array(y.length+w.length);E.set(w),E.set(y,w.length),y=E}else if(y.length>e)throw new Error("murmur3 oversized key for length");for(y.reverse(),r=y.length&3,s=y.length-r,o=n,c=3432918353,d=461845907,m=0;m<s;)f=y[m]&255|(y[++m]&255)<<8|(y[++m]&255)<<16|(y[++m]&255)<<24,++m,f=(f&65535)*c+(((f>>>16)*c&65535)<<16)&4294967295,f=f<<15|f>>>17,f=(f&65535)*d+(((f>>>16)*d&65535)<<16)&4294967295,o^=f,o=o<<13|o>>>19,u=(o&65535)*5+(((o>>>16)*5&65535)<<16)&4294967295,o=(u&65535)+27492+(((u>>>16)+58964&65535)<<16);switch(f=0,r){case 3:f^=(y[m+2]&255)<<16;case 2:f^=(y[m+1]&255)<<8;case 1:f^=y[m]&255,f=(f&65535)*c+(((f>>>16)*c&65535)<<16)&4294967295,f=f<<15|f>>>17,f=(f&65535)*d+(((f>>>16)*d&65535)<<16)&4294967295,o^=f}return o^=y.length,o^=o>>>16,o=(o&65535)*2246822507+(((o>>>16)*2246822507&65535)<<16)&4294967295,o^=o>>>13,o=(o&65535)*3266489909+(((o>>>16)*3266489909&65535)<<16)&4294967295,o^=o>>>16,o>>>0}function mt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.length===1?t[0]:t;if(_2(r))return r;if(typeof r=="number")return Y.fromInt(r);if(typeof r=="bigint")return new Y(r);if(typeof r=="string")return Y.fromCord(r);if(Array.isArray(r)){if(r.length<2)return mt(r[0]);const o=mt(r[r.length-2]),u=mt(r[r.length-1]);let c=new ze(o,u);for(var s=r.length-3;s>=0;--s)c=new ze(mt(r[s]),c);return c}else if(r===null)return Y.zero;throw console.error("what do you mean??",typeof r,JSON.stringify(r)),new Error("dwim, but meaning unclear")}function S2(e){return e.length===0?Y.zero:mt([...e,Y.zero])}function C2(e){if(e.length===0)return Y.zero;let t=Y.zero;for(let n of e)t=uf(t,mt(n));return t}function x2(e){if(e.length===0)return Y.zero;let t=Y.zero;for(let n of e)t=cf(t,mt(n.key),mt(n.val));return t}const Jf={nounify:mt,dwim:mt,list:S2,set:C2,map:x2};function My(e,t,n){let r=0;for(;r<8;){const s=v2(null,n,e),o=s>>>31^s&2147483647;if(o!==0)return o;r++,e++}return t}function tu(e,t){return e.equals(t)?!0:e.isCell()?t.isAtom()?!1:e.head.equals(t.head)?tu(e.tail,t.tail):tu(e.head,t.head):t.isCell()?!0:e<t}function $y(e,t){const n=e.mug(),r=t.mug();return n===r?tu(e,t):n<r}function nu(e,t){const n=Y.fromInt(e.mug()).mug(),r=Y.fromInt(t.mug()).mug();return n===r?tu(e,t):n<r}function nl(e){return e.isCell()&&e.tail.isCell()}function uf(e,t){if(e.equals(Y.zero))return mt(t,null,null);if(!nl(e))throw new Error("malformed set");if(t.equals(e.head))return e;if($y(t,e.head)){const r=uf(e.tail.head,t);if(!nl(r))throw new Error("implementation error");return nu(e.head,r.head)?mt(e.head,r,e.tail.tail):mt(r.head,r.tail.head,[e.head,r.tail.tail,e.tail.tail])}const n=uf(e.tail.tail,t);if(!nl(n))throw new Error("implementation error");return nu(e.head,n.head)?mt(e.head,e.tail.head,n):mt(n.head,[e.head,e.tail.head,n.tail.head],n.tail.tail)}function rl(e){return e.isCell()&&e.head.isCell()&&e.tail.isCell()}function cf(e,t,n){if(e.equals(Y.zero))return mt([t,n],null,null);if(!rl(e))throw new Error("malformed map");if(t.equals(e.head.head))return n.equals(e.head.tail)?e:mt([t,n],e.tail);if($y(t,e.head.head)){const s=cf(e.tail.head,t,n);if(!rl(s))throw new Error("implementation error");return nu(e.head.head,s.head.head)?mt(e.head,s,e.tail.tail):mt(s.head,s.tail.head,[e.head,s.tail.tail,e.tail.tail])}const r=cf(e.tail.tail,t,n);if(!rl(r))throw new Error("implementation error");return nu(e.head.head,r.head.head)?mt(e.head,e.tail.head,r):mt(r.head,[e.head,e.tail.head,r.tail.head],r.tail.tail)}var Ms;const il={0:function(e){throw new Error("Bail")},1:function(e){return e}};class Y{constructor(t){this.number=void 0,this._mug=0,this.deep=!1,this.number=t}isAtom(){return!0}isCell(){return!1}pretty(t,n){if(this.number<65536n)t.push(this.number.toString(10));else{let r=[],s=!0,o=!0,u=eu(this.number);for(let c=u.length-1;c>=0;--c){const d=u[c];if(s&&(d<32||d>127)){s=!1,o=!1;break}else o&&!(d>47&&d<58||d>96&&d<123||d===45)&&(o=!1);r.push(String.fromCharCode(d))}o?(t.push("%"),t.push.apply(t,r)):s?(t.push("'"),t.push.apply(t,r),t.push("'")):(t.push("0x"),t.push(this.number.toString(16)))}}toString(){const t=[];return this.pretty(t,!1),t.join("")}equals(t){return t instanceof Y&&t.number===this.number}loob(){if(Number(this.number)===0)return!0;if(Number(this.number)===1)return!1;throw new Error("Bail")}mug(){return this._mug===0&&(this._mug=this.calculateMug()),this._mug}calculateMug(){return My(3405691582,32767,this.number)}mugged(){return this._mug!==0}at(t){return Y.fragmenter(t)(this)}bump(){return new Y(this.number+1n)}bytes(){const t=eu(this.number),n=[];for(var r=t.length-1;r>=0;--r)n.push(t[r]&255);return n}cap(){if(Number(this.number)===0)throw new Error("Bail");if(Number(this.number)===1)throw new Error("Bail");return E2(this.number,Fo(this.number)-2)?new Y(3n):new Y(2n)}mas(){if(Number(this.number)===0)throw new Error("Bail");if(Number(this.number)===1)throw new Error("Bail");if(Number(this.number)===2)return new Y(1n);if(Number(this.number)===3)return new Y(1n);{const t=this.number,n=Fo(t)-2,r=BigInt(1<<n),s=BigInt((1<<n)-1);return new Y(t&s^r)}}shortCode(){return this.number.toString(36)}static cordToString(t){const n=t.bytes(),r=[];for(let s=0;s<n.length;++s)r.push(String.fromCharCode(n[s]));return r.join("")}static fragmenter(t){const n=t.shortCode();if(il.hasOwnProperty(n))return il[n];for(var r=["a"];!Y.one.equals(t);t=t.mas())r.push(Y.two.equals(t.cap())?"head":"tail");return il[n]=new Function("a","return "+r.join(".")+";")}static fromString(t,n){n===void 0&&(n=10);const r=Zf(t,n);return new Y(r)}static fromInt(t){return t<256?Y.small[t]:new Y(BigInt(t))}static fromCord(t){if(t.length===0)return Y.zero;let n,r,s=Array(t.length);for(n=0,r=s.length-1;n<s.length;++n,--r){const o=(t.charCodeAt(n)&255).toString(16);s[r]=o.length===1?"0"+o:o}return t.length>4?Y.fromString(s.join(""),16):new Y(BigInt(parseInt(s.join(""),16)))}}Ms=Y;Y.small=Array.from(Array(256)).map(function(e,t){return new Ms(BigInt(t))});Y.zero=Ms.small[0];Y.one=Ms.small[1];Y.two=Ms.small[2];Y.three=Ms.small[3];class ze{constructor(t,n,r){r===void 0&&(r=!0),this.head=void 0,this.tail=void 0,this.deep=void 0,this._mug=0,this.head=t,this.tail=n,this.deep=r}isAtom(){return!1}isCell(){return!0}pretty(t,n){n||t.push("["),this.head.pretty(t,!1),t.push(" "),this.tail.pretty(t,!0),n||t.push("]")}toString(){const t=[];return this.pretty(t,!1),t.join("")}mug(){return this._mug===0&&(this._mug=this.calculateMug()),this._mug}calculateMug(){return My(3735928559,65534,BigInt(this.tail.mug())<<32n|BigInt(this.head.mug()))}mugged(){return this._mug!==0}equals(t){return t instanceof ze?this.unify(t):!1}bump(){throw new Error("Bail")}loob(){throw new Error("Bail")}at(t){return Y.fragmenter(t)(this)}unify(t){if(this===t)return!0;if(t.mugged())if(this.mugged()){if(this.mug()!=t.mug())return!1}else return t.unify(this);return this.head.equals(t.head)&&(t.head=this.head,this.tail.equals(t.tail))?(t._mug=this._mug,t.tail=this.tail,!0):!1}}function A2(e){return e instanceof Y}function F2(e){return e instanceof ze}function _2(e){return A2(e)||F2(e)}const I2=function(e){return function(t){if(!(t instanceof ze&&t.head instanceof Y))throw new Error("frond: noun not cell with tag head");const n=Y.cordToString(t.head);for(let r=0;r<e.length;r++)if(n===e[r].tag)return{[n]:e[r].get(t.tail)};throw new Error("frond: unknown tag"+n)}},B2=function(e){return function(t){let n=0,r=[];for(;n<e.length-1;){if(t.isAtom())throw new Error("tuple: noun too shallow");r.push(e[n](t.head)),t=t.tail,n++}return r.push(e[n](t)),r}},Ly=function(e){return function(t){let n=0,r={};for(;n<e.length-1;){if(!(t instanceof ze))throw new Error("pairs: noun too shallow");r[e[n].nom]=e[n].get(t.head),t=t.tail,n++}return r[e[n].nom]=e[n].get(t),r}},k2=function(e,t,n,r){return Ly([{nom:e,get:t},{nom:n,get:r}])},R2=function(e){return function(t){for(let n=0;n<e.length;n++)try{return e[n](t)}catch{continue}throw new Error("bucwut: no matches")}},T2=function(e){return function(t){if(!(t instanceof ze&&t.head instanceof Y))throw new Error("buccen: noun not cell with tag head");const n=Y.cordToString(t.head);for(let r=0;r<e.length;r++)if(n===e[r].tag)return e[r].get(t.tail);throw new Error("buccen: unknown tag: "+n)}},Xf=function(e){return function(t){let n=[];for(;t instanceof ze;)n.push(e(t.head)),t=t.tail;return n}},lf=function(e){return function(t){if(t instanceof ze){if(!(t.tail instanceof ze))throw new Error("tree: malformed");return[...lf(e)(t.tail.tail),e(t.head),...lf(e)(t.tail.head)]}return[]}},zy=function(e){if(!(e instanceof Y))throw new Error(`cord: noun not atom ${e.toString()}`);return Y.cordToString(e)},P2=function(e){return Xf(t=>{if(t.isCell())throw new Error("tape: malformed");return Y.cordToString(t)})(e).join()},N2=function(e){if(!(e instanceof Y))throw new Error("numb: noun not atom");return Fo(e.number)<=32?Number(e.number):e.number.toString()},O2=function(e){if(!(e instanceof Y))throw new Error("numb32: noun not atom");if(Fo(e.number)>32)throw new Error("numb32: number too big");return Number(e.number)},U2=function(e){if(!(e instanceof Y))throw new Error("numbString: noun not atom");return e.number.toString()},M2=function(e){return e.loob()},$2=function(e){if(!(e instanceof Y&&e.number===0n))throw new Error("nill: not null");return null},L2=Xf(zy),Bs={frond:I2,tuple:B2,pairs:Ly,pair:k2,array:Xf,loob:M2,tree:lf,cord:zy,tape:P2,numb:N2,numb32:O2,numbString:U2,path:L2,buccen:T2,bucwut:R2,nill:$2};function _o(e,t){var n=Fo(t.number),r=n>>>e,s=r<<e!==n;return s?r+1:r}function ks(e,t){return e.number>t.number}function z2(e,t){return e.number<t.number}function H2(e,t){return e.number>=t.number}function G2(e,t){return e.number<=t.number}function q2(e,t){return new Y(e.number+t.number)}function Hy(e,t){var n=e.number-t.number;if(n<0)throw new Error("subtract underflow");return new Y(n)}function j2(e){return Hy(e,Y.one)}function W2(e){const t=1n<<e.number;return new Y(t)}function K2(e,t,n){var r=Number(t.number<<e.number);return new Y(n.number<<BigInt(r))}function V2(e,t,n){var r=t.number<<e.number;return new Y(n.number>>BigInt(r))}function Gy(e){var t=e.length,n=t%4;let r,s,o;if(n>0)for(t+=4-n,r=0;r<n;++r)e.push(0);const u=t>>2,c=new Array(u);for(r=0,s=0;r<u;++r)o=e[s++]<<0&255,o^=e[s++]<<8&65280,o^=e[s++]<<16&16711680,o^=e[s++]<<24&4278190080,c[r]=o;return c}function qy(e){const t=[];let n,r,s;for(r=0,s=0;r<e.length;++r)n=e[r],t[s++]=255&(n&255),t[s++]=255&(n&65280)>>>8,t[s++]=255&(n&16711680)>>>16,t[s++]=255&(n&4278190080)>>>24;for(;t[--s]===0;)t.pop();return t}function jy(e){let t,n=[];for(var r=e.length-1;r>=0;--r)t=e[r]&255,n.push(t<16?"0"+t.toString(16):t.toString(16));const s=Zf(n.join(""),16);return new Y(s)}function Wy(e){return e.bytes()}function Ky(e){return Gy(Wy(e))}function Vy(e){return jy(qy(e))}var Eu=Vy;function vu(e,t){return new Array((t<<e)+31>>>5)}function Io(e,t,n,r,s,o){var u=Ky(o),c=u.length,d,f,F,m,y,w,E,F,I,T,$,V,H,Q,te;if(e<5)for(F=1<<e,m=(1<<F)-1,y=t<<e,w=r<<e,d=0;d<n;++d)$=y>>>5,V=y&31,H=w>>>5,Q=w&31,te=$>=c?0:u[$],te=te>>>V&m,s[H]^=te<<Q,y+=F,w+=F;else for(E=e-5,F=1<<E,d=0;d<n;++d)for(I=t+d<<E,T=r+d<<E,f=0;f<F;++f)s[T+f]^=I+f>=c?0:u[I+f]}function Z2(e,t,n,r){if(e.number===0n)return new Y(r.number>>t.number&(1n<<n.number)-1n);var s=Number(e.number),o=Number(t.number),u=Number(n.number),c=_o(s,r);if(Y.zero.equals(n)||o>=c)return Y.zero;if(o+u>c&&(u=c-Number(t.number)),o===0&&u===c)return r;var d=vu(s,u);return Io(s,o,u,0,d,r),Eu(d)}const Zy=Y.fromInt(4294967295),Yf=Y.fromInt(32);function J2(e,t,n){if(ks(e,Yf))throw new Error("Fail");if(ks(t,Zy))return n;var r=Number(e.number),s=Number(t.number),o=_o(r,n);if(s===0)return Y.zero;if(s>=o)return n;var u=vu(r,s);return Io(r,0,s,0,u,n),Eu(u)}function X2(e,t){return new Y(e.number^t.number)}function Y2(e,t,n){if(ks(e,Yf))throw new Error("Fail");var r=Number(e.number),s=_o(r,t),o=_o(r,n),u=s+o;if(u===0)return Y.zero;{const c=vu(r,u);return Io(r,0,s,0,c,t),Io(r,0,o,s,c,n),Eu(c)}}function Q2(e,t){if(ks(e,Yf))throw new Error("Fail");{let r=Number(e.number),s=0,o=t,u,c,d,f;for(;!Y.zero.equals(o);){if(o instanceof Y)throw new Error("Fail");if(c=o.head,c instanceof Y)throw new Error("Fail");if(c instanceof ze&&(d=c.head,f=c.tail),d instanceof Y&&ks(d,Zy))throw new Error("Fail");if(f instanceof ze)throw new Error("Fail");d instanceof Y&&(s+=Number(d.number)),o instanceof ze&&(o=o.tail)}if(s===0)return Y.zero;var n=vu(r,s);for(o=t,u=0;!Y.zero.equals(o);)o instanceof ze&&(c=o.head),c instanceof ze&&(c.head instanceof Y&&(d=Number(c.head.number)),f=c.tail,Io(r,0,d,u,n,f),u+=d,o instanceof ze&&(o=o.tail));return Eu(n)}}var ft={met:_o,cut:Z2,add:q2,sub:Hy,dec:j2,gth:ks,lth:z2,gte:H2,lte:G2,bex:W2,lsh:K2,rsh:V2,end:J2,mix:X2,cat:Y2,can:Q2,bytesToWords:Gy,wordsToBytes:qy,bytesToAtom:jy,atomToBytes:Wy,atomToWords:Ky,wordsToAtom:Vy};const xr=Jf.dwim;function e3(e){for(var t=Y.zero;;){if(Y.zero.equals(e))return t;if(e instanceof Y)throw new Error("Bail");t=new ze(e.head,t),e=e.tail}}function t3(e,t){for(;;){if(Y.zero.equals(e))return;if(e instanceof Y)throw new Error("Bail");t(e.head),e=e.tail}}var n3={flop:e3,forEach:t3};class Qf{}let r3=class extends Qf{constructor(){super(),this.slots=void 0,this.slots=Array(32)}insert(t,n,r,s){r-=5;const o=s>>>r;return s&=(1<<r)-1,this.slots[o]=this.slots[o]===void 0?new ed(t,n):this.slots[o].insert(t,n,r,s),this}get(t,n,r){n-=5;const s=r>>>n;r&=(1<<n)-1;const o=this.slots[s];return o===void 0?void 0:o.get(t,n,r)}};class i3 extends Qf{constructor(){super(),this.singles=void 0,this.singles=[]}insert(t,n,r,s){const o=this.singles;for(var u=0;u<o.length;++u){const c=o[u];if(c.key.equals(t))return c.val=n,this}return o.push(new ed(t,n)),this}get(t){const n=this.singles;for(var r=0;r<n.length;++r){const s=n[r];if(s.key.equals(t))return s.val}}}class ed extends Qf{constructor(t,n){super(),this.key=void 0,this.val=void 0,this.key=t,this.val=n}insert(t,n,r,s){if(this.key.equals(t))return this.val=n,this;{const o=this.key.mug()&(1<<r)-1,u=r>0?new r3:new i3;return u.insert(this.key,this.val,r,o),u.insert(t,n,r,s),u}}get(t){if(this.key.equals(t))return this.val}}class s3{constructor(){this.slots=void 0,this.slots=Array(64)}insert(t,n){const r=t.mug(),s=r>>>25,o=this.slots;if(o[s]===void 0)o[s]=new ed(t,n);else{var u=r&33554431;o[s]=o[s].insert(t,n,25,u)}}get(t){const n=t.mug(),r=n>>>25,s=this.slots[r];if(s!==void 0){var o=n&33554431;return s.get(t,25,o)}}}function Jy(e){if(e.length===1)return BigInt(e[0]);let t,n=[];for(var r=e.length-1;r>=0;--r)t=e[r]&255,n.push(t.toString(16).padStart(2,"0"));return Zf(n.join(""),16)}function o3(e){return new DataView(new Uint8Array(eu(e).reverse()).buffer)}function ru(e,t){const n=Math.floor(e/8);return t.getUint8(n)>>e%8&1}function a3(e){const t=e.byteLength-1;if(t>2**49)throw new Error("bail: oversized byte buffer");return t*8+e.getUint8(t).toString(2).length}function Xg(e,t,n){if(t===1)return ru(e,n)?1n:0n;const r=e%8;if(r===0)return u3(e,t,n);const s=[];let o=Math.floor(e/8);const u=8-r,c=r,d=255>>8-c;for(;t>=8;){const f=n.getUint8(o),y=(n.getUint8(o+1)&d)<<u,w=f>>c;s.push(y|w),o++,t-=8}if(t>0n){const f=Math.min(t,8-r),m=t-f,y=255>>8-f<<r,w=255>>8-m,E=n.getUint8(o),F=o+1>=n.byteLength?0:n.getUint8(o+1),I=m===0?0:(F&w)<<f,T=(E&y)>>r;s.push(I|T)}return Jy(s)}function u3(e,t,n){if(e%8!==0)throw new Error("non-byte-aligned read "+e);let r=Math.floor(e/8);const s=[];for(;t>=8;)s.push(n.getUint8(r)),r++,t-=8;return t>0n&&s.push(n.getUint8(r)&255>>8-t),Jy(s)}function Yg(e,t,n){var r,s,o,u,c,d,f,m,y,w;for(w=e+n,c=e;ru(c,t)===0;){if(d=c+1,c>w)throw new Error("bail: rubbing past end");c=d}if(e===c)return{head:1,tail:Y.zero};if(r=c-e,s=c+1,c=r-1,c>52)throw new Error("bail: rubbing oversized pointer (>52 bits)");return d=2**c,f=Number(Xg(s,c,t)),o=d+f,u=r+r,d=u+o,f=s+c,m=u+o,y=Xg(f,o,t),{head:m,tail:new Y(y)}}function Qg(e,t,n){return e[t]=n}function c3(e,t){return e[t]}function ff(e,t,n,r){let s,o;if(ru(r,t)===0){const u=1+r,c=Yg(u,t,n);s=c.head+1,o=c.tail,Qg(e,r,o)}else{let u=2+r,c=1+r;if(ru(c,t)===0){const d=ff(e,t,n,u),f=d.head+u,m=ff(e,t,n,f);s=2+(d.head+m.head),o=new ze(d.tail,m.tail),Qg(e,r,o)}else{const d=Yg(u,t,n),f=c3(e,Number(d.tail.number));if(f===void 0)throw new Error("Bail");s=2+d.head,o=f}}return{head:s,tail:o}}function Xy(e){return l3(o3(e.number))}function l3(e){return ff({},e,a3(e),0).tail}function Yy(e){if(Y.zero.equals(e))return xr(1,1);{const t=xr(ft.met(0,e)),n=xr(ft.met(0,t)),r=ft.dec(n),s=ft.add(n,n),o=ft.end(Y.zero,r,t),u=ft.bex(n),c=ft.lsh(Y.zero,r,e),d=ft.mix(o,c),f=ft.add(s,t),m=ft.cat(Y.zero,u,d);return xr(f,m)}}function f3(e,t,n,r,s){var o=xr([2,1],s),u=ft.add(Y.two,r),c=df(e,t,u,o),d=ft.add(u,c.head),f=df(e,n,d,c.tail.head),m=ft.add(c.head,f.head);return xr(ft.add(Y.two,m),f.tail.head,Y.zero)}function d3(e,t){var n=Yy(e),r=ft.lsh(Y.zero,Y.two,n.tail),s=ft.add(Y.two,n.head);return xr(s,[[s,ft.mix(Y.three,r)],t],Y.zero)}function e0(e,t){var n=Yy(e),r=ft.add(Y.one,n.head);return xr(r,[[r,ft.lsh(Y.zero,Y.one,n.tail)],t],Y.zero)}function df(e,t,n,r){const s=e.get(t);return s==null?(e.insert(t,n),t instanceof ze?f3(e,t.head,t.tail,n,r):e0(t,r)):t instanceof Y&&ft.met(0,t)<=ft.met(0,s)?e0(t,r):d3(s,r)}function h3(e){const t=df(new s3,e,Y.zero,Y.zero),n=n3.flop(t.tail.head);return ft.can(Y.zero,n)}var qr=typeof window<"u"&&typeof window.document<"u";typeof process<"u"&&process.versions!=null&&process.versions.node!=null;typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&"userAgent"in navigator&&typeof navigator.userAgent=="string"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom"));typeof Deno<"u"&&typeof Deno.version<"u"&&typeof Deno.version.deno<"u";typeof process<"u"&&process.versions!=null&&process.versions.bun!=null;var p3={exports:{}};(function(e){var t=function(n){var r=1e7,s=7,o=9007199254740992,u=F(o),c="0123456789abcdefghijklmnopqrstuvwxyz",d=typeof BigInt=="function";function f(S,g,h,p){return typeof S>"u"?f[0]:typeof g<"u"?+g==10&&!h?be(S):rn(S,g,h,p):be(S)}function m(S,g){this.value=S,this.sign=g,this.isSmall=!1}m.prototype=Object.create(f.prototype);function y(S){this.value=S,this.sign=S<0,this.isSmall=!0}y.prototype=Object.create(f.prototype);function w(S){this.value=S}w.prototype=Object.create(f.prototype);function E(S){return-o<S&&S<o}function F(S){return S<1e7?[S]:S<1e14?[S%1e7,Math.floor(S/1e7)]:[S%1e7,Math.floor(S/1e7)%1e7,Math.floor(S/1e14)]}function I(S){T(S);var g=S.length;if(g<4&&pn(S,u)<0)switch(g){case 0:return 0;case 1:return S[0];case 2:return S[0]+S[1]*r;default:return S[0]+(S[1]+S[2]*r)*r}return S}function T(S){for(var g=S.length;S[--g]===0;);S.length=g+1}function $(S){for(var g=new Array(S),h=-1;++h<S;)g[h]=0;return g}function V(S){return S>0?Math.floor(S):Math.ceil(S)}function H(S,g){var h=S.length,p=g.length,v=new Array(h),C=0,B=r,R,q;for(q=0;q<p;q++)R=S[q]+g[q]+C,C=R>=B?1:0,v[q]=R-C*B;for(;q<h;)R=S[q]+C,C=R===B?1:0,v[q++]=R-C*B;return C>0&&v.push(C),v}function Q(S,g){return S.length>=g.length?H(S,g):H(g,S)}function te(S,g){var h=S.length,p=new Array(h),v=r,C,B;for(B=0;B<h;B++)C=S[B]-v+g,g=Math.floor(C/v),p[B]=C-g*v,g+=1;for(;g>0;)p[B++]=g%v,g=Math.floor(g/v);return p}m.prototype.add=function(S){var g=be(S);if(this.sign!==g.sign)return this.subtract(g.negate());var h=this.value,p=g.value;return g.isSmall?new m(te(h,Math.abs(p)),this.sign):new m(Q(h,p),this.sign)},m.prototype.plus=m.prototype.add,y.prototype.add=function(S){var g=be(S),h=this.value;if(h<0!==g.sign)return this.subtract(g.negate());var p=g.value;if(g.isSmall){if(E(h+p))return new y(h+p);p=F(Math.abs(p))}return new m(te(p,Math.abs(h)),h<0)},y.prototype.plus=y.prototype.add,w.prototype.add=function(S){return new w(this.value+be(S).value)},w.prototype.plus=w.prototype.add;function ge(S,g){var h=S.length,p=g.length,v=new Array(h),C=0,B=r,R,q;for(R=0;R<p;R++)q=S[R]-C-g[R],q<0?(q+=B,C=1):C=0,v[R]=q;for(R=p;R<h;R++){if(q=S[R]-C,q<0)q+=B;else{v[R++]=q;break}v[R]=q}for(;R<h;R++)v[R]=S[R];return T(v),v}function De(S,g,h){var p;return pn(S,g)>=0?p=ge(S,g):(p=ge(g,S),h=!h),p=I(p),typeof p=="number"?(h&&(p=-p),new y(p)):new m(p,h)}function rt(S,g,h){var p=S.length,v=new Array(p),C=-g,B=r,R,q;for(R=0;R<p;R++)q=S[R]+C,C=Math.floor(q/B),q%=B,v[R]=q<0?q+B:q;return v=I(v),typeof v=="number"?(h&&(v=-v),new y(v)):new m(v,h)}m.prototype.subtract=function(S){var g=be(S);if(this.sign!==g.sign)return this.add(g.negate());var h=this.value,p=g.value;return g.isSmall?rt(h,Math.abs(p),this.sign):De(h,p,this.sign)},m.prototype.minus=m.prototype.subtract,y.prototype.subtract=function(S){var g=be(S),h=this.value;if(h<0!==g.sign)return this.add(g.negate());var p=g.value;return g.isSmall?new y(h-p):rt(p,Math.abs(h),h>=0)},y.prototype.minus=y.prototype.subtract,w.prototype.subtract=function(S){return new w(this.value-be(S).value)},w.prototype.minus=w.prototype.subtract,m.prototype.negate=function(){return new m(this.value,!this.sign)},y.prototype.negate=function(){var S=this.sign,g=new y(-this.value);return g.sign=!S,g},w.prototype.negate=function(){return new w(-this.value)},m.prototype.abs=function(){return new m(this.value,!1)},y.prototype.abs=function(){return new y(Math.abs(this.value))},w.prototype.abs=function(){return new w(this.value>=0?this.value:-this.value)};function Je(S,g){var h=S.length,p=g.length,v=h+p,C=$(v),B=r,R,q,ae,de,ce;for(ae=0;ae<h;++ae){de=S[ae];for(var me=0;me<p;++me)ce=g[me],R=de*ce+C[ae+me],q=Math.floor(R/B),C[ae+me]=R-q*B,C[ae+me+1]+=q}return T(C),C}function fr(S,g){var h=S.length,p=new Array(h),v=r,C=0,B,R;for(R=0;R<h;R++)B=S[R]*g+C,C=Math.floor(B/v),p[R]=B-C*v;for(;C>0;)p[R++]=C%v,C=Math.floor(C/v);return p}function Xi(S,g){for(var h=[];g-- >0;)h.push(0);return h.concat(S)}function ti(S,g){var h=Math.max(S.length,g.length);if(h<=30)return Je(S,g);h=Math.ceil(h/2);var p=S.slice(h),v=S.slice(0,h),C=g.slice(h),B=g.slice(0,h),R=ti(v,B),q=ti(p,C),ae=ti(Q(v,p),Q(B,C)),de=Q(Q(R,Xi(ge(ge(ae,R),q),h)),Xi(q,2*h));return T(de),de}function Hs(S,g){return-.012*S-.012*g+15e-6*S*g>0}m.prototype.multiply=function(S){var g=be(S),h=this.value,p=g.value,v=this.sign!==g.sign,C;if(g.isSmall){if(p===0)return f[0];if(p===1)return this;if(p===-1)return this.negate();if(C=Math.abs(p),C<r)return new m(fr(h,C),v);p=F(C)}return Hs(h.length,p.length)?new m(ti(h,p),v):new m(Je(h,p),v)},m.prototype.times=m.prototype.multiply;function ni(S,g,h){return S<r?new m(fr(g,S),h):new m(Je(g,F(S)),h)}y.prototype._multiplyBySmall=function(S){return E(S.value*this.value)?new y(S.value*this.value):ni(Math.abs(S.value),F(Math.abs(this.value)),this.sign!==S.sign)},m.prototype._multiplyBySmall=function(S){return S.value===0?f[0]:S.value===1?this:S.value===-1?this.negate():ni(Math.abs(S.value),this.value,this.sign!==S.sign)},y.prototype.multiply=function(S){return be(S)._multiplyBySmall(this)},y.prototype.times=y.prototype.multiply,w.prototype.multiply=function(S){return new w(this.value*be(S).value)},w.prototype.times=w.prototype.multiply;function _i(S){var g=S.length,h=$(g+g),p=r,v,C,B,R,q;for(B=0;B<g;B++){R=S[B],C=0-R*R;for(var ae=B;ae<g;ae++)q=S[ae],v=2*(R*q)+h[B+ae]+C,C=Math.floor(v/p),h[B+ae]=v-C*p;h[B+g]=C}return T(h),h}m.prototype.square=function(){return new m(_i(this.value),!1)},y.prototype.square=function(){var S=this.value*this.value;return E(S)?new y(S):new m(_i(F(Math.abs(this.value))),!1)},w.prototype.square=function(S){return new w(this.value*this.value)};function Gs(S,g){var h=S.length,p=g.length,v=r,C=$(g.length),B=g[p-1],R=Math.ceil(v/(2*B)),q=fr(S,R),ae=fr(g,R),de,ce,me,sn,Kt,Yi,Qi;for(q.length<=h&&q.push(0),ae.push(0),B=ae[p-1],ce=h-p;ce>=0;ce--){for(de=v-1,q[ce+p]!==B&&(de=Math.floor((q[ce+p]*v+q[ce+p-1])/B)),me=0,sn=0,Yi=ae.length,Kt=0;Kt<Yi;Kt++)me+=de*ae[Kt],Qi=Math.floor(me/v),sn+=q[ce+Kt]-(me-Qi*v),me=Qi,sn<0?(q[ce+Kt]=sn+v,sn=-1):(q[ce+Kt]=sn,sn=0);for(;sn!==0;){for(de-=1,me=0,Kt=0;Kt<Yi;Kt++)me+=q[ce+Kt]-v+ae[Kt],me<0?(q[ce+Kt]=me+v,me=0):(q[ce+Kt]=me,me=1);sn+=me}C[ce]=de}return q=An(q,R)[0],[I(C),I(q)]}function er(S,g){for(var h=S.length,p=g.length,v=[],C=[],B=r,R,q,ae,de,ce;h;){if(C.unshift(S[--h]),T(C),pn(C,g)<0){v.push(0);continue}q=C.length,ae=C[q-1]*B+C[q-2],de=g[p-1]*B+g[p-2],q>p&&(ae=(ae+1)*B),R=Math.ceil(ae/de);do{if(ce=fr(g,R),pn(ce,C)<=0)break;R--}while(R);v.push(R),C=ge(C,ce)}return v.reverse(),[I(v),I(C)]}function An(S,g){var h=S.length,p=$(h),v=r,C,B,R,q;for(R=0,C=h-1;C>=0;--C)q=R*v+S[C],B=V(q/g),R=q-B*g,p[C]=B|0;return[p,R|0]}function tr(S,g){var h,p=be(g);if(d)return[new w(S.value/p.value),new w(S.value%p.value)];var v=S.value,C=p.value,B;if(C===0)throw new Error("Cannot divide by zero");if(S.isSmall)return p.isSmall?[new y(V(v/C)),new y(v%C)]:[f[0],S];if(p.isSmall){if(C===1)return[S,f[0]];if(C==-1)return[S.negate(),f[0]];var R=Math.abs(C);if(R<r){h=An(v,R),B=I(h[0]);var q=h[1];return S.sign&&(q=-q),typeof B=="number"?(S.sign!==p.sign&&(B=-B),[new y(B),new y(q)]):[new m(B,S.sign!==p.sign),new y(q)]}C=F(R)}var ae=pn(v,C);if(ae===-1)return[f[0],S];if(ae===0)return[f[S.sign===p.sign?1:-1],f[0]];v.length+C.length<=200?h=Gs(v,C):h=er(v,C),B=h[0];var de=S.sign!==p.sign,ce=h[1],me=S.sign;return typeof B=="number"?(de&&(B=-B),B=new y(B)):B=new m(B,de),typeof ce=="number"?(me&&(ce=-ce),ce=new y(ce)):ce=new m(ce,me),[B,ce]}m.prototype.divmod=function(S){var g=tr(this,S);return{quotient:g[0],remainder:g[1]}},w.prototype.divmod=y.prototype.divmod=m.prototype.divmod,m.prototype.divide=function(S){return tr(this,S)[0]},w.prototype.over=w.prototype.divide=function(S){return new w(this.value/be(S).value)},y.prototype.over=y.prototype.divide=m.prototype.over=m.prototype.divide,m.prototype.mod=function(S){return tr(this,S)[1]},w.prototype.mod=w.prototype.remainder=function(S){return new w(this.value%be(S).value)},y.prototype.remainder=y.prototype.mod=m.prototype.remainder=m.prototype.mod,m.prototype.pow=function(S){var g=be(S),h=this.value,p=g.value,v,C,B;if(p===0)return f[1];if(h===0)return f[0];if(h===1)return f[1];if(h===-1)return g.isEven()?f[1]:f[-1];if(g.sign)return f[0];if(!g.isSmall)throw new Error("The exponent "+g.toString()+" is too large.");if(this.isSmall&&E(v=Math.pow(h,p)))return new y(V(v));for(C=this,B=f[1];p&!0&&(B=B.times(C),--p),p!==0;)p/=2,C=C.square();return B},y.prototype.pow=m.prototype.pow,w.prototype.pow=function(S){var g=be(S),h=this.value,p=g.value,v=BigInt(0),C=BigInt(1),B=BigInt(2);if(p===v)return f[1];if(h===v)return f[0];if(h===C)return f[1];if(h===BigInt(-1))return g.isEven()?f[1]:f[-1];if(g.isNegative())return new w(v);for(var R=this,q=f[1];(p&C)===C&&(q=q.times(R),--p),p!==v;)p/=B,R=R.square();return q},m.prototype.modPow=function(S,g){if(S=be(S),g=be(g),g.isZero())throw new Error("Cannot take modPow with modulus 0");var h=f[1],p=this.mod(g);for(S.isNegative()&&(S=S.multiply(f[-1]),p=p.modInv(g));S.isPositive();){if(p.isZero())return f[0];S.isOdd()&&(h=h.multiply(p).mod(g)),S=S.divide(2),p=p.square().mod(g)}return h},w.prototype.modPow=y.prototype.modPow=m.prototype.modPow;function pn(S,g){if(S.length!==g.length)return S.length>g.length?1:-1;for(var h=S.length-1;h>=0;h--)if(S[h]!==g[h])return S[h]>g[h]?1:-1;return 0}m.prototype.compareAbs=function(S){var g=be(S),h=this.value,p=g.value;return g.isSmall?1:pn(h,p)},y.prototype.compareAbs=function(S){var g=be(S),h=Math.abs(this.value),p=g.value;return g.isSmall?(p=Math.abs(p),h===p?0:h>p?1:-1):-1},w.prototype.compareAbs=function(S){var g=this.value,h=be(S).value;return g=g>=0?g:-g,h=h>=0?h:-h,g===h?0:g>h?1:-1},m.prototype.compare=function(S){if(S===1/0)return-1;if(S===-1/0)return 1;var g=be(S),h=this.value,p=g.value;return this.sign!==g.sign?g.sign?1:-1:g.isSmall?this.sign?-1:1:pn(h,p)*(this.sign?-1:1)},m.prototype.compareTo=m.prototype.compare,y.prototype.compare=function(S){if(S===1/0)return-1;if(S===-1/0)return 1;var g=be(S),h=this.value,p=g.value;return g.isSmall?h==p?0:h>p?1:-1:h<0!==g.sign?h<0?-1:1:h<0?1:-1},y.prototype.compareTo=y.prototype.compare,w.prototype.compare=function(S){if(S===1/0)return-1;if(S===-1/0)return 1;var g=this.value,h=be(S).value;return g===h?0:g>h?1:-1},w.prototype.compareTo=w.prototype.compare,m.prototype.equals=function(S){return this.compare(S)===0},w.prototype.eq=w.prototype.equals=y.prototype.eq=y.prototype.equals=m.prototype.eq=m.prototype.equals,m.prototype.notEquals=function(S){return this.compare(S)!==0},w.prototype.neq=w.prototype.notEquals=y.prototype.neq=y.prototype.notEquals=m.prototype.neq=m.prototype.notEquals,m.prototype.greater=function(S){return this.compare(S)>0},w.prototype.gt=w.prototype.greater=y.prototype.gt=y.prototype.greater=m.prototype.gt=m.prototype.greater,m.prototype.lesser=function(S){return this.compare(S)<0},w.prototype.lt=w.prototype.lesser=y.prototype.lt=y.prototype.lesser=m.prototype.lt=m.prototype.lesser,m.prototype.greaterOrEquals=function(S){return this.compare(S)>=0},w.prototype.geq=w.prototype.greaterOrEquals=y.prototype.geq=y.prototype.greaterOrEquals=m.prototype.geq=m.prototype.greaterOrEquals,m.prototype.lesserOrEquals=function(S){return this.compare(S)<=0},w.prototype.leq=w.prototype.lesserOrEquals=y.prototype.leq=y.prototype.lesserOrEquals=m.prototype.leq=m.prototype.lesserOrEquals,m.prototype.isEven=function(){return(this.value[0]&1)===0},y.prototype.isEven=function(){return(this.value&1)===0},w.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},m.prototype.isOdd=function(){return(this.value[0]&1)===1},y.prototype.isOdd=function(){return(this.value&1)===1},w.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},m.prototype.isPositive=function(){return!this.sign},y.prototype.isPositive=function(){return this.value>0},w.prototype.isPositive=y.prototype.isPositive,m.prototype.isNegative=function(){return this.sign},y.prototype.isNegative=function(){return this.value<0},w.prototype.isNegative=y.prototype.isNegative,m.prototype.isUnit=function(){return!1},y.prototype.isUnit=function(){return Math.abs(this.value)===1},w.prototype.isUnit=function(){return this.abs().value===BigInt(1)},m.prototype.isZero=function(){return!1},y.prototype.isZero=function(){return this.value===0},w.prototype.isZero=function(){return this.value===BigInt(0)},m.prototype.isDivisibleBy=function(S){var g=be(S);return g.isZero()?!1:g.isUnit()?!0:g.compareAbs(2)===0?this.isEven():this.mod(g).isZero()},w.prototype.isDivisibleBy=y.prototype.isDivisibleBy=m.prototype.isDivisibleBy;function He(S){var g=S.abs();if(g.isUnit())return!1;if(g.equals(2)||g.equals(3)||g.equals(5))return!0;if(g.isEven()||g.isDivisibleBy(3)||g.isDivisibleBy(5))return!1;if(g.lesser(49))return!0}function St(S,g){for(var h=S.prev(),p=h,v=0,C,B,R;p.isEven();)p=p.divide(2),v++;e:for(B=0;B<g.length;B++)if(!S.lesser(g[B])&&(R=t(g[B]).modPow(p,S),!(R.isUnit()||R.equals(h)))){for(C=v-1;C!=0;C--){if(R=R.square().mod(S),R.isUnit())return!1;if(R.equals(h))continue e}return!1}return!0}m.prototype.isPrime=function(S){var g=He(this);if(g!==n)return g;var h=this.abs(),p=h.bitLength();if(p<=64)return St(h,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var v=Math.log(2)*p.toJSNumber(),C=Math.ceil(S===!0?2*Math.pow(v,2):v),B=[],R=0;R<C;R++)B.push(t(R+2));return St(h,B)},w.prototype.isPrime=y.prototype.isPrime=m.prototype.isPrime,m.prototype.isProbablePrime=function(S,g){var h=He(this);if(h!==n)return h;for(var p=this.abs(),v=S===n?5:S,C=[],B=0;B<v;B++)C.push(t.randBetween(2,p.minus(2),g));return St(p,C)},w.prototype.isProbablePrime=y.prototype.isProbablePrime=m.prototype.isProbablePrime,m.prototype.modInv=function(S){for(var g=t.zero,h=t.one,p=be(S),v=this.abs(),C,B,R;!v.isZero();)C=p.divide(v),B=g,R=p,g=h,p=v,h=B.subtract(C.multiply(h)),v=R.subtract(C.multiply(v));if(!p.isUnit())throw new Error(this.toString()+" and "+S.toString()+" are not co-prime");return g.compare(0)===-1&&(g=g.add(S)),this.isNegative()?g.negate():g},w.prototype.modInv=y.prototype.modInv=m.prototype.modInv,m.prototype.next=function(){var S=this.value;return this.sign?rt(S,1,this.sign):new m(te(S,1),this.sign)},y.prototype.next=function(){var S=this.value;return S+1<o?new y(S+1):new m(u,!1)},w.prototype.next=function(){return new w(this.value+BigInt(1))},m.prototype.prev=function(){var S=this.value;return this.sign?new m(te(S,1),!0):rt(S,1,this.sign)},y.prototype.prev=function(){var S=this.value;return S-1>-o?new y(S-1):new m(u,!0)},w.prototype.prev=function(){return new w(this.value-BigInt(1))};for(var gn=[1];2*gn[gn.length-1]<=r;)gn.push(2*gn[gn.length-1]);var dr=gn.length,zt=gn[dr-1];function hr(S){return Math.abs(S)<=r}m.prototype.shiftLeft=function(S){var g=be(S).toJSNumber();if(!hr(g))throw new Error(String(g)+" is too large for shifting.");if(g<0)return this.shiftRight(-g);var h=this;if(h.isZero())return h;for(;g>=dr;)h=h.multiply(zt),g-=dr-1;return h.multiply(gn[g])},w.prototype.shiftLeft=y.prototype.shiftLeft=m.prototype.shiftLeft,m.prototype.shiftRight=function(S){var g,h=be(S).toJSNumber();if(!hr(h))throw new Error(String(h)+" is too large for shifting.");if(h<0)return this.shiftLeft(-h);for(var p=this;h>=dr;){if(p.isZero()||p.isNegative()&&p.isUnit())return p;g=tr(p,zt),p=g[1].isNegative()?g[0].prev():g[0],h-=dr-1}return g=tr(p,gn[h]),g[1].isNegative()?g[0].prev():g[0]},w.prototype.shiftRight=y.prototype.shiftRight=m.prototype.shiftRight;function ri(S,g,h){g=be(g);for(var p=S.isNegative(),v=g.isNegative(),C=p?S.not():S,B=v?g.not():g,R=0,q=0,ae=null,de=null,ce=[];!C.isZero()||!B.isZero();)ae=tr(C,zt),R=ae[1].toJSNumber(),p&&(R=zt-1-R),de=tr(B,zt),q=de[1].toJSNumber(),v&&(q=zt-1-q),C=ae[0],B=de[0],ce.push(h(R,q));for(var me=h(p?1:0,v?1:0)!==0?t(-1):t(0),sn=ce.length-1;sn>=0;sn-=1)me=me.multiply(zt).add(t(ce[sn]));return me}m.prototype.not=function(){return this.negate().prev()},w.prototype.not=y.prototype.not=m.prototype.not,m.prototype.and=function(S){return ri(this,S,function(g,h){return g&h})},w.prototype.and=y.prototype.and=m.prototype.and,m.prototype.or=function(S){return ri(this,S,function(g,h){return g|h})},w.prototype.or=y.prototype.or=m.prototype.or,m.prototype.xor=function(S){return ri(this,S,function(g,h){return g^h})},w.prototype.xor=y.prototype.xor=m.prototype.xor;var Wt=1<<30,nr=(r&-r)*(r&-r)|Wt;function Rr(S){var g=S.value,h=typeof g=="number"?g|Wt:typeof g=="bigint"?g|BigInt(Wt):g[0]+g[1]*r|nr;return h&-h}function Tr(S,g){if(g.compareTo(S)<=0){var h=Tr(S,g.square(g)),p=h.p,v=h.e,C=p.multiply(g);return C.compareTo(S)<=0?{p:C,e:v*2+1}:{p,e:v*2}}return{p:t(1),e:0}}m.prototype.bitLength=function(){var S=this;return S.compareTo(t(0))<0&&(S=S.negate().subtract(t(1))),S.compareTo(t(0))===0?t(0):t(Tr(S,t(2)).e).add(t(1))},w.prototype.bitLength=y.prototype.bitLength=m.prototype.bitLength;function pr(S,g){return S=be(S),g=be(g),S.greater(g)?S:g}function Fn(S,g){return S=be(S),g=be(g),S.lesser(g)?S:g}function Ct(S,g){if(S=be(S).abs(),g=be(g).abs(),S.equals(g))return S;if(S.isZero())return g;if(g.isZero())return S;for(var h=f[1],p,v;S.isEven()&&g.isEven();)p=Fn(Rr(S),Rr(g)),S=S.divide(p),g=g.divide(p),h=h.multiply(p);for(;S.isEven();)S=S.divide(Rr(S));do{for(;g.isEven();)g=g.divide(Rr(g));S.greater(g)&&(v=g,g=S,S=v),g=g.subtract(S)}while(!g.isZero());return h.isUnit()?S:S.multiply(h)}function Pr(S,g){return S=be(S).abs(),g=be(g).abs(),S.divide(Ct(S,g)).multiply(g)}function qs(S,g,h){S=be(S),g=be(g);var p=h||Math.random,v=Fn(S,g),C=pr(S,g),B=C.subtract(v).add(1);if(B.isSmall)return v.add(Math.floor(p()*B));for(var R=mn(B,r).value,q=[],ae=!0,de=0;de<R.length;de++){var ce=ae?R[de]+(de+1<R.length?R[de+1]/r:0):r,me=V(p()*ce);q.push(me),me<R[de]&&(ae=!1)}return v.add(f.fromArray(q,r,!1))}var rn=function(S,g,h,p){h=h||c,S=String(S),p||(S=S.toLowerCase(),h=h.toLowerCase());var v=S.length,C,B=Math.abs(g),R={};for(C=0;C<h.length;C++)R[h[C]]=C;for(C=0;C<v;C++){var q=S[C];if(q!=="-"&&q in R&&R[q]>=B){if(q==="1"&&B===1)continue;throw new Error(q+" is not a valid digit in base "+g+".")}}g=be(g);var ae=[],de=S[0]==="-";for(C=de?1:0;C<S.length;C++){var q=S[C];if(q in R)ae.push(be(R[q]));else if(q==="<"){var ce=C;do C++;while(S[C]!==">"&&C<S.length);ae.push(be(S.slice(ce+1,C)))}else throw new Error(q+" is not a valid character")}return Ii(ae,g,de)};function Ii(S,g,h){var p=f[0],v=f[1],C;for(C=S.length-1;C>=0;C--)p=p.add(S[C].times(v)),v=v.times(g);return h?p.negate():p}function js(S,g){return g=g||c,S<g.length?g[S]:"<"+S+">"}function mn(S,g){if(g=t(g),g.isZero()){if(S.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(g.equals(-1)){if(S.isZero())return{value:[0],isNegative:!1};if(S.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-S.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var h=Array.apply(null,Array(S.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return h.unshift([1]),{value:[].concat.apply([],h),isNegative:!1}}var p=!1;if(S.isNegative()&&g.isPositive()&&(p=!0,S=S.abs()),g.isUnit())return S.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(S.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:p};for(var v=[],C=S,B;C.isNegative()||C.compareAbs(g)>=0;){B=C.divmod(g),C=B.quotient;var R=B.remainder;R.isNegative()&&(R=g.minus(R).abs(),C=C.next()),v.push(R.toJSNumber())}return v.push(C.toJSNumber()),{value:v.reverse(),isNegative:p}}function Bt(S,g,h){var p=mn(S,g);return(p.isNegative?"-":"")+p.value.map(function(v){return js(v,h)}).join("")}m.prototype.toArray=function(S){return mn(this,S)},y.prototype.toArray=function(S){return mn(this,S)},w.prototype.toArray=function(S){return mn(this,S)},m.prototype.toString=function(S,g){if(S===n&&(S=10),S!==10||g)return Bt(this,S,g);for(var h=this.value,p=h.length,v=String(h[--p]),C="0000000",B;--p>=0;)B=String(h[p]),v+=C.slice(B.length)+B;var R=this.sign?"-":"";return R+v},y.prototype.toString=function(S,g){return S===n&&(S=10),S!=10||g?Bt(this,S,g):String(this.value)},w.prototype.toString=y.prototype.toString,w.prototype.toJSON=m.prototype.toJSON=y.prototype.toJSON=function(){return this.toString()},m.prototype.valueOf=function(){return parseInt(this.toString(),10)},m.prototype.toJSNumber=m.prototype.valueOf,y.prototype.valueOf=function(){return this.value},y.prototype.toJSNumber=y.prototype.valueOf,w.prototype.valueOf=w.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function kt(S){if(E(+S)){var g=+S;if(g===V(g))return d?new w(BigInt(g)):new y(g);throw new Error("Invalid integer: "+S)}var h=S[0]==="-";h&&(S=S.slice(1));var p=S.split(/e/i);if(p.length>2)throw new Error("Invalid integer: "+p.join("e"));if(p.length===2){var v=p[1];if(v[0]==="+"&&(v=v.slice(1)),v=+v,v!==V(v)||!E(v))throw new Error("Invalid integer: "+v+" is not a valid exponent.");var C=p[0],B=C.indexOf(".");if(B>=0&&(v-=C.length-B-1,C=C.slice(0,B)+C.slice(B+1)),v<0)throw new Error("Cannot include negative exponent part for integers");C+=new Array(v+1).join("0"),S=C}var R=/^([0-9][0-9]*)$/.test(S);if(!R)throw new Error("Invalid integer: "+S);if(d)return new w(BigInt(h?"-"+S:S));for(var q=[],ae=S.length,de=s,ce=ae-de;ae>0;)q.push(+S.slice(ce,ae)),ce-=de,ce<0&&(ce=0),ae-=de;return T(q),new m(q,h)}function gr(S){if(d)return new w(BigInt(S));if(E(S)){if(S!==V(S))throw new Error(S+" is not an integer.");return new y(S)}return kt(S.toString())}function be(S){return typeof S=="number"?gr(S):typeof S=="string"?kt(S):typeof S=="bigint"?new w(S):S}for(var ut=0;ut<1e3;ut++)f[ut]=be(ut),ut>0&&(f[-ut]=be(-ut));return f.one=f[1],f.zero=f[0],f.minusOne=f[-1],f.max=pr,f.min=Fn,f.gcd=Ct,f.lcm=Pr,f.isInstance=function(S){return S instanceof m||S instanceof y||S instanceof w},f.randBetween=qs,f.fromArray=function(S,g,h){return Ii(S.map(be),be(g||10),h)},f}();e.hasOwnProperty("exports")&&(e.exports=t)})(p3);var Ar={},g3=yt&&yt.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(r[o]=s[o])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(Ar,"__esModule",{value:!0});Ar.EmptyBTree=Ar.asSet=Ar.simpleComparator=Ar.defaultComparator=void 0;function Qy(e,t){if(Number.isFinite(e)&&Number.isFinite(t))return e-t;var n=typeof e,r=typeof t;if(n!==r)return n<r?-1:1;if(n==="object"){if(e===null)return t===null?0:-1;if(t===null)return 1;if(e=e.valueOf(),t=t.valueOf(),n=typeof e,r=typeof t,n!==r)return n<r?-1:1}return e<t?-1:e>t?1:e===t?0:Number.isNaN(e)?Number.isNaN(t)?0:-1:Number.isNaN(t)?1:Array.isArray(e)?0:Number.NaN}Ar.defaultComparator=Qy;function m3(e,t){return e>t?1:e<t?-1:0}Ar.simpleComparator=m3;var Ir=function(){function e(t,n,r){this._root=sl,this._size=0,this._maxNodeSize=r>=4?Math.min(r,256):32,this._compare=n||Qy,t&&this.setPairs(t)}return Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return this._size===0},enumerable:!1,configurable:!0}),e.prototype.clear=function(){this._root=sl,this._size=0},e.prototype.forEach=function(t,n){var r=this;return n!==void 0&&(t=t.bind(n)),this.forEachPair(function(s,o){return t(o,s,r)})},e.prototype.forEachPair=function(t,n){var r=this.minKey(),s=this.maxKey();return this.forRange(r,s,!0,t,n)},e.prototype.get=function(t,n){return this._root.get(t,n,this)},e.prototype.set=function(t,n,r){this._root.isShared&&(this._root=this._root.clone());var s=this._root.set(t,n,r,this);return s===!0||s===!1?s:(this._root=new D3([this._root,s]),!0)},e.prototype.has=function(t){return this.forRange(t,t,!0,void 0)!==0},e.prototype.delete=function(t){return this.editRange(t,t,!0,t0)!==0},e.prototype.with=function(t,n,r){var s=this.clone();return s.set(t,n,r)||r?s:this},e.prototype.withPairs=function(t,n){var r=this.clone();return r.setPairs(t,n)!==0||n?r:this},e.prototype.withKeys=function(t,n){for(var r=this.clone(),s=!1,o=0;o<t.length;o++)s=r.set(t[o],void 0,!1)||s;return n&&!s?this:r},e.prototype.without=function(t,n){return this.withoutRange(t,t,!0,n)},e.prototype.withoutKeys=function(t,n){var r=this.clone();return r.deleteKeys(t)||!n?r:this},e.prototype.withoutRange=function(t,n,r,s){var o=this.clone();return o.deleteRange(t,n,r)===0&&s?this:o},e.prototype.filter=function(t,n){var r=this.greedyClone(),s;return r.editAll(function(o,u,c){if(!t(o,u,c))return s=tD}),!s&&n?this:r},e.prototype.mapValues=function(t){var n={},r=this.greedyClone();return r.editAll(function(s,o,u){return n.value=t(o,s,u),n}),r},e.prototype.reduce=function(t,n){for(var r=0,s=n,o=this.entries(this.minKey(),lo),u;!(u=o.next()).done;)s=t(s,u.value,r++,this);return s},e.prototype.entries=function(t,n){var r=this.findPath(t);if(r===void 0)return ps();var s=r.nodequeue,o=r.nodeindex,u=r.leaf,c=n!==void 0?1:0,d=t===void 0?-1:u.indexOf(t,0,this._compare)-1;return ps(function(){e:for(;;)switch(c){case 0:if(++d<u.keys.length)return{done:!1,value:[u.keys[d],u.values[d]]};c=2;continue;case 1:if(++d<u.keys.length)return n[0]=u.keys[d],n[1]=u.values[d],{done:!1,value:n};c=2;case 2:for(var f=-1;;){if(++f>=s.length){c=3;continue e}if(++o[f]<s[f].length)break}for(;f>0;f--)s[f-1]=s[f][o[f]].children,o[f-1]=0;u=s[0][o[0]],d=-1,c=n!==void 0?1:0;continue;case 3:return{done:!0,value:void 0}}})},e.prototype.entriesReversed=function(t,n,r){if(t===void 0&&(t=this.maxKey(),r=void 0,t===void 0))return ps();var s=this.findPath(t)||this.findPath(this.maxKey()),o=s.nodequeue,u=s.nodeindex,c=s.leaf;On(!o[0]||c===o[0][u[0]],"wat!");var d=c.indexOf(t,0,this._compare);!r&&d<c.keys.length&&this._compare(c.keys[d],t)<=0&&d++;var f=n!==void 0?1:0;return ps(function(){e:for(;;)switch(f){case 0:if(--d>=0)return{done:!1,value:[c.keys[d],c.values[d]]};f=2;continue;case 1:if(--d>=0)return n[0]=c.keys[d],n[1]=c.values[d],{done:!1,value:n};f=2;case 2:for(var m=-1;;){if(++m>=o.length){f=3;continue e}if(--u[m]>=0)break}for(;m>0;m--)o[m-1]=o[m][u[m]].children,u[m-1]=o[m-1].length-1;c=o[0][u[0]],d=c.keys.length,f=n!==void 0?1:0;continue;case 3:return{done:!0,value:void 0}}})},e.prototype.findPath=function(t){var n=this._root,r,s;if(n.isLeaf)r=n0,s=n0;else{r=[],s=[];for(var o=0;!n.isLeaf;o++){if(r[o]=n.children,s[o]=t===void 0?0:n.indexOf(t,0,this._compare),s[o]>=r[o].length)return;n=r[o][s[o]]}r.reverse(),s.reverse()}return{nodequeue:r,nodeindex:s,leaf:n}},e.prototype.diffAgainst=function(t,n,r,s){if(t._compare!==this._compare)throw new Error("Tree comparators are not the same.");if(this.isEmpty||t.isEmpty)return this.isEmpty&&t.isEmpty?void 0:this.isEmpty?r===void 0?void 0:e.stepToEnd(e.makeDiffCursor(t),r):n===void 0?void 0:e.stepToEnd(e.makeDiffCursor(this),n);for(var o=this._compare,u=e.makeDiffCursor(this),c=e.makeDiffCursor(t),d=!0,f=!0,m=e.compare(u,c,o);d&&f;){var y=e.compare(u,c,o),w=u.leaf,E=u.internalSpine,F=u.levelIndices,I=c.leaf,T=c.internalSpine,$=c.levelIndices;if(w||I){if(m!==0){if(y===0){if(w&&I&&s){var V=w.values[F[F.length-1]],H=I.values[$[$.length-1]];if(!Object.is(V,H)){var Q=s(u.currentKey,V,H);if(Q&&Q.break)return Q.break}}}else if(y>0){if(I&&r){var te=I.values[$[$.length-1]],Q=r(c.currentKey,te);if(Q&&Q.break)return Q.break}}else if(n&&w&&m!==0){var V=w.values[F[F.length-1]],Q=n(u.currentKey,V);if(Q&&Q.break)return Q.break}}}else if(!w&&!I&&y===0){var ge=E.length-1,De=T.length-1,rt=E[ge][F[ge]],Je=T[De][$[De]];if(Je===rt){m=0,d=e.step(u,!0),f=e.step(c,!0);continue}}m=y,y<0?d=e.step(u):f=e.step(c)}if(d&&n)return e.finishCursorWalk(u,c,o,n);if(f&&r)return e.finishCursorWalk(c,u,o,r)},e.finishCursorWalk=function(t,n,r,s){var o=e.compare(t,n,r);if(o===0){if(!e.step(t))return}else o<0&&On(!1,"cursor walk terminated early");return e.stepToEnd(t,s)},e.stepToEnd=function(t,n){for(var r=!0;r;){var s=t.leaf,o=t.levelIndices,u=t.currentKey;if(s){var c=s.values[o[o.length-1]],d=n(u,c);if(d&&d.break)return d.break}r=e.step(t)}},e.makeDiffCursor=function(t){var n=t._root,r=t.height;return{height:r,internalSpine:[[n]],levelIndices:[0],leaf:void 0,currentKey:n.maxKey()}},e.step=function(t,n){var r=t.internalSpine,s=t.levelIndices,o=t.leaf;if(n===!0||o){var u=s.length;if(n===!0||s[u-1]===0){var c=r.length;if(c===0)return!1;for(var d=c-1,f=d;f>=0;){if(s[f]>0)return f<u-1&&(t.leaf=void 0,s.pop()),f<d&&(t.internalSpine=r.slice(0,f+1)),t.currentKey=r[f][--s[f]].maxKey(),!0;f--}return!1}else{var m=--s[u-1];return t.currentKey=o.keys[m],!0}}else{var y=r.length,w=y-1,E=r[w][s[w]];if(E.isLeaf){t.leaf=E;var m=s[y]=E.values.length-1;t.currentKey=E.keys[m]}else{var F=E.children;r[y]=F;var I=F.length-1;s[y]=I,t.currentKey=F[I].maxKey()}return!0}},e.compare=function(t,n,r){var s=t.height,o=t.currentKey,u=t.levelIndices,c=n.height,d=n.currentKey,f=n.levelIndices,m=r(d,o);if(m!==0)return m;var y=s<c?s:c,w=u.length-(s-y),E=f.length-(c-y);return w-E},e.prototype.keys=function(t){var n=this.entries(t,lo);return ps(function(){var r=n.next();return r.value&&(r.value=r.value[0]),r})},e.prototype.values=function(t){var n=this.entries(t,lo);return ps(function(){var r=n.next();return r.value&&(r.value=r.value[1]),r})},Object.defineProperty(e.prototype,"maxNodeSize",{get:function(){return this._maxNodeSize},enumerable:!1,configurable:!0}),e.prototype.minKey=function(){return this._root.minKey()},e.prototype.maxKey=function(){return this._root.maxKey()},e.prototype.clone=function(){this._root.isShared=!0;var t=new e(void 0,this._compare,this._maxNodeSize);return t._root=this._root,t._size=this._size,t},e.prototype.greedyClone=function(t){var n=new e(void 0,this._compare,this._maxNodeSize);return n._root=this._root.greedyClone(t),n._size=this._size,n},e.prototype.toArray=function(t){t===void 0&&(t=2147483647);var n=this.minKey(),r=this.maxKey();return n!==void 0?this.getRange(n,r,!0,t):[]},e.prototype.keysArray=function(){var t=[];return this._root.forRange(this.minKey(),this.maxKey(),!0,!1,this,0,function(n,r){t.push(n)}),t},e.prototype.valuesArray=function(){var t=[];return this._root.forRange(this.minKey(),this.maxKey(),!0,!1,this,0,function(n,r){t.push(r)}),t},e.prototype.toString=function(){return this.toArray().toString()},e.prototype.setIfNotPresent=function(t,n){return this.set(t,n,!1)},e.prototype.nextHigherPair=function(t,n){return n=n||[],t===void 0?this._root.minPair(n):this._root.getPairOrNextHigher(t,this._compare,!1,n)},e.prototype.nextHigherKey=function(t){var n=this.nextHigherPair(t,lo);return n&&n[0]},e.prototype.nextLowerPair=function(t,n){return n=n||[],t===void 0?this._root.maxPair(n):this._root.getPairOrNextLower(t,this._compare,!1,n)},e.prototype.nextLowerKey=function(t){var n=this.nextLowerPair(t,lo);return n&&n[0]},e.prototype.getPairOrNextLower=function(t,n){return this._root.getPairOrNextLower(t,this._compare,!0,n||[])},e.prototype.getPairOrNextHigher=function(t,n){return this._root.getPairOrNextHigher(t,this._compare,!0,n||[])},e.prototype.changeIfPresent=function(t,n){return this.editRange(t,t,!0,function(r,s){return{value:n}})!==0},e.prototype.getRange=function(t,n,r,s){s===void 0&&(s=67108863);var o=[];return this._root.forRange(t,n,r,!1,this,0,function(u,c){return o.push([u,c]),o.length>s?w3:void 0}),o},e.prototype.setPairs=function(t,n){for(var r=0,s=0;s<t.length;s++)this.set(t[s][0],t[s][1],n)&&r++;return r},e.prototype.forRange=function(t,n,r,s,o){var u=this._root.forRange(t,n,r,!1,this,o||0,s);return typeof u=="number"?u:u.break},e.prototype.editRange=function(t,n,r,s,o){var u=this._root;u.isShared&&(this._root=u=u.clone());try{var c=u.forRange(t,n,r,!0,this,o||0,s);return typeof c=="number"?c:c.break}finally{for(var d=void 0;u.keys.length<=1&&!u.isLeaf;)d||(d=u.isShared),this._root=u=u.keys.length===0?sl:u.children[0];d&&(u.isShared=!0)}},e.prototype.editAll=function(t,n){return this.editRange(this.minKey(),this.maxKey(),!0,t,n)},e.prototype.deleteRange=function(t,n,r){return this.editRange(t,n,r,t0)},e.prototype.deleteKeys=function(t){for(var n=0,r=0;n<t.length;n++)this.delete(t[n])&&r++;return r},Object.defineProperty(e.prototype,"height",{get:function(){for(var t=this._root,n=-1;t;)n++,t=t.isLeaf?void 0:t.children[0];return n},enumerable:!1,configurable:!0}),e.prototype.freeze=function(){var t=this;t.clear=t.set=t.editRange=function(){throw new Error("Attempted to modify a frozen BTree")}},e.prototype.unfreeze=function(){delete this.clear,delete this.set,delete this.editRange},Object.defineProperty(e.prototype,"isFrozen",{get:function(){return this.hasOwnProperty("editRange")},enumerable:!1,configurable:!0}),e.prototype.checkValid=function(){var t=this._root.checkValid(0,this,0);On(t===this.size,"size mismatch: counted ",t,"but stored",this.size)},e}();Ar.default=Ir;function y3(e){return e}Ar.asSet=y3;Symbol&&Symbol.iterator&&(Ir.prototype[Symbol.iterator]=Ir.prototype.entries);Ir.prototype.where=Ir.prototype.filter;Ir.prototype.setRange=Ir.prototype.setPairs;Ir.prototype.add=Ir.prototype.set;function ps(e){e===void 0&&(e=function(){return{done:!0,value:void 0}});var t={next:e};return Symbol&&Symbol.iterator&&(t[Symbol.iterator]=function(){return this}),t}var eD=function(){function e(t,n){t===void 0&&(t=[]),this.keys=t,this.values=n||qt,this.isShared=void 0}return Object.defineProperty(e.prototype,"isLeaf",{get:function(){return this.children===void 0},enumerable:!1,configurable:!0}),e.prototype.maxKey=function(){return this.keys[this.keys.length-1]},e.prototype.indexOf=function(t,n,r){for(var s=this.keys,o=0,u=s.length,c=u>>1;o<u;){var d=r(s[c],t);if(d<0)o=c+1;else if(d>0)u=c;else{if(d===0)return c;if(t===t)return s.length;throw new Error("BTree: NaN was used as a key")}c=o+u>>1}return c^n},e.prototype.minKey=function(){return this.keys[0]},e.prototype.minPair=function(t){if(this.keys.length!==0)return t[0]=this.keys[0],t[1]=this.values[0],t},e.prototype.maxPair=function(t){if(this.keys.length!==0){var n=this.keys.length-1;return t[0]=this.keys[n],t[1]=this.values[n],t}},e.prototype.clone=function(){var t=this.values;return new e(this.keys.slice(0),t===qt?t:t.slice(0))},e.prototype.greedyClone=function(t){return this.isShared&&!t?this:this.clone()},e.prototype.get=function(t,n,r){var s=this.indexOf(t,-1,r._compare);return s<0?n:this.values[s]},e.prototype.getPairOrNextLower=function(t,n,r,s){var o=this.indexOf(t,-1,n),u=o<0?~o-1:r?o:o-1;if(u>=0)return s[0]=this.keys[u],s[1]=this.values[u],s},e.prototype.getPairOrNextHigher=function(t,n,r,s){var o=this.indexOf(t,-1,n),u=o<0?~o:r?o:o+1,c=this.keys;if(u<c.length)return s[0]=c[u],s[1]=this.values[u],s},e.prototype.checkValid=function(t,n,r){var s=this.keys.length,o=this.values.length;return On(this.values===qt?s<=o:s===o,"keys/values length mismatch: depth",t,"with lengths",s,o,"and baseIndex",r),On(t==0||s>0,"empty leaf at depth",t,"and baseIndex",r),s},e.prototype.set=function(t,n,r,s){var o=this.indexOf(t,-1,s._compare);if(o<0){if(o=~o,s._size++,this.keys.length<s._maxNodeSize)return this.insertInLeaf(o,t,n,s);var u=this.splitOffRightSide(),c=this;return o>this.keys.length&&(o-=this.keys.length,c=u),c.insertInLeaf(o,t,n,s),u}else return r!==!1&&(n!==void 0&&this.reifyValues(),this.keys[o]=t,this.values[o]=n),!1},e.prototype.reifyValues=function(){return this.values===qt?this.values=this.values.slice(0,this.keys.length):this.values},e.prototype.insertInLeaf=function(t,n,r,s){if(this.keys.splice(t,0,n),this.values===qt){for(;qt.length<s._maxNodeSize;)qt.push(void 0);if(r===void 0)return!0;this.values=qt.slice(0,this.keys.length-1)}return this.values.splice(t,0,r),!0},e.prototype.takeFromRight=function(t){var n=this.values;t.values===qt?n!==qt&&n.push(void 0):(n=this.reifyValues(),n.push(t.values.shift())),this.keys.push(t.keys.shift())},e.prototype.takeFromLeft=function(t){var n=this.values;t.values===qt?n!==qt&&n.unshift(void 0):(n=this.reifyValues(),n.unshift(t.values.pop())),this.keys.unshift(t.keys.pop())},e.prototype.splitOffRightSide=function(){var t=this.keys.length>>1,n=this.keys.splice(t),r=this.values===qt?qt:this.values.splice(t);return new e(n,r)},e.prototype.forRange=function(t,n,r,s,o,u,c){var d=o._compare,f,m;if(n===t){if(!r||(m=(f=this.indexOf(t,-1,d))+1,f<0))return u}else f=this.indexOf(t,0,d),m=this.indexOf(n,-1,d),m<0?m=~m:r===!0&&m++;var y=this.keys,w=this.values;if(c!==void 0)for(var E=f;E<m;E++){var F=y[E],I=c(F,w[E],u++);if(I!==void 0){if(s===!0){if(F!==y[E]||this.isShared===!0)throw new Error("BTree illegally changed or cloned in editRange");I.delete?(this.keys.splice(E,1),this.values!==qt&&this.values.splice(E,1),o._size--,E--,m--):I.hasOwnProperty("value")&&(w[E]=I.value)}if(I.break!==void 0)return I}}else u+=m-f;return u},e.prototype.mergeSibling=function(t,n){if(this.keys.push.apply(this.keys,t.keys),this.values===qt){if(t.values===qt)return;this.values=this.values.slice(0,this.keys.length)}this.values.push.apply(this.values,t.reifyValues())},e}(),D3=function(e){g3(t,e);function t(n,r){var s=this;if(!r){r=[];for(var o=0;o<n.length;o++)r[o]=n[o].maxKey()}return s=e.call(this,r)||this,s.children=n,s}return t.prototype.clone=function(){for(var n=this.children.slice(0),r=0;r<n.length;r++)n[r].isShared=!0;return new t(n,this.keys.slice(0))},t.prototype.greedyClone=function(n){if(this.isShared&&!n)return this;for(var r=new t(this.children.slice(0),this.keys.slice(0)),s=0;s<r.children.length;s++)r.children[s]=r.children[s].greedyClone(n);return r},t.prototype.minKey=function(){return this.children[0].minKey()},t.prototype.minPair=function(n){return this.children[0].minPair(n)},t.prototype.maxPair=function(n){return this.children[this.children.length-1].maxPair(n)},t.prototype.get=function(n,r,s){var o=this.indexOf(n,0,s._compare),u=this.children;return o<u.length?u[o].get(n,r,s):void 0},t.prototype.getPairOrNextLower=function(n,r,s,o){var u=this.indexOf(n,0,r),c=this.children;if(u>=c.length)return this.maxPair(o);var d=c[u].getPairOrNextLower(n,r,s,o);return d===void 0&&u>0?c[u-1].maxPair(o):d},t.prototype.getPairOrNextHigher=function(n,r,s,o){var u=this.indexOf(n,0,r),c=this.children,d=c.length;if(!(u>=d)){var f=c[u].getPairOrNextHigher(n,r,s,o);return f===void 0&&u<d-1?c[u+1].minPair(o):f}},t.prototype.checkValid=function(n,r,s){var o=this.keys.length,u=this.children.length;On(o===u,"keys/children length mismatch: depth",n,"lengths",o,u,"baseIndex",s),On(o>1||n>0,"internal node has length",o,"at depth",n,"baseIndex",s);for(var c=0,d=this.children,f=this.keys,m=0,y=0;y<u;y++)c+=d[y].checkValid(n+1,r,s+c),m+=d[y].keys.length,On(c>=m,"wtf",s),On(y===0||d[y-1].constructor===d[y].constructor,"type mismatch, baseIndex:",s),d[y].maxKey()!=f[y]&&On(!1,"keys[",y,"] =",f[y],"is wrong, should be ",d[y].maxKey(),"at depth",n,"baseIndex",s),y===0||r._compare(f[y-1],f[y])<0||On(!1,"sort violation at depth",n,"index",y,"keys",f[y-1],f[y]);var w=m===0;return(w||m>r.maxNodeSize*u)&&On(!1,w?"too few":"too many","children (",m,c,") at depth",n,"maxNodeSize:",r.maxNodeSize,"children.length:",u,"baseIndex:",s),c},t.prototype.set=function(n,r,s,o){var u=this.children,c=o._maxNodeSize,d=o._compare,f=Math.min(this.indexOf(n,0,d),u.length-1),m=u[f];if(m.isShared&&(u[f]=m=m.clone()),m.keys.length>=c){var y;f>0&&(y=u[f-1]).keys.length<c&&d(m.keys[0],n)<0?(y.isShared&&(u[f-1]=y=y.clone()),y.takeFromRight(m),this.keys[f-1]=y.maxKey()):(y=u[f+1])!==void 0&&y.keys.length<c&&d(m.maxKey(),n)<0&&(y.isShared&&(u[f+1]=y=y.clone()),y.takeFromLeft(m),this.keys[f]=u[f].maxKey())}var w=m.set(n,r,s,o);if(w===!1)return!1;if(this.keys[f]=m.maxKey(),w===!0)return!0;if(this.keys.length<c)return this.insert(f+1,w),!0;var E=this.splitOffRightSide(),F=this;return d(w.maxKey(),this.maxKey())>0&&(F=E,f-=this.keys.length),F.insert(f+1,w),E},t.prototype.insert=function(n,r){this.children.splice(n,0,r),this.keys.splice(n,0,r.maxKey())},t.prototype.splitOffRightSide=function(){var n=this.children.length>>1;return new t(this.children.splice(n),this.keys.splice(n))},t.prototype.takeFromRight=function(n){this.keys.push(n.keys.shift()),this.children.push(n.children.shift())},t.prototype.takeFromLeft=function(n){this.keys.unshift(n.keys.pop()),this.children.unshift(n.children.pop())},t.prototype.forRange=function(n,r,s,o,u,c,d){var f=u._compare,m=this.keys,y=this.children,w=this.indexOf(n,0,f),E=w,F=Math.min(r===n?w:this.indexOf(r,0,f),m.length-1);if(o){if(E<=F)try{for(;E<=F;E++){y[E].isShared&&(y[E]=y[E].clone());var I=y[E].forRange(n,r,s,o,u,c,d);if(m[E]=y[E].maxKey(),typeof I!="number")return I;c=I}}finally{var T=u._maxNodeSize>>1;for(w>0&&w--,E=F;E>=w;E--)y[E].keys.length<=T&&(y[E].keys.length!==0?this.tryMerge(E,u._maxNodeSize):(m.splice(E,1),y.splice(E,1)));y.length!==0&&y[0].keys.length===0&&On(!1,"emptiness bug")}}else for(;E<=F;E++){var I=y[E].forRange(n,r,s,o,u,c,d);if(typeof I!="number")return I;c=I}return c},t.prototype.tryMerge=function(n,r){var s=this.children;return n>=0&&n+1<s.length&&s[n].keys.length+s[n+1].keys.length<=r?(s[n].isShared&&(s[n]=s[n].clone()),s[n].mergeSibling(s[n+1],r),s.splice(n+1,1),this.keys.splice(n+1,1),this.keys[n]=s[n].maxKey(),!0):!1},t.prototype.mergeSibling=function(n,r){var s=this.keys.length;this.keys.push.apply(this.keys,n.keys);var o=n.children;if(this.children.push.apply(this.children,o),n.isShared&&!this.isShared)for(var u=0;u<o.length;u++)o[u].isShared=!0;this.tryMerge(s-1,r)},t}(eD),qt=[],tD={delete:!0},t0=function(){return tD},w3={break:!0},sl=function(){var e=new eD;return e.isShared=!0,e}(),n0=[],lo=[];function On(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!e)throw t.unshift("B+ tree"),new Error(t.join(" "))}Ar.EmptyBTree=function(){var e=new Ir;return e.freeze(),e}();function td(...e){return"/"+e.filter(t=>!!t).join("/")}function r0(e){return e[0]==="#"}const i0=2048;function Bo(e){const t=e.image.length>i0?"":e.image,n=t?r0(t)?{iconImageColor:t}:{iconImage:t}:{},r=e.cover.length>i0?"":e.cover,s=r?r0(r)?{coverImageColor:r}:{coverImage:r}:{};return{title:e.title,iconImage:n.iconImage??null,iconImageColor:n.iconImageColor??null,coverImage:s.coverImage??null,coverImageColor:s.coverImageColor??null,description:e.description}}function b3(e){return{title:e.title??"",image:e.iconImage??e.iconImageColor??"",cover:e.coverImage??e.coverImageColor??"",description:e.description??""}}function qi(e){return nn("ud",BigInt(e))}function $s(e){return ur.toUnix(E3(e))}function E3(e){return f2("ud",e)||BigInt(e)}function v3(e){return nn("ud",ur.fromUnix(e.getTime()))}function Qn(e){return e.startsWith("~")}function Br(e){return e.startsWith("0v")}function Ai(e){return e.startsWith("chat")||e.startsWith("diary")||e.startsWith("heap")}function nD(e){const t=e.split("/");return{kind:t[0],host:t[1],name:t[2]}}function Su(e){const t=e.split("/");return{host:t[0],name:t[1]}}function Cu(e){if(Qn(e))return"dm";if(Br(e))return"club";if(Ai(e))return"channel";throw new Error("invalid channel id")}function S3(e){return e.split("/").length===1?!0:Ai(e)}async function C3(e,t){try{return await e}catch(n){if(n instanceof Ls&&n.status===404)return t;throw n}}function Ge(e){let t=e;return t[0]==="~"&&(t=t.split("/").pop()),t[3]!=="."&&(t=nn("ud",BigInt(t))),t}function rD({content:e,authorId:t,sentAt:n,channelType:r,blob:s,metadata:o}){return{content:e,sent:n,kind:r==="notebook"?"/diary":r==="gallery"?"/heap":"/chat",author:t,blob:s||null,meta:o||null}}var hf;(e=>{function t(n,r){return r==="link"?R3(n):r in n}e.is=t})(hf||(hf={}));function iD(e){return typeof e=="object"&&e!==null&&"bold"in e}function sD(e){return typeof e=="object"&&e!==null&&"italics"in e}function oD(e){return typeof e=="object"&&e!==null&&"link"in e&&"href"in e.link}function aD(e){return typeof e=="object"&&e!==null&&"strike"in e}function uD(e){return typeof e=="object"&&e!==null&&"blockquote"in e}function cD(e){return typeof e=="object"&&e!==null&&"inline-code"in e}function lD(e){return typeof e=="object"&&e!==null&&"code"in e&&typeof e.code=="string"}function nd(e){return typeof e=="object"&&e!==null&&"break"in e}function fD(e){return typeof e=="object"&&e!==null&&"ship"in e}function dD(e){return typeof e=="object"&&e!==null&&"sect"in e}function x3(e){return"header"in e}function A3(e){return typeof e=="object"&&e!==null&&"code"in e&&typeof e.code=="object"}function F3(e){return"listing"in e}function _3(e){return"item"in e}function I3(e){return"list"in e}function B3(e){return typeof e=="object"&&e!==null&&"tag"in e}function k3(e){return typeof e=="object"&&e!==null&&"block"in e}function hD(e){return typeof e=="object"&&e!==null&&"task"in e}function pD(e){return typeof e=="object"&&e!==null&&"image"in e}function R3(e){return typeof e=="object"&&e!==null&&"link"in e&&"url"in e.link}function T3(e){return"cite"in e}function gD(e){return"block"in e}const s0=fn("urbitUtils",!1),P3=["chat","heap","diary"];function rd(e){const t=e.split("/");return t.length!==3?(s0.error("Invalid nest:",e),!1):P3.includes(t[0])?!0:(s0.log(`Custom channel type detected (${t[0]}), pretending its chat.`,e),!1)}function mD(e){rd(e);const[t,...n]=e.split("/");return[t,n.join("/")]}function yD(e){return e?e.trim().startsWith("~")?e.trim():"~".concat(e.trim()):""}function Rs(e){return e?e.trim().replace("~",""):""}function N3(e){return nn("t",Y.fromCord(e).number)}function O3(e){return e.split("/").length===3}function $o(e){if(!O3(e)){if(id(e))return"dm";if(wD(e))return"groupDm"}const[t]=mD(e);return t==="chat"?"chat":t==="heap"?"gallery":t==="diary"?"notebook":"chat"}function U3(e){if(e)return Array.isArray(e)?e.map(t=>M3(t)?"":gD(t)?$3(t.block):"inline"in t?L3(t.inline):"").filter(t=>!!t&&t!=="").join(" ").trim():typeof e=="string"?e:void 0}function M3(e){return"type"in e&&e.type==="reference"}function $3(e){if(pD(e))return"(Image)";if(T3(e))return"(Reference)";if(x3(e))return e.header.content.map(Di);if(A3(e))return e.code.code;if(F3(e))return DD(e.listing)}function DD(e){return _3(e)?e.item.map(Di).join(" "):e.list.items.map(DD).join(" ")}function L3(e){return e.map(Di).filter(t=>t&&t!=="").join(" ")}function Di(e){return iD(e)?e.bold.map(Di).join(" "):sD(e)?e.italics.map(Di).join(" "):oD(e)?e.link.content:aD(e)?e.strike.map(Di).join(" "):uD(e)?e.blockquote.map(Di).join(" "):cD(e)?e["inline-code"]:lD(e)?e.code:nd(e)?"":fD(e)?e.ship:dD(e)?`@${e.sect||"all"}`:B3(e)?e.tag:k3(e)?e.block.text:hD(e)?e.task.content.map(Di).join(" "):e}function id(e){return e.startsWith("~")&&!e.match("/")}function wD(e){return e.startsWith("0v")}function bD(e,t){return e?"privacy"in e?e.privacy:e.secret?"secret":e.cordon&&"shut"in e.cordon?"private":"public":"secret"}function ED(e,t=!1){if("thread"in e){const n=`${e.thread.channel}/${e.thread.key.time}`;return t?n:`thread/${n}`}if("dm-thread"in e){const r=`${ED({dm:e["dm-thread"].whom},!0)}/${e["dm-thread"].key.id}`;return t?r:`dm-thread/${r}`}if("channel"in e)return t?e.channel.nest:`channel/${e.channel.nest}`;if("group"in e)return t?e.group:`group/${e.group}`;if("dm"in e)return"ship"in e.dm?t?e.dm.ship:`ship/${e.dm.ship}`:t?e.dm.club:`club/${e.dm.club}`;if("base"in e)return"base";throw new Error("Invalid activity source")}const z3=["dm-reply","post-mention","reply-mention","dm-invite","dm-post","dm-post-mention","dm-reply","dm-reply-mention","group-ask","group-invite","flag-post","flag-reply"],H3=["reply","group-join","group-kick","group-role"];function $a(e){const t=Object.entries(e);if(Xl.every(t,([,r])=>r.notify))return"loud";if(Xl.every(t,([,r])=>!r.notify))return"hush";let n=!0;return t.forEach(([r,s])=>{z3.concat("post").includes(r)&&!s.notify&&(n=!1),H3.includes(r)&&s.notify&&(n=!1)}),n?"medium":"soft"}var o0;(e=>{function t(n,r){return r in n}e.is=t})(o0||(o0={}));function G3(e){throw new Error(`Unexpected case: ${e}`)}async function q3(e){return await new Promise((t,n)=>{const r=new FileReader;r.onload=()=>t(r.result),r.onerror=n,r.readAsArrayBuffer(e)})}function ol(e){const t=new AbortController,n=t.signal,r=setTimeout(()=>{t.abort()},e);return n.addEventListener("abort",()=>{clearTimeout(r)},{once:!0}),n.cleanup=()=>{clearTimeout(r)},n}class j3{constructor(){P(this,"listeners",{})}on(t,n){return t in this.listeners||(this.listeners[t]=[]),this.listeners[t].push(n),this}off(t,n){if(!(t in this.listeners))return;const r=this.listeners[t].findIndex(s=>s===n);return r!==-1&&this.listeners[t].splice(r,1),this}emit(t,...n){if(t in this.listeners)for(let r=0;r<this.listeners[t].length;r++)this.listeners[t][r].apply(this,n)}}class W3 extends Error{}class vD extends Error{}class vi extends Error{}class K3 extends Error{}class pf extends Error{constructor(n,r,s){super(n);P(this,"status");P(this,"text");this.status=r,this.text=s}}async function V3(e,t,n){const r=e.getReader();let s={done:!1,value:new Uint8Array};for(;s&&!s.done;){if(s=await Promise.race([r.read(),new Promise((o,u)=>{setTimeout(()=>u(new Error("getBytes timed out")),n)})]),!s.value){console.warn("Empty chunk received from server");continue}try{t(s.value)}catch(o){console.error("Error processing chunk:",o)}}}function Z3(e){let t,n,r,s=!1;return function(u){t===void 0?(t=u,n=0,r=-1):t=X3(t,u);const c=t.length;let d=0;for(;n<c;){s&&(t[n]===10&&(d=++n),s=!1);let f=-1;for(;n<c&&f===-1;++n)switch(t[n]){case 58:r===-1&&(r=n-d);break;case 13:s=!0;case 10:f=n;break}if(f===-1)break;e(t.subarray(d,f),r),d=n,r=-1}d===c?t=void 0:d!==0&&(t=t.subarray(d),n-=d)}}function J3(e,t,n){let r=al();const s=new TextDecoder;return function(u,c){if(u.length===0)e==null||e(r),r=al();else if(c>0){const d=s.decode(u.subarray(0,c)),f=c+(u[c+1]===32?2:1),m=s.decode(u.subarray(f));switch(d){case"data":r.data=r.data?r.data+`
`+m:m;break;case"event":r.event=m;break;case"id":r=al(),t==null||t(r.id=m);break;case"retry":const y=parseInt(m,10);isNaN(y)||n==null||n(r.retry=y);break}}}}function X3(e,t){const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function al(){return{data:"",event:"",id:"",retry:void 0}}const gf="text/event-stream",Y3=1e3,a0="last-event-id";function u0(e,{signal:t,headers:n,onopen:r,onmessage:s,onclose:o,onerror:u,openWhenHidden:c,fetch:d,responseTimeout:f,...m}){return new Promise((y,w)=>{const E={...n};E.accept||(E.accept=gf);let F,I=Y3,T;function $(){clearTimeout(T),F.abort()}t==null||t.addEventListener("abort",()=>{$(),y()});const V=d??fetch,H=r??Q3;let Q=!1;async function te(){F=new AbortController;try{const ge=await Promise.race([V(e,{...m,headers:E,signal:F.signal}),new Promise((De,rt)=>{setTimeout(()=>rt(new K3("Request timed out")),f)})]);if(ge.status===404){$(),u==null||u(new vD("Channel reaped")),y();return}else if(ge.status===500){$(),u==null||u(new pf("Server error",500)),y();return}if(ge.status<200||ge.status>=300)throw new pf("Invalid server response",ge.status);await H(ge,Q),Q&&(Q=!1),await V3(ge.body,Z3(J3(s,De=>{De?E[a0]=De:delete E[a0]},De=>{I=De})),f),o==null||o(),$(),y()}catch(ge){if(!F.signal.aborted)try{Q=!0,F.abort();const De=(u==null?void 0:u(ge))??I;clearTimeout(T),T=setTimeout(te,De)}catch(De){$(),w(De)}}}te()})}function Q3(e){const t=e.headers.get("content-type");if(!(t!=null&&t.startsWith(gf)))throw new Error(`Expected content-type to be ${gf}, Actual: ${t}`)}async function e_(e){const t=[...new Uint8Array(e)].reverse().map(n=>n.toString(16).padStart(2,"0")).join("");return Xy(Y.fromString(t,16))}function Ka(e){const n=Math.pow(16,Math.min(e,8)-1),r=Math.pow(16,Math.min(e,8))-1;let o=(Math.floor(Math.random()*(r-n+1))+n).toString(16);for(;o.length<e;)o=o+Ka(e-8);return o}const ul=fn("UrbitHttpApi",!1);function t_(e){return e instanceof Y||e instanceof ze}class ko{constructor(t,n,r,s){P(this,"emitter",new j3);P(this,"uid",`${Math.floor(Date.now()/1e3)}-${Ka(6)}`);P(this,"lastEventId",0);P(this,"lastHeardEventId",-1);P(this,"lastAcknowledgedEventId",-1);P(this,"sseClientInitialized",!1);P(this,"cookie");P(this,"outstandingPokes",new Map);P(this,"outstandingSubscriptions",new Map);P(this,"channelAbort",new AbortController);P(this,"nodeId");P(this,"our");P(this,"verbose");P(this,"errorCount",0);P(this,"fetchFn",(t,n)=>fetch(t,n));return this.url=t,this.code=n,this.desk=r,qr&&window.addEventListener("beforeunload",this.delete),s&&(this.fetchFn=s),this}get channelUrl(){return`${this.url}/~/channel/${this.uid}`}get fetchOptions(){const t={"Content-Type":"application/json"};return!qr&&this.cookie&&(t.Cookie=this.cookie),{credentials:qr?"include":void 0,accept:"*",headers:t}}fetchOptionsNoun(t="PUT",n="noun"){let r;switch(n){case"noun":r="application/x-urb-jam";break;case"json":r="application/json";break}const s={};switch(t){case"PUT":s["Content-Type"]=r,s.Accept=r;break;case"GET":s["X-Channel-Format"]=r;break}return qr||(s.Cookie=this.cookie),{credentials:"include",accept:"*",headers:s}}static async authenticate({ship:t,url:n,code:r,verbose:s=!1}){const o=new ko(n.startsWith("http")?n:`http://${n}`,r);return o.verbose=s,o.nodeId=t,await o.connect(),await o.poke({app:"hood",mark:"helm-hi",json:"opening airlock"}),await o.eventSource(),o}emit(t,...n){this.emitter.emit(t,...n)}on(t,n){this.emitter.on(t,n),this.verbose&&console.log(t,"listening active"),t==="init"&&this.emitter.emit("init",{uid:this.uid,subscriptions:[...this.outstandingSubscriptions.entries()].map(([r,s])=>({id:r,app:s.app,path:s.path}))})}async getShipName(){if(this.nodeId)return Promise.resolve();const n=await(await this.fetchFn(`${this.url}/~/host`,{method:"get",credentials:"include"})).text();this.nodeId=n}async getOurName(){const t={};!qr&&this.cookie&&(t.Cookie=this.cookie);const r=await(await this.fetchFn(`${this.url}/~/name`,{method:"get",credentials:"include",headers:t})).text();this.our=r}async connect(){return this.verbose&&console.log(`password=${this.code} `,qr?`Connecting in browser context at ${this.url}/~/login`:"Connecting from node context"),this.fetchFn(`${this.url}/~/login`,{method:"post",body:`password=${this.code}`,credentials:"include"}).then(async t=>{var r;if(this.verbose&&console.log("Received authentication response",t),t.status<200||t.status>=300)throw new Error("Login failed with status "+t.status);const n=t.headers.get("set-cookie");if(!this.nodeId&&n){const s=(r=new RegExp(/urbauth-(~[\w-]+)/).exec(n))==null?void 0:r[1];this.nodeId=s}qr||(this.cookie=(n==null?void 0:n.split(";")[0].trim())||void 0),this.getShipName(),this.getOurName()})}async eventSource(){if(this.sseClientInitialized)return Promise.resolve();if(this.lastEventId===0){this.emit("status-update",{status:"opening"}),await this.poke({app:"hood",mark:"helm-hi",json:"Opening API channel"});return}return this.sseClientInitialized=!0,new Promise((t,n)=>{u0(this.channelUrl,{...this.fetchOptions,signal:this.channelAbort.signal,reactNative:{textStreaming:!0},openWhenHidden:!0,responseTimeout:25e3,fetch:this.fetchFn,onopen:async(r,s)=>{if(this.verbose&&console.log("Opened eventsource",r),r.ok){this.errorCount=0,this.emit("status-update",{status:s?"reconnected":"active"}),t();return}else{const o=new Error("failed to open eventsource");n(o)}},onmessage:r=>{var o,u,c,d,f;if(this.verbose&&console.log("Received SSE: ",r),!r.id)return;const s=parseInt(r.id,10);if(this.emit("fact",{id:s,data:r.data,time:Date.now()}),s<=this.lastHeardEventId){this.verbose&&console.log("dropping old or out-of-order event",{eventId:s,lastHeard:this.lastHeardEventId});return}if(this.lastHeardEventId=s,this.emit("id-update",{lastHeard:this.lastHeardEventId}),s-this.lastAcknowledgedEventId>20&&this.ack(s),r.data&&JSON.parse(r.data)){const m=JSON.parse(r.data);if(this.verbose&&console.log("received data",m),m.response==="poke"&&this.outstandingPokes.has(m.id)){const y=this.outstandingPokes.get(m.id);"ok"in m&&y?(o=y.onSuccess)==null||o.call(y):"err"in m&&y?(console.error(m.err),(u=y.onError)==null||u.call(y,m.err)):console.error("Invalid poke response",m),this.outstandingPokes.delete(m.id)}else if(m.response==="subscribe"&&this.outstandingSubscriptions.has(m.id)){const y=this.outstandingSubscriptions.get(m.id);"err"in m&&y&&(console.error(m.err),(c=y.err)==null||c.call(y,m.err,m.id),this.outstandingSubscriptions.delete(m.id))}else if(m.response==="diff"&&this.outstandingSubscriptions.has(m.id)){const y=this.outstandingSubscriptions.get(m.id);try{(d=y==null?void 0:y.event)==null||d.call(y,m.json,m.mark??"json",m.id)}catch(w){console.error("Failed to call subscription event callback",w)}}else if(m.response==="quit"&&this.outstandingSubscriptions.has(m.id)){const y=this.outstandingSubscriptions.get(m.id);(f=y==null?void 0:y.quit)==null||f.call(y,m),this.outstandingSubscriptions.delete(m.id),this.emit("subscription",{id:m.id,status:"close"}),y!=null&&y.resubOnQuit&&this.subscribe(y)}else this.verbose&&(console.log([...this.outstandingSubscriptions.keys()]),console.log("Unrecognized response",m))}},onerror:r=>{if(this.errorCount++,this.emit("error",{time:Date.now(),msg:JSON.stringify(r),error:r}),r instanceof vD){this.emit("channel-reaped",{time:Date.now()}),this.seamlessReset();return}if(!(r instanceof W3)){const s={};if(r instanceof pf){if(r.status===500){this.seamlessReset();return}s.message=r.message,s.requestStatus=r.status}return s.message=r.message,this.emit("status-update",{status:"reconnecting",context:s}),Math.min(5e3,Math.pow(2,this.errorCount-1)*750)}throw this.emit("status-update",{status:"errored"}),r},onclose:()=>{throw console.log("e"),new Error("Ship unexpectedly closed the connection")}})})}reset(){this.verbose&&console.log("resetting"),this.delete(),this.uid=`${Math.floor(Date.now()/1e3)}-${Ka(6)}`,this.emit("reset",{uid:this.uid}),this.lastEventId=0,this.lastHeardEventId=-1,this.lastAcknowledgedEventId=-1,this.outstandingSubscriptions=new Map,this.outstandingPokes=new Map,this.sseClientInitialized=!1}seamlessReset(){this.uid=`${Math.floor(Date.now()/1e3)}-${Ka(6)}`,this.emit("seamless-reset",{uid:this.uid}),this.emit("status-update",{status:"initial"}),this.sseClientInitialized=!1,this.lastEventId=0,this.lastHeardEventId=-1,this.lastAcknowledgedEventId=-1;const t=[...this.outstandingSubscriptions.entries()];this.outstandingSubscriptions=new Map,t.forEach(([n,r])=>{var s;(s=r.quit)==null||s.call(r,{id:n,response:"quit"}),this.emit("subscription",{id:n,status:"close"}),r.resubOnQuit&&this.subscribe(r)}),this.outstandingPokes.forEach((n,r)=>{var s;(s=n.onError)==null||s.call(n,"Channel was reaped")}),this.outstandingPokes=new Map}getEventId(){return this.lastEventId+=1,this.emit("id-update",{current:this.lastEventId}),this.lastEventId}async ack(t){this.lastAcknowledgedEventId=t,this.emit("id-update",{lastAcknowledged:t});const n={action:"ack","event-id":t};return await this.sendJSONtoChannel(n),t}async sendNounsToChannel(...t){const n=this.fetchOptionsNoun("PUT","noun"),r=nn("uw",h3(Jf.list(t)).number);this.validatePokeBodySize(r);const s=await this.fetchFn(this.channelUrl,{...n,signal:this.channelAbort.signal,method:"PUT",body:r});if(!s.ok)throw console.log(s.status,s.statusText,await s.text()),new Error("Failed to PUT channel command(s)");if(!this.sseClientInitialized){if(this.verbose&&console.log("initializing event source"),await Promise.all([this.getOurName(),this.getShipName()]),this.our!==this.nodeId)throw new vi("invalid session");await this.eventSource()}}async sendJSONtoChannel(...t){const n=JSON.stringify(t);if(this.validatePokeBodySize(n),!(await this.fetchFn(this.channelUrl,{...this.fetchOptions,signal:this.channelAbort.signal,method:"PUT",body:n})).ok)throw new Error("Failed to PUT channel");if(!this.sseClientInitialized){if(this.verbose&&console.log("initializing event source"),await Promise.all([this.getOurName(),this.getShipName()]),this.our!==this.nodeId)throw console.log("our name does not match ship name"),console.log("our:",this.our),console.log("ship:",this.nodeId),console.log("messages:",t),new vi("invalid session");await this.eventSource()}}validatePokeBodySize(t){if(t.length/1024>512)throw ul.trackError("Body too large to send to channel"),new Error("Body too large to send to channel")}async subscribeOnce(t,n,r,s){return new Promise((o,u)=>{let c=!1;const m={app:t,path:n,ship:r,resubOnQuit:!1,event:(y,w,E)=>{c||(o(y),this.unsubscribe(E))},err:u,quit:()=>{c||u("quit")}};this.subscribe(m).then(y=>{s&&setTimeout(()=>{c||(c=!0,u("timeout"),this.unsubscribe(y))},s)})})}async pokeNoun(t){var c;t.onSuccess=t.onSuccess||(()=>{}),t.onError=t.onError||(()=>{});const{app:n,mark:r,noun:s,ship:o}={ship:((c=this.nodeId)==null?void 0:c.replace("~",""))||"",...t};this.lastEventId===0&&this.emit("status-update",{status:"opening"});const u=this.getEventId();if(this.outstandingPokes.set(u,t),t_(s)){const d=new Y(Vf("p",`~${o}`)),f=["poke",u,d,n,r,s];await this.sendNounsToChannel(f)}else throw new Error("pokeNoun requires a noun");return u}async poke(t){const{app:n,mark:r,json:s,ship:o,onSuccess:u,onError:c}={onSuccess:()=>{},onError:()=>{},ship:Rs(this.nodeId??""),...t};this.lastEventId===0&&this.emit("status-update",{status:"opening"});const d={id:this.getEventId(),action:"poke",ship:o,app:n,mark:r,json:s};return new Promise((f,m)=>{this.outstandingPokes.set(d.id,{onSuccess:()=>{u(),f(d.id)},onError:y=>{c(y),m(y)}}),this.sendJSONtoChannel(d).catch(m)})}async subscribe(t){const{app:n,path:r,ship:s,resubOnQuit:o,err:u,event:c,quit:d}={err:()=>{},event:()=>{},quit:()=>{},resubOnQuit:!0,...t,ship:Rs(t.ship??this.nodeId??"")};this.lastEventId===0&&this.emit("status-update",{status:"opening"});const f={id:this.getEventId(),action:"subscribe",ship:s,app:n,path:r};return this.outstandingSubscriptions.set(f.id,{app:n,path:r,resubOnQuit:o,err:u,event:c,quit:d}),this.emit("subscription",{id:f.id,app:n,path:r,status:"open"}),await this.sendJSONtoChannel(f),f.id}async unsubscribe(t){return this.sendJSONtoChannel({id:this.getEventId(),action:"unsubscribe",subscription:t}).then(()=>{this.emit("subscription",{id:t,status:"close"}),this.outstandingSubscriptions.delete(t)})}async delete(){this.channelAbort.abort(),this.channelAbort=new AbortController;const t=JSON.stringify([{id:this.getEventId(),action:"delete"}]);if(qr)navigator.sendBeacon(this.channelUrl,t);else if(!(await this.fetchFn(this.channelUrl,{...this.fetchOptions,signal:this.channelAbort.signal,method:"POST",body:t})).ok)throw new Error("Failed to DELETE channel in node context")}async checkIsNodeBusy(){try{const t=await this.fetchFn(`${this.url}/~_~/healthz`,{method:"GET"});return t.status===204?"available":t.status===429?"busy":(ul.trackEvent("Unexpected node busy response",{status:t.status}),"unknown")}catch(t){return ul.trackEvent("Failed to check if node is busy",{error:t}),"unknown"}}async scry(t){const{result:n}=await this.scryWithInfo(t);return n}async scryWithInfo(t){const{app:n,path:r,timeout:s}=t,o=s?ol(s):void 0,u=await this.fetchFn(`${this.url}/~/scry/${n}${r}.json`,{...this.fetchOptions,signal:o});if(o==null||o.cleanup(),!u.ok)return Promise.reject(u);const c=await u.json(),d=u.headers.get("content-length");return{responseStatus:u.status,responseSizeInBytes:Number(d),result:c}}async scryNoun(t){const{result:n}=await this.scryNounWithInfo(t);return n}async scryNounWithInfo(t){const{app:n,path:r}=t;try{const s=await this.fetchFn(`${this.url}/~/scry/${n}${r}.noun`,{...this.fetchOptionsNoun("GET","noun")});if(!s.ok)return Promise.reject(s);const o=await s.blob(),u=await q3(o);try{const c=await e_(u),d=s.headers.get("content-length");return{responseStatus:s.status,responseSizeInBytes:Number(d),result:c}}catch(c){throw console.error("Unpack failed",c),c}}catch(s){throw console.error(s),s}}async thread(t){const{inputMark:n,outputMark:r,threadName:s,body:o,timeout:u,desk:c=this.desk}=t;if(!c)throw new Error("Must supply desk to run thread from");const d=u?ol(u):void 0,f=await this.fetchFn(`${this.url}/spider/${c}/${n}/${s}/${r}.json`,{...this.fetchOptions,signal:d,method:"POST",body:JSON.stringify(o)});return d==null||d.cleanup(),f}async getSpinHints(){return new Promise((t,n)=>{const r=new AbortController;let s=!1;u0(`${this.url}/~_~/spin`,{signal:r.signal,reactNative:{textStreaming:!0},openWhenHidden:!0,responseTimeout:25e3,fetch:this.fetchFn,onmessage(o){s||(s=!0,r.abort(),t(o.data))},onerror(o){r.abort(),n(o)}})})}async request(t,n={},r){t.startsWith("/")||(t="/"+t);const s=r?ol(r):void 0,o={...this.fetchOptions,...n,headers:{...this.fetchOptions.headers,...n.headers||{}},signal:s};!qr&&this.cookie&&(o.headers={...o.headers,Cookie:this.cookie});const u=await this.fetchFn(`${this.url}${t}`,o);if(s==null||s.cleanup(),!u.ok)return Promise.reject(u);const c=u.headers.get("content-type");return c!=null&&c.includes("application/json")?u.json():c!=null&&c.includes("text/")?u.text():u.blob()}static async onArvoNetwork(t,n){const r=`https://${t}.arvo.network`;return await ko.authenticate({ship:t,url:r,code:n})}}const SD=async(e,t)=>{var r;const n=await fetch(`${e}/~/login`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:`password=${t}`,credentials:"include"});if(n.status<200||n.status>299)throw new Error("Failed to authenticate. Is your access code correct?");return(r=n.headers.get("set-cookie"))==null?void 0:r.split(";")[0]},_e=fn("urbit",!1),iu=60*1e3,c0=90*1e3;class Ls extends Error{constructor(t,n){super(),this.status=t,this.body=n}}class sd extends Error{constructor({connectionStatus:n,timeoutDuration:r}){super(`TimeoutError: ${n}`);P(this,"connectionStatus");P(this,"timeoutDuration");this.connectionStatus=n||"unknown",this.timeoutDuration=r??null}}const ne={client:null,lastStatus:"",shipUrl:"",subWatchers:{},pendingAuth:null,onQuitOrReset:void 0,getCode:void 0,handleAuthFailure:void 0},zi=new Proxy({},{get:function(e,t,n){if(!ne.client)throw new Error("Urbit client not set.");return Reflect.get(ne.client,t,n)}}),cr=()=>{if(!zi.nodeId)throw new Error("Client not initialized");return zi.nodeId},CD=()=>{if(!zi.nodeId)throw new Error("Client not initialized");if(zi.url)return zg(zi.url);const e=Ei(),t=wy()?e.DEV_SHIP_URL:window.location.hostname;return zg(t)};async function n_({shipName:e,shipUrl:t,verbose:n,fetchFn:r,getCode:s,handleAuthFailure:o,onQuitOrReset:u,onChannelStatusChange:c,client:d}){const f=!d&&s?await s():"";ne.client=d||ne.client||new ko(t,f,"",r),ne.client.verbose=n,ne.client.nodeId=yD(e),ne.shipUrl=t,ne.onQuitOrReset=u,ne.getCode=s,ne.handleAuthFailure=o,ne.subWatchers={},f&&(await ne.client.connect(),await ne.client.eventSource()),ne.client.on("status-update",m=>{_e.trackEvent(Ke.NodeConnectionDebug,{context:"status update",connectionStatus:m.status,statusUpdateContext:m.context?m.context:null}),ne.lastStatus=m.status,c==null||c(m.status)}),ne.client.on("fact",m=>{_e.log("received message",by(()=>xF(JSON.stringify(m))))}),ne.client.on("seamless-reset",()=>{var m;_e.log("client seamless-reset"),_e.trackEvent(Ke.NodeConnectionDebug,{context:"seamless-reset"}),(m=ne.onQuitOrReset)==null||m.call(ne,"reset")}),ne.client.on("error",m=>{_e.log("client error",m)}),ne.client.on("channel-reaped",()=>{_e.trackEvent(Ke.NodeConnectionDebug,{context:"client channel reaped"}),_e.log("client channel-reaped")})}function vn(e){return`${e.app}${e.path}`}async function Ki(e,t){const n=async s=>{if(!ne.client)throw new Error("Client not initialized");return ne.pendingAuth&&await ne.pendingAuth,_e.log("subscribing to",vn(e)),ne.client.subscribe({app:e.app,path:e.path,event:(o,u,c)=>{_e.debug(`got subscription event on ${vn(e)}:`,o);const d=vn(e),f=ne.subWatchers[d];_e.debug(`checking for endpoint watchers on ${d}:`,f),f&&f.forEach(m=>{m.predicate(o,u)?(_e.debug(`watcher ${m.id} predicate met`,o),m.resolve(),f.delete(m.id)):_e.debug(`watcher ${m.id} predicate failed`,o)}),t(o,c)},quit:()=>{var o;_e.log("subscription quit on",vn(e)),(o=ne.onQuitOrReset)==null||o.call(ne,"subscriptionQuit")},err:(o,u)=>{_e.trackError(`subscribe error on ${vn(e)}`,{stack:o}),s&&(_e.log("calling error handler for subscription",vn(e)),s(o,u))}})},r=async s=>{if(_e.error("bad subscribe",vn(e),s),!(s instanceof vi))throw s;return ne.pendingAuth=Vi(),n()};try{return n(r)}catch(s){return r(s)}}async function Qr(e,t,n,r){if(!ne.client)throw new Error("Client not initialized");ne.pendingAuth&&await ne.pendingAuth,_e.log("subscribing once to",vn(e));try{return ne.client.subscribeOnce(e.app,e.path,n,t)}catch(s){if(s!=="timeout"&&s!=="quit"?_e.trackError(`bad subscribeOnce ${vn(e)}`,{stack:s}):s==="timeout"?(_e.error("subscribeOnce timed out",vn(e)),_e.trackEvent(Ke.ErrorSubscribeOnceTimeout,{requestTag:r==null?void 0:r.tag,subEndpoint:vn(e),connectionStatus:ne.lastStatus,timeoutDuration:t})):_e.error("subscribeOnce quit",vn(e)),!(s instanceof vi))throw s;return await Vi(),ne.client.subscribeOnce(e.app,e.path,n,t)}}async function xD(e){if(!ne.client)throw new Error("Client not initialized");ne.pendingAuth&&await ne.pendingAuth;try{return ne.client.unsubscribe(e)}catch(t){if(_e.error("bad unsubscribe",e,t),t instanceof vi)return await Vi(),ne.client.unsubscribe(e)}}async function od({app:e,mark:t,noun:n}){const r=async o=>{if(!ne.client)throw new Error("Client not initialized");return ne.pendingAuth&&await ne.pendingAuth,_e.log("noun poke",{app:e,mark:t}),ne.client.pokeNoun({...o,app:e,mark:t,noun:n})},s=async o=>{if(_e.trackError(`NOUN POKE: bad poke to ${e} with mark ${t}`,{stack:o,noun:n}),!(o instanceof vi))throw o;return await Vi(),r()};try{return r({onError:s})}catch(o){s(o)}}async function fe({app:e,mark:t,json:n}){_e.log("poke",e,t,n);const r=Lo(Ke.Poke,{app:e,mark:t}),s=async u=>{if(!ne.client)throw new Error("Client not initialized");return ne.pendingAuth&&await ne.pendingAuth,ne.client.poke({...u,app:e,mark:t,json:n})},o=async u=>{if(_e.trackError(`bad poke to ${e} with mark ${t}`,{stack:u,body:n}),!(u instanceof vi))throw r("error"),u;return await Vi(),s()};try{const u=await s();return r("success"),u}catch(u){const c=await o(u);return r("success"),c}}async function lr(e,t,n,r){ne.pendingAuth&&await ne.pendingAuth;const s=Lo(Ke.TrackedPoke,{app:e.app,mark:e.mark});let o=!1;try{const u=r_(t,n,(r==null?void 0:r.timeout)??2e4),c=fe(e).then(()=>o=!0);await Promise.all([u,c]),s("success")}catch(u){throw _e.error("tracked poke failed",u),s("error"),u instanceof sd&&_e.trackEvent(Ke.ErrorTrackedPokeTimeout,{requestTag:r==null?void 0:r.tag,pokeParams:e,subEndpoint:vn(t),connectionStatus:ne.lastStatus,timeoutDuration:u.timeoutDuration,pokeCompleted:o}),u}}async function r_(e,t,n=15e3){const r=vn(e);return new Promise((s,o)=>{const u=ne.subWatchers[r]||new Map,c=Xl.uniqueId();ne.subWatchers[r]=u.set(c,{id:c,predicate:t,resolve:s,reject:o}),n&&setTimeout(()=>{u.has(c)&&(u.delete(c),o(new sd({connectionStatus:ne.lastStatus,timeoutDuration:n})))},n)})}async function i_(){var e;return((e=ne.client)==null?void 0:e.checkIsNodeBusy())||Promise.resolve("unknown")}async function s_(){if(!ne.client)throw new Error("Client not initialized");const e=await zi.getSpinHints();return e==="/root"?{nodeBusyStatus:"available"}:{nodeBusyStatus:"busy",hints:e}}async function Ve({app:e,path:t,timeout:n}){if(!ne.client)throw new Error("Client not initialized");ne.pendingAuth&&await ne.pendingAuth,_e.log("scry",e,t);const r=Lo(Ke.Scry,{app:e,path:FD(t),shouldTimeoutAfter:n??iu});try{const{result:s,responseSizeInBytes:o,responseStatus:u}=await ne.client.scryWithInfo({app:e,path:t,timeout:n??iu});return r("success",{responseSizeInBytes:o,responseStatus:u}),s}catch(s){if(_e.log("bad scry",e,t,s.status),s.status===403){_e.log("scry failed with 403, authing to try again"),await Vi();const{result:o,responseSizeInBytes:u,responseStatus:c}=await ne.client.scryWithInfo({app:e,path:t});return r("success",{responseSizeInBytes:u,responseStatus:c}),o}throw r("error",{errorMessage:s.message,responseStatus:s.status}),new Ls(s.status,s.toString())}}async function o_({app:e,path:t,timeout:n}){if(!ne.client)throw new Error("Client not initialized");ne.pendingAuth&&await ne.pendingAuth,_e.log("scry noun",e,t);const r=Lo(Ke.ScryNoun,{app:e,path:FD(t),shouldTimeoutAfter:n??iu});try{const{result:s,responseSizeInBytes:o,responseStatus:u}=await ne.client.scryNounWithInfo({app:e,path:t,timeout:n??iu});return r("success",{responseSizeInBytes:o,responseStatus:u}),s}catch(s){if(_e.log("bad scry",e,t,s.status),s.status===403){_e.log("scry failed with 403, authing to try again"),await Vi();const{result:o,responseSizeInBytes:u,responseStatus:c}=await ne.client.scryNounWithInfo({app:e,path:t});return r("success",{responseSizeInBytes:u,responseStatus:c}),o}throw r("error",{message:s.message,responseStatus:s.status}),new Ls(s.status,s.toString())}}async function ad(e){if(!e.desk)throw new Error("Must supply desk to run thread from");if(!ne.client)throw new Error("Cannot call thread before client is initialized");const t=Lo(Ke.Thread,{desk:e.desk,inputMark:e.inputMark,threadName:e.threadName,outputMark:e.outputMark,shouldTimeoutAfter:e.timeout??c0}),n={};try{const r=await ne.client.thread({...e,timeout:e.timeout??c0});if(!r.ok){const s=await r.text();throw n.responseStatus=r.status,n.responseText=s,new Ls(r.status,s)}return t("success"),r.json()}catch(r){throw t("error",{...n,errorMessage:r.toString()}),r}}async function AD(e,t={},n){if(!ne.client)throw new Error("Cannot make request before client is initialized");return ne.client.request(e,t,n)}function FD(e){return e.replace(/~.+?(?:\/.+?)(\/|$)/g,"[id]/")}async function Vi(){if(!ne.getCode){if(_e.log("No getCode function provided for auth"),ne.handleAuthFailure)return _e.log("calling auth failure handler"),ne.handleAuthFailure();throw new Error("Unable to authenticate with urbit")}if(ne.pendingAuth)return ne.pendingAuth;try{let e=0;_e.log("getting urbit code");const t=await ne.getCode();return ne.pendingAuth=new Promise((n,r)=>{const s=async()=>{try{_e.log("trying to auth with code",t);const o=await SD(ne.shipUrl,t);if(!o&&e<3){_e.log("auth failed, trying again",e),e++,setTimeout(s,1e3+2**e*1e3);return}if(!o){ne.pendingAuth=null,ne.handleAuthFailure&&(_e.log("auth failed, calling auth failure handler"),ne.handleAuthFailure()),r(new Error("Couldn't authenticate with urbit"));return}ne.client&&(ne.client.cookie=o),ne.pendingAuth=null,n(o);return}catch(o){r(new Error(`Error during reauth: ${o}`))}};s()}),await ne.pendingAuth}catch(e){if(_e.error("error getting urbit code",e),ne.pendingAuth=null,ne.handleAuthFailure)return ne.handleAuthFailure();throw e}}function Lo(e,t){const n=Date.now();return(r,s)=>{_e.trackEvent(e,{...t,...s,status:r,scryStatus:r,duration:Date.now()-n})}}var _D={},ud={},su=yt&&yt.__assign||function(){return su=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},su.apply(this,arguments)};Object.defineProperty(ud,"__esModule",{value:!0});var a_={delayFirstAttempt:!1,jitter:"none",maxDelay:1/0,numOfAttempts:10,retry:function(){return!0},startingDelay:100,timeMultiple:2};function u_(e){var t=su(su({},a_),e);return t.numOfAttempts<1&&(t.numOfAttempts=1),t}ud.getSanitizedOptions=u_;var cd={},ld={},xu={},fd={},dd={};Object.defineProperty(dd,"__esModule",{value:!0});function c_(e){var t=Math.random()*e;return Math.round(t)}dd.fullJitter=c_;var hd={};Object.defineProperty(hd,"__esModule",{value:!0});function l_(e){return e}hd.noJitter=l_;Object.defineProperty(fd,"__esModule",{value:!0});var f_=dd,d_=hd;function h_(e){switch(e.jitter){case"full":return f_.fullJitter;case"none":default:return d_.noJitter}}fd.JitterFactory=h_;Object.defineProperty(xu,"__esModule",{value:!0});var p_=fd,g_=function(){function e(t){this.options=t,this.attempt=0}return e.prototype.apply=function(){var t=this;return new Promise(function(n){return setTimeout(n,t.jitteredDelay)})},e.prototype.setAttemptNumber=function(t){this.attempt=t},Object.defineProperty(e.prototype,"jitteredDelay",{get:function(){var t=p_.JitterFactory(this.options);return t(this.delay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delay",{get:function(){var t=this.options.startingDelay,n=this.options.timeMultiple,r=this.numOfDelayedAttempts,s=t*Math.pow(n,r);return Math.min(s,this.options.maxDelay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt},enumerable:!0,configurable:!0}),e}();xu.Delay=g_;var m_=yt&&yt.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var o in s)s.hasOwnProperty(o)&&(r[o]=s[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),y_=yt&&yt.__awaiter||function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(u){u(o)})}return new(n||(n=Promise))(function(o,u){function c(m){try{f(r.next(m))}catch(y){u(y)}}function d(m){try{f(r.throw(m))}catch(y){u(y)}}function f(m){m.done?o(m.value):s(m.value).then(c,d)}f((r=r.apply(e,t||[])).next())})},D_=yt&&yt.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,s,o,u;return u={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function c(f){return function(m){return d([f,m])}}function d(f){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(o=f[0]&2?s.return:f[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,f[1])).done)return o;switch(s=0,o&&(f=[f[0]&2,o.value]),f[0]){case 0:case 1:o=f;break;case 4:return n.label++,{value:f[1],done:!1};case 5:n.label++,s=f[1],f=[0];continue;case 7:f=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(f[0]===6||f[0]===2)){n=0;continue}if(f[0]===3&&(!o||f[1]>o[0]&&f[1]<o[3])){n.label=f[1];break}if(f[0]===6&&n.label<o[1]){n.label=o[1],o=f;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(f);break}o[2]&&n.ops.pop(),n.trys.pop();continue}f=t.call(e,n)}catch(m){f=[6,m],s=0}finally{r=o=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}};Object.defineProperty(ld,"__esModule",{value:!0});var w_=xu,b_=function(e){m_(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.apply=function(){return y_(this,void 0,void 0,function(){return D_(this,function(n){return[2,this.isFirstAttempt?!0:e.prototype.apply.call(this)]})})},Object.defineProperty(t.prototype,"isFirstAttempt",{get:function(){return this.attempt===0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt-1},enumerable:!0,configurable:!0}),t}(w_.Delay);ld.SkipFirstDelay=b_;var pd={},E_=yt&&yt.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var o in s)s.hasOwnProperty(o)&&(r[o]=s[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(pd,"__esModule",{value:!0});var v_=xu,S_=function(e){E_(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(v_.Delay);pd.AlwaysDelay=S_;Object.defineProperty(cd,"__esModule",{value:!0});var C_=ld,x_=pd;function A_(e,t){var n=F_(e);return n.setAttemptNumber(t),n}cd.DelayFactory=A_;function F_(e){return e.delayFirstAttempt?new x_.AlwaysDelay(e):new C_.SkipFirstDelay(e)}var mf=yt&&yt.__awaiter||function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(u){u(o)})}return new(n||(n=Promise))(function(o,u){function c(m){try{f(r.next(m))}catch(y){u(y)}}function d(m){try{f(r.throw(m))}catch(y){u(y)}}function f(m){m.done?o(m.value):s(m.value).then(c,d)}f((r=r.apply(e,t||[])).next())})},yf=yt&&yt.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,s,o,u;return u={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function c(f){return function(m){return d([f,m])}}function d(f){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(o=f[0]&2?s.return:f[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,f[1])).done)return o;switch(s=0,o&&(f=[f[0]&2,o.value]),f[0]){case 0:case 1:o=f;break;case 4:return n.label++,{value:f[1],done:!1};case 5:n.label++,s=f[1],f=[0];continue;case 7:f=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(f[0]===6||f[0]===2)){n=0;continue}if(f[0]===3&&(!o||f[1]>o[0]&&f[1]<o[3])){n.label=f[1];break}if(f[0]===6&&n.label<o[1]){n.label=o[1],o=f;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(f);break}o[2]&&n.ops.pop(),n.trys.pop();continue}f=t.call(e,n)}catch(m){f=[6,m],s=0}finally{r=o=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}};Object.defineProperty(_D,"__esModule",{value:!0});var __=ud,I_=cd;function B_(e,t){return t===void 0&&(t={}),mf(this,void 0,void 0,function(){var n,r;return yf(this,function(s){switch(s.label){case 0:return n=__.getSanitizedOptions(t),r=new k_(e,n),[4,r.execute()];case 1:return[2,s.sent()]}})})}_D.backOff=B_;var k_=function(){function e(t,n){this.request=t,this.options=n,this.attemptNumber=0}return e.prototype.execute=function(){return mf(this,void 0,void 0,function(){var t,n;return yf(this,function(r){switch(r.label){case 0:if(this.attemptLimitReached)return[3,7];r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.applyDelay()];case 2:return r.sent(),[4,this.request()];case 3:return[2,r.sent()];case 4:return t=r.sent(),this.attemptNumber++,[4,this.options.retry(t,this.attemptNumber)];case 5:if(n=r.sent(),!n||this.attemptLimitReached)throw t;return[3,6];case 6:return[3,0];case 7:throw new Error("Something went wrong.")}})})},Object.defineProperty(e.prototype,"attemptLimitReached",{get:function(){return this.attemptNumber>=this.options.numOfAttempts},enumerable:!0,configurable:!0}),e.prototype.applyDelay=function(){return mf(this,void 0,void 0,function(){var t;return yf(this,function(n){switch(n.label){case 0:return t=I_.DelayFactory(this.options,this.attemptNumber),[4,t.apply()];case 1:return n.sent(),[2]}})})},e}();const ID="settings",gd="base_unreads",R_={getValue:()=>null,setValue:()=>{}},T_={getValue:()=>null,setValue:()=>{}},P_=()=>/[#*0-9]\uFE0F?\u20E3|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23ED-\u23EF\u23F1\u23F2\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692\u2694-\u2697\u2699\u269B\u269C\u26A0\u26A7\u26AA\u26B0\u26B1\u26BD\u26BE\u26C4\u26C8\u26CF\u26D1\u26E9\u26F0-\u26F5\u26F7\u26F8\u26FA\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B55\u3030\u303D\u3297\u3299]\uFE0F?|[\u261D\u270C\u270D](?:\uD83C[\uDFFB-\uDFFF]|\uFE0F)?|[\u270A\u270B](?:\uD83C[\uDFFB-\uDFFF])?|[\u23E9-\u23EC\u23F0\u23F3\u25FD\u2693\u26A1\u26AB\u26C5\u26CE\u26D4\u26EA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2795-\u2797\u27B0\u27BF\u2B50]|\u26D3\uFE0F?(?:\u200D\uD83D\uDCA5)?|\u26F9(?:\uD83C[\uDFFB-\uDFFF]|\uFE0F)?(?:\u200D[\u2640\u2642]\uFE0F?)?|\u2764\uFE0F?(?:\u200D(?:\uD83D\uDD25|\uD83E\uDE79))?|\uD83C(?:[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF5\uDFF7]\uFE0F?|[\uDF85\uDFC2\uDFC7](?:\uD83C[\uDFFB-\uDFFF])?|[\uDFC4\uDFCA](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDFCB\uDFCC](?:\uD83C[\uDFFB-\uDFFF]|\uFE0F)?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF43\uDF45-\uDF4A\uDF4C-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF8-\uDFFF]|\uDDE6\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF]|\uDDE7\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF]|\uDDE8\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF7\uDDFA-\uDDFF]|\uDDE9\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF]|\uDDEA\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA]|\uDDEB\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7]|\uDDEC\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE]|\uDDED\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA]|\uDDEE\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9]|\uDDEF\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5]|\uDDF0\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF]|\uDDF1\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE]|\uDDF2\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF]|\uDDF3\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF]|\uDDF4\uD83C\uDDF2|\uDDF5\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE]|\uDDF6\uD83C\uDDE6|\uDDF7\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC]|\uDDF8\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF]|\uDDF9\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF]|\uDDFA\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF]|\uDDFB\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA]|\uDDFC\uD83C[\uDDEB\uDDF8]|\uDDFD\uD83C\uDDF0|\uDDFE\uD83C[\uDDEA\uDDF9]|\uDDFF\uD83C[\uDDE6\uDDF2\uDDFC]|\uDF44(?:\u200D\uD83D\uDFEB)?|\uDF4B(?:\u200D\uD83D\uDFE9)?|\uDFC3(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?|\uDFF3\uFE0F?(?:\u200D(?:\u26A7\uFE0F?|\uD83C\uDF08))?|\uDFF4(?:\u200D\u2620\uFE0F?|\uDB40\uDC67\uDB40\uDC62\uDB40(?:\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDC73\uDB40\uDC63\uDB40\uDC74|\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F)?)|\uD83D(?:[\uDC3F\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3]\uFE0F?|[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC](?:\uD83C[\uDFFB-\uDFFF])?|[\uDC6E-\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4\uDEB5](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD74\uDD90](?:\uD83C[\uDFFB-\uDFFF]|\uFE0F)?|[\uDC00-\uDC07\uDC09-\uDC14\uDC16-\uDC25\uDC27-\uDC3A\uDC3C-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE2D\uDE2F-\uDE34\uDE37-\uDE41\uDE43\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED8\uDEDC-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uDC08(?:\u200D\u2B1B)?|\uDC15(?:\u200D\uD83E\uDDBA)?|\uDC26(?:\u200D(?:\u2B1B|\uD83D\uDD25))?|\uDC3B(?:\u200D\u2744\uFE0F?)?|\uDC41\uFE0F?(?:\u200D\uD83D\uDDE8\uFE0F?)?|\uDC68(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDC68\uDC69]\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83D\uDC68\uD83C[\uDFFC-\uDFFF])|\uD83E(?:[\uDD1D\uDEEF]\u200D\uD83D\uDC68\uD83C[\uDFFC-\uDFFF]|[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83E(?:[\uDD1D\uDEEF]\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFD-\uDFFF]|[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83E(?:[\uDD1D\uDEEF]\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83E(?:[\uDD1D\uDEEF]\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFD\uDFFF]|[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFE])|\uD83E(?:[\uDD1D\uDEEF]\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFE]|[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3])))?))?|\uDC69(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?[\uDC68\uDC69]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?|\uDC69\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?))|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83D\uDC69\uD83C[\uDFFC-\uDFFF])|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFC-\uDFFF]|\uDEEF\u200D\uD83D\uDC69\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83D\uDC69\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFD-\uDFFF]|\uDEEF\u200D\uD83D\uDC69\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83D\uDC69\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|\uDEEF\u200D\uD83D\uDC69\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83D\uDC69\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFD\uDFFF]|\uDEEF\u200D\uD83D\uDC69\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83D\uDC69\uD83C[\uDFFB-\uDFFE])|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFE]|\uDEEF\u200D\uD83D\uDC69\uD83C[\uDFFB-\uDFFE])))?))?|\uDD75(?:\uD83C[\uDFFB-\uDFFF]|\uFE0F)?(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDE2E(?:\u200D\uD83D\uDCA8)?|\uDE35(?:\u200D\uD83D\uDCAB)?|\uDE36(?:\u200D\uD83C\uDF2B\uFE0F?)?|\uDE42(?:\u200D[\u2194\u2195]\uFE0F?)?|\uDEB6(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?)|\uD83E(?:[\uDD0C\uDD0F\uDD18-\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5\uDEC3-\uDEC5\uDEF0\uDEF2-\uDEF8](?:\uD83C[\uDFFB-\uDFFF])?|[\uDD26\uDD35\uDD37-\uDD39\uDD3C-\uDD3E\uDDB8\uDDB9\uDDCD\uDDCF\uDDD4\uDDD6-\uDDDD](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDDDE\uDDDF](?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD0D\uDD0E\uDD10-\uDD17\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3F-\uDD45\uDD47-\uDD76\uDD78-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCC\uDDD0\uDDE0-\uDDFF\uDE70-\uDE7C\uDE80-\uDE8A\uDE8E-\uDEC2\uDEC6\uDEC8\uDECD-\uDEDC\uDEDF-\uDEEA\uDEEF]|\uDDCE(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?|\uDDD1(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3\uDE70]|\uDD1D\u200D\uD83E\uDDD1|\uDDD1\u200D\uD83E\uDDD2(?:\u200D\uD83E\uDDD2)?|\uDDD2(?:\u200D\uD83E\uDDD2)?))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF])|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3\uDE70]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF]|\uDEEF\u200D\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3\uDE70]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF]|\uDEEF\u200D\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3\uDE70]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF]|\uDEEF\u200D\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3\uDE70]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF]|\uDEEF\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE])|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3\uDE70]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF]|\uDEEF\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE])))?))?|\uDEF1(?:\uD83C(?:\uDFFB(?:\u200D\uD83E\uDEF2\uD83C[\uDFFC-\uDFFF])?|\uDFFC(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFD-\uDFFF])?|\uDFFD(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])?|\uDFFE(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFD\uDFFF])?|\uDFFF(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFE])?))?)/g,N_=/(\.mov|\.mp4|\.ogv|\.webm)(?:\?.*)?$/i,O_=/^(http(s?):)([/.\w\s-:]|%2*)*\.(?:jpg|img|png|gif|tiff|jpeg|webp|svg)(?:\?.*)?$/i,U_=P_();function M_(e){const t=e.trim();return t.length===0||t.length>10?!1:[...t].every(n=>!!n.match(U_))}function md(e){if(!e)return null;if(e.startsWith("#"))return e;const t=e.replace(".","");return`#${(e.startsWith("0x")?t.slice(2):t).toUpperCase().padStart(6,"0")}`}new Date().getTimezoneOffset()*60*1e3;function $_(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);t=(t<<5)-t+r,t=t&t}return Math.abs(t).toString(36)}const L_=fn("harkApi",!0),z_=e=>{try{const t=H_(e),n=G_(e),r=e.split("/"),s=r.length>10;return r.length<2?null:t&&r[5]?{id:Ge(r[5]),authorId:r[4],isDm:t}:n&&s&&r[9]?{id:Ge(r[9]),authorId:"",isDm:t}:null}catch(t){return L_.error("getPostInfoFromWer failed",t,e),null}},H_=e=>{const t=e.split("/");return t.length<2?!1:t[1]==="dm"},G_=e=>{const t=e.split("/");return t.length<2?!1:t[1]==="groups"};function q_(e){return t=>{if(!(t instanceof ze))throw new Error("malformed frond");const n=Bs.cord(t.head),r=e.find(s=>s.tag===n);if(!r)throw new Error("unknown frond tag");return r.get(t.tail)}}var Ro;(e=>{e.defaultConfig=Object.freeze({blockSeparator:`
`,includeLinebreaks:!0,includeRefTag:!0}),e.inlineConfig=Object.freeze({blockSeparator:" ",includeLinebreaks:!1,includeRefTag:!1})})(Ro||(Ro={}));function j_(e,t=Ro.defaultConfig){return e.map(n=>{switch(n.type){case"blockquote":return`> ${Ss(n.content)}`;case"paragraph":return Ss(n.content);case"image":return"(Image)";case"video":return"(Video)";case"reference":return t.includeRefTag?"(Ref)":"";case"code":return`\`\`\`${n.lang??""}
${n.content}
\`\`\``;case"header":return Ss(n.children);case"rule":return"---";case"list":return BD(n.list,t);case"bigEmoji":return n.emoji}}).join(t.blockSeparator).trim()}function BD(e,t){const n=[];if(n.push(Ss(e.content)),e.children!=null){const r=u=>{switch(e.type){case void 0:case"tasklist":case"unordered":return"-";case"ordered":return`${u+1}.`}},s=t.indentDepth??0,o=t.includeLinebreaks?s:0;n.push(...e.children.map((u,c)=>`${"	".repeat(o)}${r(c)} ${BD(u,{...t,indentDepth:s+1})}`))}return n.join(t.blockSeparator)}function Ss(e,t){return e.map(n=>W_(n)).join("")}function W_(e,t){switch(e.type){case"style":return Ss(e.children);case"text":return e.text;case"mention":return e.contactId;case"groupMention":return`@${e.group}`;case"lineBreak":return`
`;case"link":return e.text;case"task":{let n=e.checked?"[x] ":"[ ] ";return n+=Ss(e.children),n}}}function K_(e){const t=[];for(const n of e)if("type"in n&&n.type==="reference")t.push(n);else if("block"in n){const r=Z_(n.block);t.push(r)}else"inline"in n?t.push(...V_(n)):(console.warn("Unhandled verse type:",{verse:n}),t.push({type:"paragraph",content:[{type:"text",text:"Unknown content type"}]}));return t}function V_(e){const t=[];let n=[];function r(){if(n.length){if(!n.every(o=>typeof o=="string"&&o.trim()==="")){const o=Jr(n);o.length&&t.push({type:"paragraph",content:o})}n=[]}}return e.inline.length<3&&(!e.inline[1]||nd(e.inline[1]))&&typeof e.inline[0]=="string"&&e.inline[0].length<12&&M_(e.inline[0].trim())?[{type:"bigEmoji",emoji:e.inline[0]}]:(e.inline.forEach(s=>{uD(s)?(r(),t.push({type:"blockquote",content:Jr(s.blockquote)})):lD(s)?(r(),t.push({type:"code",content:s.code})):n.push(s)}),r(),t)}function Z_(e){const t=hf.is,n=r=>({type:"paragraph",content:[{type:"text",text:r}]});switch(!0){case t(e,"image"):return N_.test(e.image.src)?{type:"video",...e.image}:{type:"image",...e.image};case t(e,"listing"):return{type:"list",list:kD(e.listing)};case t(e,"header"):return{type:"header",level:e.header.tag,children:Jr(e.header.content)};case t(e,"code"):return{type:"code",content:e.code.code,lang:e.code.lang};case t(e,"rule"):return{type:"rule"};case t(e,"cite"):return Sd(e.cite)??n("Failed to parse");case t(e,"link"):return{...e.link.meta,type:"link",url:e.link.url};default:return G3(e),console.warn("Unhandled block type:",{block:e}),n("Unknown content type")}}function kD(e){return I3(e)?{type:e.list.type,content:Jr(e.list.contents),children:e.list.items.map(kD)}:{content:Jr(e.item)}}function Jr(e){const t=[];return e.forEach((n,r)=>{typeof n=="string"?t.push({type:"text",text:n}):iD(n)?t.push({type:"style",style:"bold",children:Jr(n.bold)}):sD(n)?t.push({type:"style",style:"italic",children:Jr(n.italics)}):aD(n)?t.push({type:"style",style:"strikethrough",children:Jr(n.strike)}):cD(n)?t.push({type:"style",style:"code",children:[{type:"text",text:n["inline-code"]}]}):oD(n)?t.push({type:"link",href:n.link.href,text:n.link.content??n.link.href}):nd(n)?r!==e.length-1&&t.push({type:"lineBreak"}):fD(n)?t.push({type:"mention",contactId:n.ship}):dD(n)?t.push({type:"groupMention",group:n.sect?n.sect:"all"}):hD(n)?t.push({type:"task",checked:n.task.checked,children:Jr(n.task.content)}):(console.warn("Unhandled inline type:",{inline:n}),t.push({type:"text",text:"Unknown content type"}))}),t}function RD(e,t=Ro.defaultConfig){return e==null?null:j_(K_(e),t)}const TD=fn("activityApi",!1);async function J_(){const e=await Ve({app:"activity",path:"/v4/activity"});return zs(e)}async function X_(e){let t="";if(Cu(e.id)==="channel"&&e.groupId){const s=Su(e.groupId),o=nD(e.id);t=`/${["v4","activity","threads",s.host,s.name,o.kind,o.host,o.name].join("/")}/`}else t=`/v4/activity/dm-threads/${e.id}/`;const n=await Ve({app:"activity",path:t});return zs(n).threadActivity}async function Y_(){return await Ve({app:"activity",path:"/volume-settings"})}const yd=30;async function Q_(){const e=await Ve({app:"activity",path:`/v5/feed/init/${yd}`}),t=eI(e),n=zs(e.summaries);return{events:t,relevantUnreads:n}}function eI(e){return[...Va(e.all,"all"),...Va(e.mentions,"mentions"),...Va(e.replies,"replies")]}async function tI({cursor:e,bucket:t}){TD.log(`fetching next activity page for bucket ${t} with cursor`,e);const n=qi(ur.fromUnix(e).toString()),r=`/v5/feed/${t}/${yd}/${n}/`,{feed:s,summaries:o}=await Ve({app:"activity",path:r}),u=Va(s,t),c=zs(o),d=nI(s);return{events:u,nextCursor:d,relevantUnreads:c}}function Va(e,t){const n={};return e.forEach(r=>{const s=r["source-key"];r.events.forEach(({time:o,event:u})=>{n[o]={sourceId:s,...u}})}),rI(n,t)}function nI(e){if(e.length===0)return null;const n=e[e.length-1].events[0];return $s(n.time)}function rI(e,t){return Object.entries(e).map(([n,r])=>PD({id:n,event:r,bucketId:t,sourceId:r.sourceId})).filter(Boolean)}function PD({id:e,sourceId:t,bucketId:n,event:r}){const s=typeof e=="number"?e:$s(e),o=r.notified,u={id:e.toString(),timestamp:s,shouldNotify:o,bucketId:n,sourceId:t};if("post"in r){const c=r.post,{authorId:d,postId:f}=jr(c.key);return{...u,type:"post",postId:f,authorId:d,channelId:c.channel,groupId:c.group,content:c.content,isMention:c.mention}}if("reply"in r){const c=r.reply,{authorId:d,postId:f}=jr(c.key),{postId:m,authorId:y}=jr(c.parent);return{...u,type:"reply",postId:f,parentId:m,authorId:d,parentAuthorId:y,channelId:c.channel,groupId:c.group,content:c.content,isMention:c.mention}}if("dm-post"in r){const c=r["dm-post"],{authorId:d,postId:f}=jr(c.key,!0);return{...u,type:"post",postId:f,authorId:d,channelId:"ship"in c.whom?c.whom.ship:c.whom.club,content:c.content,isMention:c.mention}}if("dm-reply"in r){const c=r["dm-reply"],{authorId:d,postId:f}=jr(c.key,!0),{postId:m,authorId:y}=jr(c.parent,!0);return{...u,type:"reply",authorId:d,postId:f,parentId:m,parentAuthorId:y,channelId:"ship"in c.whom?c.whom.ship:c.whom.club,content:c.content,isMention:c.mention}}if("flag-post"in r){const c=r["flag-post"],{authorId:d,postId:f}=jr(c.key);return{...u,type:"flag-post",postId:f,authorId:d,channelId:c.channel,groupId:c.group}}if("flag-reply"in r){const c=r["flag-reply"],{authorId:d,postId:f}=jr(c.key),{postId:m,authorId:y}=jr(c.parent);return{...u,type:"flag-reply",postId:f,parentId:m,parentAuthorId:y,authorId:d,channelId:c.channel,groupId:c.group}}if("group-ask"in r)return{...u,type:"group-ask",groupId:r["group-ask"].group,groupEventUserId:r["group-ask"].ship};if("contact"in r){const c=r.contact,d=iI(u.id,r);return d?{...u,type:"contact",contactUserId:c.who,...d}:null}return null}function iI(e,t){var r,s,o,u,c,d,f;const n=t.contact.update;if(!n)return null;if("nickname"in n)return{contactUpdateType:"nickname",contactUpdateValue:((r=n.nickname)==null?void 0:r.value)??""};if("bio"in n)return{contactUpdateType:"bio",contactUpdateValue:((s=n.bio)==null?void 0:s.value)??""};if("status"in n)return{contactUpdateType:"status",contactUpdateValue:((o=n.status)==null?void 0:o.value)??""};if("color"in n)return{contactUpdateType:"color",contactUpdateValue:md(((u=n.color)==null?void 0:u.value)??"")};if("avatar"in n)return{contactUpdateType:"avatarImage",contactUpdateValue:((c=n.avatar)==null?void 0:c.value)??""};if("groups"in n){const m=((d=n.groups)==null?void 0:d.value.map(y=>y.value))??[];return m.length===0?null:{contactUpdateType:"pinnedGroups",contactUpdateValue:((f=n.groups)==null?void 0:f.value.map(y=>y.value).join(","))??"",contactUpdateGroups:m.map(y=>({groupId:y,activityEventId:e}))??[]}}return null}function jr(e,t){const n=e.id.split("/")[0],r=Ge(t?e.id:e.time);return{authorId:n,postId:r}}function sI(e){Ki({app:"activity",path:"/v4"},async t=>{if(TD.log("activity update",by(()=>JSON.stringify(t))),"activity"in t&&Object.entries(t.activity).forEach(n=>{const[r,s]=n,o=oI(r);switch(o.type){case"base":e({type:"updateBaseUnread",unread:{id:gd,count:s.count,notify:s.notify,notifyCount:s["notify-count"],updatedAt:s.recency,notifTimestamp:s["recency-uv"]}});break;case"group":e({type:"updateGroupUnread",unread:ND(o.groupId,s)});break;case"channel":e({type:"updateChannelUnread",activity:Df(o.channelId,s,"dm")});break;case"thread":e({type:"updateThreadUnread",activity:OD(o.channelId,o.threadId,s,o.channelType)});break}}),"adjust"in t){const{source:n,volume:r}=t.adjust;if(ED(n)==="base"){const o=r?$a(r):"default";return e({type:"updateItemVolume",volumeUpdate:{itemId:"base",itemType:"base",level:o}})}if("group"in n)return e(r?{type:"updateItemVolume",volumeUpdate:{itemId:n.group,itemType:"group",level:$a(r)}}:{type:"removeItemVolume",itemId:n.group,itemType:"group"});if("channel"in n||"dm"in n){const o="channel"in n?n.channel.nest:"ship"in n.dm?n.dm.ship:n.dm.club;return e(r?{type:"updateItemVolume",volumeUpdate:{itemId:o,itemType:"channel",level:$a(r)}}:{type:"removeItemVolume",itemId:o,itemType:"channel"})}if("thread"in n||"dm-thread"in n){const o=aI(n);return e(r?{type:"updateItemVolume",volumeUpdate:{itemId:o,itemType:"thread",level:$a(r)}}:{type:"removeItemVolume",itemId:o,itemType:"thread"})}}if("allow-notifications"in t){const n=t["allow-notifications"];return e({type:"updatePushNotificationsSetting",value:n})}if("add"in t){const n=t.add.time,r=t.add["source-key"],s=t.add.event,o=PD({id:n,sourceId:r,bucketId:"all",event:s}),u=[];if(o&&(u.push(o),o!=null&&o.isMention&&u.push({...o,bucketId:"mentions"}),(o==null?void 0:o.type)==="reply"&&u.push({...o,bucketId:"replies"})),u.length>0)return e({type:"addActivityEvent",events:u})}})}function oI(e){if(e==="base")return{type:"base"};const t=e.split("/"),n=t[0];if(n==="group"){const r=t[1],s=t[2];return{type:"group",groupId:`${r}/${s}`}}if(n==="channel"){const r=t[1],s=t[2],o=t[3];return{type:"channel",channelId:`${r}/${s}/${o}`}}if(n==="ship"||n==="club")return{type:"channel",channelId:t[1]};if(n==="thread"){const r=t[1],s=t[2],o=t[3],u=Ge(t[4]);return{type:"thread",channelType:"channel",channelId:`${r}/${s}/${o}`,threadId:u}}if(n==="dm-thread"){const r=t[1],s=Ge(`${t[2]}/${t[3]}`);return{type:"thread",channelType:"dm",channelId:r,threadId:s}}return n==="contact"?{type:"contact",contactUserId:t[1]}:{type:"unknown"}}function aI(e){return"thread"in e?Ge(e.thread.key.time):"dm-thread"in e?Ge(e["dm-thread"].key.id):""}const zs=e=>{const t=[],n=[],r=[];let s;return Object.entries(e).forEach(([o,u])=>{o==="base"&&(s={id:gd,count:u.count,notify:u.notify,notifyCount:u["notify-count"],updatedAt:u.recency});const[c,...d]=o.split("/");if(c==="ship"||c==="club"){const f=d.join("/");n.push(Df(f,u,"dm"))}if(c==="group"){const f=d.join("/");t.push(ND(f,u))}if(c==="channel"){const f=d.join("/");n.push(Df(f,u,"channel"))}if(c==="thread"||c==="dm-thread"){const f=c==="dm-thread"?d[0]:d.slice(0,3).join("/"),m=d[d.length-1];r.push(OD(f,m,u,c==="dm-thread"?"dm":"channel"))}}),{baseUnread:s,channelUnreads:n,threadActivity:r,groupUnreads:t}},ND=(e,t)=>({groupId:e,count:t.count,notify:t.notify,updatedAt:t.recency,notifyCount:t["notify-count"]}),Df=(e,t,n)=>{var o;const r=n==="dm"?"id":"time",s=t.unread&&t.unread[r]?Ge(t.unread[r]):null;return{channelId:e,type:n,updatedAt:t.recency,count:t.count,notify:t.notify,countWithoutThreads:((o=t.unread)==null?void 0:o.count)??0,firstUnreadPostId:s,firstUnreadPostReceivedAt:s?$s(s):null}},OD=(e,t,n,r)=>{const s=r==="dm"?"id":"time",o=n.unread&&n.unread[s]?Ge(n.unread[s]):null;return{channelId:e,threadId:Ge(t),updatedAt:n.recency,count:n.count,notify:n.notify,firstUnreadPostId:o,firstUnreadPostReceivedAt:o?$s(o):null}};function Wr(){return{showAuthors:{displayName:"Show authors",type:"boolean"},showReplies:{displayName:"Show replies",type:"boolean"}}}const UD={"tlon.r0.collection.chat":{displayName:"Chat",enumTag:"chat",parametersSchema:Wr()},"tlon.r0.collection.gallery":{displayName:"Gallery",enumTag:"gallery",parametersSchema:Wr()},"tlon.r0.collection.notebook":{displayName:"Notebook",enumTag:"notebook",parametersSchema:Wr()},"tlon.r0.collection.carousel":{displayName:"Carousel",enumTag:"carousel",parametersSchema:{...Wr(),scrollDirection:{displayName:"Scroll direction",type:"radio",options:[{displayName:"Horizontal",value:"horizontal"},{displayName:"Vertical",value:"vertical"}]}}},"tlon.r0.collection.cards":{displayName:"Cards",enumTag:"cards",parametersSchema:Wr()},"tlon.r0.collection.sign":{displayName:"Sign",enumTag:"sign",parametersSchema:Wr()},"tlon.r0.collection.boardroom":{displayName:"Boardroom",enumTag:"boardroom",parametersSchema:Wr()},"tlon.r0.collection.strobe":{displayName:"Strobe",enumTag:"strobe",parametersSchema:{...Wr(),interval:{displayName:"Frame rate in milliseconds",type:"string"}}},"tlon.r0.collection.summaries":{displayName:"Summaries",enumTag:"summaries",parametersSchema:Wr()}},MD={"tlon.r0.input.chat":{displayName:"Chat",enumTag:"chat"},"tlon.r0.input.gallery":{displayName:"Gallery",enumTag:"gallery"},"tlon.r0.input.notebook":{displayName:"Notebook",enumTag:"notebook"},"tlon.r0.input.yo":{displayName:"Yo",enumTag:"yo",parametersSchema:{text:{displayName:"Message text",type:"string"}}},"tlon.r0.input.mic":{displayName:"Mic",enumTag:"mic"},"tlon.r0.input.color":{displayName:"Color",enumTag:"color"}},$D={"tlon.r0.content.chat":{displayName:"Chat",enumTag:"chat"},"tlon.r0.content.gallery":{displayName:"Gallery",enumTag:"gallery",parametersSchema:{embedded:{displayName:"Show frame",type:"boolean"},contentSize:{displayName:"Content size",type:"radio",options:[{displayName:"Large",value:"$l"},{displayName:"Small",value:"$s"}]}}},"tlon.r0.content.notebook":{displayName:"Notebook",enumTag:"notebook"},"tlon.r0.content.audio":{displayName:"Audio",enumTag:"audio"},"tlon.r0.content.color":{displayName:"Color",enumTag:"color"},"tlon.r0.content.raw":{displayName:"Raw",enumTag:"raw",parametersSchema:{fontFamily:{displayName:"Font family",type:"string"}}},"tlon.r0.content.yell":{displayName:"Yell",enumTag:"yell"},"tlon.r0.content.scratchpad":{displayName:"Scratchpad",enumTag:"scratchpad"}},Dd=Ed(UD),wd=Ed(MD),bd=Ed($D);var Cs;(e=>{function t(r){return typeof r=="string"?r:r.id}e.id=t;function n(r){return typeof r=="string"?{id:r}:r}e.coerce=n})(Cs||(Cs={}));exports.ChannelContentConfiguration=void 0;(e=>{function t(){return{draftInput:{id:wd.chat},defaultPostContentRenderer:{id:bd.chat},defaultPostCollectionRenderer:{id:Dd.chat}}}e.defaultConfiguration=t;function n(o){return Cs.coerce(o.draftInput)}e.draftInput=n;function r(o){return Cs.coerce(o.defaultPostContentRenderer)}e.defaultPostContentRenderer=r;function s(o){return Cs.coerce(o.defaultPostCollectionRenderer)}e.defaultPostCollectionRenderer=s})(exports.ChannelContentConfiguration||(exports.ChannelContentConfiguration={}));exports.StructuredChannelDescriptionPayload=void 0;(e=>{function t(r){return JSON.stringify(r)}e.encode=t;function n(r){if(r==null)return{};try{const s=JSON.parse(r);if(typeof s!="object"||!s)return{};if("channelContentConfiguration"in s){if(typeof s.channelContentConfiguration!="object")throw new Error("Invalid configuration");s.channelContentConfiguration=(o=>{const u={draftInput:wd.chat,defaultPostContentRenderer:bd.chat,defaultPostCollectionRenderer:Dd.chat,...o},c=Cs.coerce(u.defaultPostCollectionRenderer);return c.configuration={showAuthors:!0,showReplies:!0,...c.configuration},u})(s.channelContentConfiguration)}return s}catch{return{description:r.length===0?void 0:r}}}e.decode=n})(exports.StructuredChannelDescriptionPayload||(exports.StructuredChannelDescriptionPayload={}));function Ed(e){return Object.entries(e).reduce((t,[n,{enumTag:r}])=>(t[r]=n,t),{})}const uI=e=>fe({app:"chat",mark:"chat-remark-action",json:{whom:e,diff:{read:null}}}),cI=({id:e,members:t})=>fe({app:"chat",mark:"chat-club-create",json:{id:e,hive:[...t]}}),lI=({channel:e,accept:t})=>{const n=cr();if(e.type==="dm")return fe({app:"chat",mark:"chat-dm-rsvp",json:{ship:e.id,ok:t}});const r=Au(e.id,{team:{ship:n,ok:t}});return fe(r)},fI=async({channelId:e,meta:t})=>await lr(Au(e,{meta:b3(t)}),{app:"chat",path:"/"},n=>{if(!("diff"in n))return!1;const{diff:r}=n;return"meta"in r&&n.id===e},{tag:"updateDMMeta"});function Au(e,t){return{app:"chat",mark:"chat-club-action-0",json:{id:e,diff:{uid:"0v3",delta:t}}}}const l0=(e,t)=>e.map(n=>dI(n,t)),dI=(e,t)=>({id:e,type:"dm",title:"",description:"",isDmInvite:!!t,contactId:e,members:[{chatId:e,contactId:e,membershipType:"channel"}]}),hI=e=>{const t=cr();return Object.entries(e).map(([n,r])=>{const s=r.team.map(m=>({contactId:m,chatId:n,membershipType:"channel",status:"joined"})),o=r.hive.map(m=>({contactId:m,chatId:n,membershipType:"channel",status:"invited"})),u=s.some(m=>m.contactId===t),c=o.some(m=>m.contactId===t);if(!u&&!c)return null;const d=Bo(r.meta),f=exports.StructuredChannelDescriptionPayload.decode(d.description);return{id:n,type:"groupDm",...d,isDmInvite:!u&&c,members:[...s,...o],contentConfiguration:f.channelContentConfiguration,description:f.description}}).filter(Boolean)},gt=fn("postsApi",!1);function Yn(e,t,n){return id(e)?{app:"chat",mark:"chat-dm-action-1",json:{ship:e,diff:{id:t,delta:n}}}:{app:"chat",mark:"chat-club-action-1",json:{id:e,diff:{uid:"0v3",delta:{writ:{id:t,delta:n}}}}}}async function pI({channelId:e,postId:t,replyId:n}){const r=`/said/${e}/post/${t}${n?"/"+n:""}`,s=await Qr({app:"channels",path:r},3e3,void 0,{tag:"getPostReference"}),o=gI(s);return o.id=t,o}function gI(e){const t=e.nest;if("reply"in e.reference)return _u(t,e.reference.reply["id-post"],e.reference.reply.reply);if("post"in e.reference)return Si(t,e.reference.post);throw new Error("invalid response"+JSON.stringify(e,null,2))}function vd(e,t){return rd(e),kr(e,{post:t})}const mI=async({channelId:e,authorId:t,sentAt:n,content:r,blob:s,metadata:o})=>{gt.log("sending post",{channelId:e,authorId:t,sentAt:n,content:r});const u=$o(e);if(u==="dm"||u==="groupDm"){const f={add:{essay:{content:r,sent:n,author:t,kind:"/chat",meta:null,blob:s??null},time:null}},m=Yn(e,`${f.add.essay.author}/${qi(ur.fromUnix(f.add.essay.sent).toString())}`,f);await fe(m);return}const c=rD({content:r,blob:s,authorId:t,sentAt:n,channelType:u,metadata:o?{title:o.title||"",image:o.image||"",description:o.description||"",cover:o.cover||""}:void 0}),d=vd(e,{add:c});await fe(d),gt.log("post sent",{channelId:e,authorId:t,sentAt:n,content:r})},yI=async({channelId:e,postId:t,authorId:n,sentAt:r,content:s,parentId:o,metadata:u,blob:c})=>{gt.log("editing post",{channelId:e,postId:t,authorId:n,sentAt:r,content:s});const d=$o(e);if(Qn(e)||Br(e))throw gt.error("Cannot edit a post in a DM or group DM"),new Error("Cannot edit a post in a DM or group DM");if(o){gt.log("editing a reply");const w={post:{reply:{id:o,action:{edit:{id:t,memo:{author:n,content:s,sent:r}}}}}};gt.log("sending action",w),await fe(kr(e,w)),gt.log("action sent");return}gt.log("editing a post");const f=rD({content:s,authorId:n,sentAt:r,channelType:d,blob:c,metadata:u?{title:u.title||"",image:u.image||"",description:u.description||"",cover:u.cover||""}:void 0}),m=vd(e,{edit:{id:t,essay:f}});gt.log("sending action",m),await fe(m),gt.log("action sent")},DI=async({channelId:e,parentId:t,parentAuthor:n,content:r,sentAt:s,authorId:o})=>{if(Qn(e)||Br(e)){const d={reply:{id:`${o}/${qi(ur.fromUnix(s).toString())}`,meta:null,delta:{add:{memo:{content:r,author:o,sent:s},time:null}}}},f=Yn(e,`${n}/${t}`,d);await fe(f);return}const c=vd(e,{reply:{id:t,action:{add:{content:r,author:o,sent:s}}}});await fe(c)},wI=async e=>{const t=await Ve({app:"groups-ui",path:`/v5/init-posts/${e.channelCount}/${e.postCount}`}),n=Object.entries(t.channels).flatMap(([s,o])=>o?To(s,o).posts:[]),r=Object.entries(t.chat).flatMap(([s,o])=>o?To(s,o).posts:[]);return[...n,...r]},bI=async({channelId:e,cursor:t,mode:n="older",count:r=20,includeReplies:s=!1,sequenceBoundary:o=null})=>{var E;const u=Cu(e),c=u==="channel"?"channels":"chat",d=td(u==="dm"?"v3/dm":null,u==="club"?"v3/club":null,u==="channel"?"v4":null,e,u==="channel"?"posts":"writs",n,t?uu(t):null,r,u==="channel"?s?"post":"outline":null,u!=="channel"?s?"heavy":"light":null),f=await C3(Ve({app:c,path:d}),{posts:[]}),m=zD(e,f),{posts:y,numStubs:w}=EI(m.posts);return{...m,posts:y,numStubs:w,numDeletes:((E=m.deletedPosts)==null?void 0:E.length)??0,newestSequenceNum:f.newest}};function EI(e,t){if(!e.length)return{posts:[],numStubs:0};let n=1/0,r=0,s=0;const o=new Map;for(const f of e){if(typeof f.sequenceNum!="number"){gt.trackError("post missing sequence number while filling gaps");continue}f.sequenceNum<n&&(n=f.sequenceNum),f.sequenceNum>r&&(r=f.sequenceNum),o.set(f.sequenceNum,f)}const u=[],c=e[0];let d=c.sentAt;for(let f=n;f<=r;f++){const m=o.get(f);if(m)d=m.sentAt,u.push(m);else{const y=d+1;u.push(OI({channelId:c.channelId,type:c.type,sentAt:y,sequenceNum:f})),d=y,s++}}return{posts:u,numStubs:s}}const vI=async({afterCursor:e,count:t})=>{try{const{channels:n,dms:r}=await Ve({app:"groups-ui",path:td("v3/heads",e?uu(e):null,t)});return[...n,...r].map(s=>{const o="nest"in s?s.nest:s.whom,u=Si(o,s.latest);return{channelId:o,updatedAt:s.recency,latestPost:u}})}catch(n){return gt.trackError("failed to sync heads",{errorMessage:n.message,errorStack:n.stack}),[]}},SI=async({channelId:e,startCursor:t,endCursor:n,afterTime:r})=>{if(!Ai(e))throw new Error(`invalid channel id  ${e}:
      server does not implement this endpoint for non-group channels`);const s=await Ve({app:"channels",path:td(`v1/${e}/posts/changes`,uu(t),uu(n),nn("da",ur.fromUnix(r.valueOf())))});return zD(e,s)};async function CI({channelId:e,postId:t,emoji:n,our:r,postAuthor:s,parentAuthorId:o,parentId:u}){if(/^:[a-zA-Z0-9_+-]+:?$/.test(n)&&gt.trackError("Sending shortcode reaction to server",{channelId:e,postId:t,emoji:n,context:"addReaction_api",stack:new Error().stack}),Qn(e)||Br(e))if(Qn(e)){if(u){if(!u||!o){gt.trackError("Parent post not found",{postId:t,parentId:u,parentAuthorId:o,context:"addReaction_parentPostNotFound"});return}const d=`${o}/${u}`,f={reply:{id:`${s}/${t}`,meta:null,delta:{"add-react":{author:r,react:n}}}};await fe(Yn(e,d,f))}else{const d={"add-react":{react:n,author:r}},f=Yn(e,`${s}/${t}`,d);await fe(f)}return}else{if(u){if(!u||!o){gt.trackError("Parent post not found",{postId:t,parentId:u,parentAuthorId:o,context:"addReaction_parentPostNotFound"});return}const d=`${o}/${u}`,f={reply:{id:`${s}/${t}`,meta:null,delta:{"add-react":{react:n,author:r}}}};await fe(Yn(e,d,f))}else{const d={"add-react":{react:n,author:r}};await fe(Yn(e,`${s}/${t}`,d))}return}u?await fe(kr(e,{post:{reply:{id:u,action:{"add-react":{id:t,react:n,ship:r}}}}})):await fe(kr(e,{post:{"add-react":{id:t,react:n,ship:r}}}))}async function xI({channelId:e,postId:t,our:n,postAuthor:r,parentId:s,parentAuthorId:o}){if(Qn(e)||Br(e))if(Qn(e))if(s){if(!s||!o){gt.trackError("Parent post not found",{postId:t,parentId:s,parentAuthorId:o,context:"removeReaction_parentPostNotFound"});return}const c=`${o}/${s}`,d={reply:{id:`${r}/${t}`,meta:null,delta:{"del-react":n}}};return fe(Yn(e,c,d))}else{const c={"del-react":n};return fe(Yn(e,`${r}/${t}`,c))}else if(s){if(!s||!o){gt.trackError("Parent post not found",{postId:t,parentId:s,parentAuthorId:o,context:"removeReaction_parentPostNotFound"});return}const c=`${o}/${s}`,d={reply:{id:`${r}/${t}`,meta:null,delta:{"del-react":n}}};return fe(Yn(e,c,d))}else{const c={"del-react":n};return fe(Yn(e,`${r}/${t}`,c))}return s?await fe(kr(e,{post:{reply:{id:s,action:{"del-react":{id:t,ship:n}}}}})):await fe(kr(e,{post:{"del-react":{id:t,ship:n}}}))}async function AI(e){if(Ai(e.channelId)){const r={app:"channels",mark:"channel-action-1",json:{"toggle-post":{show:e.id}}};return fe(r)}const n={app:"chat",mark:"chat-toggle-message",json:{show:`${e.authorId}/${e.id}`}};return fe(n)}async function LD(e){if(Ai(e.channelId)){const r={app:"channels",mark:"channel-action-1",json:{"toggle-post":{hide:e.id}}};return fe(r)}const n={app:"chat",mark:"chat-toggle-message",json:{hide:`${e.authorId}/${e.id}`}};return fe(n)}const FI=e=>e.map(t=>Ge(t));async function _I(e,t,n,r){await LD(r);const s={app:"groups",mark:"group-action-4",json:{group:{flag:t,"a-group":{"flag-content":{nest:n,"post-key":{post:r.parentId?r.parentId:r.id,reply:r.parentId?r.id:null},src:e}}}}};return await fe(s)}const II=async()=>(await Ve({app:"channels",path:"/hidden-posts"})).map(t=>Ge(t)),BI=async()=>(await Ve({app:"chat",path:"/hidden-messages"})).map(t=>Ge(t));async function kI(e,t,n){const r=Qn(e)?Yn(e,`${n}/${t}`,{del:null}):Br(e)?Au(e,{writ:{id:`${n}/${t}`,delta:{del:null}}}):kr(e,{post:{del:t}});return await fe(r)}async function RI(e){let t=null;return Qn(e.channelId)?t=Yn(e.channelId,`${e.parentAuthorId}/${e.parentId}`,{reply:{id:`${e.authorId}/${e.postId}`,meta:null,delta:{del:null}}}):Br(e.channelId)?t=Au(e.channelId,{writ:{id:`${e.parentAuthorId}/${e.parentId}`,delta:{reply:{id:`${e.authorId}/${e.postId}`,meta:null,delta:{del:null}}}}}):t=kr(e.channelId,{post:{reply:{id:e.parentId,action:{del:e.postId}}}}),await fe(t)}const TI=async({postId:e,channelId:t,authorId:n})=>{if(gt.log("fetching post with replies",{postId:e,channelId:t,authorId:n}),!n&&(Qn(t)||Br(t)))throw new Error("author id is required to fetch posts for a dm or group dm");let r,s;if(Qn(t))r="chat",s=`/v2/dm/${t}/writs/writ/id/${n}/${e}`;else if(Br(t))r="chat",s=`/v2/club/${t}/writs/writ/id/${n}/${e}`;else if(Ai(t))r="channels",s=`/v4/${t}/posts/post/${e}`;else throw new Error("invalid channel id");const o=await Ve({app:r,path:s});return Si(t,o)};function zD(e,t){const n="writs"in t?t.writs:t.posts,r=To(e,n);return{older:t.older?qi(t.older):null,newer:t.newer?qi(t.newer):null,totalPosts:t.total,...r}}function To(e,t){const n=Object.entries(t),r=[],s=[];for(const[,o]of n){if(o===null)continue;const u=Si(e,o);Fu(o)&&r.push(u),s.push(u)}return s.sort((o,u)=>(o.receivedAt??0)-(u.receivedAt??0)),{posts:s,deletedPosts:r}}function ou(e){return typeof e=="string"?e:e.ship}function Si(e,t){var E,F,I,T,$;const n=e.split("/")[0],s=(V=>UI(V)?"notice":n==="chat"?"chat":n==="diary"?"note":n==="heap"?"block":"chat")(t);if(Fu(t))return{id:Ge(t.id),authorId:ou(t.author),channelId:e,type:s,sentAt:xs(t.id),isDeleted:!0,deletedAt:t["deleted-at"],receivedAt:xs(t.id),sequenceNum:t.seq?Number(t.seq):null};const[o,u]=HD(t==null?void 0:t.essay.content),c=Ge(t.seal.id),d=t.seal&&"time"in t.seal?Ge(t.seal.time.toString()):null,f=PI(t)?NI(c,e,t):null,m=n==="heap"&&o&&o.length===1&&"inline"in o[0]&&o[0].inline.length===1&&typeof o[0].inline[0]=="object"&&"link"in o[0].inline[0]&&o[0].inline[0].link.href.match(O_)?o[0].inline[0].link.href:null,y=[{block:{image:{src:m??"",alt:"heap image"}}}];let w=null;return"seq"in t.seal&&(w=Number(t.seal.seq)),{id:c,channelId:e,type:s,backendTime:d,sequenceNum:w,title:((E=t.essay.meta)==null?void 0:E.title)??"",image:((F=t.essay.meta)==null?void 0:F.image)??"",description:((I=t.essay.meta)==null?void 0:I.description)??"",cover:((T=t.essay.meta)==null?void 0:T.cover)??"",authorId:ou(t.essay.author),isEdited:"revision"in t&&t.revision!=="0",content:JSON.stringify(m?y:o),textContent:RD(t==null?void 0:t.essay.content,Ro.inlineConfig),sentAt:t.essay.sent,receivedAt:xs(c),replyCount:t==null?void 0:t.seal.meta.replyCount,replyTime:t==null?void 0:t.seal.meta.lastReply,replyContactIds:t==null?void 0:t.seal.meta.lastRepliers,images:GD(c,($=t.essay)==null?void 0:$.content),reactions:(()=>{const V=(t==null?void 0:t.seal.reacts)??{};if(Object.keys(V).length>0){const H=Object.entries(V).filter(([,Q])=>typeof Q=="string"&&/^:[a-zA-Z0-9_+-]+:?$/.test(Q));H.length>0&&gt.trackError("Shortcode reactions in initial post load",{postId:c,channelId:e,shortcodeReactions:H.map(([Q,te])=>({user:Q,value:te})),allReacts:V,context:"initial_post_load"})}return au(V,c)})(),replies:f,deliveryStatus:null,syncedAt:Date.now(),blob:t.essay.blob??null,...u}}function xs(e){return $s(e.split("/").pop()??e)}function PI(e){return!!(e.seal.replies&&!Array.isArray(e.seal.replies))}function Fu(e){return"type"in e&&e.type==="tombstone"}function NI(e,t,n){return Object.entries(n.seal.replies??{}).map(([,r])=>_u(t,e,r))}function _u(e,t,n){if(Fu(n))return{id:Ge(n.id),parentId:Ge(t),authorId:ou(n.author),channelId:e,type:"reply",sentAt:xs(n.id),isDeleted:!0,deletedAt:n["deleted-at"],receivedAt:xs(n.id),sequenceNum:null,syncedAt:Date.now()};const[r,s]=HD(n.memo.content),o=Ge(n.seal.id),u=n.seal&&"time"in n.seal?Ge(n.seal.time.toString()):null;return{id:o,channelId:e,type:"reply",authorId:ou(n.memo.author),isEdited:!!n.revision&&n.revision!=="0",parentId:Ge(t),reactions:au(n.seal.reacts,o),content:JSON.stringify(r),textContent:RD(n.memo.content),sentAt:n.memo.sent,sequenceNum:0,backendTime:u,receivedAt:xs(o),replyCount:0,images:GD(o,n.memo.content),syncedAt:Date.now(),...s}}function OI({channelId:e,type:t,sequenceNum:n,sentAt:r}){return{id:`sequence-stub-${e}-${n}`,type:t,channelId:e,authorId:"~zod",sentAt:r??Date.now(),receivedAt:r??Date.now(),content:null,hidden:!1,sequenceNum:n,isSequenceStub:!0}}function HD(e){if(!e)return[null,null];const t={hasAppReference:!1,hasChannelReference:!1,hasGroupReference:!1,hasLink:!1,hasImage:!1};return[e.map(r=>{if("block"in r&&"cite"in r.block){const s=Sd(r.block.cite);if(s)return s.referenceType==="app"?t.hasAppReference=!0:s.referenceType==="channel"?t.hasChannelReference=!0:s.referenceType==="group"&&(t.hasGroupReference=!0),s}return r}),t]}function Sd(e){if("chan"in e){const t=e.chan.nest,n=/\/([0-9\.]+(?=[$\/]?))/g,[r,s]=Array.from(e.chan.where.matchAll(n)).map(o=>o[1].replace(/\./g,""));return r?{type:"reference",referenceType:"channel",channelId:t,postId:qi(r),replyId:s?qi(s):void 0}:(console.error("found invalid ref",e),null)}else{if("group"in e)return{type:"reference",referenceType:"group",groupId:e.group};if("desk"in e){const t=e.desk.flag.split("/"),n=t[0],r=t[1];return!n||!r?(console.error("found invalid ref",e),null):{type:"reference",referenceType:"app",userId:n,appId:r}}}return null}function UI(e){return!e||Fu(e)?!1:(e==null?void 0:e.essay.kind)==="/chat/notice"}function GD(e,t){return(t||[]).reduce((n,r)=>(gD(r)&&pD(r.block)&&n.push({...r.block.image,postId:e}),n),[])}function au(e,t){return Object.entries(e).filter(([,n])=>{const r=typeof n=="string";return r||gt.log("toReactionsData: filtering out non-string reaction",{postId:t,reaction:n,type:typeof n}),r}).map(([n,r])=>(typeof r=="string"&&/^:[a-zA-Z0-9_+-]+:?$/.test(r)&&gt.trackError("Shortcode reaction detected in toReactionsData",{postId:t,contactId:n,reaction:r,context:"channel_reactions",stack:new Error().stack}),{contactId:n,postId:t,value:r}))}function uu(e){return typeof e=="string"?e:v3(e)}const Pn=fn("channelsApi",!1);function kr(e,t){return{app:"channels",mark:"channel-action-1",json:{channel:{nest:e,action:t}}}}const MI=async({id:e,...t})=>lr({app:"channels",mark:"channel-action-1",json:{create:t}},{app:"channels",path:"/v2"},n=>"create"in n.response&&n.nest===e,{tag:"createChannel"});async function $I(e,t){return lr({app:"channels",mark:"channel-action",json:{channel:{nest:e,action:{meta:t}}}},{app:"channels",path:"/v2"},n=>"meta"in n.response)}const LI=async(e,t)=>ad({desk:"groups",inputMark:"hook-setup-template-args",outputMark:"json",threadName:"channel-setup-from-template",body:{example:e,target:t}}),zI=async e=>{Ki({app:"channels",path:"/v2"},t=>{Pn.log("channels received event",t),e(qI(t))})};function HI(e,t){return Object.entries(e).map(([n,r])=>GI(n,r,t[n]??[]))}function GI(e,t,n){return{channelId:e,writers:t.perms.writers??[],readers:n,order:t.order.map(r=>Ge(r))}}const qI=e=>{if(Pn.log("channel event",{channelEvent:e}),e.hide!==void 0){const n=Ge(e.hide);return Pn.log("hide post event"),{type:"hidePost",postId:n}}if(e.show!==void 0){const n=Ge(e.show);return Pn.log("show post event"),{type:"showPost",postId:n}}const t=e.nest;if("response"in e){if("order"in e.response)return{type:"updateOrder",channelId:t,order:e.response.order.map(n=>Ge(n))};if("perm"in e.response)return{type:"updateWriters",channelId:t,writers:e.response.perm.writers,groupId:e.response.perm.group};if("meta"in e.response)return{type:"channelMetaUpdate",meta:e.response.meta};if("create"in e.response)return{type:"createChannel",channelId:t,writers:e.response.create.writers,groupId:e.response.create.group};if("join"in e.response)return{type:"joinChannelSuccess",channelId:t};if("leave"in e.response)return{type:"leaveChannelSuccess",channelId:t};if("posts"in e.response){const{posts:n}=e.response,r=Object.entries(n).filter(([s,o])=>o!==null).map(([s,o])=>Si(t,o));return{type:"initialPostsOnChannelJoin",channelId:t,posts:r}}if("post"in e.response){if(!("reply"in e.response.post["r-post"])){const n=Ge(e.response.post.id),r=e.response.post["r-post"];if("set"in r){if(r.set!==null){const s={id:n,...r.set};return Pn.log("add post event"),{type:"addPost",post:Si(t,s)}}return Pn.log("delete post event"),{type:"deletePost",postId:n,channelId:t}}else if("reacts"in r&&r.reacts!==null){const s=Object.entries(r.reacts).filter(([,u])=>typeof u=="string"&&/^:[a-zA-Z0-9_+-]+:?$/.test(u));s.length>0&&Pn.trackError("Shortcode reactions received from server (post)",{postId:n,shortcodeReactions:s.map(([u,c])=>({user:u,value:c})),allReacts:r.reacts,context:"channel_post_update"});const o=au(r.reacts,n);return Pn.log("update reactions event"),{type:"updateReactions",postId:n,reactions:o}}}if("reply"in e.response.post["r-post"]){const n=Ge(e.response.post.id),r=Ge(e.response.post["r-post"].reply.id),s=e.response.post["r-post"].reply["r-reply"];if("set"in s)return s.set!==null?(Pn.log("add reply event"),{type:"addPost",post:_u(t,n,s.set)}):(Pn.log("delete reply event"),{type:"deletePost",postId:r,channelId:t});if("reacts"in s&&s.reacts!==null){const o=Object.entries(s.reacts).filter(([,c])=>typeof c=="string"&&/^:[a-zA-Z0-9_+-]+:?$/.test(c));o.length>0&&Pn.trackError("Shortcode reactions received from server (reply)",{replyId:r,shortcodeReactions:o.map(([c,d])=>({user:c,value:d})),allReacts:s.reacts,context:"channel_reply_update"});const u=au(s.reacts,r);return Pn.log("update reply reactions event"),{type:"updateReactions",postId:r,reactions:u}}}}if("pending"in e.response){const n=e.response.pending.id;return{type:"markPostSent",cacheId:Ge(ur.fromUnix(n.sent).toString())}}}return Pn.log("unknown event",e),{type:"unknown"}},jI=async({groupId:e,currentUserId:t})=>{const n=Math.floor(Math.random()*1e4),r={kind:"chat",group:e,name:`welcome-${n}`,title:"Welcome",description:"Welcome to your new group!",meta:null,readers:[],writers:[]};return lr({app:"channels",mark:"channel-action",json:{create:r}},{app:"channels",path:"/v2"},s=>{const{response:o,nest:u}=s;return"create"in o&&u===`${r.kind}/${t}/${r.name}`},{tag:"createNewGroupDefaultChannel"})},WI=async e=>{const n=Ai(e.channelId),r=N3(e.query);let s;if(n)s=await Ve({app:"channels",path:`/${e.channelId}/search/bounded/text/${e.cursor?nn("ud",BigInt(e.cursor??0)):""}/500/${r}`});else{const c=Cu(e.channelId)==="dm"?"dm":"club";s=await Ve({app:"chat",path:`/${c}/${e.channelId}/search/bounded/text/${e.cursor?nn("ud",BigInt(e.cursor??0)):""}/500/${r}`})}const o=s.scan.map(c=>{if("post"in c)return Si(e.channelId,c.post);if("writ"in c)return Si(e.channelId,c.writ);if("reply"in c){const d=Ge(n?c.reply["id-post"]:c.reply.reply.seal["parent-id"]);return _u(e.channelId,d,c.reply.reply)}return!1}).filter(c=>c!==!1),u=s.last;return{posts:o,cursor:u}},KI=async(e,t)=>{await fe({app:"channels",mark:"channel-action",json:{channel:{nest:e,action:{order:t}}}})},VI=async e=>lr({app:"channels",mark:"channel-action",json:{channel:{nest:e,action:{leave:null}}}},{app:"channels",path:"/v2"},t=>"leave"in t.response&&t.response.leave===e,{tag:"leaveChannel"}),ZI=async(e,t)=>lr({app:"channels",mark:"channel-action",json:{channel:{nest:e,action:{join:t}}}},{app:"channels",path:"/v2"},n=>"join"in n.response&&n.nest===e,{tag:"joinChannel"});async function JI(e){return Qr({app:"channels",path:`/v1/hooks/preview/${e}`},1e4)}async function XI({channelId:e,writers:t}){return fe(kr(e,{"add-writers":t}))}async function YI({channelId:e,writers:t}){return fe(kr(e,{"del-writers":t}))}const Fr=fn("groupsApi",!1);function vt(e){return{app:"groups",mark:"group-action-4",json:e}}function QI(e,t){return{app:"groups",mark:"group-action-4",json:{group:{flag:e,"a-group":{navigation:t}}}}}const eB=async()=>{const e=await Ve({app:"groups-ui",path:"/pins"});return qD(e)},qD=e=>e.map(tB).reverse(),tB=(e,t)=>({type:hB(e),index:t,itemId:e});function nB({groupId:e,contactIds:t}){return fe(vt({group:{flag:e,"a-group":{entry:{ask:{ships:t,"a-ask":"approve"}}}}}))}function rB({groupId:e,contactIds:t}){return fe(vt({group:{flag:e,"a-group":{entry:{ask:{ships:t,"a-ask":"deny"}}}}}))}function iB(e){return fe({app:"groups",mark:"group-cancel",json:e})}function sB({groupId:e,contactIds:t}){return fe(vt({invite:{flag:e,ships:t,"a-invite":{token:null,note:null}}}))}function oB(e){return Fr.log("api rescinding",e),fe({app:"groups",mark:"group-rescind",json:e})}async function aB({groupId:e,contactIds:t}){return fe(vt({group:{flag:e,"a-group":{seat:{ships:t,"a-seat":{del:null}}}}}))}async function uB({groupId:e,contactIds:t}){return fe(vt({group:{flag:e,"a-group":{entry:{ban:{"add-ships":t}}}}}))}async function cB({groupId:e,contactIds:t}){return fe(vt({group:{flag:e,"a-group":{entry:{ban:{"del-ships":t}}}}}))}async function lB(e){return fe({app:"groups",mark:"group-leave",json:e})}function fB(e){return Fr.log("api knocking",e),fe({app:"groups",mark:"group-knock",json:e})}async function dB(e){return fe(vt({group:{flag:e.groupId,"a-group":{entry:{privacy:e.newPrivacy}}}}))}const hB=e=>e.startsWith("~")?e.split("/").length===2?"group":"dm":e.split("/").length===3?"channel":"groupDm",pB=async e=>await fe({app:"groups-ui",mark:"ui-action",json:{pins:{del:e}}}),gB=async e=>await fe({app:"groups-ui",mark:"ui-action",json:{pins:{add:e}}}),mB=async e=>{const t=await Qr({app:"groups",path:`/chan/${e}`},void 0,void 0,{tag:"getChannelPreview"});return t?jB({id:e,channel:t,groupId:t.group.flag}):null},yB=async e=>{const t=await Qr({app:"groups",path:`/gangs/${e}/preview`},void 0,void 0,{tag:"getGroupPreview"});return WD(e,t)},DB=async e=>{const t=await Qr({app:"groups",path:`/gangs/index/${e}`},3e4,void 0,{tag:"findGroupsHostedBy"});return Fr.log("findGroupsHostedBy result",t),MB(t)},jD="⁠",wB=async({group:e,placeHolderTitle:t,memberIds:n})=>{const r={groupId:e.id,meta:{title:e.title?e.title:t+jD,description:"",image:e.iconImage??"",cover:""},guestList:n??[],channels:(e.channels??[]).map(s=>({channelId:s.id,meta:{title:s.title??"",description:s.description??"",image:"",cover:""}}))};try{const s=await ad({desk:"groups",inputMark:"group-create-thread",threadName:"group-create-1",outputMark:"group-ui-2",body:r});return Fr.trackEvent(Ke.DebugGroupCreate,{context:"group-create-thread request succeeded"}),xd(e.id,s,!0)}catch(s){throw s instanceof Ls?Fr.trackEvent("Create Group Error",{severity:Yl.Critical,status:s.status,error:s.toString(),context:"group-create-thread request failed"}):Fr.trackEvent("Create Group Error",{severity:Yl.Critical,errorMessage:s.message,errorStack:s.stack,context:"group-create-thread unexpected error"}),s}},bB=async e=>{const t=`/v2/ui/groups/${e}`,n=await Ve({app:"groups",path:t});return xd(e,n,!0)},EB=async()=>{const e=await Ve({app:"groups",path:"/v2/groups"});return Cd(e,!0)},vB=async({groupId:e,meta:t})=>await lr(vt({group:{flag:e,"a-group":{meta:t}}}),{app:"groups",path:"/v1/groups"},n=>"r-group"in n?"meta"in n["r-group"]&&n.flag===e:!1,{tag:"updateGroupMeta"}),SB=async e=>await lr(vt({group:{flag:e,"a-group":{delete:null}}}),{app:"groups",path:"/v1/groups"},t=>"r-group"in t?"delete"in t["r-group"]&&t.flag===e:!1,{tag:"deleteGroup"}),CB=async({groupId:e,navSection:t})=>await lr(vt({group:{flag:e,"a-group":{section:{"section-id":t.sectionId,"a-section":{add:{title:t.title??"",description:t.description??"",image:t.iconImage??t.coverImageColor??"",cover:t.coverImage??t.coverImageColor??""}}}}}}),{app:"groups",path:"/v1/groups"},n=>"r-group"in n?"section"in n["r-group"]&&n.flag===e:!1,{tag:"addNavSection"}),xB=async({sectionId:e,groupId:t})=>await fe(vt({group:{flag:t,"a-group":{section:{"section-id":e,"a-section":{del:null}}}}})),AB=async({groupId:e,navSection:t})=>await fe(vt({group:{flag:e,"a-group":{section:{"section-id":t.sectionId,"a-section":{edit:{title:t.title??"",description:t.description??"",image:t.iconImage??t.coverImageColor??"",cover:t.coverImage??t.coverImageColor??""}}}}}})),FB=async({groupId:e,navSectionId:t,channelId:n})=>(Fr.log("addChannelToNavSection",{groupId:e,navSectionId:t,channelId:n}),await lr(vt({group:{flag:e,"a-group":{channel:{nest:n,"a-channel":{section:t}}}}}),{app:"groups",path:"/v1/groups"},r=>{if(!("r-group"in r))return!1;const s=r["r-group"];return"channel"in s&&s.channel.nest===n&&"section"in s.channel["r-channel"]},{tag:"addChannelToNavSection"})),_B=async({channelId:e,groupId:t,sectionId:n})=>await lr(vt({group:{flag:t,"a-group":{channel:{nest:e,"a-channel":{section:n}}}}}),{app:"groups",path:"/v1/groups"},r=>{if(!("r-group"in r))return!1;const s=r["r-group"];return"channel"in s&&s.channel.nest===e&&"section"in s.channel["r-channel"]},{tag:"addChannelToGroup"}),IB=async({groupId:e,channelId:t,channel:n})=>await fe(vt({group:{flag:e,"a-group":{channel:{nest:t,"a-channel":{edit:n}}}}})),BB=async({groupId:e,channelId:t})=>await fe(vt({group:{flag:e,"a-group":{channel:{nest:t,"a-channel":{del:null}}}}})),kB=async({groupId:e,navSections:t})=>{const n={};for(const s of t)n[s.sectionId]={meta:{title:s.title??"",description:s.description??"",image:s.iconImage??s.coverImageColor??"",cover:s.coverImage??s.coverImageColor??""},order:(s.channels??[]).sort((o,u)=>(o.channelIndex??0)-(u.channelIndex??0)).map(o=>o.channelId).filter(o=>!!o)};const r={sections:n,order:t.sort((s,o)=>(s.sectionIndex??0)-(o.sectionIndex??0)).map(s=>s.sectionId)};return await fe(QI(e,r))},RB=async({groupId:e,roleId:t,meta:n})=>await fe(vt({group:{flag:e,"a-group":{role:{roles:[t],"a-role":{add:{title:n.title??"",description:n.description??"",image:"",cover:""}}}}}})),TB=async({groupId:e,roleId:t})=>await fe(vt({group:{flag:e,"a-group":{role:{roles:[t],"a-role":{del:null}}}}})),PB=async({groupId:e,roleId:t,meta:n})=>await fe(vt({group:{flag:e,"a-group":{role:{roles:[t],"a-role":{edit:{title:n.title??"",description:n.description??"",image:"",cover:""}}}}}})),NB=async({groupId:e,roleId:t,ships:n})=>await fe(vt({group:{flag:e,"a-group":{seat:{ships:n,"a-seat":{"add-roles":[t]}}}}})),OB=async({groupId:e,roleId:t,ships:n})=>await fe(vt({group:{flag:e,"a-group":{seat:{ships:n,"a-seat":{"del-roles":[t]}}}}})),UB=(e,t)=>{const n=[];return t&&Object.entries(t).forEach(([r,s])=>{Object.entries(s).forEach(([o,u])=>{u.flaggers.forEach(c=>{n.push({groupId:e,channelId:r,postId:o,flaggedByContactId:c})})})}),n};function Cd(e,t){return e?Object.entries(e).map(([n,r])=>xd(n,r,t)):[]}function xd(e,t,n){var w,E,F,I,T,$,V;const r=cr(),{host:s}=Su(e),o=UB(e,t["flagged-content"]);Fr.log("admissions",t.admissions);const u=((F=(E=(w=t.admissions)==null?void 0:w.banned)==null?void 0:E.ships)==null?void 0:F.map(H=>({contactId:H,groupId:e})))??[];Fr.log("bannedMembers",u);const c=(I=t.admissions)!=null&&I.requests?Object.entries(t.admissions.requests).map(([H,Q])=>({contactId:H,groupId:e,requestedAt:Q.requestedAt||null})):[],d=(T=t.admissions)!=null&&T.invited?Object.entries(t.admissions.invited).filter(([H])=>{var Q;return!((Q=t.seats)!=null&&Q[H])}).map(([H])=>({membershipType:"group",contactId:H,chatId:e,roles:[],status:"invited",joinedAt:null})):[],f=(t.seats?Object.entries(t.seats):[]).map(([H,Q])=>f0({groupId:e,contactId:H,vessel:{sects:Q.roles,joined:Q.joined},status:"joined"})).concat(d.map(H=>f0({groupId:e,contactId:H.contactId,vessel:{sects:[],joined:0},status:"invited"})));Fr.log("joinRequests",c);const m=(t.roles?Object.entries(t.roles):[]).map(([H,Q])=>({id:H,groupId:e,...Bo(Q)})),y=((V=($=t.seats)==null?void 0:$[r])==null?void 0:V.roles)??[];return{id:e,roles:m,privacy:t.admissions.privacy,...KD(t.meta),haveInvite:n?!1:void 0,haveRequestedInvite:n?!1:void 0,currentUserIsMember:n,currentUserIsHost:s===r,isPersonalGroup:e===`${r}/${RF.slug}`,joinStatus:void 0,hostUserId:s,flaggedPosts:o,navSections:(t["section-order"]??[]).map((H,Q)=>{var De;const te=(De=t.sections)==null?void 0:De[H];return te?{id:`${e}-${H}`,sectionId:H,groupId:e,...Bo(te.meta),sectionIndex:Q,channels:(te.order??[]).map((rt,Je)=>({channelIndex:Je,channelId:rt,groupNavSectionId:`${e}-${H}`}))}:void 0}).filter(H=>!!H),members:f,bannedMembers:u,joinRequests:c,channels:t.channels?GB({channels:t.channels,groupId:e,currentUserRoles:y}):[]}}function MB(e){return Object.entries(e).map(([t,n])=>WD(t,n))}function WD(e,t){const n=cr(),{host:r}=Su(e);return{id:e,hostUserId:r,currentUserIsMember:!1,currentUserIsHost:r===n,privacy:bD(t),...Bo(t.meta)}}function $B(e,t){var c;const n=cr(),{host:r}=Su(e),s=bD(t.preview),o=zB(t),u=((c=t.invites)==null?void 0:c.filter(d=>d.valid))??[];return{id:e,hostUserId:r,privacy:s,currentUserIsMember:!1,currentUserIsHost:r===n,haveInvite:u.length>0,haveRequestedInvite:t.progress==="ask",joinStatus:o,...t.preview?KD(t.preview.meta):{}}}function LB(e){return e?Object.entries(e).map(([t,n])=>$B(t,n)):[]}function zB(e){if(e.progress)switch(e.progress){case"join":case"watch":return"joining";case"done":return;case"error":return"errored";default:return}}function KD(e){return{...Bo(e),title:HB(e.title)}}function HB(e){return e.at(-1)===jD?"":e}function GB({channels:e,groupId:t,currentUserRoles:n=[]}){return Object.entries(e).map(([r,s])=>qB({id:r,channel:s,groupId:t,currentUserRoles:n}))}function qB({id:e,channel:t,groupId:n,currentUserRoles:r=[]}){const{description:s,channelContentConfiguration:o}=exports.StructuredChannelDescriptionPayload.decode(t.meta.description),u=(t.readers??[]).map(w=>({channelId:e,roleId:w})),c=cr(),{host:d}=nD(e),f=t.readers.length===0,m=t.readers.some(w=>r.includes(w)),y=f||m;return{id:e,groupId:n,type:$o(e),iconImage:As(t.meta.image),title:As(t.meta.title),coverImage:As(t.meta.cover),description:s,contentConfiguration:o,currentUserIsHost:d===c,readerRoles:u,currentUserIsMember:y}}function jB({id:e,channel:t,groupId:n}){const{description:r,channelContentConfiguration:s}=exports.StructuredChannelDescriptionPayload.decode(t.meta.description);return{id:e,groupId:n,type:$o(e),iconImage:As(t.meta.image),title:As(t.meta.title),coverImage:As(t.meta.cover),description:r,contentConfiguration:s}}function f0({groupId:e,contactId:t,vessel:n,status:r}){return{membershipType:"group",contactId:t,chatId:e,roles:n.sects.map(s=>({groupId:e,contactId:t,roleId:s})),status:r,joinedAt:n.joined}}function As(e){return e===""?null:e}const En=fn("initApi",!1),WB=async()=>{const e=await Ve({app:"groups-ui",path:"/v6/init"});return En.crumb("got init data from api"),VB(e)};function KB(e){const t={};return Object.entries(e).forEach(([n,r])=>{r.channels&&Object.entries(r.channels).forEach(([s,o])=>{t[s]=o.readers??[]})}),t}const VB=e=>{En.crumb("converting init data to client data"),En.log("response.groups:",e.groups);const t=qD(e.pins),n=KB(e.groups),r=HI(e.channel.channels,n);En.crumb("extracting hidden posts");const s=e.channel["hidden-posts"]??[],o=e.chat["hidden-messages"]??[],u=FI([...s,...o]);En.crumb("extracting blocked users");const c=e.chat.blocked??[];En.crumb("converting groups to client data");const d=Cd(e.groups,!0);En.crumb("converting unjoined groups to client data");const f=LB(e.foreigns);En.crumb("converting dm channels to client data");const m=l0(e.chat.dms);En.crumb("converting group dm channels to client data");const y=hI(e.chat.clubs);En.crumb("converting invited dm channels to client data");const w=l0(e.chat.invited,!0);En.crumb("converting unreads to client data");const E=zs(e.activity??{});En.crumb("extracting joined groups");const F=d.map(T=>T.id);En.crumb("extracting joined channels");const I=r.map(T=>T.channelId);return En.crumb("returning init data"),{pins:t,groups:d,unjoinedGroups:f,unreads:E,channels:[...m,...y,...w],channelPerms:r,joinedGroups:F,joinedChannels:I,hiddenPostIds:u,blockedUsers:c}};function d0(e){const t=Vf("uw",e),n=new Y(t),r=Xy(n);if(!(r instanceof ze))throw new Error("Bad Sign: not a cell");const s=r.head;if(!(s instanceof Y))throw new Error("Bad Sign: provider not an atom");const o=nn("p",s.number),c=r.at(Y.fromInt(14));if(!c)throw new Error("Bad Sign: could not find dat");const d=JB(c);return d&&(d.provider=o,d.signature=e),d}function ZB(e){if(!(e instanceof ze))throw new Error("getHeadTaggedAttestation: not a cell");const t=e.tail;if(!(t instanceof ze))throw new Error("getHeadTaggedAttestation: tail is not a cell");return t.tail}function JB(e){const t=ZB(e);return q_([{tag:"half",get:QB},{tag:"full",get:ek}])(t)}function XB(e){if(!(e instanceof ze))throw new Error("Bad identifier: not a cell");const t=Bs.cord(e.head),n=Bs.cord(e.tail);if(t!=="twitter"&&t!=="phone")throw new Error(`Bad identifier: invalid type ${t}`);return{type:t,value:n}}function YB(e){if(!(e instanceof ze))throw new Error("Bad identifier: not a cell");const t=Bs.cord(e.head),n=Bs.cord(e.tail);if(t==="tweet")return{proofTweetId:n};throw new Error(`Bad proof: invalid type ${t}`)}function QB(e){if(!(e instanceof ze))throw"Bad half sign 1";const t=new Date(ur.toUnix(BigInt(e.head.toString()))).getTime();if(!(e.tail instanceof ze))throw"Bad half sign 2";const n=e.tail;if(!(n.head instanceof Y))throw new Error("Bad half Sign 3");const r=nn("p",n.head.number),s=Bs.cord(n.tail);return{signType:"half",when:t,type:s,contactId:r}}function ek(e){if(!(e instanceof ze))throw"Bad full sign 1";const t=new Date(ur.toUnix(BigInt(e.head.toString()))).getTime();if(!(e.tail instanceof ze))throw"Bad full sign 2";const n=e.tail;if(!(n.head instanceof Y))throw new Error("Bad full Sign 3");const r=nn("p",n.head.number),s=n.tail;if(!(s instanceof ze))throw new Error("Bad full Sign 4");const o=XB(s.head);let u={};const c=s.tail;return c instanceof ze&&(u=YB(c.tail)),{signType:"full",when:t,contactId:r,type:o.type,value:o.value,...u}}const tn=fn("lanyardApi",!1);function tk(e){Ki({app:"lanyard",path:"/v1/records"},t=>{tn.log("raw lanyard sub event",t),e({type:"Default"})})}async function nk(e){var c;const t=Math.floor(Math.random()*1e6),n=nn("uv",BigInt(t)),r=[null,[null,t],["valid-jam",new Y(Vf("uw",e))]],s=xr(r),o=Qr({app:"lanyard",path:`/v1/query/${n}`},void 0,void 0,{tag:"checkAttestedSignature"});await od({app:"lanyard",mark:"lanyard-query-1",noun:s});const u=await o;if(u){const d=(c=u.query)==null?void 0:c.result;return!!(d.live&&d.valid)}return!1}async function rk(e,t=null,n=null){var r,s;try{const o=await ik(e,n),u=(t==null?void 0:t.replaceAll(".",""))??"0x0",c=BigInt(u),d=Math.floor(Math.random()*1e6),f=nn("uv",BigInt(d)),m=[null,[null,d],"whose-bulk",c,o.last,o.add,o.del],y=xr(m),w=Qr({app:"lanyard",path:`/v1/query/${f}`},void 0,void 0,{tag:"discoverContacts"});try{await od({app:"lanyard",mark:"lanyard-query-1",noun:y})}catch(E){tn.trackEvent(Ke.ErrorContactMatching,{error:E,errorMessage:E.message,context:"discoverContacts"})}try{const E=await w;if(tn.log("discoverContacts: queryResponse",E),E&&E.query.nonce===f){if(E.query.result==="rate limited")return tn.trackEvent(Ke.ErrorContactMatching,{error:"rate limited",context:"discoverContacts",errorMessage:"rate limited"}),{matches:[],nextSalt:null};const F=(r=E.query.result)==null?void 0:r["next-salt"];return{matches:(s=E.query.result)!=null&&s.results?Object.entries(E.query.result.results).filter(([T,$])=>!!$):[],nextSalt:F}}return{matches:[],nextSalt:null}}catch(E){throw tn.error("error in discoverContacts",E),tn.trackEvent(Ke.ErrorContactMatching,{context:"discoverContacts",error:E,errorMessage:E.message}),E}}catch(o){throw tn.error("error discovering contacts",o),o}}async function ik(e,t){if(tn.log("diffContactBook: last phone contact set",t),t){const n=JSON.parse(t);tn.log("diffContactBook: lastSet",n);const r=e.filter(o=>!n.includes(o));tn.log("diffContactBook: diff",r),tn.trackEvent(Ke.DebugContactMatching,{context:"diffContactBook",diffSetLength:r.length});const s=n.filter(o=>!e.includes(o));return tn.log("diffContactBook: delSet",s),tn.trackEvent(Ke.DebugContactMatching,{context:"diffContactBook",delSetLength:s.length}),r.length===0&&s.length===0?(tn.log("diffContactBook: no changes, returning empty with lastSet"),{last:Kr(n),add:Kr([]),del:Kr([])}):(tn.log("diffContactBook: returning diff and del",r,s),{last:Kr(n),add:Kr(r),del:Kr(s)})}return tn.log("diffContactBook: no last set, returning with add"),{last:Kr([]),add:Kr(e),del:Kr([])}}function Kr(e){return Jf.set(e.map(t=>["phone",t]))}function h0(e){const t=`${e.contactId}:${e.type}:${e.value}:${e.provider}`;return $_(t)}const fo=fn("contactsApi",!1),sk=async()=>{const e=await Ve({app:"contacts",path:"/all"}),t=await Ve({app:"contacts",path:"/v1/book"}),n=await Ve({app:"groups-ui",path:"/suggested-contacts"});return ok({peersResponse:e,contactsResponse:t,suggestionsResponse:n})},ok=({peersResponse:e,contactsResponse:t,suggestionsResponse:n})=>{const r=new Set(Object.keys(t)),s=new Set(n),o=fk(e,{userIdsToOmit:r,contactSuggestions:s}),u=hk(t,{contactSuggestions:s});return[...o,...u]},ak=async e=>fe({app:"groups-ui",mark:"ui-hide-contact",json:e}),uk=async e=>fe({app:"groups-ui",mark:"ui-add-contact-suggestions",json:e}),ck=async e=>fe({app:"contacts",mark:"contact-action-1",json:{meet:e}}),lk=async(e,t)=>{const n={};return t.nickname!==void 0&&(n.nickname=t.nickname?{type:"text",value:t.nickname}:null),t.avatarImage!==void 0&&(n.avatar=t.avatarImage?{type:"look",value:t.avatarImage}:null),fe({app:"contacts",mark:"contact-action-1",json:{edit:{kip:e,contact:n}}})},fk=(e,t)=>Object.entries(e).filter(([n])=>t!=null&&t.userIdsToOmit?!t.userIdsToOmit.has(n):!0).flatMap(([n,r])=>{var s;return r===null?[]:[dk(n,r,{isContactSuggestion:(s=t==null?void 0:t.contactSuggestions)==null?void 0:s.has(n)})]}),dk=(e,t,n)=>{var s;const r=cr();return{id:e,peerNickname:(t==null?void 0:t.nickname)??null,peerAvatarImage:(t==null?void 0:t.avatar)??null,bio:(t==null?void 0:t.bio)??null,status:(t==null?void 0:t.status)??null,color:t!=null&&t.color?md(t.color):null,coverImage:(t==null?void 0:t.cover)??null,pinnedGroups:((s=t==null?void 0:t.groups)==null?void 0:s.map(o=>({groupId:o,contactId:e})))??[],attestations:VD(e,t),isContact:!1,isContactSuggestion:(n==null?void 0:n.isContactSuggestion)&&e!==r}};function VD(e,t){var s,o,u,c,d;if(!t)return null;const n=[];if(t["lanyard-twitter-0-sign"]&&t["lanyard-twitter-0-sign"].value)try{const f=d0(t["lanyard-twitter-0-sign"].value);if(f)if(f.contactId===e){const y=((s=t["lanyard-twitter-0-url"])==null?void 0:s.value)??null,w="~zod",E=f.type,F=f.signType==="full"?f.value:"",I=h0({provider:w,type:E,value:F,contactId:e}),T=f.signType==="full"?f.proofTweetId??null:null;n.push({id:I,provider:w,type:E,value:F,contactId:e,initiatedAt:f.when,discoverability:f.signType==="full"?"public":"verified",status:"verified",providerUrl:y,provingTweetId:T,signature:f.signature})}else fo.trackEvent(Ke.ErrorAttestation,{context:"forged attestation",type:"twitter",contactId:e,sign:(o=t["lanyard-twitter-0-sign"])==null?void 0:o.value})}catch(f){fo.trackEvent(Ke.ErrorNounParse,{parser:"twitter signed",error:f,errorMessage:f.message,noun:t["lanyard-twitter-0-sign"].value})}if(t["lanyard-phone-0-sign"]&&t["lanyard-phone-0-sign"].value)try{const f=d0(t["lanyard-phone-0-sign"].value);if(f)if(f.contactId===e){const y=((u=t["lanyard-phone-0-url"])==null?void 0:u.value)??null,w="~zod",E=f.type,F=f.signType==="full"?f.value:"",I=h0({provider:w,type:E,value:F,contactId:e}),T=f.signType==="full"?f.proofTweetId??null:null;f.contactId!==e&&fo.trackEvent(Ke.ErrorAttestation,{context:"forged attestation",contactId:e,sign:(c=t["lanyard-phone-0-sign"])==null?void 0:c.value}),n.push({id:I,provider:w,type:E,value:F,contactId:e,initiatedAt:f.when,discoverability:f.signType==="full"?"public":"verified",status:"verified",providerUrl:y,provingTweetId:T,signature:f.signature})}else fo.trackEvent(Ke.ErrorAttestation,{context:"forged attestation",type:"phone",contactId:e,sign:(d=t["lanyard-phone-0-sign"])==null?void 0:d.value})}catch(f){fo.trackEvent(Ke.ErrorNounParse,{parser:"phone signed",error:f,errorMessage:f.message,noun:t["lanyard-phone-0-sign"].value})}return n.length===0?null:n.map(f=>({contactId:e,attestationId:f.id,attestation:f}))}const hk=(e,t)=>Object.entries(e).flatMap(([n,r])=>{var s;return r===null?[]:[ZD(n,r,{isContactSuggestion:(s=t==null?void 0:t.contactSuggestions)==null?void 0:s.has(n)})]}),ZD=(e,t,n)=>{var o,u,c,d,f,m,y,w;const[r,s]=t;return{id:e,peerNickname:((o=r.nickname)==null?void 0:o.value)??null,customNickname:(u=s==null?void 0:s.nickname)==null?void 0:u.value,peerAvatarImage:((c=r.avatar)==null?void 0:c.value)??null,customAvatarImage:(d=s==null?void 0:s.avatar)==null?void 0:d.value,status:((f=r.status)==null?void 0:f.value)??null,bio:((m=r.bio)==null?void 0:m.value)??null,coverImage:((y=r.cover)==null?void 0:y.value)??null,color:r.color?md(r.color.value):null,pinnedGroups:((w=r.groups)==null?void 0:w.value.map(E=>({groupId:E.value,contactId:e})))??[],attestations:VD(e,r),isContact:!!s,isContactSuggestion:!1}},wf="pendingMemberDismissal:";function pk(e){if(e.startsWith(wf))return"groups";switch(e){case"messagesFilter":return"talk";case"activitySeenTimestamp":case"completedWayfindingSplash":case"completedWayfindingTutorial":case"disableTlonInfraEnhancement":case"enableTelemetry":return"groups";case"disableAvatars":case"disableNicknames":case"disableRemoteContent":case"disableAppTileUnreads":case"disableSpellcheck":case"showUnreadCounts":return"calmEngine";case"theme":return"display";default:return console.warn(`No explicit bucket defined for setting key: ${e}, defaulting to 'groups'`),"groups"}}const gk=async(e,t)=>fe({app:"settings",mark:"settings-event",json:{"put-entry":{desk:"groups","bucket-key":pk(e),"entry-key":e,value:t}}}),mk=async()=>{const e=await Ve({app:"settings",path:"/desk/groups"}),t=Dk(e),n=wk(e);return{settings:t,pendingMemberDismissals:n}},yk=e=>{switch(e){case"A → Z":return"alphabetical";case"Arranged":return"arranged";case"Recent":return"recent"}return"arranged"},Dk=e=>{var t,n,r,s,o,u,c,d,f,m,y,w,E,F,I,T,$,V,H,Q,te,ge,De;return{id:ID,theme:(t=e.desk.display)==null?void 0:t.theme,disableAppTileUnreads:(n=e.desk.calmEngine)==null?void 0:n.disableAppTileUnreads,disableAvatars:(r=e.desk.calmEngine)==null?void 0:r.disableAvatars,disableRemoteContent:(s=e.desk.calmEngine)==null?void 0:s.disableRemoteContent,disableSpellcheck:(o=e.desk.calmEngine)==null?void 0:o.disableSpellcheck,disableNicknames:(u=e.desk.calmEngine)==null?void 0:u.disableNicknames,orderedGroupPins:(c=e.desk.groups)==null?void 0:c.orderedGroupPins,sideBarSort:yk((d=e.desk.groups)==null?void 0:d.sideBarSort),groupSideBarSort:(f=e.desk.groups)==null?void 0:f.groupSideBarSort,showActivityMessage:(m=e.desk.groups)==null?void 0:m.showActivityMessage,enableTelemetry:(y=e.desk.groups)==null?void 0:y.enableTelemetry,logActivity:(w=e.desk.groups)==null?void 0:w.logActivity,analyticsId:(E=e.desk.groups)==null?void 0:E.analyticsId,seenWelcomeCard:(F=e.desk.groups)==null?void 0:F.seenWelcomeCard,newGroupFlags:(I=e.desk.groups)==null?void 0:I.newGroupFlags,groupsNavState:(T=e.desk.groups)==null?void 0:T.groupsNavState,messagesNavState:($=e.desk.groups)==null?void 0:$.messagesNavState,messagesFilter:(V=e.desk.talk)==null?void 0:V.messagesFilter,gallerySettings:(H=e.desk.heaps)==null?void 0:H.heapSettings,notebookSettings:JSON.stringify(e.desk.diary),activitySeenTimestamp:(Q=e.desk.groups)==null?void 0:Q.activitySeenTimestamp,completedWayfindingSplash:((te=e.desk.groups)==null?void 0:te.completedWayfindingSplash)??!1,completedWayfindingTutorial:((ge=e.desk.groups)==null?void 0:ge.completedWayfindingTutorial)??!1,disableTlonInfraEnhancement:((De=e.desk.groups)==null?void 0:De.disableTlonInfraEnhancement)??!1}},wk=e=>{const t=[];return Object.entries(e.desk.groups||{}).filter(([n])=>n.startsWith(wf)).forEach(([n,r])=>{const s=n.slice(wf.length);console.log(`Pending member dismissal for group ${s}: ${r}`);const o=Number(r);isNaN(o)||t.push({groupId:s,dismissedAt:o})}),t};async function bk(){var s;const e=await Ve({app:"hood",path:"/kiln/pikes"}),t=(await Ve({app:"docket",path:"/charges"})).initial,n=(e==null?void 0:e.groups)??{};return{groupsVersion:((t==null?void 0:t.groups)??{}).version??"n/a",groupsHash:n.hash??"n/a",groupsSyncNode:((s=n.sync)==null?void 0:s.ship)??"n/a"}}function Ek(e){Ki({app:"settings",path:"/desk/groups"},t=>{if(!("settings-event"in t))return;const n=t["settings-event"];if("put-entry"in n){const r=n["put-entry"];e({type:"updateSetting",setting:{[r["entry-key"]]:r.value}})}})}const vk=e=>({setHttpHandler(t){e.httpHandler=t},httpHandler(){return e.httpHandler},updateHttpClientConfig(t,n){var r;(r=e.httpHandler)==null||r.updateHttpClientConfig(t,n)},httpHandlerConfigs(){return e.httpHandler.httpHandlerConfigs()}}),Sk=e=>({httpHandler:e.httpHandler()});var Po;(function(e){e.HTTP="http",e.HTTPS="https"})(Po||(Po={}));var cu;(function(e){e.MD5="md5",e.CRC32="crc32",e.CRC32C="crc32c",e.SHA1="sha1",e.SHA256="sha256"})(cu||(cu={}));const bf="__smithy_context";class bt{constructor(t){P(this,"method");P(this,"protocol");P(this,"hostname");P(this,"port");P(this,"path");P(this,"query");P(this,"headers");P(this,"username");P(this,"password");P(this,"fragment");P(this,"body");this.method=t.method||"GET",this.hostname=t.hostname||"localhost",this.port=t.port,this.query=t.query||{},this.headers=t.headers||{},this.body=t.body,this.protocol=t.protocol?t.protocol.slice(-1)!==":"?`${t.protocol}:`:t.protocol:"https:",this.path=t.path?t.path.charAt(0)!=="/"?`/${t.path}`:t.path:"/",this.username=t.username,this.password=t.password,this.fragment=t.fragment}static clone(t){const n=new bt({...t,headers:{...t.headers}});return n.query&&(n.query=Ck(n.query)),n}static isInstance(t){if(!t)return!1;const n=t;return"method"in n&&"protocol"in n&&"hostname"in n&&"path"in n&&typeof n.query=="object"&&typeof n.headers=="object"}clone(){return bt.clone(this)}}function Ck(e){return Object.keys(e).reduce((t,n)=>{const r=e[n];return{...t,[n]:Array.isArray(r)?[...r]:r}},{})}class ji{constructor(t){P(this,"statusCode");P(this,"reason");P(this,"headers");P(this,"body");this.statusCode=t.statusCode,this.reason=t.reason,this.headers=t.headers||{},this.body=t.body}static isInstance(t){if(!t)return!1;const n=t;return typeof n.statusCode=="number"&&typeof n.headers=="object"}}function xk(e){return t=>async n=>{var s,o,u,c;const{request:r}=n;if(e.expectContinueHeader!==!1&&bt.isInstance(r)&&r.body&&e.runtime==="node"&&((o=(s=e.requestHandler)==null?void 0:s.constructor)==null?void 0:o.name)!=="FetchHttpHandler"){let d=!0;if(typeof e.expectContinueHeader=="number")try{d=(Number((u=r.headers)==null?void 0:u["content-length"])??((c=e.bodyLengthChecker)==null?void 0:c.call(e,r.body))??1/0)>=e.expectContinueHeader}catch{}else d=!!e.expectContinueHeader;d&&(r.headers.Expect="100-continue")}return t({...n,request:r})}}const Ak={step:"build",tags:["SET_EXPECT_HEADER","EXPECT_HEADER"],name:"addExpectContinueMiddleware",override:!0},Fk=e=>({applyToStack:t=>{t.add(xk(e),Ak)}}),Ts={WHEN_SUPPORTED:"WHEN_SUPPORTED",WHEN_REQUIRED:"WHEN_REQUIRED"},_k=Ts.WHEN_SUPPORTED,cl={WHEN_SUPPORTED:"WHEN_SUPPORTED",WHEN_REQUIRED:"WHEN_REQUIRED"},Ik=Ts.WHEN_SUPPORTED;var Qe;(function(e){e.MD5="MD5",e.CRC32="CRC32",e.CRC32C="CRC32C",e.CRC64NVME="CRC64NVME",e.SHA1="SHA1",e.SHA256="SHA256"})(Qe||(Qe={}));var p0;(function(e){e.HEADER="header",e.TRAILER="trailer"})(p0||(p0={}));const Ef=Qe.CRC32;function Bk(e,t,n){return e.$source||(e.$source={}),e.$source[t]=n,e}function At(e,t,n){e.__aws_sdk_context?e.__aws_sdk_context.features||(e.__aws_sdk_context.features={}):e.__aws_sdk_context={features:{}},e.__aws_sdk_context.features[t]=n}const g0=e=>{var t,n;return ji.isInstance(e)?((t=e.headers)==null?void 0:t.date)??((n=e.headers)==null?void 0:n.Date):void 0},Ad=e=>new Date(Date.now()+e),kk=(e,t)=>Math.abs(Ad(t).getTime()-e)>=3e5,m0=(e,t)=>{const n=Date.parse(e);return kk(n,t)?n-Date.now():t},wo=(e,t)=>{if(!t)throw new Error(`Property \`${e}\` is not resolved for AWS SDK SigV4Auth`);return t},JD=async e=>{var f,m,y;const t=wo("context",e.context),n=wo("config",e.config),r=(y=(m=(f=t.endpointV2)==null?void 0:f.properties)==null?void 0:m.authSchemes)==null?void 0:y[0],o=await wo("signer",n.signer)(r),u=e==null?void 0:e.signingRegion,c=e==null?void 0:e.signingRegionSet,d=e==null?void 0:e.signingName;return{config:n,signer:o,signingRegion:u,signingRegionSet:c,signingName:d}};class XD{async sign(t,n,r){var y;if(!bt.isInstance(t))throw new Error("The request is not an instance of `HttpRequest` and cannot be signed");const s=await JD(r),{config:o,signer:u}=s;let{signingRegion:c,signingName:d}=s;const f=r.context;if(((y=f==null?void 0:f.authSchemes)==null?void 0:y.length)??!1){const[w,E]=f.authSchemes;(w==null?void 0:w.name)==="sigv4a"&&(E==null?void 0:E.name)==="sigv4"&&(c=(E==null?void 0:E.signingRegion)??c,d=(E==null?void 0:E.signingName)??d)}return await u.sign(t,{signingDate:Ad(o.systemClockOffset),signingRegion:c,signingService:d})}errorHandler(t){return n=>{const r=n.ServerTime??g0(n.$response);if(r){const s=wo("config",t.config),o=s.systemClockOffset;s.systemClockOffset=m0(r,s.systemClockOffset),s.systemClockOffset!==o&&n.$metadata&&(n.$metadata.clockSkewCorrected=!0)}throw n}}successHandler(t,n){const r=g0(t);if(r){const s=wo("config",n.config);s.systemClockOffset=m0(r,s.systemClockOffset)}}}class Rk extends XD{async sign(t,n,r){var w;if(!bt.isInstance(t))throw new Error("The request is not an instance of `HttpRequest` and cannot be signed");const{config:s,signer:o,signingRegion:u,signingRegionSet:c,signingName:d}=await JD(r),m=(await((w=s.sigv4aSigningRegionSet)==null?void 0:w.call(s))??c??[u]).join(",");return await o.sign(t,{signingDate:Ad(s.systemClockOffset),signingRegion:m,signingService:d})}}const Fi=e=>e[bf]||(e[bf]={}),ar=e=>{if(typeof e=="function")return e;const t=Promise.resolve(e);return()=>t},Tk=(e,t)=>{if(!t||t.length===0)return e;const n=[];for(const r of t)for(const s of e)s.schemeId.split("#")[1]===r&&n.push(s);for(const r of e)n.find(({schemeId:s})=>s===r.schemeId)||n.push(r);return n};function Pk(e){const t=new Map;for(const n of e)t.set(n.schemeId,n);return t}const Nk=(e,t)=>(n,r)=>async s=>{var y;const o=e.httpAuthSchemeProvider(await t.httpAuthSchemeParametersProvider(e,r,s.input)),u=e.authSchemePreference?await e.authSchemePreference():[],c=Tk(o,u),d=Pk(e.httpAuthSchemes),f=Fi(r),m=[];for(const w of c){const E=d.get(w.schemeId);if(!E){m.push(`HttpAuthScheme \`${w.schemeId}\` was not enabled for this service.`);continue}const F=E.identityProvider(await t.identityProviderConfigProvider(e));if(!F){m.push(`HttpAuthScheme \`${w.schemeId}\` did not have an IdentityProvider configured.`);continue}const{identityProperties:I={},signingProperties:T={}}=((y=w.propertiesExtractor)==null?void 0:y.call(w,e,r))||{};w.identityProperties=Object.assign(w.identityProperties||{},I),w.signingProperties=Object.assign(w.signingProperties||{},T),f.selectedHttpAuthScheme={httpAuthOption:w,identity:await F(w.identityProperties),signer:E.signer};break}if(!f.selectedHttpAuthScheme)throw new Error(m.join(`
`));return n(s)},Ok={step:"serialize",tags:["HTTP_AUTH_SCHEME"],name:"httpAuthSchemeMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"},Uk=(e,{httpAuthSchemeParametersProvider:t,identityProviderConfigProvider:n})=>({applyToStack:r=>{r.addRelativeTo(Nk(e,{httpAuthSchemeParametersProvider:t,identityProviderConfigProvider:n}),Ok)}}),Mk={name:"serializerMiddleware"},$k=e=>t=>{throw t},Lk=(e,t)=>{},zk=e=>(t,n)=>async r=>{if(!bt.isInstance(r.request))return t(r);const o=Fi(n).selectedHttpAuthScheme;if(!o)throw new Error("No HttpAuthScheme was selected: unable to sign request");const{httpAuthOption:{signingProperties:u={}},identity:c,signer:d}=o,f=await t({...r,request:await d.sign(r.request,c,u)}).catch((d.errorHandler||$k)(u));return(d.successHandler||Lk)(f.response,u),f},YD={step:"finalizeRequest",tags:["HTTP_SIGNING"],name:"httpSigningMiddleware",aliases:["apiKeyMiddleware","tokenMiddleware","awsAuthMiddleware"],override:!0,relation:"after",toMiddleware:"retryMiddleware"},Hk=e=>({applyToStack:t=>{t.addRelativeTo(zk(),YD)}}),Fs=e=>{if(typeof e=="function")return e;const t=Promise.resolve(e);return()=>t},QD="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",y0=Object.entries(QD).reduce((e,[t,n])=>(e[n]=Number(t),e),{}),Gk=QD.split(""),_s=6,bo=8,qk=63,Ps=e=>{let t=e.length/4*3;e.slice(-2)==="=="?t-=2:e.slice(-1)==="="&&t--;const n=new ArrayBuffer(t),r=new DataView(n);for(let s=0;s<e.length;s+=4){let o=0,u=0;for(let f=s,m=s+3;f<=m;f++)if(e[f]!=="="){if(!(e[f]in y0))throw new TypeError(`Invalid character ${e[f]} in base64 string.`);o|=y0[e[f]]<<(m-f)*_s,u+=_s}else o>>=_s;const c=s/4*3;o>>=u%bo;const d=Math.floor(u/bo);for(let f=0;f<d;f++){const m=(d-f-1)*bo;r.setUint8(c+f,(o&255<<m)>>m)}}return new Uint8Array(n)},Yr=e=>new TextEncoder().encode(e),Ns=e=>typeof e=="string"?Yr(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e),Zi=e=>{if(typeof e=="string")return e;if(typeof e!="object"||typeof e.byteOffset!="number"||typeof e.byteLength!="number")throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return new TextDecoder("utf-8").decode(e)};function Wi(e){let t;typeof e=="string"?t=Yr(e):t=e;const n=typeof t=="object"&&typeof t.length=="number",r=typeof t=="object"&&typeof t.byteOffset=="number"&&typeof t.byteLength=="number";if(!n&&!r)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let s="";for(let o=0;o<t.length;o+=3){let u=0,c=0;for(let f=o,m=Math.min(o+3,t.length);f<m;f++)u|=t[f]<<(m-f-1)*bo,c+=bo;const d=Math.ceil(c/_s);u<<=d*_s-c;for(let f=1;f<=d;f++){const m=(d-f)*_s;s+=Gk[(u&qk<<m)>>m]}s+="==".slice(0,4-d)}return s}class Hi extends Uint8Array{static fromString(t,n="utf-8"){if(typeof t=="string")return n==="base64"?Hi.mutate(Ps(t)):Hi.mutate(Yr(t));throw new Error(`Unsupported conversion from ${typeof t} to Uint8ArrayBlobAdapter.`)}static mutate(t){return Object.setPrototypeOf(t,Hi.prototype),t}transformToString(t="utf-8"){return t==="base64"?Wi(this):Zi(this)}}const jk=typeof ReadableStream=="function"?ReadableStream:function(){};class Wk extends jk{}const vf=e=>{var t;return typeof ReadableStream=="function"&&(((t=e==null?void 0:e.constructor)==null?void 0:t.name)===ReadableStream.name||e instanceof ReadableStream)},Kk=({expectedChecksum:e,checksum:t,source:n,checksumSourceLocation:r,base64Encoder:s})=>{var d;if(!vf(n))throw new Error(`@smithy/util-stream: unsupported source type ${((d=n==null?void 0:n.constructor)==null?void 0:d.name)??n} in ChecksumStream.`);const o=s??Wi;if(typeof TransformStream!="function")throw new Error("@smithy/util-stream: unable to instantiate ChecksumStream because API unavailable: ReadableStream/TransformStream.");const u=new TransformStream({start(){},async transform(f,m){t.update(f),m.enqueue(f)},async flush(f){const m=await t.digest(),y=o(m);if(e!==y){const w=new Error(`Checksum mismatch: expected "${e}" but received "${y}" in response header "${r}".`);f.error(w)}else f.terminate()}});n.pipeThrough(u);const c=u.readable;return Object.setPrototypeOf(c,Wk.prototype),c};class Vk{constructor(t){P(this,"allocByteArray");P(this,"byteLength",0);P(this,"byteArrays",[]);this.allocByteArray=t}push(t){this.byteArrays.push(t),this.byteLength+=t.byteLength}flush(){if(this.byteArrays.length===1){const r=this.byteArrays[0];return this.reset(),r}const t=this.allocByteArray(this.byteLength);let n=0;for(let r=0;r<this.byteArrays.length;++r){const s=this.byteArrays[r];t.set(s,n),n+=s.byteLength}return this.reset(),t}reset(){this.byteArrays=[],this.byteLength=0}}function Zk(e,t,n){const r=e.getReader();let s=!1,o=0;const u=["",new Vk(f=>new Uint8Array(f))];let c=-1;const d=async f=>{const{value:m,done:y}=await r.read(),w=m;if(y){if(c!==-1){const E=ll(u,c);Eo(E)>0&&f.enqueue(E)}f.close()}else{const E=Yk(w,!1);if(c!==E&&(c>=0&&f.enqueue(ll(u,c)),c=E),c===-1){f.enqueue(w);return}const F=Eo(w);o+=F;const I=Eo(u[c]);if(F>=t&&I===0)f.enqueue(w);else{const T=Xk(u,c,w);!s&&o>t*2&&(s=!0,n==null||n.warn(`@smithy/util-stream - stream chunk size ${F} is below threshold of ${t}, automatically buffering.`)),T>=t?f.enqueue(ll(u,c)):await d(f)}}};return new ReadableStream({pull:d})}const Jk=Zk;function Xk(e,t,n){switch(t){case 0:return e[0]+=n,Eo(e[0]);case 1:case 2:return e[t].push(n),Eo(e[t])}}function ll(e,t){switch(t){case 0:const n=e[0];return e[0]="",n;case 1:case 2:return e[t].flush()}throw new Error(`@smithy/util-stream - invalid index ${t} given to flush()`)}function Eo(e){return(e==null?void 0:e.byteLength)??(e==null?void 0:e.length)??0}function Yk(e,t=!0){return t&&typeof Buffer<"u"&&e instanceof Buffer?2:e instanceof Uint8Array?1:typeof e=="string"?0:-1}const Qk=(e,t)=>{const{base64Encoder:n,bodyLengthChecker:r,checksumAlgorithmFn:s,checksumLocationName:o,streamHasher:u}=t,c=n!==void 0&&r!==void 0&&s!==void 0&&o!==void 0&&u!==void 0,d=c?u(s,e):void 0,f=e.getReader();return new ReadableStream({async pull(m){const{value:y,done:w}=await f.read();if(w){if(m.enqueue(`0\r
`),c){const E=n(await d);m.enqueue(`${o}:${E}\r
`),m.enqueue(`\r
`)}m.close()}else m.enqueue(`${(r(y)||0).toString(16)}\r
${y}\r
`)}})};async function eR(e,t){let n=0;const r=[],s=e.getReader();let o=!1;for(;!o;){const{done:d,value:f}=await s.read();if(f&&(r.push(f),n+=(f==null?void 0:f.byteLength)??0),n>=t)break;o=d}s.releaseLock();const u=new Uint8Array(Math.min(t,n));let c=0;for(const d of r){if(d.byteLength>u.byteLength-c){u.set(d.subarray(0,u.byteLength-c),c);break}else u.set(d,c);c+=d.length}return u}const Gi=e=>encodeURIComponent(e).replace(/[!'()*]/g,tR),tR=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`;function ew(e){const t=[];for(let n of Object.keys(e).sort()){const r=e[n];if(n=Gi(n),Array.isArray(r))for(let s=0,o=r.length;s<o;s++)t.push(`${n}=${Gi(r[s])}`);else{let s=n;(r||typeof r=="string")&&(s+=`=${Gi(r)}`),t.push(s)}}return t.join("&")}function D0(e,t){return new Request(e,t)}function nR(e=0){return new Promise((t,n)=>{e&&setTimeout(()=>{const r=new Error(`Request did not complete within ${e} ms`);r.name="TimeoutError",n(r)},e)})}const fl={supported:void 0};class Fd{constructor(t){P(this,"config");P(this,"configProvider");typeof t=="function"?this.configProvider=t().then(n=>n||{}):(this.config=t??{},this.configProvider=Promise.resolve(this.config)),fl.supported===void 0&&(fl.supported=typeof Request<"u"&&"keepalive"in D0("https://[::1]"))}static create(t){return typeof(t==null?void 0:t.handle)=="function"?t:new Fd(t)}destroy(){}async handle(t,{abortSignal:n,requestTimeout:r}={}){var V;this.config||(this.config=await this.configProvider);const s=r??this.config.requestTimeout,o=this.config.keepAlive===!0,u=this.config.credentials;if(n!=null&&n.aborted){const H=new Error("Request aborted");return H.name="AbortError",Promise.reject(H)}let c=t.path;const d=ew(t.query||{});d&&(c+=`?${d}`),t.fragment&&(c+=`#${t.fragment}`);let f="";if(t.username!=null||t.password!=null){const H=t.username??"",Q=t.password??"";f=`${H}:${Q}@`}const{port:m,method:y}=t,w=`${t.protocol}//${f}${t.hostname}${m?`:${m}`:""}${c}`,E=y==="GET"||y==="HEAD"?void 0:t.body,F={body:E,headers:new Headers(t.headers),method:y,credentials:u};(V=this.config)!=null&&V.cache&&(F.cache=this.config.cache),E&&(F.duplex="half"),typeof AbortController<"u"&&(F.signal=n),fl.supported&&(F.keepalive=o),typeof this.config.requestInit=="function"&&Object.assign(F,this.config.requestInit(t));let I=()=>{};const T=D0(w,F),$=[fetch(T).then(H=>{const Q=H.headers,te={};for(const De of Q.entries())te[De[0]]=De[1];return H.body!=null?{response:new ji({headers:te,reason:H.statusText,statusCode:H.status,body:H.body})}:H.blob().then(De=>({response:new ji({headers:te,reason:H.statusText,statusCode:H.status,body:De})}))}),nR(s)];return n&&$.push(new Promise((H,Q)=>{const te=()=>{const ge=new Error("Request aborted");ge.name="AbortError",Q(ge)};if(typeof n.addEventListener=="function"){const ge=n;ge.addEventListener("abort",te,{once:!0}),I=()=>ge.removeEventListener("abort",te)}else n.onabort=te})),Promise.race($).finally(I)}updateHttpClientConfig(t,n){this.config=void 0,this.configProvider=this.configProvider.then(r=>(r[t]=n,r))}httpHandlerConfigs(){return this.config??{}}}const tw=async e=>{var t;return typeof Blob=="function"&&e instanceof Blob||((t=e.constructor)==null?void 0:t.name)==="Blob"?Blob.prototype.arrayBuffer!==void 0?new Uint8Array(await e.arrayBuffer()):rR(e):iR(e)};async function rR(e){const t=await sR(e),n=Ps(t);return new Uint8Array(n)}async function iR(e){const t=[],n=e.getReader();let r=!1,s=0;for(;!r;){const{done:c,value:d}=await n.read();d&&(t.push(d),s+=d.length),r=c}const o=new Uint8Array(s);let u=0;for(const c of t)o.set(c,u),u+=c.length;return o}function sR(e){return new Promise((t,n)=>{const r=new FileReader;r.onloadend=()=>{if(r.readyState!==2)return n(new Error("Reader aborted too early"));const s=r.result??"",o=s.indexOf(","),u=o>-1?o+1:s.length;t(s.substring(u))},r.onabort=()=>n(new Error("Read aborted")),r.onerror=()=>n(r.error),r.readAsDataURL(e)})}const nw={},Sf={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`),nw[e]=t,Sf[t]=e}function rw(e){if(e.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2){const r=e.slice(n,n+2).toLowerCase();if(r in Sf)t[n/2]=Sf[r];else throw new Error(`Cannot decode unrecognized sequence ${r} as hexadecimal`)}return t}function Sn(e){let t="";for(let n=0;n<e.byteLength;n++)t+=nw[e[n]];return t}const w0="The stream has already been transformed.",iw=e=>{var s,o;if(!b0(e)&&!vf(e)){const u=((o=(s=e==null?void 0:e.__proto__)==null?void 0:s.constructor)==null?void 0:o.name)||e;throw new Error(`Unexpected stream implementation, expect Blob or ReadableStream, got ${u}`)}let t=!1;const n=async()=>{if(t)throw new Error(w0);return t=!0,await tw(e)},r=u=>{if(typeof u.stream!="function")throw new Error(`Cannot transform payload Blob to web stream. Please make sure the Blob.stream() is polyfilled.
If you are using React Native, this API is not yet supported, see: https://react-native.canny.io/feature-requests/p/fetch-streaming-body`);return u.stream()};return Object.assign(e,{transformToByteArray:n,transformToString:async u=>{const c=await n();if(u==="base64")return Wi(c);if(u==="hex")return Sn(c);if(u===void 0||u==="utf8"||u==="utf-8")return Zi(c);if(typeof TextDecoder=="function")return new TextDecoder(u).decode(c);throw new Error("TextDecoder is not available, please make sure polyfill is provided.")},transformToWebStream:()=>{if(t)throw new Error(w0);if(t=!0,b0(e))return r(e);if(vf(e))return e;throw new Error(`Cannot transform payload to web stream, got ${e}`)}})},b0=e=>typeof Blob=="function"&&e instanceof Blob;async function oR(e){return typeof e.stream=="function"&&(e=e.stream()),e.tee()}const La=async(e=new Uint8Array,t)=>{if(e instanceof Uint8Array)return Hi.mutate(e);if(!e)return Hi.mutate(new Uint8Array);const n=t.streamCollector(e);return Hi.mutate(await n)};function E0(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}const dl=e=>typeof e=="function"?e():e,sw=(e,t,n,r,s)=>({name:t,namespace:e,traits:n,input:r,output:s}),aR=e=>(t,n)=>async r=>{var y,w,E,F;const{response:s}=await t(r),{operationSchema:o}=Fi(n),[,u,c,d,f,m]=o??[];try{const I=await e.protocol.deserializeResponse(sw(u,c,d,f,m),{...e,...n},s);return{response:s,output:I}}catch(I){if(Object.defineProperty(I,"$response",{value:s,enumerable:!1,writable:!1,configurable:!1}),!("$metadata"in I)){const T="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";try{I.message+=`
  `+T}catch{!n.logger||((w=(y=n.logger)==null?void 0:y.constructor)==null?void 0:w.name)==="NoOpLogger"?console.warn(T):(F=(E=n.logger)==null?void 0:E.warn)==null||F.call(E,T)}typeof I.$responseBodyText<"u"&&I.$response&&(I.$response.body=I.$responseBodyText);try{if(ji.isInstance(s)){const{headers:$={}}=s,V=Object.entries($);I.$metadata={httpStatusCode:s.statusCode,requestId:hl(/^x-[\w-]+-request-?id$/,V),extendedRequestId:hl(/^x-[\w-]+-id-2$/,V),cfId:hl(/^x-[\w-]+-cf-id$/,V)}}}catch{}}throw I}},hl=(e,t)=>(t.find(([n])=>n.match(e))||[void 0,void 0])[1],uR=e=>(t,n)=>async r=>{var w;const{operationSchema:s}=Fi(n),[,o,u,c,d,f]=s??[],m=(w=n.endpointV2)!=null&&w.url&&e.urlParser?async()=>e.urlParser(n.endpointV2.url):e.endpoint,y=await e.protocol.serializeRequest(sw(o,u,c,d,f),r.input,{...e,...n,endpoint:m});return t({...r,request:y})},cR={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},lR={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function fR(e){return{applyToStack:t=>{t.add(uR(e),lR),t.add(aR(e),cR),e.protocol.setSerdeContext(e)}}}function bs(e){if(typeof e=="object")return e;e=e|0;const t={};let n=0;for(const r of["httpLabel","idempotent","idempotencyToken","sensitive","httpPayload","httpResponseCode","httpQueryParams"])(e>>n++&1)===1&&(t[r]=1);return t}const v0={it:Symbol.for("@smithy/nor-struct-it")},yi=class yi{constructor(t,n){P(this,"ref");P(this,"memberName");P(this,"symbol",yi.symbol);P(this,"name");P(this,"schema");P(this,"_isMemberSchema");P(this,"traits");P(this,"memberTraits");P(this,"normalizedTraits");this.ref=t,this.memberName=n;const r=[];let s=t,o=t;for(this._isMemberSchema=!1;pl(s);)r.push(s[1]),s=s[0],o=dl(s),this._isMemberSchema=!0;if(r.length>0){this.memberTraits={};for(let u=r.length-1;u>=0;--u){const c=r[u];Object.assign(this.memberTraits,bs(c))}}else this.memberTraits=0;if(o instanceof yi){const u=this.memberTraits;Object.assign(this,o),this.memberTraits=Object.assign({},u,o.getMemberTraits(),this.getMemberTraits()),this.normalizedTraits=void 0,this.memberName=n??o.memberName;return}if(this.schema=dl(o),dR(this.schema)?(this.name=`${this.schema[1]}#${this.schema[2]}`,this.traits=this.schema[3]):(this.name=this.memberName??String(o),this.traits=0),this._isMemberSchema&&!n)throw new Error(`@smithy/core/schema - NormalizedSchema member init ${this.getName(!0)} missing member name.`)}static[Symbol.hasInstance](t){const n=this.prototype.isPrototypeOf(t);return!n&&typeof t=="object"&&t!==null?t.symbol===this.symbol:n}static of(t){const n=dl(t);if(n instanceof yi)return n;if(pl(n)){const[r,s]=n;if(r instanceof yi)return Object.assign(r.getMergedTraits(),bs(s)),r;throw new Error(`@smithy/core/schema - may not init unwrapped member schema=${JSON.stringify(t,null,2)}.`)}return new yi(n)}getSchema(){const t=this.schema;return Array.isArray(t)&&t[0]===0?t[4]:t}getName(t=!1){const{name:n}=this;return!t&&n&&n.includes("#")?n.split("#")[1]:n||void 0}getMemberName(){return this.memberName}isMemberSchema(){return this._isMemberSchema}isListSchema(){const t=this.getSchema();return typeof t=="number"?t>=64&&t<128:t[0]===1}isMapSchema(){const t=this.getSchema();return typeof t=="number"?t>=128&&t<=255:t[0]===2}isStructSchema(){const t=this.getSchema();if(typeof t!="object")return!1;const n=t[0];return n===3||n===-3||n===4}isUnionSchema(){const t=this.getSchema();return typeof t!="object"?!1:t[0]===4}isBlobSchema(){const t=this.getSchema();return t===21||t===42}isTimestampSchema(){const t=this.getSchema();return typeof t=="number"&&t>=4&&t<=7}isUnitSchema(){return this.getSchema()==="unit"}isDocumentSchema(){return this.getSchema()===15}isStringSchema(){return this.getSchema()===0}isBooleanSchema(){return this.getSchema()===2}isNumericSchema(){return this.getSchema()===1}isBigIntegerSchema(){return this.getSchema()===17}isBigDecimalSchema(){return this.getSchema()===19}isStreaming(){const{streaming:t}=this.getMergedTraits();return!!t||this.getSchema()===42}isIdempotencyToken(){return!!this.getMergedTraits().idempotencyToken}getMergedTraits(){return this.normalizedTraits??(this.normalizedTraits={...this.getOwnTraits(),...this.getMemberTraits()})}getMemberTraits(){return bs(this.memberTraits)}getOwnTraits(){return bs(this.traits)}getKeySchema(){const[t,n]=[this.isDocumentSchema(),this.isMapSchema()];if(!t&&!n)throw new Error(`@smithy/core/schema - cannot get key for non-map: ${this.getName(!0)}`);const r=this.getSchema(),s=t?15:r[4]??0;return ho([s,0],"key")}getValueSchema(){const t=this.getSchema(),[n,r,s]=[this.isDocumentSchema(),this.isMapSchema(),this.isListSchema()],o=typeof t=="number"?63&t:t&&typeof t=="object"&&(r||s)?t[3+t[0]]:n?15:void 0;if(o!=null)return ho([o,0],r?"value":"member");throw new Error(`@smithy/core/schema - ${this.getName(!0)} has no value member.`)}getMemberSchema(t){const n=this.getSchema();if(this.isStructSchema()&&n[4].includes(t)){const r=n[4].indexOf(t),s=n[5][r];return ho(pl(s)?s:[s,0],t)}if(this.isDocumentSchema())return ho([15,0],t);throw new Error(`@smithy/core/schema - ${this.getName(!0)} has no no member=${t}.`)}getMemberSchemas(){const t={};try{for(const[n,r]of this.structIterator())t[n]=r}catch{}return t}getEventStreamMember(){if(this.isStructSchema()){for(const[t,n]of this.structIterator())if(n.isStreaming()&&n.isStructSchema())return t}return""}*structIterator(){if(this.isUnitSchema())return;if(!this.isStructSchema())throw new Error("@smithy/core/schema - cannot iterate non-struct schema.");const t=this.getSchema(),n=t[4].length;let r=t[v0.it];if(r&&n===r.length){yield*r;return}r=Array(n);for(let s=0;s<n;++s){const o=t[4][s],u=ho([t[5][s],0],o);yield r[s]=[o,u]}t[v0.it]=r}};P(yi,"symbol",Symbol.for("@smithy/nor"));let Dt=yi;function ho(e,t){if(e instanceof Dt)return Object.assign(e,{memberName:t,_isMemberSchema:!0});const n=Dt;return new n(e,t)}const pl=e=>Array.isArray(e)&&e.length===2,dR=e=>Array.isArray(e)&&e.length>=5,vr=class vr{constructor(t,n=new Map,r=new Map){P(this,"namespace");P(this,"schemas");P(this,"exceptions");this.namespace=t,this.schemas=n,this.exceptions=r}static for(t){return vr.registries.has(t)||vr.registries.set(t,new vr(t)),vr.registries.get(t)}register(t,n){const r=this.normalizeShapeId(t);vr.for(r.split("#")[0]).schemas.set(r,n)}getSchema(t){const n=this.normalizeShapeId(t);if(!this.schemas.has(n))throw new Error(`@smithy/core/schema - schema not found for ${n}`);return this.schemas.get(n)}registerError(t,n){const r=t,s=vr.for(r[1]);s.schemas.set(r[1]+"#"+r[2],r),s.exceptions.set(r,n)}getErrorCtor(t){const n=t;return vr.for(n[1]).exceptions.get(n)}getBaseException(){for(const t of this.exceptions.keys())if(Array.isArray(t)){const[,n,r]=t,s=n+"#"+r;if(s.startsWith("smithy.ts.sdk.synthetic.")&&s.endsWith("ServiceException"))return t}}find(t){return[...this.schemas.values()].find(t)}clear(){this.schemas.clear(),this.exceptions.clear()}normalizeShapeId(t){return t.includes("#")?t:this.namespace+"#"+t}};P(vr,"registries",new Map);let Et=vr;const hR=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],pR=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Cf(e){const t=e.getUTCFullYear(),n=e.getUTCMonth(),r=e.getUTCDay(),s=e.getUTCDate(),o=e.getUTCHours(),u=e.getUTCMinutes(),c=e.getUTCSeconds(),d=s<10?`0${s}`:`${s}`,f=o<10?`0${o}`:`${o}`,m=u<10?`0${u}`:`${u}`,y=c<10?`0${c}`:`${c}`;return`${hR[r]}, ${d} ${pR[n]} ${t} ${f}:${m}:${y} GMT`}const S0=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Jt=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0")),_d=()=>{if(S0)return S0();const e=new Uint8Array(16);return crypto.getRandomValues(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128,Jt[e[0]]+Jt[e[1]]+Jt[e[2]]+Jt[e[3]]+"-"+Jt[e[4]]+Jt[e[5]]+"-"+Jt[e[6]]+Jt[e[7]]+"-"+Jt[e[8]]+Jt[e[9]]+"-"+Jt[e[10]]+Jt[e[11]]+Jt[e[12]]+Jt[e[13]]+Jt[e[14]]+Jt[e[15]]},wi=function(t){return Object.assign(new String(t),{deserializeJSON(){return JSON.parse(String(t))},toString(){return String(t)},toJSON(){return String(t)}})};wi.from=e=>e&&typeof e=="object"&&(e instanceof wi||"deserializeJSON"in e)?e:typeof e=="string"||Object.getPrototypeOf(e)===String.prototype?wi(String(e)):wi(JSON.stringify(e));wi.fromObject=wi.from;function gR(e){return(e.includes(",")||e.includes('"'))&&(e=`"${e.replace(/"/g,'\\"')}"`),e}const Id="(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun)(?:[ne|u?r]?s?day)?",Bd="(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)",kd="(\\d?\\d):(\\d{2}):(\\d{2})(?:\\.(\\d+))?",ow="(\\d?\\d)",aw="(\\d{4})",mR=new RegExp(/^(\d{4})-(\d\d)-(\d\d)[tT](\d\d):(\d\d):(\d\d)(\.(\d+))?(([-+]\d\d:\d\d)|[zZ])$/),yR=new RegExp(`^${Id}, ${ow} ${Bd} ${aw} ${kd} GMT$`),DR=new RegExp(`^${Id}, ${ow}-${Bd}-(\\d\\d) ${kd} GMT$`),wR=new RegExp(`^${Id} ${Bd} ( [1-9]|\\d\\d) ${kd} ${aw}$`),bR=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ER=e=>{if(e==null)return;let t=NaN;if(typeof e=="number")t=e;else if(typeof e=="string"){if(!/^-?\d*\.?\d+$/.test(e))throw new TypeError("parseEpochTimestamp - numeric string invalid.");t=Number.parseFloat(e)}else typeof e=="object"&&e.tag===1&&(t=e.value);if(isNaN(t)||Math.abs(t)===1/0)throw new TypeError("Epoch timestamps must be valid finite numbers.");return new Date(Math.round(t*1e3))},vR=e=>{if(e==null)return;if(typeof e!="string")throw new TypeError("RFC3339 timestamps must be strings");const t=mR.exec(e);if(!t)throw new TypeError(`Invalid RFC3339 timestamp format ${e}`);const[,n,r,s,o,u,c,,d,f]=t;Zr(r,1,12),Zr(s,1,31),Zr(o,0,23),Zr(u,0,59),Zr(c,0,60);const m=new Date(Date.UTC(Number(n),Number(r)-1,Number(s),Number(o),Number(u),Number(c),Number(d)?Math.round(parseFloat(`0.${d}`)*1e3):0));if(m.setUTCFullYear(Number(n)),f.toUpperCase()!="Z"){const[,y,w,E]=/([+-])(\d\d):(\d\d)/.exec(f)||[void 0,"+",0,0],F=y==="-"?1:-1;m.setTime(m.getTime()+F*(Number(w)*60*60*1e3+Number(E)*60*1e3))}return m},SR=e=>{if(e==null)return;if(typeof e!="string")throw new TypeError("RFC7231 timestamps must be strings.");let t,n,r,s,o,u,c,d;if((d=yR.exec(e))?[,t,n,r,s,o,u,c]=d:(d=DR.exec(e))?([,t,n,r,s,o,u,c]=d,r=(Number(r)+1900).toString()):(d=wR.exec(e))&&([,n,t,s,o,u,c,r]=d),r&&u){const f=Date.UTC(Number(r),bR.indexOf(n),Number(t),Number(s),Number(o),Number(u),c?Math.round(parseFloat(`0.${c}`)*1e3):0);Zr(t,1,31),Zr(s,0,23),Zr(o,0,59),Zr(u,0,60);const m=new Date(f);return m.setUTCFullYear(Number(r)),m}throw new TypeError(`Invalid RFC7231 date-time value ${e}.`)};function Zr(e,t,n){const r=Number(e);if(r<t||r>n)throw new Error(`Value ${r} out of range [${t}, ${n}]`)}function CR(e,t,n){if(!Number.isInteger(n))throw new Error("Invalid number of delimiters ("+n+") for splitEvery.");const r=e.split(t),s=[];let o="";for(let u=0;u<r.length;u++)o===""?o=r[u]:o+=t+r[u],(u+1)%n===0&&(s.push(o),o="");return o!==""&&s.push(o),s}const uw=e=>{const t=e.length,n=[];let r=!1,s,o=0;for(let u=0;u<t;++u){const c=e[u];switch(c){case'"':s!=="\\"&&(r=!r);break;case",":r||(n.push(e.slice(o,u)),o=u+1);break}s=c}return n.push(e.slice(o)),n.map(u=>{u=u.trim();const c=u.length;return c<2?u:(u[0]==='"'&&u[c-1]==='"'&&(u=u.slice(1,c-1)),u.replace(/\\"/g,'"'))})},C0=/^-?\d*(\.\d+)?$/;class Iu{constructor(t,n){P(this,"string");P(this,"type");if(this.string=t,this.type=n,!C0.test(t))throw new Error('@smithy/core/serde - NumericValue must only contain [0-9], at most one decimal point ".", and an optional negation prefix "-".')}toString(){return this.string}static[Symbol.hasInstance](t){if(!t||typeof t!="object")return!1;const n=t;return Iu.prototype.isPrototypeOf(t)||n.type==="bigDecimal"&&C0.test(n.string)}}class Bu{constructor(){P(this,"serdeContext")}setSerdeContext(t){this.serdeContext=t}}class xR extends Bu{constructor(n){super();P(this,"options");this.options=n}getRequestType(){return bt}getResponseType(){return ji}setSerdeContext(n){this.serdeContext=n,this.serializer.setSerdeContext(n),this.deserializer.setSerdeContext(n),this.getPayloadCodec()&&this.getPayloadCodec().setSerdeContext(n)}updateServiceEndpoint(n,r){if("url"in r){n.protocol=r.url.protocol,n.hostname=r.url.hostname,n.port=r.url.port?Number(r.url.port):void 0,n.path=r.url.pathname,n.fragment=r.url.hash||void 0,n.username=r.url.username||void 0,n.password=r.url.password||void 0,n.query||(n.query={});for(const[s,o]of r.url.searchParams.entries())n.query[s]=o;return n}else return n.protocol=r.protocol,n.hostname=r.hostname,n.port=r.port?Number(r.port):void 0,n.path=r.path,n.query={...r.query},n}setHostPrefix(n,r,s){var c,d;if((c=this.serdeContext)!=null&&c.disableHostPrefix)return;const o=Dt.of(r.input),u=bs(r.traits??{});if(u.endpoint){let f=(d=u.endpoint)==null?void 0:d[0];if(typeof f=="string"){const m=[...o.structIterator()].filter(([,y])=>y.getMergedTraits().hostLabel);for(const[y]of m){const w=s[y];if(typeof w!="string")throw new Error(`@smithy/core/schema - ${y} in input must be a string as hostLabel.`);f=f.replace(`{${y}}`,w)}n.hostname=f+n.hostname}}}deserializeMetadata(n){return{httpStatusCode:n.statusCode,requestId:n.headers["x-amzn-requestid"]??n.headers["x-amzn-request-id"]??n.headers["x-amz-request-id"],extendedRequestId:n.headers["x-amz-id-2"],cfId:n.headers["x-amz-cf-id"]}}async serializeEventStream({eventStream:n,requestSchema:r,initialRequest:s}){return(await this.loadEventStreamCapability()).serializeEventStream({eventStream:n,requestSchema:r,initialRequest:s})}async deserializeEventStream({response:n,responseSchema:r,initialResponseContainer:s}){return(await this.loadEventStreamCapability()).deserializeEventStream({response:n,responseSchema:r,initialResponseContainer:s})}async loadEventStreamCapability(){const{EventStreamSerde:n}=await Promise.resolve().then(()=>xM);return new n({marshaller:this.getEventStreamMarshaller(),serializer:this.serializer,deserializer:this.deserializer,serdeContext:this.serdeContext,defaultContentType:this.getDefaultContentType()})}getDefaultContentType(){throw new Error(`@smithy/core/protocols - ${this.constructor.name} getDefaultContentType() implementation missing.`)}async deserializeHttpMessage(n,r,s,o,u){return[]}getEventStreamMarshaller(){const n=this.serdeContext;if(!n.eventStreamMarshaller)throw new Error("@smithy/core - HttpProtocol: eventStreamMarshaller missing in serdeContext.");return n.eventStreamMarshaller}}class AR extends xR{async serializeRequest(t,n,r){const s={...n??{}},o=this.serializer,u={},c={},d=await r.endpoint(),f=Dt.of(t==null?void 0:t.input),m=f.getSchema();let y=!1,w;const E=new bt({protocol:"",hostname:"",port:void 0,path:"",fragment:void 0,query:u,headers:c,body:void 0});if(d){this.updateServiceEndpoint(E,d),this.setHostPrefix(E,t,s);const F=bs(t.traits);if(F.http){E.method=F.http[0];const[I,T]=F.http[1].split("?");E.path=="/"?E.path=I:E.path+=I;const $=new URLSearchParams(T??"");Object.assign(u,Object.fromEntries($))}}for(const[F,I]of f.structIterator()){const T=I.getMergedTraits()??{},$=s[F];if($==null&&!I.isIdempotencyToken()){if(T.httpLabel&&(E.path.includes(`{${F}+}`)||E.path.includes(`{${F}}`)))throw new Error(`No value provided for input HTTP label: ${F}.`);continue}if(T.httpPayload)I.isStreaming()?I.isStructSchema()?s[F]&&(w=await this.serializeEventStream({eventStream:s[F],requestSchema:f})):w=$:(o.write(I,$),w=o.flush()),delete s[F];else if(T.httpLabel){o.write(I,$);const V=o.flush();E.path.includes(`{${F}+}`)?E.path=E.path.replace(`{${F}+}`,V.split("/").map(E0).join("/")):E.path.includes(`{${F}}`)&&(E.path=E.path.replace(`{${F}}`,E0(V))),delete s[F]}else if(T.httpHeader)o.write(I,$),c[T.httpHeader.toLowerCase()]=String(o.flush()),delete s[F];else if(typeof T.httpPrefixHeaders=="string"){for(const[V,H]of Object.entries($)){const Q=T.httpPrefixHeaders+V;o.write([I.getValueSchema(),{httpHeader:Q}],H),c[Q.toLowerCase()]=o.flush()}delete s[F]}else T.httpQuery||T.httpQueryParams?(this.serializeQuery(I,$,u),delete s[F]):y=!0}return y&&s&&(o.write(m,s),w=o.flush()),E.headers=c,E.query=u,E.body=w,E}serializeQuery(t,n,r){const s=this.serializer,o=t.getMergedTraits();if(o.httpQueryParams){for(const[u,c]of Object.entries(n))if(!(u in r)){const d=t.getValueSchema();Object.assign(d.getMergedTraits(),{...o,httpQuery:u,httpQueryParams:void 0}),this.serializeQuery(d,c,r)}return}if(t.isListSchema()){const u=!!t.getMergedTraits().sparse,c=[];for(const d of n){s.write([t.getValueSchema(),o],d);const f=s.flush();(u||f!==void 0)&&c.push(f)}r[o.httpQuery]=c}else s.write([t,o],n),r[o.httpQuery]=s.flush()}async deserializeResponse(t,n,r){const s=this.deserializer,o=Dt.of(t.output),u={};if(r.statusCode>=300){const d=await La(r.body,n);throw d.byteLength>0&&Object.assign(u,await s.read(15,d)),await this.handleError(t,n,r,u,this.deserializeMetadata(r)),new Error("@smithy/core/protocols - HTTP Protocol error handler failed to throw.")}for(const d in r.headers){const f=r.headers[d];delete r.headers[d],r.headers[d.toLowerCase()]=f}const c=await this.deserializeHttpMessage(o,n,r,u);if(c.length){const d=await La(r.body,n);if(d.byteLength>0){const f=await s.read(o,d);for(const m of c)u[m]=f[m]}}else c.discardResponseBody&&await La(r.body,n);return u.$metadata=this.deserializeMetadata(r),u}async deserializeHttpMessage(t,n,r,s,o){let u;s instanceof Set?u=o:u=s;let c=!0;const d=this.deserializer,f=Dt.of(t),m=[];for(const[y,w]of f.structIterator()){const E=w.getMemberTraits();if(E.httpPayload){if(c=!1,w.isStreaming())w.isStructSchema()?u[y]=await this.deserializeEventStream({response:r,responseSchema:f}):u[y]=iw(r.body);else if(r.body){const I=await La(r.body,n);I.byteLength>0&&(u[y]=await d.read(w,I))}}else if(E.httpHeader){const F=String(E.httpHeader).toLowerCase(),I=r.headers[F];if(I!=null)if(w.isListSchema()){const T=w.getValueSchema();T.getMergedTraits().httpHeader=F;let $;T.isTimestampSchema()&&T.getSchema()===4?$=CR(I,",",2):$=uw(I);const V=[];for(const H of $)V.push(await d.read(T,H.trim()));u[y]=V}else u[y]=await d.read(w,I)}else if(E.httpPrefixHeaders!==void 0){u[y]={};for(const[F,I]of Object.entries(r.headers))if(F.startsWith(E.httpPrefixHeaders)){const T=w.getValueSchema();T.getMergedTraits().httpHeader=F,u[y][F.slice(E.httpPrefixHeaders.length)]=await d.read(T,I)}}else E.httpResponseCode?u[y]=r.statusCode:m.push(y)}return m.discardResponseBody=c,m}}function Rd(e,t){if(t.timestampFormat.useTrait&&e.isTimestampSchema()&&(e.getSchema()===5||e.getSchema()===6||e.getSchema()===7))return e.getSchema();const{httpLabel:n,httpPrefixHeaders:r,httpHeader:s,httpQuery:o}=e.getMergedTraits();return(t.httpBindings?typeof r=="string"||s?6:o||n?5:void 0:void 0)??t.timestampFormat.default}class cw extends Bu{constructor(n){super();P(this,"settings");this.settings=n}read(n,r){var o;const s=Dt.of(n);if(s.isListSchema())return uw(r).map(u=>this.read(s.getValueSchema(),u));if(s.isBlobSchema())return(((o=this.serdeContext)==null?void 0:o.base64Decoder)??Ps)(r);if(s.isTimestampSchema())switch(Rd(s,this.settings)){case 5:return vR(r);case 6:return SR(r);case 7:return ER(r);default:return console.warn("Missing timestamp format, parsing value with Date constructor:",r),new Date(r)}if(s.isStringSchema()){const u=s.getMergedTraits().mediaType;let c=r;if(u)return s.getMergedTraits().httpHeader&&(c=this.base64ToUtf8(c)),(u==="application/json"||u.endsWith("+json"))&&(c=wi.from(c)),c}return s.isNumericSchema()?Number(r):s.isBigIntegerSchema()?BigInt(r):s.isBigDecimalSchema()?new Iu(r,"bigDecimal"):s.isBooleanSchema()?String(r).toLowerCase()==="true":r}base64ToUtf8(n){var r,s;return(((r=this.serdeContext)==null?void 0:r.utf8Encoder)??Zi)((((s=this.serdeContext)==null?void 0:s.base64Decoder)??Ps)(n))}}class FR extends Bu{constructor(n,r){super();P(this,"codecDeserializer");P(this,"stringDeserializer");this.codecDeserializer=n,this.stringDeserializer=new cw(r)}setSerdeContext(n){this.stringDeserializer.setSerdeContext(n),this.codecDeserializer.setSerdeContext(n),this.serdeContext=n}read(n,r){var c,d;const s=Dt.of(n),o=s.getMergedTraits(),u=((c=this.serdeContext)==null?void 0:c.utf8Encoder)??Zi;if(o.httpHeader||o.httpResponseCode)return this.stringDeserializer.read(s,u(r));if(o.httpPayload){if(s.isBlobSchema()){const f=((d=this.serdeContext)==null?void 0:d.utf8Decoder)??Yr;return typeof r=="string"?f(r):r}else if(s.isStringSchema())return"byteLength"in r?u(r):r}return this.codecDeserializer.read(s,r)}}class _R extends Bu{constructor(n){super();P(this,"settings");P(this,"stringBuffer","");this.settings=n}write(n,r){var o,u;const s=Dt.of(n);switch(typeof r){case"object":if(r===null){this.stringBuffer="null";return}if(s.isTimestampSchema()){if(!(r instanceof Date))throw new Error(`@smithy/core/protocols - received non-Date value ${r} when schema expected Date in ${s.getName(!0)}`);switch(Rd(s,this.settings)){case 5:this.stringBuffer=r.toISOString().replace(".000Z","Z");break;case 6:this.stringBuffer=Cf(r);break;case 7:this.stringBuffer=String(r.getTime()/1e3);break;default:console.warn("Missing timestamp format, using epoch seconds",r),this.stringBuffer=String(r.getTime()/1e3)}return}if(s.isBlobSchema()&&"byteLength"in r){this.stringBuffer=(((o=this.serdeContext)==null?void 0:o.base64Encoder)??Wi)(r);return}if(s.isListSchema()&&Array.isArray(r)){let f="";for(const m of r){this.write([s.getValueSchema(),s.getMergedTraits()],m);const y=this.flush(),w=s.getValueSchema().isTimestampSchema()?y:gR(y);f!==""&&(f+=", "),f+=w}this.stringBuffer=f;return}this.stringBuffer=JSON.stringify(r,null,2);break;case"string":const c=s.getMergedTraits().mediaType;let d=r;if(c&&((c==="application/json"||c.endsWith("+json"))&&(d=wi.from(d)),s.getMergedTraits().httpHeader)){this.stringBuffer=(((u=this.serdeContext)==null?void 0:u.base64Encoder)??Wi)(d.toString());return}this.stringBuffer=r;break;default:s.isIdempotencyToken()?this.stringBuffer=_d():this.stringBuffer=String(r)}}flush(){const n=this.stringBuffer;return this.stringBuffer="",n}}class IR{constructor(t,n,r=new _R(n)){P(this,"codecSerializer");P(this,"stringSerializer");P(this,"buffer");this.codecSerializer=t,this.stringSerializer=r}setSerdeContext(t){this.codecSerializer.setSerdeContext(t),this.stringSerializer.setSerdeContext(t)}write(t,n){const r=Dt.of(t),s=r.getMergedTraits();if(s.httpHeader||s.httpLabel||s.httpQuery){this.stringSerializer.write(r,n),this.buffer=this.stringSerializer.flush();return}return this.codecSerializer.write(r,n)}flush(){if(this.buffer!==void 0){const t=this.buffer;return this.buffer=void 0,t}return this.codecSerializer.flush()}}function BR(e,t,n){e.__smithy_context?e.__smithy_context.features||(e.__smithy_context.features={}):e.__smithy_context={features:{}},e.__smithy_context.features[t]=n}class kR{constructor(t){P(this,"authSchemes",new Map);for(const[n,r]of Object.entries(t))r!==void 0&&this.authSchemes.set(n,r)}getIdentityProvider(t){return this.authSchemes.get(t)}}const RR=e=>function(n){return lw(n)&&n.expiration.getTime()-Date.now()<e},TR=3e5,PR=RR(TR),lw=e=>e.expiration!==void 0,NR=(e,t,n)=>{if(e===void 0)return;const r=typeof e!="function"?async()=>Promise.resolve(e):e;let s,o,u,c=!1;const d=async f=>{o||(o=r(f));try{s=await o,u=!0,c=!1}finally{o=void 0}return s};return t===void 0?async f=>((!u||f!=null&&f.forceRefresh)&&(s=await d(f)),s):async f=>((!u||f!=null&&f.forceRefresh)&&(s=await d(f)),c?s:n(s)?(t(s)&&await d(f),s):(c=!0,s))},OR=(e,t,n)=>{let r,s,o,u=!1;const c=async()=>{s||(s=e());try{r=await s,o=!0,u=!1}finally{s=void 0}return r};return async d=>((!o||d!=null&&d.forceRefresh)&&(r=await c()),r)},UR=e=>(e.sigv4aSigningRegionSet=Fs(e.sigv4aSigningRegionSet),e),MR="X-Amz-Algorithm",$R="X-Amz-Credential",fw="X-Amz-Date",LR="X-Amz-SignedHeaders",zR="X-Amz-Expires",dw="X-Amz-Signature",hw="X-Amz-Security-Token",pw="authorization",gw=fw.toLowerCase(),HR="date",GR=[pw,gw,HR],qR=dw.toLowerCase(),xf="x-amz-content-sha256",jR=hw.toLowerCase(),WR={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},KR=/^proxy-/,VR=/^sec-/,gl="AWS4-HMAC-SHA256",ZR="AWS4-HMAC-SHA256-PAYLOAD",JR="UNSIGNED-PAYLOAD",XR=50,mw="aws4_request",YR=60*60*24*7,za={},ml=[],yl=(e,t,n)=>`${e}/${t}/${n}/${mw}`,QR=async(e,t,n,r,s)=>{const o=await x0(e,t.secretAccessKey,t.accessKeyId),u=`${n}:${r}:${s}:${Sn(o)}:${t.sessionToken}`;if(u in za)return za[u];for(ml.push(u);ml.length>XR;)delete za[ml.shift()];let c=`AWS4${t.secretAccessKey}`;for(const d of[n,r,s,mw])c=await x0(e,c,d);return za[u]=c},x0=(e,t,n)=>{const r=new e(t);return r.update(Ns(n)),r.digest()},A0=({headers:e},t,n)=>{const r={};for(const s of Object.keys(e).sort()){if(e[s]==null)continue;const o=s.toLowerCase();(o in WR||t!=null&&t.has(o)||KR.test(o)||VR.test(o))&&(!n||n&&!n.has(o))||(r[o]=e[s].trim().replace(/\s+/g," "))}return r},yw=e=>typeof ArrayBuffer=="function"&&e instanceof ArrayBuffer||Object.prototype.toString.call(e)==="[object ArrayBuffer]",Dl=async({headers:e,body:t},n)=>{for(const r of Object.keys(e))if(r.toLowerCase()===xf)return e[r];if(t==null)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(typeof t=="string"||ArrayBuffer.isView(t)||yw(t)){const r=new n;return r.update(Ns(t)),Sn(await r.digest())}return JR};class eT{format(t){const n=[];for(const o of Object.keys(t)){const u=Yr(o);n.push(Uint8Array.from([u.byteLength]),u,this.formatHeaderValue(t[o]))}const r=new Uint8Array(n.reduce((o,u)=>o+u.byteLength,0));let s=0;for(const o of n)r.set(o,s),s+=o.byteLength;return r}formatHeaderValue(t){switch(t.type){case"boolean":return Uint8Array.from([t.value?0:1]);case"byte":return Uint8Array.from([2,t.value]);case"short":const n=new DataView(new ArrayBuffer(3));return n.setUint8(0,3),n.setInt16(1,t.value,!1),new Uint8Array(n.buffer);case"integer":const r=new DataView(new ArrayBuffer(5));return r.setUint8(0,4),r.setInt32(1,t.value,!1),new Uint8Array(r.buffer);case"long":const s=new Uint8Array(9);return s[0]=5,s.set(t.value.bytes,1),s;case"binary":const o=new DataView(new ArrayBuffer(3+t.value.byteLength));o.setUint8(0,6),o.setUint16(1,t.value.byteLength,!1);const u=new Uint8Array(o.buffer);return u.set(t.value,3),u;case"string":const c=Yr(t.value),d=new DataView(new ArrayBuffer(3+c.byteLength));d.setUint8(0,7),d.setUint16(1,c.byteLength,!1);const f=new Uint8Array(d.buffer);return f.set(c,3),f;case"timestamp":const m=new Uint8Array(9);return m[0]=8,m.set(nT.fromNumber(t.value.valueOf()).bytes,1),m;case"uuid":if(!tT.test(t.value))throw new Error(`Invalid UUID received: ${t.value}`);const y=new Uint8Array(17);return y[0]=9,y.set(rw(t.value.replace(/\-/g,"")),1),y}}}var F0;(function(e){e[e.boolTrue=0]="boolTrue",e[e.boolFalse=1]="boolFalse",e[e.byte=2]="byte",e[e.short=3]="short",e[e.integer=4]="integer",e[e.long=5]="long",e[e.byteArray=6]="byteArray",e[e.string=7]="string",e[e.timestamp=8]="timestamp",e[e.uuid=9]="uuid"})(F0||(F0={}));const tT=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;let nT=class Dw{constructor(t){P(this,"bytes");if(this.bytes=t,t.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(t){if(t>9223372036854776e3||t<-9223372036854776e3)throw new Error(`${t} is too large (or, if negative, too small) to represent as an Int64`);const n=new Uint8Array(8);for(let r=7,s=Math.abs(Math.round(t));r>-1&&s>0;r--,s/=256)n[r]=s;return t<0&&_0(n),new Dw(n)}valueOf(){const t=this.bytes.slice(0),n=t[0]&128;return n&&_0(t),parseInt(Sn(t),16)*(n?-1:1)}toString(){return String(this.valueOf())}};function _0(e){for(let t=0;t<8;t++)e[t]^=255;for(let t=7;t>-1&&(e[t]++,e[t]===0);t--);}const rT=(e,t)=>{e=e.toLowerCase();for(const n of Object.keys(t))if(e===n.toLowerCase())return!0;return!1},iT=(e,t={})=>{var s,o;const{headers:n,query:r={}}=bt.clone(e);for(const u of Object.keys(n)){const c=u.toLowerCase();(c.slice(0,6)==="x-amz-"&&!((s=t.unhoistableHeaders)!=null&&s.has(c))||(o=t.hoistableHeaders)!=null&&o.has(c))&&(r[u]=n[u],delete n[u])}return{...e,headers:n,query:r}},I0=e=>{e=bt.clone(e);for(const t of Object.keys(e.headers))GR.indexOf(t.toLowerCase())>-1&&delete e.headers[t];return e},sT=({query:e={}})=>{const t=[],n={};for(const r of Object.keys(e)){if(r.toLowerCase()===qR)continue;const s=Gi(r);t.push(s);const o=e[r];typeof o=="string"?n[s]=`${s}=${Gi(o)}`:Array.isArray(o)&&(n[s]=o.slice(0).reduce((u,c)=>u.concat([`${s}=${Gi(c)}`]),[]).sort().join("&"))}return t.sort().map(r=>n[r]).filter(r=>r).join("&")},oT=e=>aT(e).toISOString().replace(/\.\d{3}Z$/,"Z"),aT=e=>typeof e=="number"?new Date(e*1e3):typeof e=="string"?Number(e)?new Date(Number(e)*1e3):new Date(e):e;class uT{constructor({applyChecksum:t,credentials:n,region:r,service:s,sha256:o,uriEscapePath:u=!0}){P(this,"service");P(this,"regionProvider");P(this,"credentialProvider");P(this,"sha256");P(this,"uriEscapePath");P(this,"applyChecksum");this.service=s,this.sha256=o,this.uriEscapePath=u,this.applyChecksum=typeof t=="boolean"?t:!0,this.regionProvider=ar(r),this.credentialProvider=ar(n)}createCanonicalRequest(t,n,r){const s=Object.keys(n).sort();return`${t.method}
${this.getCanonicalPath(t)}
${sT(t)}
${s.map(o=>`${o}:${n[o]}`).join(`
`)}

${s.join(";")}
${r}`}async createStringToSign(t,n,r,s){const o=new this.sha256;o.update(Ns(r));const u=await o.digest();return`${s}
${t}
${n}
${Sn(u)}`}getCanonicalPath({path:t}){if(this.uriEscapePath){const n=[];for(const o of t.split("/"))(o==null?void 0:o.length)!==0&&o!=="."&&(o===".."?n.pop():n.push(o));const r=`${t!=null&&t.startsWith("/")?"/":""}${n.join("/")}${n.length>0&&(t!=null&&t.endsWith("/"))?"/":""}`;return Gi(r).replace(/%2F/g,"/")}return t}validateResolvedCredentials(t){if(typeof t!="object"||typeof t.accessKeyId!="string"||typeof t.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")}formatDate(t){const n=oT(t).replace(/[\-:]/g,"");return{longDate:n,shortDate:n.slice(0,8)}}getCanonicalHeaderList(t){return Object.keys(t).sort().join(";")}}class Af extends uT{constructor({applyChecksum:n,credentials:r,region:s,service:o,sha256:u,uriEscapePath:c=!0}){super({applyChecksum:n,credentials:r,region:s,service:o,sha256:u,uriEscapePath:c});P(this,"headerFormatter",new eT)}async presign(n,r={}){const{signingDate:s=new Date,expiresIn:o=3600,unsignableHeaders:u,unhoistableHeaders:c,signableHeaders:d,hoistableHeaders:f,signingRegion:m,signingService:y}=r,w=await this.credentialProvider();this.validateResolvedCredentials(w);const E=m??await this.regionProvider(),{longDate:F,shortDate:I}=this.formatDate(s);if(o>YR)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");const T=yl(I,E,y??this.service),$=iT(I0(n),{unhoistableHeaders:c,hoistableHeaders:f});w.sessionToken&&($.query[hw]=w.sessionToken),$.query[MR]=gl,$.query[$R]=`${w.accessKeyId}/${T}`,$.query[fw]=F,$.query[zR]=o.toString(10);const V=A0($,u,d);return $.query[LR]=this.getCanonicalHeaderList(V),$.query[dw]=await this.getSignature(F,T,this.getSigningKey(w,E,I,y),this.createCanonicalRequest($,V,await Dl(n,this.sha256))),$}async sign(n,r){return typeof n=="string"?this.signString(n,r):n.headers&&n.payload?this.signEvent(n,r):n.message?this.signMessage(n,r):this.signRequest(n,r)}async signEvent({headers:n,payload:r},{signingDate:s=new Date,priorSignature:o,signingRegion:u,signingService:c}){const d=u??await this.regionProvider(),{shortDate:f,longDate:m}=this.formatDate(s),y=yl(f,d,c??this.service),w=await Dl({headers:{},body:r},this.sha256),E=new this.sha256;E.update(n);const F=Sn(await E.digest()),I=[ZR,m,y,o,F,w].join(`
`);return this.signString(I,{signingDate:s,signingRegion:d,signingService:c})}async signMessage(n,{signingDate:r=new Date,signingRegion:s,signingService:o}){return this.signEvent({headers:this.headerFormatter.format(n.message.headers),payload:n.message.body},{signingDate:r,signingRegion:s,signingService:o,priorSignature:n.priorSignature}).then(c=>({message:n.message,signature:c}))}async signString(n,{signingDate:r=new Date,signingRegion:s,signingService:o}={}){const u=await this.credentialProvider();this.validateResolvedCredentials(u);const c=s??await this.regionProvider(),{shortDate:d}=this.formatDate(r),f=new this.sha256(await this.getSigningKey(u,c,d,o));return f.update(Ns(n)),Sn(await f.digest())}async signRequest(n,{signingDate:r=new Date,signableHeaders:s,unsignableHeaders:o,signingRegion:u,signingService:c}={}){const d=await this.credentialProvider();this.validateResolvedCredentials(d);const f=u??await this.regionProvider(),m=I0(n),{longDate:y,shortDate:w}=this.formatDate(r),E=yl(w,f,c??this.service);m.headers[gw]=y,d.sessionToken&&(m.headers[jR]=d.sessionToken);const F=await Dl(m,this.sha256);!rT(xf,m.headers)&&this.applyChecksum&&(m.headers[xf]=F);const I=A0(m,o,s),T=await this.getSignature(y,E,this.getSigningKey(d,f,w,c),this.createCanonicalRequest(m,I,F));return m.headers[pw]=`${gl} Credential=${d.accessKeyId}/${E}, SignedHeaders=${this.getCanonicalHeaderList(I)}, Signature=${T}`,m}async getSignature(n,r,s,o){const u=await this.createStringToSign(n,r,o,gl),c=new this.sha256(await s);return c.update(Ns(u)),Sn(await c.digest())}getSigningKey(n,r,s,o){return QR(this.sha256,n,s,r,o||this.service)}}const cT=e=>{let t=e.credentials,n=!!e.credentials,r;Object.defineProperty(e,"credentials",{set(f){f&&f!==t&&f!==r&&(n=!0),t=f;const m=lT(e,{credentials:t,credentialDefaultProvider:e.credentialDefaultProvider}),y=fT(e,m);if(n&&!y.attributed){const w=typeof t=="object"&&t!==null;r=async E=>{const I=await y(E);return w&&(!I.$source||Object.keys(I.$source).length===0)?Bk(I,"CREDENTIALS_CODE","e"):I},r.memoized=y.memoized,r.configBound=y.configBound,r.attributed=!0}else r=y},get(){return r},enumerable:!0,configurable:!0}),e.credentials=t;const{signingEscapePath:s=!0,systemClockOffset:o=e.systemClockOffset||0,sha256:u}=e;let c;return e.signer?c=Fs(e.signer):e.regionInfoProvider?c=()=>Fs(e.region)().then(async f=>[await e.regionInfoProvider(f,{useFipsEndpoint:await e.useFipsEndpoint(),useDualstackEndpoint:await e.useDualstackEndpoint()})||{},f]).then(([f,m])=>{const{signingRegion:y,signingService:w}=f;e.signingRegion=e.signingRegion||y||m,e.signingName=e.signingName||w||e.serviceId;const E={...e,credentials:e.credentials,region:e.signingRegion,service:e.signingName,sha256:u,uriEscapePath:s},F=e.signerConstructor||Af;return new F(E)}):c=async f=>{f=Object.assign({},{name:"sigv4",signingName:e.signingName||e.defaultSigningName,signingRegion:await Fs(e.region)(),properties:{}},f);const m=f.signingRegion,y=f.signingName;e.signingRegion=e.signingRegion||m,e.signingName=e.signingName||y||e.serviceId;const w={...e,credentials:e.credentials,region:e.signingRegion,service:e.signingName,sha256:u,uriEscapePath:s},E=e.signerConstructor||Af;return new E(w)},Object.assign(e,{systemClockOffset:o,signingEscapePath:s,signer:c})};function lT(e,{credentials:t,credentialDefaultProvider:n}){let r;return t?t!=null&&t.memoized?r=t:r=NR(t,PR,lw):n?r=Fs(n(Object.assign({},e,{parentClientConfig:e}))):r=async()=>{throw new Error("@aws-sdk/core::resolveAwsSdkSigV4Config - `credentials` not provided and no credentialDefaultProvider was configured.")},r.memoized=!0,r}function fT(e,t){if(t.configBound)return t;const n=async r=>t({...r,callerClientConfig:e});return n.memoized=t.memoized,n.configBound=!0,n}const B0=typeof TextEncoder=="function"?new TextEncoder:null,dT=e=>{if(typeof e=="string"){if(B0)return B0.encode(e).byteLength;let t=e.length;for(let n=t-1;n>=0;n--){const r=e.charCodeAt(n);r>127&&r<=2047?t++:r>2047&&r<=65535&&(t+=2),r>=56320&&r<=57343&&n--}return t}else{if(typeof e.byteLength=="number")return e.byteLength;if(typeof e.size=="number")return e.size}throw new Error(`Body Length computation failed for ${e}`)},$i=(e,t)=>{const n=[];if(e&&n.push(e),t)for(const r of t)n.push(r);return n},hi=(e,t)=>`${e||"anonymous"}${t&&t.length>0?` (a.k.a. ${t.join(",")})`:""}`,lu=()=>{let e=[],t=[],n=!1;const r=new Set,s=y=>y.sort((w,E)=>k0[E.step]-k0[w.step]||R0[E.priority||"normal"]-R0[w.priority||"normal"]),o=y=>{let w=!1;const E=F=>{const I=$i(F.name,F.aliases);if(I.includes(y)){w=!0;for(const T of I)r.delete(T);return!1}return!0};return e=e.filter(E),t=t.filter(E),w},u=y=>{let w=!1;const E=F=>{if(F.middleware===y){w=!0;for(const I of $i(F.name,F.aliases))r.delete(I);return!1}return!0};return e=e.filter(E),t=t.filter(E),w},c=y=>{var w;return e.forEach(E=>{y.add(E.middleware,{...E})}),t.forEach(E=>{y.addRelativeTo(E.middleware,{...E})}),(w=y.identifyOnResolve)==null||w.call(y,m.identifyOnResolve()),y},d=y=>{const w=[];return y.before.forEach(E=>{E.before.length===0&&E.after.length===0?w.push(E):w.push(...d(E))}),w.push(y),y.after.reverse().forEach(E=>{E.before.length===0&&E.after.length===0?w.push(E):w.push(...d(E))}),w},f=(y=!1)=>{const w=[],E=[],F={};return e.forEach(T=>{const $={...T,before:[],after:[]};for(const V of $i($.name,$.aliases))F[V]=$;w.push($)}),t.forEach(T=>{const $={...T,before:[],after:[]};for(const V of $i($.name,$.aliases))F[V]=$;E.push($)}),E.forEach(T=>{if(T.toMiddleware){const $=F[T.toMiddleware];if($===void 0){if(y)return;throw new Error(`${T.toMiddleware} is not found when adding ${hi(T.name,T.aliases)} middleware ${T.relation} ${T.toMiddleware}`)}T.relation==="after"&&$.after.push(T),T.relation==="before"&&$.before.push(T)}}),s(w).map(d).reduce((T,$)=>(T.push(...$),T),[])},m={add:(y,w={})=>{const{name:E,override:F,aliases:I}=w,T={step:"initialize",priority:"normal",middleware:y,...w},$=$i(E,I);if($.length>0){if($.some(V=>r.has(V))){if(!F)throw new Error(`Duplicate middleware name '${hi(E,I)}'`);for(const V of $){const H=e.findIndex(te=>{var ge;return te.name===V||((ge=te.aliases)==null?void 0:ge.some(De=>De===V))});if(H===-1)continue;const Q=e[H];if(Q.step!==T.step||T.priority!==Q.priority)throw new Error(`"${hi(Q.name,Q.aliases)}" middleware with ${Q.priority} priority in ${Q.step} step cannot be overridden by "${hi(E,I)}" middleware with ${T.priority} priority in ${T.step} step.`);e.splice(H,1)}}for(const V of $)r.add(V)}e.push(T)},addRelativeTo:(y,w)=>{const{name:E,override:F,aliases:I}=w,T={middleware:y,...w},$=$i(E,I);if($.length>0){if($.some(V=>r.has(V))){if(!F)throw new Error(`Duplicate middleware name '${hi(E,I)}'`);for(const V of $){const H=t.findIndex(te=>{var ge;return te.name===V||((ge=te.aliases)==null?void 0:ge.some(De=>De===V))});if(H===-1)continue;const Q=t[H];if(Q.toMiddleware!==T.toMiddleware||Q.relation!==T.relation)throw new Error(`"${hi(Q.name,Q.aliases)}" middleware ${Q.relation} "${Q.toMiddleware}" middleware cannot be overridden by "${hi(E,I)}" middleware ${T.relation} "${T.toMiddleware}" middleware.`);t.splice(H,1)}}for(const V of $)r.add(V)}t.push(T)},clone:()=>c(lu()),use:y=>{y.applyToStack(m)},remove:y=>typeof y=="string"?o(y):u(y),removeByTag:y=>{let w=!1;const E=F=>{const{tags:I,name:T,aliases:$}=F;if(I&&I.includes(y)){const V=$i(T,$);for(const H of V)r.delete(H);return w=!0,!1}return!0};return e=e.filter(E),t=t.filter(E),w},concat:y=>{var E;const w=c(lu());return w.use(y),w.identifyOnResolve(n||w.identifyOnResolve()||(((E=y.identifyOnResolve)==null?void 0:E.call(y))??!1)),w},applyToStack:c,identify:()=>f(!0).map(y=>{const w=y.step??y.relation+" "+y.toMiddleware;return hi(y.name,y.aliases)+" - "+w}),identifyOnResolve(y){return typeof y=="boolean"&&(n=y),n},resolve:(y,w)=>{for(const E of f().map(F=>F.middleware).reverse())y=E(y,w);return n&&console.log(m.identify()),y}};return m},k0={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},R0={high:3,normal:2,low:1};class hT{constructor(t){P(this,"config");P(this,"middlewareStack",lu());P(this,"initConfig");P(this,"handlers");this.config=t;const{protocol:n,protocolSettings:r}=t;r&&typeof n=="function"&&(t.protocol=new n(r))}send(t,n,r){const s=typeof n!="function"?n:void 0,o=typeof n=="function"?n:r,u=s===void 0&&this.config.cacheMiddleware===!0;let c;if(u){this.handlers||(this.handlers=new WeakMap);const d=this.handlers;d.has(t.constructor)?c=d.get(t.constructor):(c=t.resolveMiddleware(this.middlewareStack,this.config,s),d.set(t.constructor,c))}else delete this.handlers,c=t.resolveMiddleware(this.middlewareStack,this.config,s);if(o)c(t).then(d=>o(null,d.output),d=>o(d)).catch(()=>{});else return c(t).then(d=>d.output)}destroy(){var t,n,r;(r=(n=(t=this.config)==null?void 0:t.requestHandler)==null?void 0:n.destroy)==null||r.call(n),delete this.handlers}}const wl="***SensitiveInformation***";function Ff(e,t){if(t==null)return t;const n=Dt.of(e);if(n.getMergedTraits().sensitive)return wl;if(n.isListSchema()){if(!!n.getValueSchema().getMergedTraits().sensitive)return wl}else if(n.isMapSchema()){if(!!n.getKeySchema().getMergedTraits().sensitive||!!n.getValueSchema().getMergedTraits().sensitive)return wl}else if(n.isStructSchema()&&typeof t=="object"){const r=t,s={};for(const[o,u]of n.structIterator())r[o]!=null&&(s[o]=Ff(u,r[o]));return s}return t}class Td{constructor(){P(this,"middlewareStack",lu());P(this,"schema")}static classBuilder(){return new pT}resolveMiddlewareWithContext(t,n,r,{middlewareFn:s,clientName:o,commandName:u,inputFilterSensitiveLog:c,outputFilterSensitiveLog:d,smithyContext:f,additionalContext:m,CommandCtor:y}){for(const T of s.bind(this)(y,t,n,r))this.middlewareStack.use(T);const w=t.concat(this.middlewareStack),{logger:E}=n,F={logger:E,clientName:o,commandName:u,inputFilterSensitiveLog:c,outputFilterSensitiveLog:d,[bf]:{commandInstance:this,...f},...m},{requestHandler:I}=n;return w.resolve(T=>I.handle(T.request,r||{}),F)}}class pT{constructor(){P(this,"_init",()=>{});P(this,"_ep",{});P(this,"_middlewareFn",()=>[]);P(this,"_commandName","");P(this,"_clientName","");P(this,"_additionalContext",{});P(this,"_smithyContext",{});P(this,"_inputFilterSensitiveLog");P(this,"_outputFilterSensitiveLog");P(this,"_serializer",null);P(this,"_deserializer",null);P(this,"_operationSchema")}init(t){this._init=t}ep(t){return this._ep=t,this}m(t){return this._middlewareFn=t,this}s(t,n,r={}){return this._smithyContext={service:t,operation:n,...r},this}c(t={}){return this._additionalContext=t,this}n(t,n){return this._clientName=t,this._commandName=n,this}f(t=r=>r,n=r=>r){return this._inputFilterSensitiveLog=t,this._outputFilterSensitiveLog=n,this}ser(t){return this._serializer=t,this}de(t){return this._deserializer=t,this}sc(t){return this._operationSchema=t,this._smithyContext.operationSchema=t,this}build(){const t=this;let n;return n=class extends Td{constructor(...[s]){super();P(this,"input");P(this,"serialize",t._serializer);P(this,"deserialize",t._deserializer);this.input=s??{},t._init(this),this.schema=t._operationSchema}static getEndpointParameterInstructions(){return t._ep}resolveMiddleware(s,o,u){const c=t._operationSchema,d=(c==null?void 0:c[4])??(c==null?void 0:c.input),f=(c==null?void 0:c[5])??(c==null?void 0:c.output);return this.resolveMiddlewareWithContext(s,o,u,{CommandCtor:n,middlewareFn:t._middlewareFn,clientName:t._clientName,commandName:t._commandName,inputFilterSensitiveLog:t._inputFilterSensitiveLog??(c?Ff.bind(null,d):m=>m),outputFilterSensitiveLog:t._outputFilterSensitiveLog??(c?Ff.bind(null,f):m=>m),smithyContext:t._smithyContext,additionalContext:t._additionalContext})}}}}class Es extends Error{constructor(n){super(n.message);P(this,"$fault");P(this,"$response");P(this,"$retryable");P(this,"$metadata");Object.setPrototypeOf(this,Object.getPrototypeOf(this).constructor.prototype),this.name=n.name,this.$fault=n.$fault,this.$metadata=n.$metadata}static isInstance(n){if(!n)return!1;const r=n;return Es.prototype.isPrototypeOf(r)||!!r.$fault&&!!r.$metadata&&(r.$fault==="client"||r.$fault==="server")}static[Symbol.hasInstance](n){if(!n)return!1;const r=n;return this===Es?Es.isInstance(n):Es.isInstance(n)?r.name&&this.name?this.prototype.isPrototypeOf(n)||r.name===this.name:this.prototype.isPrototypeOf(n):!1}}const T0=(e,t={})=>{Object.entries(t).filter(([,r])=>r!==void 0).forEach(([r,s])=>{(e[r]==null||e[r]==="")&&(e[r]=s)});const n=e.message||e.Message||"UnknownError";return e.message=n,delete e.Message,e},gT=e=>{switch(e){case"standard":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}},mT=e=>{const t=[];for(const n in cu){const r=cu[n];e[r]!==void 0&&t.push({algorithmId:()=>r,checksumConstructor:()=>e[r]})}return{addChecksumAlgorithm(n){t.push(n)},checksumAlgorithms(){return t}}},yT=e=>{const t={};return e.checksumAlgorithms().forEach(n=>{t[n.algorithmId()]=n.checksumConstructor()}),t},DT=e=>({setRetryStrategy(t){e.retryStrategy=t},retryStrategy(){return e.retryStrategy}}),wT=e=>{const t={};return t.retryStrategy=e.retryStrategy(),t},bT=e=>Object.assign(mT(e),DT(e)),ET=e=>Object.assign(yT(e),wT(e)),ww=e=>{const t="#text";for(const n in e)e.hasOwnProperty(n)&&e[n][t]!==void 0?e[n]=e[n][t]:typeof e[n]=="object"&&e[n]!==null&&(e[n]=ww(e[n]));return e};class Pd{trace(){}debug(){}info(){}warn(){}error(){}}class vT{constructor(t=!1){P(this,"queryCompat");this.queryCompat=t}resolveRestContentType(t,n){const r=n.getMemberSchemas(),s=Object.values(r).find(o=>!!o.getMergedTraits().httpPayload);if(s){const o=s.getMergedTraits().mediaType;return o||(s.isStringSchema()?"text/plain":s.isBlobSchema()?"application/octet-stream":t)}else if(!n.isUnitSchema()&&Object.values(r).find(u=>{const{httpQuery:c,httpQueryParams:d,httpHeader:f,httpLabel:m,httpPrefixHeaders:y}=u.getMergedTraits();return!c&&!d&&!f&&!m&&y===void 0}))return t}async getErrorSchemaOrThrowBaseException(t,n,r,s,o,u){let c=n,d=t;t.includes("#")&&([c,d]=t.split("#"));const f={$metadata:o,$fault:r.statusCode<500?"client":"server"},m=Et.for(c);try{return{errorSchema:(u==null?void 0:u(m,d))??m.getSchema(t),errorMetadata:f}}catch{s.message=s.message??s.Message??"UnknownError";const w=Et.for("smithy.ts.sdk.synthetic."+c),E=w.getBaseException();if(E){const F=w.getErrorCtor(E)??Error;throw this.decorateServiceException(Object.assign(new F({name:d}),f),s)}throw this.decorateServiceException(Object.assign(new Error(d),f),s)}}decorateServiceException(t,n={}){if(this.queryCompat){const r=t.Message??n.Message,s=T0(t,n);r&&(s.message=r),s.Error={...s.Error,Type:s.Error.Type,Code:s.Error.Code,Message:s.Error.message??s.Error.Message??r};const o=s.$metadata.requestId;return o&&(s.RequestId=o),s}return T0(t,n)}setQueryCompatError(t,n){var s;const r=(s=n.headers)==null?void 0:s["x-amzn-query-error"];if(t!==void 0&&r!=null){const[o,u]=r.split(";"),c=Object.entries(t),d={Code:o,Type:u};Object.assign(t,d);for(const[f,m]of c)d[f==="message"?"Message":f]=m;delete d.__type,t.Error=d}}queryCompatOutput(t,n){t.Error&&(n.Error=t.Error),t.Type&&(n.Type=t.Type),t.Code&&(n.Code=t.Code)}findQueryCompatibleError(t,n){try{return t.getSchema(n)}catch{return t.find(s=>{var o;return((o=Dt.of(s).getMergedTraits().awsQueryError)==null?void 0:o[0])===n})}}}class Nd{constructor(){P(this,"serdeContext")}setSerdeContext(t){this.serdeContext=t}}class ST{constructor(t,n){P(this,"from");P(this,"to");P(this,"keys");this.from=t,this.to=n,this.keys=new Set(Object.keys(this.from).filter(r=>r!=="__type"))}mark(t){this.keys.delete(t)}hasUnknown(){return this.keys.size===1&&Object.keys(this.to).length===0}writeUnknown(){if(this.hasUnknown()){const t=this.keys.values().next().value,n=this.from[t];this.to.$unknown=[t,n]}}}function CT(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function xT(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#x0D;").replace(/\n/g,"&#x0A;").replace(/\u0085/g,"&#x85;").replace(/\u2028/,"&#x2028;")}class _f{constructor(t){P(this,"value");this.value=t}toString(){return xT(""+this.value)}}class ln{constructor(t,n=[]){P(this,"name");P(this,"children");P(this,"attributes",{});this.name=t,this.children=n}static of(t,n,r){const s=new ln(t);return n!==void 0&&s.addChildNode(new _f(n)),r!==void 0&&s.withName(r),s}withName(t){return this.name=t,this}addAttribute(t,n){return this.attributes[t]=n,this}addChildNode(t){return this.children.push(t),this}removeAttribute(t){return delete this.attributes[t],this}n(t){return this.name=t,this}c(t){return this.children.push(t),this}a(t,n){return n!=null&&(this.attributes[t]=n),this}cc(t,n,r=n){if(t[n]!=null){const s=ln.of(n,t[n]).withName(r);this.c(s)}}l(t,n,r,s){t[n]!=null&&s().map(u=>{u.withName(r),this.c(u)})}lc(t,n,r,s){if(t[n]!=null){const o=s(),u=new ln(r);o.map(c=>{u.c(c)}),this.c(u)}}toString(){const t=!!this.children.length;let n=`<${this.name}`;const r=this.attributes;for(const s of Object.keys(r)){const o=r[s];o!=null&&(n+=` ${s}="${CT(""+o)}"`)}return n+=t?`>${this.children.map(s=>s.toString()).join("")}</${this.name}>`:"/>"}}let bl;function AT(e){bl||(bl=new DOMParser);const t=bl.parseFromString(e,"application/xml");if(t.getElementsByTagName("parsererror").length>0)throw new Error("DOMParser XML parsing error.");const n=r=>{var s;if(r.nodeType===Node.TEXT_NODE&&(s=r.textContent)!=null&&s.trim())return r.textContent;if(r.nodeType===Node.ELEMENT_NODE){const o=r;if(o.attributes.length===0&&o.childNodes.length===0)return"";const u={},c=Array.from(o.attributes);for(const f of c)u[`${f.name}`]=f.value;const d=Array.from(o.childNodes);for(const f of d){const m=n(f);if(m!=null){const y=f.nodeName;if(d.length===1&&c.length===0&&y==="#text")return m;u[y]?Array.isArray(u[y])?u[y].push(m):u[y]=[u[y],m]:u[y]=m}else if(d.length===1&&c.length===0)return o.textContent}return u}return null};return{[t.documentElement.nodeName]:n(t.documentElement)}}class FT extends Nd{constructor(n){super();P(this,"settings");P(this,"stringDeserializer");this.settings=n,this.stringDeserializer=new cw(n)}setSerdeContext(n){this.serdeContext=n,this.stringDeserializer.setSerdeContext(n)}read(n,r,s){var m;const o=Dt.of(n),u=o.getMemberSchemas();if(o.isStructSchema()&&o.isMemberSchema()&&!!Object.values(u).find(y=>!!y.getMemberTraits().eventPayload)){const y={},w=Object.keys(u)[0];return u[w].isBlobSchema()?y[w]=r:y[w]=this.read(u[w],r),y}const d=(((m=this.serdeContext)==null?void 0:m.utf8Encoder)??Zi)(r),f=this.parseXml(d);return this.readSchema(n,s?f[s]:f)}readSchema(n,r){const s=Dt.of(n);if(s.isUnitSchema())return;const o=s.getMergedTraits();if(s.isListSchema()&&!Array.isArray(r))return this.readSchema(s,[r]);if(r==null)return r;if(typeof r=="object"){const u=!!o.sparse,c=!!o.xmlFlattened;if(s.isListSchema()){const f=s.getValueSchema(),m=[],y=f.getMergedTraits().xmlName??"member",w=c?r:(r[0]??r)[y],E=Array.isArray(w)?w:[w];for(const F of E)(F!=null||u)&&m.push(this.readSchema(f,F));return m}const d={};if(s.isMapSchema()){const f=s.getKeySchema(),m=s.getValueSchema();let y;c?y=Array.isArray(r)?r:[r]:y=Array.isArray(r.entry)?r.entry:[r.entry];const w=f.getMergedTraits().xmlName??"key",E=m.getMergedTraits().xmlName??"value";for(const F of y){const I=F[w],T=F[E];(T!=null||u)&&(d[I]=this.readSchema(m,T))}return d}if(s.isStructSchema()){const f=s.isUnionSchema();let m;f&&(m=new ST(r,d));for(const[y,w]of s.structIterator()){const E=w.getMergedTraits(),F=E.httpPayload?E.xmlName??w.getName():w.getMemberTraits().xmlName??y;f&&m.mark(F),r[F]!=null&&(d[y]=this.readSchema(w,r[F]))}return f&&m.writeUnknown(),d}if(s.isDocumentSchema())return r;throw new Error(`@aws-sdk/core/protocols - xml deserializer unhandled schema type for ${s.getName(!0)}`)}return s.isListSchema()?[]:s.isMapSchema()||s.isStructSchema()?{}:this.stringDeserializer.read(s,r)}parseXml(n){if(n.length){let r;try{r=AT(n)}catch(c){throw c&&typeof c=="object"&&Object.defineProperty(c,"$responseBodyText",{value:n}),c}const s="#text",o=Object.keys(r)[0],u=r[o];return u[s]&&(u[o]=u[s],delete u[s]),ww(u)}return{}}}const _T=(e,t)=>{var n;if(((n=t==null?void 0:t.Error)==null?void 0:n.Code)!==void 0)return t.Error.Code;if((t==null?void 0:t.Code)!==void 0)return t.Code;if(e.statusCode==404)return"NotFound"};class IT extends Nd{constructor(n){super();P(this,"settings");P(this,"stringBuffer");P(this,"byteBuffer");P(this,"buffer");this.settings=n}write(n,r){var o;const s=Dt.of(n);if(s.isStringSchema()&&typeof r=="string")this.stringBuffer=r;else if(s.isBlobSchema())this.byteBuffer="byteLength"in r?r:(((o=this.serdeContext)==null?void 0:o.base64Decoder)??Ps)(r);else{this.buffer=this.writeStruct(s,r,void 0);const u=s.getMergedTraits();u.httpPayload&&!u.xmlName&&this.buffer.withName(s.getName())}}flush(){var r;if(this.byteBuffer!==void 0){const s=this.byteBuffer;return delete this.byteBuffer,s}if(this.stringBuffer!==void 0){const s=this.stringBuffer;return delete this.stringBuffer,s}const n=this.buffer;return this.settings.xmlNamespace&&((r=n==null?void 0:n.attributes)!=null&&r.xmlns||n.addAttribute("xmlns",this.settings.xmlNamespace)),delete this.buffer,n.toString()}writeStruct(n,r,s){const o=n.getMergedTraits(),u=n.isMemberSchema()&&!o.httpPayload?n.getMemberTraits().xmlName??n.getMemberName():o.xmlName??n.getName();if(!u||!n.isStructSchema())throw new Error(`@aws-sdk/core/protocols - xml serializer, cannot write struct with empty name or non-struct, schema=${n.getName(!0)}.`);const c=ln.of(u),[d,f]=this.getXmlnsAttribute(n,s);for(const[y,w]of n.structIterator()){const E=r[y];if(E!=null||w.isIdempotencyToken()){if(w.getMergedTraits().xmlAttribute){c.addAttribute(w.getMergedTraits().xmlName??y,this.writeSimple(w,E));continue}if(w.isListSchema())this.writeList(w,E,c,f);else if(w.isMapSchema())this.writeMap(w,E,c,f);else if(w.isStructSchema())c.addChildNode(this.writeStruct(w,E,f));else{const F=ln.of(w.getMergedTraits().xmlName??w.getMemberName());this.writeSimpleInto(w,E,F,f),c.addChildNode(F)}}}const{$unknown:m}=r;if(m&&n.isUnionSchema()&&Array.isArray(m)&&Object.keys(r).length===1){const[y,w]=m,E=ln.of(y);if(typeof w!="string")if(r instanceof ln||r instanceof _f)c.addChildNode(r);else throw new Error("@aws-sdk - $unknown union member in XML requires value of type string, @aws-sdk/xml-builder::XmlNode or XmlText.");this.writeSimpleInto(0,w,E,f),c.addChildNode(E)}return f&&c.addAttribute(d,f),c}writeList(n,r,s,o){if(!n.isMemberSchema())throw new Error(`@aws-sdk/core/protocols - xml serializer, cannot write non-member list: ${n.getName(!0)}`);const u=n.getMergedTraits(),c=n.getValueSchema(),d=c.getMergedTraits(),f=!!d.sparse,m=!!u.xmlFlattened,[y,w]=this.getXmlnsAttribute(n,o),E=(F,I)=>{if(c.isListSchema())this.writeList(c,Array.isArray(I)?I:[I],F,w);else if(c.isMapSchema())this.writeMap(c,I,F,w);else if(c.isStructSchema()){const T=this.writeStruct(c,I,w);F.addChildNode(T.withName(m?u.xmlName??n.getMemberName():d.xmlName??"member"))}else{const T=ln.of(m?u.xmlName??n.getMemberName():d.xmlName??"member");this.writeSimpleInto(c,I,T,w),F.addChildNode(T)}};if(m)for(const F of r)(f||F!=null)&&E(s,F);else{const F=ln.of(u.xmlName??n.getMemberName());w&&F.addAttribute(y,w);for(const I of r)(f||I!=null)&&E(F,I);s.addChildNode(F)}}writeMap(n,r,s,o,u=!1){if(!n.isMemberSchema())throw new Error(`@aws-sdk/core/protocols - xml serializer, cannot write non-member map: ${n.getName(!0)}`);const c=n.getMergedTraits(),d=n.getKeySchema(),m=d.getMergedTraits().xmlName??"key",y=n.getValueSchema(),w=y.getMergedTraits(),E=w.xmlName??"value",F=!!w.sparse,I=!!c.xmlFlattened,[T,$]=this.getXmlnsAttribute(n,o),V=(H,Q,te)=>{const ge=ln.of(m,Q),[De,rt]=this.getXmlnsAttribute(d,$);rt&&ge.addAttribute(De,rt),H.addChildNode(ge);let Je=ln.of(E);y.isListSchema()?this.writeList(y,te,Je,$):y.isMapSchema()?this.writeMap(y,te,Je,$,!0):y.isStructSchema()?Je=this.writeStruct(y,te,$):this.writeSimpleInto(y,te,Je,$),H.addChildNode(Je)};if(I){for(const[H,Q]of Object.entries(r))if(F||Q!=null){const te=ln.of(c.xmlName??n.getMemberName());V(te,H,Q),s.addChildNode(te)}}else{let H;u||(H=ln.of(c.xmlName??n.getMemberName()),$&&H.addAttribute(T,$),s.addChildNode(H));for(const[Q,te]of Object.entries(r))if(F||te!=null){const ge=ln.of("entry");V(ge,Q,te),(u?s:H).addChildNode(ge)}}}writeSimple(n,r){var u;if(r===null)throw new Error("@aws-sdk/core/protocols - (XML serializer) cannot write null value.");const s=Dt.of(n);let o=null;if(r&&typeof r=="object")if(s.isBlobSchema())o=(((u=this.serdeContext)==null?void 0:u.base64Encoder)??Wi)(r);else if(s.isTimestampSchema()&&r instanceof Date)switch(Rd(s,this.settings)){case 5:o=r.toISOString().replace(".000Z","Z");break;case 6:o=Cf(r);break;case 7:o=String(r.getTime()/1e3);break;default:console.warn("Missing timestamp format, using http date",r),o=Cf(r);break}else{if(s.isBigDecimalSchema()&&r)return r instanceof Iu?r.string:String(r);throw s.isMapSchema()||s.isListSchema()?new Error("@aws-sdk/core/protocols - xml serializer, cannot call _write() on List/Map schema, call writeList or writeMap() instead."):new Error(`@aws-sdk/core/protocols - xml serializer, unhandled schema type for object value and schema: ${s.getName(!0)}`)}if((s.isBooleanSchema()||s.isNumericSchema()||s.isBigIntegerSchema()||s.isBigDecimalSchema())&&(o=String(r)),s.isStringSchema()&&(r===void 0&&s.isIdempotencyToken()?o=_d():o=String(r)),o===null)throw new Error(`Unhandled schema-value pair ${s.getName(!0)}=${r}`);return o}writeSimpleInto(n,r,s,o){const u=this.writeSimple(n,r),c=Dt.of(n),d=new _f(u),[f,m]=this.getXmlnsAttribute(c,o);m&&s.addAttribute(f,m),s.addChildNode(d)}getXmlnsAttribute(n,r){const s=n.getMergedTraits(),[o,u]=s.xmlNamespace??[];return u&&u!==r?[o?`xmlns:${o}`:"xmlns",u]:[void 0,void 0]}}class BT extends Nd{constructor(n){super();P(this,"settings");this.settings=n}createSerializer(){const n=new IT(this.settings);return n.setSerdeContext(this.serdeContext),n}createDeserializer(){const n=new FT(this.settings);return n.setSerdeContext(this.serdeContext),n}}class kT extends AR{constructor(n){super(n);P(this,"codec");P(this,"serializer");P(this,"deserializer");P(this,"mixin",new vT);const r={timestampFormat:{useTrait:!0,default:5},httpBindings:!0,xmlNamespace:n.xmlNamespace,serviceNamespace:n.defaultNamespace};this.codec=new BT(r),this.serializer=new IR(this.codec.createSerializer(),r),this.deserializer=new FR(this.codec.createDeserializer(),r)}getPayloadCodec(){return this.codec}getShapeId(){return"aws.protocols#restXml"}async serializeRequest(n,r,s){const o=await super.serializeRequest(n,r,s),u=Dt.of(n.input);if(!o.headers["content-type"]){const c=this.mixin.resolveRestContentType(this.getDefaultContentType(),u);c&&(o.headers["content-type"]=c)}return typeof o.body=="string"&&o.headers["content-type"]===this.getDefaultContentType()&&!o.body.startsWith("<?xml ")&&!this.hasUnstructuredPayloadBinding(u)&&(o.body='<?xml version="1.0" encoding="UTF-8"?>'+o.body),o}async deserializeResponse(n,r,s){return super.deserializeResponse(n,r,s)}async handleError(n,r,s,o,u){var I,T,$;const c=_T(s,o)??"Unknown",{errorSchema:d,errorMetadata:f}=await this.mixin.getErrorSchemaOrThrowBaseException(c,this.options.defaultNamespace,s,o,u),m=Dt.of(d),y=((I=o.Error)==null?void 0:I.message)??((T=o.Error)==null?void 0:T.Message)??o.message??o.Message??"Unknown",w=Et.for(d[1]).getErrorCtor(d)??Error,E=new w(y);await this.deserializeHttpMessage(d,r,s,o);const F={};for(const[V,H]of m.structIterator()){const Q=H.getMergedTraits().xmlName??V,te=(($=o.Error)==null?void 0:$[Q])??o[Q];F[V]=this.codec.createDeserializer().readSchema(H,te)}throw this.mixin.decorateServiceException(Object.assign(E,f,{$fault:m.getMergedTraits().error,message:y},F),o)}getDefaultContentType(){return"application/xml"}hasUnstructuredPayloadBinding(n){for(const[,r]of n.structIterator())if(r.getMergedTraits().httpPayload)return!(r.isStructSchema()||r.isMapSchema()||r.isListSchema());return!1}}const If=[Qe.CRC32,Qe.CRC32C,Qe.CRC64NVME,Qe.SHA1,Qe.SHA256],RT=[Qe.SHA256,Qe.SHA1,Qe.CRC32,Qe.CRC32C,Qe.CRC64NVME],TT=(e,{requestChecksumRequired:t,requestAlgorithmMember:n,requestChecksumCalculation:r})=>{if(!n)return r===Ts.WHEN_SUPPORTED||t?Ef:void 0;if(!e[n])return;const s=e[n];if(!If.includes(s))throw new Error(`The checksum algorithm "${s}" is not supported by the client. Select one of ${If}.`);return s},Od=e=>e===Qe.MD5?"content-md5":`x-amz-checksum-${e.toLowerCase()}`,PT=(e,t)=>{const n=e.toLowerCase();for(const r of Object.keys(t))if(n===r.toLowerCase())return!0;return!1},NT=(e,t)=>{const n=e.toLowerCase();for(const r of Object.keys(t))if(r.toLowerCase().startsWith(n))return!0;return!1},bw=e=>e!==void 0&&typeof e!="string"&&!ArrayBuffer.isView(e)&&!yw(e);function Ud(e,t,n,r){function s(o){return o instanceof n?o:new n(function(u){u(o)})}return new(n||(n=Promise))(function(o,u){function c(m){try{f(r.next(m))}catch(y){u(y)}}function d(m){try{f(r.throw(m))}catch(y){u(y)}}function f(m){m.done?o(m.value):s(m.value).then(c,d)}f((r=r.apply(e,t||[])).next())})}function Md(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,s,o,u=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return u.next=c(0),u.throw=c(1),u.return=c(2),typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function c(f){return function(m){return d([f,m])}}function d(f){if(r)throw new TypeError("Generator is already executing.");for(;u&&(u=0,f[0]&&(n=0)),n;)try{if(r=1,s&&(o=f[0]&2?s.return:f[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,f[1])).done)return o;switch(s=0,o&&(f=[f[0]&2,o.value]),f[0]){case 0:case 1:o=f;break;case 4:return n.label++,{value:f[1],done:!1};case 5:n.label++,s=f[1],f=[0];continue;case 7:f=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(f[0]===6||f[0]===2)){n=0;continue}if(f[0]===3&&(!o||f[1]>o[0]&&f[1]<o[3])){n.label=f[1];break}if(f[0]===6&&n.label<o[1]){n.label=o[1],o=f;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(f);break}o[2]&&n.ops.pop(),n.trys.pop();continue}f=t.call(e,n)}catch(m){f=[6,m],s=0}finally{r=o=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Ew(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}const OT=e=>new TextEncoder().encode(e);var UT=typeof Buffer<"u"&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:OT;function Ci(e){return e instanceof Uint8Array?e:typeof e=="string"?UT(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}function No(e){return typeof e=="string"?e.length===0:e.byteLength===0}function vw(e){return new Uint8Array([(e&4278190080)>>24,(e&16711680)>>16,(e&65280)>>8,e&255])}function Sw(e){if(!Uint32Array.from){for(var t=new Uint32Array(e.length),n=0;n<e.length;)t[n]=e[n],n+=1;return t}return Uint32Array.from(e)}var MT=function(){function e(){this.crc32c=new P0}return e.prototype.update=function(t){No(t)||this.crc32c.update(Ci(t))},e.prototype.digest=function(){return Ud(this,void 0,void 0,function(){return Md(this,function(t){return[2,vw(this.crc32c.digest())]})})},e.prototype.reset=function(){this.crc32c=new P0},e}(),P0=function(){function e(){this.checksum=4294967295}return e.prototype.update=function(t){var n,r;try{for(var s=Ew(t),o=s.next();!o.done;o=s.next()){var u=o.value;this.checksum=this.checksum>>>8^LT[(this.checksum^u)&255]}}catch(c){n={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return this},e.prototype.digest=function(){return(this.checksum^4294967295)>>>0},e}(),$T=[0,4067132163,3778769143,324072436,3348797215,904991772,648144872,3570033899,2329499855,2024987596,1809983544,2575936315,1296289744,3207089363,2893594407,1578318884,274646895,3795141740,4049975192,51262619,3619967088,632279923,922689671,3298075524,2592579488,1760304291,2075979607,2312596564,1562183871,2943781820,3156637768,1313733451,549293790,3537243613,3246849577,871202090,3878099393,357341890,102525238,4101499445,2858735121,1477399826,1264559846,3107202533,1845379342,2677391885,2361733625,2125378298,820201905,3263744690,3520608582,598981189,4151959214,85089709,373468761,3827903834,3124367742,1213305469,1526817161,2842354314,2107672161,2412447074,2627466902,1861252501,1098587580,3004210879,2688576843,1378610760,2262928035,1955203488,1742404180,2511436119,3416409459,969524848,714683780,3639785095,205050476,4266873199,3976438427,526918040,1361435347,2739821008,2954799652,1114974503,2529119692,1691668175,2005155131,2247081528,3690758684,697762079,986182379,3366744552,476452099,3993867776,4250756596,255256311,1640403810,2477592673,2164122517,1922457750,2791048317,1412925310,1197962378,3037525897,3944729517,427051182,170179418,4165941337,746937522,3740196785,3451792453,1070968646,1905808397,2213795598,2426610938,1657317369,3053634322,1147748369,1463399397,2773627110,4215344322,153784257,444234805,3893493558,1021025245,3467647198,3722505002,797665321,2197175160,1889384571,1674398607,2443626636,1164749927,3070701412,2757221520,1446797203,137323447,4198817972,3910406976,461344835,3484808360,1037989803,781091935,3705997148,2460548119,1623424788,1939049696,2180517859,1429367560,2807687179,3020495871,1180866812,410100952,3927582683,4182430767,186734380,3756733383,763408580,1053836080,3434856499,2722870694,1344288421,1131464017,2971354706,1708204729,2545590714,2229949006,1988219213,680717673,3673779818,3383336350,1002577565,4010310262,493091189,238226049,4233660802,2987750089,1082061258,1395524158,2705686845,1972364758,2279892693,2494862625,1725896226,952904198,3399985413,3656866545,731699698,4283874585,222117402,510512622,3959836397,3280807620,837199303,582374963,3504198960,68661723,4135334616,3844915500,390545967,1230274059,3141532936,2825850620,1510247935,2395924756,2091215383,1878366691,2644384480,3553878443,565732008,854102364,3229815391,340358836,3861050807,4117890627,119113024,1493875044,2875275879,3090270611,1247431312,2660249211,1828433272,2141937292,2378227087,3811616794,291187481,34330861,4032846830,615137029,3603020806,3314634738,939183345,1776939221,2609017814,2295496738,2058945313,2926798794,1545135305,1330124605,3173225534,4084100981,17165430,307568514,3762199681,888469610,3332340585,3587147933,665062302,2042050490,2346497209,2559330125,1793573966,3190661285,1279665062,1595330642,2910671697],LT=Sw($T);const zT=()=>{const t=new Array(8);for(let n=0;n<8;n++){const r=new Array(512);for(let s=0;s<256;s++){let o=BigInt(s);for(let u=0;u<8*(n+1);u++)o&1n?o=o>>1n^0x9a6c9329ac4bc9b5n:o=o>>1n;r[s*2]=Number(o>>32n&0xffffffffn),r[s*2+1]=Number(o&0xffffffffn)}t[n]=new Uint32Array(r)}return t};let El,yo,Bf,kf,Rf,Tf,Pf,Nf,Of;const HT=()=>{El||(El=zT(),[yo,Bf,kf,Rf,Tf,Pf,Nf,Of]=El)};class GT{constructor(){P(this,"c1",0);P(this,"c2",0);HT(),this.reset()}update(t){const n=t.length;let r=0,s=this.c1,o=this.c2;for(;r+8<=n;){const u=((o^t[r++])&255)<<1,c=((o>>>8^t[r++])&255)<<1,d=((o>>>16^t[r++])&255)<<1,f=((o>>>24^t[r++])&255)<<1,m=((s^t[r++])&255)<<1,y=((s>>>8^t[r++])&255)<<1,w=((s>>>16^t[r++])&255)<<1,E=((s>>>24^t[r++])&255)<<1;s=Of[u]^Nf[c]^Pf[d]^Tf[f]^Rf[m]^kf[y]^Bf[w]^yo[E],o=Of[u+1]^Nf[c+1]^Pf[d+1]^Tf[f+1]^Rf[m+1]^kf[y+1]^Bf[w+1]^yo[E+1]}for(;r<n;){const u=((o^t[r])&255)<<1;o=(o>>>8|(s&255)<<24)>>>0,s=s>>>8^yo[u],o^=yo[u+1],r++}this.c1=s,this.c2=o}async digest(){const t=this.c1^4294967295,n=this.c2^4294967295;return new Uint8Array([t>>>24,t>>>16&255,t>>>8&255,t&255,n>>>24,n>>>16&255,n>>>8&255,n&255])}reset(){this.c1=4294967295,this.c2=4294967295}}var qT=function(){function e(){this.crc32=new fu}return e.prototype.update=function(t){No(t)||this.crc32.update(Ci(t))},e.prototype.digest=function(){return Ud(this,void 0,void 0,function(){return Md(this,function(t){return[2,vw(this.crc32.digest())]})})},e.prototype.reset=function(){this.crc32=new fu},e}(),fu=function(){function e(){this.checksum=4294967295}return e.prototype.update=function(t){var n,r;try{for(var s=Ew(t),o=s.next();!o.done;o=s.next()){var u=o.value;this.checksum=this.checksum>>>8^WT[(this.checksum^u)&255]}}catch(c){n={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return this},e.prototype.digest=function(){return(this.checksum^4294967295)>>>0},e}(),jT=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],WT=Sw(jT);const KT=()=>qT,Cw=(e,t)=>{switch(e){case Qe.MD5:return t.md5;case Qe.CRC32:return KT();case Qe.CRC32C:return MT;case Qe.CRC64NVME:return GT;case Qe.SHA1:return t.sha1;case Qe.SHA256:return t.sha256;default:throw new Error(`Unsupported checksum algorithm: ${e}`)}},xw=(e,t)=>{const n=new e;return n.update(Ns(t||"")),n.digest()},VT={name:"flexibleChecksumsMiddleware",step:"build",tags:["BODY_CHECKSUM"],override:!0},ZT=(e,t)=>(n,r)=>async s=>{if(!bt.isInstance(s.request)||NT("x-amz-checksum-",s.request.headers))return n(s);const{request:o,input:u}=s,{body:c,headers:d}=o,{base64Encoder:f,streamHasher:m}=e,{requestChecksumRequired:y,requestAlgorithmMember:w}=t,E=await e.requestChecksumCalculation(),F=w==null?void 0:w.name,I=w==null?void 0:w.httpHeader;F&&!u[F]&&(E===Ts.WHEN_SUPPORTED||y)&&(u[F]=Ef,I&&(d[I]=Ef));const T=TT(u,{requestChecksumRequired:y,requestAlgorithmMember:w==null?void 0:w.name,requestChecksumCalculation:E});let $=c,V=d;if(T){switch(T){case Qe.CRC32:At(r,"FLEXIBLE_CHECKSUMS_REQ_CRC32","U");break;case Qe.CRC32C:At(r,"FLEXIBLE_CHECKSUMS_REQ_CRC32C","V");break;case Qe.CRC64NVME:At(r,"FLEXIBLE_CHECKSUMS_REQ_CRC64","W");break;case Qe.SHA1:At(r,"FLEXIBLE_CHECKSUMS_REQ_SHA1","X");break;case Qe.SHA256:At(r,"FLEXIBLE_CHECKSUMS_REQ_SHA256","Y");break}const H=Od(T),Q=Cw(T,e);if(bw(c)){const{getAwsChunkedEncodingStream:te,bodyLengthChecker:ge}=e;$=te(typeof e.requestStreamBufferSize=="number"&&e.requestStreamBufferSize>=8*1024?Jk(c,e.requestStreamBufferSize,r.logger):c,{base64Encoder:f,bodyLengthChecker:ge,checksumLocationName:H,checksumAlgorithmFn:Q,streamHasher:m}),V={...d,"content-encoding":d["content-encoding"]?`${d["content-encoding"]},aws-chunked`:"aws-chunked","transfer-encoding":"chunked","x-amz-decoded-content-length":d["content-length"],"x-amz-content-sha256":"STREAMING-UNSIGNED-PAYLOAD-TRAILER","x-amz-trailer":H},delete V["content-length"]}else if(!PT(H,d)){const te=await xw(Q,c);V={...d,[H]:f(te)}}}try{return await n({...s,request:{...o,headers:V,body:$}})}catch(H){if(H instanceof Error&&H.name==="InvalidChunkSizeError")try{H.message.endsWith(".")||(H.message+="."),H.message+=" Set [requestStreamBufferSize=number e.g. 65_536] in client constructor to instruct AWS SDK to buffer your input stream."}catch{}throw H}},JT={name:"flexibleChecksumsInputMiddleware",toMiddleware:"serializerMiddleware",relation:"before",tags:["BODY_CHECKSUM"],override:!0},XT=(e,t)=>(n,r)=>async s=>{const o=s.input,{requestValidationModeMember:u}=t,c=await e.requestChecksumCalculation(),d=await e.responseChecksumValidation();switch(c){case Ts.WHEN_REQUIRED:At(r,"FLEXIBLE_CHECKSUMS_REQ_WHEN_REQUIRED","a");break;case Ts.WHEN_SUPPORTED:At(r,"FLEXIBLE_CHECKSUMS_REQ_WHEN_SUPPORTED","Z");break}switch(d){case cl.WHEN_REQUIRED:At(r,"FLEXIBLE_CHECKSUMS_RES_WHEN_REQUIRED","c");break;case cl.WHEN_SUPPORTED:At(r,"FLEXIBLE_CHECKSUMS_RES_WHEN_SUPPORTED","b");break}return u&&!o[u]&&d===cl.WHEN_SUPPORTED&&(o[u]="ENABLED"),n(s)},Aw=(e=[])=>{const t=[];for(const n of RT)!e.includes(n)||!If.includes(n)||t.push(n);return t},YT=e=>{const t=e.lastIndexOf("-");if(t!==-1){const n=e.slice(t+1);if(!n.startsWith("0")){const r=parseInt(n,10);if(!isNaN(r)&&r>=1&&r<=1e4)return!0}}return!1},QT=async(e,{checksumAlgorithmFn:t,base64Encoder:n})=>n(await xw(t,e)),e8=async(e,{config:t,responseAlgorithms:n,logger:r})=>{const s=Aw(n),{body:o,headers:u}=e;for(const c of s){const d=Od(c),f=u[d];if(f){let m;try{m=Cw(c,t)}catch(E){if(c===Qe.CRC64NVME){r==null||r.warn(`Skipping ${Qe.CRC64NVME} checksum validation: ${E.message}`);continue}throw E}const{base64Encoder:y}=t;if(bw(o)){e.body=Kk({expectedChecksum:f,checksumSourceLocation:d,checksum:new m,source:o,base64Encoder:y});return}const w=await QT(o,{checksumAlgorithmFn:m,base64Encoder:y});if(w===f)break;throw new Error(`Checksum mismatch: expected "${w}" but received "${f}" in response header "${d}".`)}}},t8={name:"flexibleChecksumsResponseMiddleware",toMiddleware:"deserializerMiddleware",relation:"after",tags:["BODY_CHECKSUM"],override:!0},n8=(e,t)=>(n,r)=>async s=>{if(!bt.isInstance(s.request))return n(s);const o=s.input,u=await n(s),c=u.response,{requestValidationModeMember:d,responseAlgorithms:f}=t;if(d&&o[d]==="ENABLED"){const{clientName:m,commandName:y}=r;if(m==="S3Client"&&y==="GetObjectCommand"&&Aw(f).every(E=>{const F=Od(E),I=c.headers[F];return!I||YT(I)}))return u;await e8(c,{config:e,responseAlgorithms:f,logger:r.logger})}return u},r8=(e,t)=>({applyToStack:n=>{n.add(ZT(e,t),VT),n.addRelativeTo(XT(e,t),JT),n.addRelativeTo(n8(e,t),t8)}}),i8=e=>{const{requestChecksumCalculation:t,responseChecksumValidation:n,requestStreamBufferSize:r}=e;return Object.assign(e,{requestChecksumCalculation:ar(t??_k),responseChecksumValidation:ar(n??Ik),requestStreamBufferSize:Number(r??0)})};const s8=e=>t=>async n=>{if(!bt.isInstance(n.request))return t(n);const{request:r}=n,{handlerProtocol:s=""}=e.requestHandler.metadata||{};if(s.indexOf("h2")>=0&&!r.headers[":authority"])delete r.headers.host,r.headers[":authority"]=r.hostname+(r.port?":"+r.port:"");else if(!r.headers.host){let o=r.hostname;r.port!=null&&(o+=`:${r.port}`),r.headers.host=o}return t(n)},o8={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},a8=e=>({applyToStack:t=>{t.add(s8(e),o8)}}),u8=()=>(e,t)=>async n=>{var r,s;try{const o=await e(n),{clientName:u,commandName:c,logger:d,dynamoDbDocumentClientOptions:f={}}=t,{overrideInputFilterSensitiveLog:m,overrideOutputFilterSensitiveLog:y}=f,w=m??t.inputFilterSensitiveLog,E=y??t.outputFilterSensitiveLog,{$metadata:F,...I}=o.output;return(r=d==null?void 0:d.info)==null||r.call(d,{clientName:u,commandName:c,input:w(n.input),output:E(I),metadata:F}),o}catch(o){const{clientName:u,commandName:c,logger:d,dynamoDbDocumentClientOptions:f={}}=t,{overrideInputFilterSensitiveLog:m}=f,y=m??t.inputFilterSensitiveLog;throw(s=d==null?void 0:d.error)==null||s.call(d,{clientName:u,commandName:c,input:y(n.input),error:o,metadata:o.$metadata}),o}},c8={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},l8=e=>({applyToStack:t=>{t.add(u8(),c8)}}),f8={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},d8=()=>e=>async t=>e(t),h8=e=>({applyToStack:t=>{t.add(d8(),f8)}}),p8="content-length",g8="x-amz-decoded-content-length";function m8(){return(e,t)=>async n=>{var s;const{request:r}=n;if(bt.isInstance(r)&&!(p8 in r.headers)&&!(g8 in r.headers)){const o="Are you using a Stream of unknown length as the Body of a PutObject request? Consider using Upload instead from @aws-sdk/lib-storage.";typeof((s=t==null?void 0:t.logger)==null?void 0:s.warn)=="function"&&!(t.logger instanceof Pd)?t.logger.warn(o):console.warn(o)}return e({...n})}}const y8={step:"finalizeRequest",tags:["CHECK_CONTENT_LENGTH_HEADER"],name:"getCheckContentLengthHeaderPlugin",override:!0},D8=e=>({applyToStack:t=>{t.add(m8(),y8)}}),w8=e=>(t,n)=>async r=>{const s=await e.region(),o=e.region;let u=()=>{};n.__s3RegionRedirect&&(Object.defineProperty(e,"region",{writable:!1,value:async()=>n.__s3RegionRedirect}),u=()=>Object.defineProperty(e,"region",{writable:!0,value:o}));try{const c=await t(r);if(n.__s3RegionRedirect){u();const d=await e.region();if(s!==d)throw new Error("Region was not restored following S3 region redirect.")}return c}catch(c){throw u(),c}},b8={tags:["REGION_REDIRECT","S3"],name:"regionRedirectEndpointMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"};function E8(e){return(t,n)=>async r=>{var s,o,u,c;try{return await t(r)}catch(d){if(e.followRegionRedirects){const f=(s=d==null?void 0:d.$metadata)==null?void 0:s.httpStatusCode,m=n.commandName==="HeadBucketCommand",y=(u=(o=d==null?void 0:d.$response)==null?void 0:o.headers)==null?void 0:u["x-amz-bucket-region"];if(y&&(f===301||f===400&&((d==null?void 0:d.name)==="IllegalLocationConstraintException"||m))){try{const w=y;(c=n.logger)==null||c.debug(`Redirecting from ${await e.region()} to ${w}`),n.__s3RegionRedirect=w}catch(w){throw new Error("Region redirect failed: "+w)}return t(r)}}throw d}}}const v8={step:"initialize",tags:["REGION_REDIRECT","S3"],name:"regionRedirectMiddleware",override:!0},S8=e=>({applyToStack:t=>{t.add(E8(e),v8),t.addRelativeTo(w8(e),b8)}}),Du=class Du{constructor(t={}){P(this,"data");P(this,"lastPurgeTime",Date.now());this.data=t}get(t){const n=this.data[t];if(n)return n}set(t,n){return this.data[t]=n,n}delete(t){delete this.data[t]}async purgeExpired(){const t=Date.now();if(!(this.lastPurgeTime+Du.EXPIRED_CREDENTIAL_PURGE_INTERVAL_MS>t))for(const n in this.data){const r=this.data[n];if(!r.isRefreshing){const s=await r.identity;s.expiration&&s.expiration.getTime()<t&&delete this.data[n]}}}};P(Du,"EXPIRED_CREDENTIAL_PURGE_INTERVAL_MS",3e4);let Uf=Du;class vl{constructor(t,n=!1,r=Date.now()){P(this,"_identity");P(this,"isRefreshing");P(this,"accessed");this._identity=t,this.isRefreshing=n,this.accessed=r}get identity(){return this.accessed=Date.now(),this._identity}}const wu=class wu{constructor(t,n=new Uf){P(this,"createSessionFn");P(this,"cache");this.createSessionFn=t,this.cache=n}async getS3ExpressIdentity(t,n){const r=n.Bucket,{cache:s}=this,o=s.get(r);return o?o.identity.then(u=>{var f,m;return(((f=u.expiration)==null?void 0:f.getTime())??0)<Date.now()?s.set(r,new vl(this.getIdentity(r))).identity:((((m=u.expiration)==null?void 0:m.getTime())??0)<Date.now()+wu.REFRESH_WINDOW_MS&&!o.isRefreshing&&(o.isRefreshing=!0,this.getIdentity(r).then(y=>{s.set(r,new vl(Promise.resolve(y)))})),u)}):s.set(r,new vl(this.getIdentity(r))).identity}async getIdentity(t){var s,o;await this.cache.purgeExpired().catch(u=>{console.warn(`Error while clearing expired entries in S3ExpressIdentityCache: 
`+u)});const n=await this.createSessionFn(t);if(!((s=n.Credentials)!=null&&s.AccessKeyId)||!((o=n.Credentials)!=null&&o.SecretAccessKey))throw new Error("s3#createSession response credential missing AccessKeyId or SecretAccessKey.");return{accessKeyId:n.Credentials.AccessKeyId,secretAccessKey:n.Credentials.SecretAccessKey,sessionToken:n.Credentials.SessionToken,expiration:n.Credentials.Expiration?new Date(n.Credentials.Expiration):void 0}}};P(wu,"REFRESH_WINDOW_MS",6e4);let Mf=wu;const C8="Directory",x8="S3Express",A8="sigv4-s3express",$f="X-Amz-S3session-Token",Lf=$f.toLowerCase();class F8 extends Af{async signWithCredentials(t,n,r){const s=N0(n);t.headers[Lf]=n.sessionToken;const o=this;return O0(o,s),o.signRequest(t,r??{})}async presignWithCredentials(t,n,r){const s=N0(n);return delete t.headers[Lf],t.headers[$f]=n.sessionToken,t.query=t.query??{},t.query[$f]=n.sessionToken,O0(this,s),this.presign(t,r)}}function N0(e){return{accessKeyId:e.accessKeyId,secretAccessKey:e.secretAccessKey,expiration:e.expiration}}function O0(e,t){const n=setTimeout(()=>{throw new Error("SignatureV4S3Express credential override was created but not called.")},10),r=e.credentialProvider,s=()=>(clearTimeout(n),e.credentialProvider=r,Promise.resolve(t));e.credentialProvider=s}const _8=e=>(t,n)=>async r=>{var s,o,u,c,d;if(n.endpointV2){const f=n.endpointV2,m=((u=(o=(s=f.properties)==null?void 0:s.authSchemes)==null?void 0:o[0])==null?void 0:u.name)===A8;if((((c=f.properties)==null?void 0:c.backend)===x8||((d=f.properties)==null?void 0:d.bucketType)===C8)&&(At(n,"S3_EXPRESS_BUCKET","J"),n.isS3ExpressBucket=!0),m){const w=r.input.Bucket;if(w){const E=await e.s3ExpressIdentityProvider.getS3ExpressIdentity(await e.credentials(),{Bucket:w});n.s3ExpressIdentity=E,bt.isInstance(r.request)&&E.sessionToken&&(r.request.headers[Lf]=E.sessionToken)}}}return t(r)},I8={name:"s3ExpressMiddleware",step:"build",tags:["S3","S3_EXPRESS"],override:!0},B8=e=>({applyToStack:t=>{t.add(_8(e),I8)}}),k8=async(e,t,n,r)=>{const s=await r.signWithCredentials(n,e,{});if(s.headers["X-Amz-Security-Token"]||s.headers["x-amz-security-token"])throw new Error("X-Amz-Security-Token must not be set for s3-express requests.");return s},R8=e=>t=>{throw t},T8=(e,t)=>{},P8=e=>(t,n)=>async r=>{if(!bt.isInstance(r.request))return t(r);const o=Fi(n).selectedHttpAuthScheme;if(!o)throw new Error("No HttpAuthScheme was selected: unable to sign request");const{httpAuthOption:{signingProperties:u={}},identity:c,signer:d}=o;let f;n.s3ExpressIdentity?f=await k8(n.s3ExpressIdentity,u,r.request,await e.signer()):f=await d.sign(r.request,c,u);const m=await t({...r,request:f}).catch((d.errorHandler||R8)(u));return(d.successHandler||T8)(m.response,u),m},N8=e=>({applyToStack:t=>{t.addRelativeTo(P8(e),YD)}}),O8=(e,{session:t})=>{const[n,r]=t,{forcePathStyle:s,useAccelerateEndpoint:o,disableMultiregionAccessPoints:u,followRegionRedirects:c,s3ExpressIdentityProvider:d,bucketEndpoint:f,expectContinueHeader:m}=e;return Object.assign(e,{forcePathStyle:s??!1,useAccelerateEndpoint:o??!1,disableMultiregionAccessPoints:u??!1,followRegionRedirects:c??!1,s3ExpressIdentityProvider:d??new Mf(async y=>n().send(new r({Bucket:y}))),bucketEndpoint:f??!1,expectContinueHeader:m??2097152})},U8={CopyObjectCommand:!0,UploadPartCopyCommand:!0,CompleteMultipartUploadCommand:!0},M8=3e3,$8=e=>(t,n)=>async r=>{const s=await t(r),{response:o}=s;if(!ji.isInstance(o))return s;const{statusCode:u,body:c}=o;if(u<200||u>=300||!(typeof(c==null?void 0:c.stream)=="function"||typeof(c==null?void 0:c.pipe)=="function"||typeof(c==null?void 0:c.tee)=="function"))return s;let f=c,m=c;c&&typeof c=="object"&&!(c instanceof Uint8Array)&&([f,m]=await oR(c)),o.body=m;const y=await L8(f,{streamCollector:async E=>eR(E,M8)});typeof(f==null?void 0:f.destroy)=="function"&&f.destroy();const w=e.utf8Encoder(y.subarray(y.length-16));if(y.length===0&&U8[n.commandName]){const E=new Error("S3 aborted request");throw E.name="InternalError",E}return w&&w.endsWith("</Error>")&&(o.statusCode=400),s},L8=(e=new Uint8Array,t)=>e instanceof Uint8Array?Promise.resolve(e):t.streamCollector(e)||Promise.resolve(new Uint8Array),z8={relation:"after",toMiddleware:"deserializerMiddleware",tags:["THROW_200_EXCEPTIONS","S3"],name:"throw200ExceptionsMiddleware",override:!0},Fw=e=>({applyToStack:t=>{t.addRelativeTo($8(e),z8)}}),H8=e=>typeof e=="string"&&e.indexOf("arn:")===0&&e.split(":").length>=6;function G8(e){return(t,n)=>async r=>{var s,o,u,c;if(e.bucketEndpoint){const d=n.endpointV2;if(d){const f=r.input.Bucket;if(typeof f=="string")try{const m=new URL(f);n.endpointV2={...d,url:m}}catch(m){const y=`@aws-sdk/middleware-sdk-s3: bucketEndpoint=true was set but Bucket=${f} could not be parsed as URL.`;throw((o=(s=n.logger)==null?void 0:s.constructor)==null?void 0:o.name)==="NoOpLogger"?console.warn(y):(c=(u=n.logger)==null?void 0:u.warn)==null||c.call(u,y),m}}}return t(r)}}const q8={name:"bucketEndpointMiddleware",override:!0,relation:"after",toMiddleware:"endpointV2Middleware"};function j8({bucketEndpoint:e}){return t=>async n=>{const{input:{Bucket:r}}=n;if(!e&&typeof r=="string"&&!H8(r)&&r.indexOf("/")>=0){const s=new Error(`Bucket name shouldn't contain '/', received '${r}'`);throw s.name="InvalidBucketName",s}return t({...n})}}const W8={step:"initialize",tags:["VALIDATE_BUCKET_NAME"],name:"validateBucketNameMiddleware",override:!0},K8=e=>({applyToStack:t=>{t.add(j8(e),W8),t.addRelativeTo(G8(e),q8)}}),V8=void 0;function Z8(e){return e===void 0?!0:typeof e=="string"&&e.length<=50}function J8(e){const t=Fs(e.userAgentAppId??V8),{customUserAgent:n}=e;return Object.assign(e,{customUserAgent:typeof n=="string"?[[n]]:n,userAgentAppId:async()=>{var s,o;const r=await t();if(!Z8(r)){const u=((o=(s=e.logger)==null?void 0:s.constructor)==null?void 0:o.name)==="NoOpLogger"||!e.logger?console:e.logger;typeof r!="string"?u==null||u.warn("userAgentAppId must be a string or undefined."):r.length>50&&(u==null||u.warn("The provided userAgentAppId exceeds the maximum length of 50 characters."))}return r}})}class X8{constructor({size:t,params:n}){P(this,"capacity");P(this,"data",new Map);P(this,"parameters",[]);this.capacity=t??50,n&&(this.parameters=n)}get(t,n){const r=this.hash(t);if(r===!1)return n();if(!this.data.has(r)){if(this.data.size>this.capacity+10){const s=this.data.keys();let o=0;for(;;){const{value:u,done:c}=s.next();if(this.data.delete(u),c||++o>10)break}}this.data.set(r,n())}return this.data.get(r)}size(){return this.data.size}hash(t){let n="";const{parameters:r}=this;if(r.length===0)return!1;for(const s of r){const o=String(t[s]??"");if(o.includes("|;"))return!1;n+=o+"|;"}return n}}const Y8=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),$d=e=>Y8.test(e)||e.startsWith("[")&&e.endsWith("]"),Q8=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),zo=(e,t=!1)=>{if(!t)return Q8.test(e);const n=e.split(".");for(const r of n)if(!zo(r))return!1;return!0},Oo={},Uo="endpoints";function xi(e){return typeof e!="object"||e==null?e:"ref"in e?`$${xi(e.ref)}`:"fn"in e?`${e.fn}(${(e.argv||[]).map(xi).join(", ")})`:JSON.stringify(e,null,2)}class Mn extends Error{constructor(t){super(t),this.name="EndpointError"}}const e6=(e,t)=>e===t,t6=e=>{const t=e.split("."),n=[];for(const r of t){const s=r.indexOf("[");if(s!==-1){if(r.indexOf("]")!==r.length-1)throw new Mn(`Path: '${e}' does not end with ']'`);const o=r.slice(s+1,-1);if(Number.isNaN(parseInt(o)))throw new Mn(`Invalid array index: '${o}' in path: '${e}'`);s!==0&&n.push(r.slice(0,s)),n.push(o)}else n.push(r)}return n},_w=(e,t)=>t6(t).reduce((n,r)=>{if(typeof n!="object")throw new Mn(`Index '${r}' in '${t}' not found in '${JSON.stringify(e)}'`);return Array.isArray(n)?n[parseInt(r)]:n[r]},e),n6=e=>e!=null,r6=e=>!e,Sl={[Po.HTTP]:80,[Po.HTTPS]:443},i6=e=>{const t=(()=>{try{if(e instanceof URL)return e;if(typeof e=="object"&&"hostname"in e){const{hostname:w,port:E,protocol:F="",path:I="",query:T={}}=e,$=new URL(`${F}//${w}${E?`:${E}`:""}${I}`);return $.search=Object.entries(T).map(([V,H])=>`${V}=${H}`).join("&"),$}return new URL(e)}catch{return null}})();if(!t)return console.error(`Unable to parse ${JSON.stringify(e)} as a whatwg URL.`),null;const n=t.href,{host:r,hostname:s,pathname:o,protocol:u,search:c}=t;if(c)return null;const d=u.slice(0,-1);if(!Object.values(Po).includes(d))return null;const f=$d(s),m=n.includes(`${r}:${Sl[d]}`)||typeof e=="string"&&e.includes(`${r}:${Sl[d]}`),y=`${r}${m?`:${Sl[d]}`:""}`;return{scheme:d,authority:y,path:o,normalizedPath:o.endsWith("/")?o:`${o}/`,isIp:f}},s6=(e,t)=>e===t,o6=(e,t,n,r)=>t>=n||e.length<n?null:r?e.substring(e.length-n,e.length-t):e.substring(t,n),a6=e=>encodeURIComponent(e).replace(/[!*'()]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`),u6={booleanEquals:e6,getAttr:_w,isSet:n6,isValidHostLabel:zo,not:r6,parseURL:i6,stringEquals:s6,substring:o6,uriEncode:a6},Iw=(e,t)=>{const n=[],r={...t.endpointParams,...t.referenceRecord};let s=0;for(;s<e.length;){const o=e.indexOf("{",s);if(o===-1){n.push(e.slice(s));break}n.push(e.slice(s,o));const u=e.indexOf("}",o);if(u===-1){n.push(e.slice(o));break}e[o+1]==="{"&&e[u+1]==="}"&&(n.push(e.slice(o+1,u)),s=u+2);const c=e.substring(o+1,u);if(c.includes("#")){const[d,f]=c.split("#");n.push(_w(r[d],f))}else n.push(r[c]);s=u+1}return n.join("")},c6=({ref:e},t)=>({...t.endpointParams,...t.referenceRecord})[e],ku=(e,t,n)=>{if(typeof e=="string")return Iw(e,n);if(e.fn)return kw.callFunction(e,n);if(e.ref)return c6(e,n);throw new Mn(`'${t}': ${String(e)} is not a string, function or reference.`)},Bw=({fn:e,argv:t},n)=>{const r=t.map(o=>["boolean","number"].includes(typeof o)?o:kw.evaluateExpression(o,"arg",n)),s=e.split(".");return s[0]in Oo&&s[1]!=null?Oo[s[0]][s[1]](...r):u6[e](...r)},kw={evaluateExpression:ku,callFunction:Bw},l6=({assign:e,...t},n)=>{var s,o;if(e&&e in n.referenceRecord)throw new Mn(`'${e}' is already defined in Reference Record.`);const r=Bw(t,n);return(o=(s=n.logger)==null?void 0:s.debug)==null||o.call(s,`${Uo} evaluateCondition: ${xi(t)} = ${xi(r)}`),{result:r===""?!0:!!r,...e!=null&&{toAssign:{name:e,value:r}}}},Ld=(e=[],t)=>{var r,s;const n={};for(const o of e){const{result:u,toAssign:c}=l6(o,{...t,referenceRecord:{...t.referenceRecord,...n}});if(!u)return{result:u};c&&(n[c.name]=c.value,(s=(r=t.logger)==null?void 0:r.debug)==null||s.call(r,`${Uo} assign: ${c.name} := ${xi(c.value)}`))}return{result:!0,referenceRecord:n}},f6=(e,t)=>Object.entries(e).reduce((n,[r,s])=>({...n,[r]:s.map(o=>{const u=ku(o,"Header value entry",t);if(typeof u!="string")throw new Mn(`Header '${r}' value '${u}' is not a string`);return u})}),{}),Rw=(e,t)=>Object.entries(e).reduce((n,[r,s])=>({...n,[r]:Pw.getEndpointProperty(s,t)}),{}),Tw=(e,t)=>{if(Array.isArray(e))return e.map(n=>Tw(n,t));switch(typeof e){case"string":return Iw(e,t);case"object":if(e===null)throw new Mn(`Unexpected endpoint property: ${e}`);return Pw.getEndpointProperties(e,t);case"boolean":return e;default:throw new Mn(`Unexpected endpoint property type: ${typeof e}`)}},Pw={getEndpointProperty:Tw,getEndpointProperties:Rw},d6=(e,t)=>{const n=ku(e,"Endpoint URL",t);if(typeof n=="string")try{return new URL(n)}catch(r){throw console.error(`Failed to construct URL with ${n}`,r),r}throw new Mn(`Endpoint URL must be a string, got ${typeof n}`)},h6=(e,t)=>{var m,y;const{conditions:n,endpoint:r}=e,{result:s,referenceRecord:o}=Ld(n,t);if(!s)return;const u={...t,referenceRecord:{...t.referenceRecord,...o}},{url:c,properties:d,headers:f}=r;return(y=(m=t.logger)==null?void 0:m.debug)==null||y.call(m,`${Uo} Resolving endpoint from template: ${xi(r)}`),{...f!=null&&{headers:f6(f,u)},...d!=null&&{properties:Rw(d,u)},url:d6(c,u)}},p6=(e,t)=>{const{conditions:n,error:r}=e,{result:s,referenceRecord:o}=Ld(n,t);if(s)throw new Mn(ku(r,"Error",{...t,referenceRecord:{...t.referenceRecord,...o}}))},Nw=(e,t)=>{for(const n of e)if(n.type==="endpoint"){const r=h6(n,t);if(r)return r}else if(n.type==="error")p6(n,t);else if(n.type==="tree"){const r=Ow.evaluateTreeRule(n,t);if(r)return r}else throw new Mn(`Unknown endpoint rule: ${n}`);throw new Mn("Rules evaluation failed")},g6=(e,t)=>{const{conditions:n,rules:r}=e,{result:s,referenceRecord:o}=Ld(n,t);if(s)return Ow.evaluateRules(r,{...t,referenceRecord:{...t.referenceRecord,...o}})},Ow={evaluateRules:Nw,evaluateTreeRule:g6},m6=(e,t)=>{var f,m,y,w;const{endpointParams:n,logger:r}=t,{parameters:s,rules:o}=e;(m=(f=t.logger)==null?void 0:f.debug)==null||m.call(f,`${Uo} Initial EndpointParams: ${xi(n)}`);const u=Object.entries(s).filter(([,E])=>E.default!=null).map(([E,F])=>[E,F.default]);if(u.length>0)for(const[E,F]of u)n[E]=n[E]??F;const c=Object.entries(s).filter(([,E])=>E.required).map(([E])=>E);for(const E of c)if(n[E]==null)throw new Mn(`Missing required parameter: '${E}'`);const d=Nw(o,{endpointParams:n,logger:r,referenceRecord:{}});return(w=(y=t.logger)==null?void 0:y.debug)==null||w.call(y,`${Uo} Resolved endpoint: ${xi(d)}`),d},Uw=(e,t=!1)=>{if(t){for(const n of e.split("."))if(!Uw(n))return!1;return!0}return!(!zo(e)||e.length<3||e.length>63||e!==e.toLowerCase()||$d(e))},U0=":",y6="/",D6=e=>{const t=e.split(U0);if(t.length<6)return null;const[n,r,s,o,u,...c]=t;if(n!=="arn"||r===""||s===""||c.join(U0)==="")return null;const d=c.map(f=>f.split(y6)).flat();return{partition:r,service:s,region:o,accountId:u,resourceId:d}},w6=[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-east-2":{description:"Asia Pacific (Taipei)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"ap-southeast-6":{description:"Asia Pacific (New Zealand)"},"ap-southeast-7":{description:"Asia Pacific (Thailand)"},"aws-global":{description:"aws global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"mx-central-1":{description:"Mexico (Central)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"aws-cn global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-eusc",outputs:{dnsSuffix:"amazonaws.eu",dualStackDnsSuffix:"api.amazonwebservices.eu",implicitGlobalRegion:"eusc-de-east-1",name:"aws-eusc",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eusc\\-(de)\\-\\w+\\-\\d+$",regions:{"eusc-de-east-1":{description:"AWS European Sovereign Cloud (Germany)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"api.aws.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"aws-iso global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"api.aws.scloud",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"aws-iso-b global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"},"us-isob-west-1":{description:"US ISOB West"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"api.cloud-aws.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"aws-iso-e-global":{description:"aws-iso-e global region"},"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"api.aws.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{"aws-iso-f-global":{description:"aws-iso-f global region"},"us-isof-east-1":{description:"US ISOF EAST"},"us-isof-south-1":{description:"US ISOF SOUTH"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"aws-us-gov global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}}],b6={partitions:w6};let E6=b6;const v6=e=>{const{partitions:t}=E6;for(const r of t){const{regions:s,outputs:o}=r;for(const[u,c]of Object.entries(s))if(u===e)return{...o,...c}}for(const r of t){const{regionRegex:s,outputs:o}=r;if(new RegExp(s).test(e))return{...o}}const n=t.find(r=>r.id==="aws");if(!n)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...n.outputs}},S6={isVirtualHostableS3Bucket:Uw,parseArn:D6,partition:v6};Oo.aws=S6;function C6(e){const t={};if(e=e.replace(/^\?/,""),e)for(const n of e.split("&")){let[r,s=null]=n.split("=");r=decodeURIComponent(r),s&&(s=decodeURIComponent(s)),r in t?Array.isArray(t[r])?t[r].push(s):t[r]=[t[r],s]:t[r]=s}return t}const du=e=>{if(typeof e=="string")return du(new URL(e));const{hostname:t,pathname:n,port:r,protocol:s,search:o}=e;let u;return o&&(u=C6(o)),{hostname:t,port:r?parseInt(r):void 0,protocol:s,path:n,query:u}},x6=/\d{12}\.ddb/;async function A6(e,t,n){var o,u,c,d,f,m,y;const r=n.request;if(((o=r==null?void 0:r.headers)==null?void 0:o["smithy-protocol"])==="rpc-v2-cbor"&&At(e,"PROTOCOL_RPC_V2_CBOR","M"),typeof t.retryStrategy=="function"){const w=await t.retryStrategy();typeof w.acquireInitialRetryToken=="function"?(c=(u=w.constructor)==null?void 0:u.name)!=null&&c.includes("Adaptive")?At(e,"RETRY_MODE_ADAPTIVE","F"):At(e,"RETRY_MODE_STANDARD","E"):At(e,"RETRY_MODE_LEGACY","D")}if(typeof t.accountIdEndpointMode=="function"){const w=e.endpointV2;switch(String((d=w==null?void 0:w.url)==null?void 0:d.hostname).match(x6)&&At(e,"ACCOUNT_ID_ENDPOINT","O"),await((f=t.accountIdEndpointMode)==null?void 0:f.call(t))){case"disabled":At(e,"ACCOUNT_ID_MODE_DISABLED","Q");break;case"preferred":At(e,"ACCOUNT_ID_MODE_PREFERRED","P");break;case"required":At(e,"ACCOUNT_ID_MODE_REQUIRED","R");break}}const s=(y=(m=e.__smithy_context)==null?void 0:m.selectedHttpAuthScheme)==null?void 0:y.identity;if(s!=null&&s.$source){const w=s;w.accountId&&At(e,"RESOLVED_ACCOUNT_ID","T");for(const[E,F]of Object.entries(w.$source??{}))At(e,E,F)}}const M0="user-agent",Cl="x-amz-user-agent",$0=" ",xl="/",F6=/[^!$%&'*+\-.^_`|~\w]/g,_6=/[^!$%&'*+\-.^_`|~\w#]/g,L0="-",I6=1024;function B6(e){let t="";for(const n in e){const r=e[n];if(t.length+r.length+1<=I6){t.length?t+=","+r:t+=r;continue}break}return t}const k6=e=>(t,n)=>async r=>{var E,F,I,T;const{request:s}=r;if(!bt.isInstance(s))return t(r);const{headers:o}=s,u=((E=n==null?void 0:n.userAgent)==null?void 0:E.map(Ha))||[],c=(await e.defaultUserAgentProvider()).map(Ha);await A6(n,e,r);const d=n;c.push(`m/${B6(Object.assign({},(F=n.__smithy_context)==null?void 0:F.features,(I=d.__aws_sdk_context)==null?void 0:I.features))}`);const f=((T=e==null?void 0:e.customUserAgent)==null?void 0:T.map(Ha))||[],m=await e.userAgentAppId();m&&c.push(Ha(["app",`${m}`]));const y=[].concat([...c,...u,...f]).join($0),w=[...c.filter($=>$.startsWith("aws-sdk-")),...f].join($0);return e.runtime!=="browser"?(w&&(o[Cl]=o[Cl]?`${o[M0]} ${w}`:w),o[M0]=y):o[Cl]=y,t({...r,request:s})},Ha=e=>{var u;const t=e[0].split(xl).map(c=>c.replace(F6,L0)).join(xl),n=(u=e[1])==null?void 0:u.replace(_6,L0),r=t.indexOf(xl),s=t.substring(0,r);let o=t.substring(r+1);return s==="api"&&(o=o.toLowerCase()),[s,o,n].filter(c=>c&&c.length>0).reduce((c,d,f)=>{switch(f){case 0:return d;case 1:return`${c}/${d}`;default:return`${c}#${d}`}},"")},R6={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},T6=e=>({applyToStack:t=>{t.add(k6(e),R6)}}),P6=!1,N6=!1,z0=new Set,O6=(e,t=zo)=>{if(!z0.has(e)&&!t(e))if(e==="*")console.warn('@smithy/config-resolver WARN - Please use the caller region instead of "*". See "sigv4a" in https://github.com/aws/aws-sdk-js-v3/blob/main/supplemental-docs/CLIENTS.md.');else throw new Error(`Region not accepted: region="${e}" is not a valid hostname component.`);else z0.add(e)},Mw=e=>typeof e=="string"&&(e.startsWith("fips-")||e.endsWith("-fips")),U6=e=>Mw(e)?["fips-aws-global","aws-fips"].includes(e)?"us-east-1":e.replace(/fips-(dkr-|prod-)?|-fips/,""):e,M6=e=>{const{region:t,useFipsEndpoint:n}=e;if(!t)throw new Error("Region is missing");return Object.assign(e,{region:async()=>{const r=typeof t=="function"?await t():t,s=U6(r);return O6(s),s},useFipsEndpoint:async()=>{const r=typeof t=="string"?t:await t();return Mw(r)?!0:typeof n!="function"?Promise.resolve(!!n):n()}})},$6=e=>Object.assign(e,{eventStreamMarshaller:e.eventStreamSerdeProvider(e)}),H0="content-length";function L6(e){return t=>async n=>{const r=n.request;if(bt.isInstance(r)){const{body:s,headers:o}=r;if(s&&Object.keys(o).map(u=>u.toLowerCase()).indexOf(H0)===-1)try{const u=e(s);r.headers={...r.headers,[H0]:String(u)}}catch{}}return t({...n,request:r})}}const z6={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},H6=e=>({applyToStack:t=>{t.add(L6(e.bodyLengthChecker),z6)}}),G6=async e=>{const t=(e==null?void 0:e.Bucket)||"";if(typeof e.Bucket=="string"&&(e.Bucket=t.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),V6(t)){if(e.ForcePathStyle===!0)throw new Error("Path-style addressing cannot be used with ARN buckets")}else(!K6(t)||t.indexOf(".")!==-1&&!String(e.Endpoint).startsWith("http:")||t.toLowerCase()!==t||t.length<3)&&(e.ForcePathStyle=!0);return e.DisableMultiRegionAccessPoints&&(e.disableMultiRegionAccessPoints=!0,e.DisableMRAP=!0),e},q6=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,j6=/(\d+\.){3}\d+/,W6=/\.\./,K6=e=>q6.test(e)&&!j6.test(e)&&!W6.test(e),V6=e=>{const[t,n,r,,,s]=e.split(":"),o=t==="arn"&&e.split(":").length>=6,u=!!(o&&n&&r&&s);if(o&&!u)throw new Error(`Invalid ARN: ${e} was an invalid ARN.`);return u},Z6=(e,t,n,r=!1)=>{const s=async()=>{let o;if(r){const u=n.clientContextParams;o=(u==null?void 0:u[e])??n[e]??n[t]}else o=n[e]??n[t];return typeof o=="function"?o():o};return e==="credentialScope"||t==="CredentialScope"?async()=>{const o=typeof n.credentials=="function"?await n.credentials():n.credentials;return(o==null?void 0:o.credentialScope)??(o==null?void 0:o.CredentialScope)}:e==="accountId"||t==="AccountId"?async()=>{const o=typeof n.credentials=="function"?await n.credentials():n.credentials;return(o==null?void 0:o.accountId)??(o==null?void 0:o.AccountId)}:e==="endpoint"||t==="endpoint"?async()=>{if(n.isCustomEndpoint===!1)return;const o=await s();if(o&&typeof o=="object"){if("url"in o)return o.url.href;if("hostname"in o){const{protocol:u,hostname:c,port:d,path:f}=o;return`${u}//${c}${d?":"+d:""}${f}`}}return o}:s},$w=async e=>{},Lw=e=>typeof e=="object"?"url"in e?du(e.url):e:du(e),zw=async(e,t,n,r)=>{if(!n.isCustomEndpoint){let u;n.serviceConfiguredEndpoint?u=await n.serviceConfiguredEndpoint():u=await $w(n.serviceId),u&&(n.endpoint=()=>Promise.resolve(Lw(u)),n.isCustomEndpoint=!0)}const s=await Hw(e,t,n);if(typeof n.endpointProvider!="function")throw new Error("config.endpointProvider is not set.");return n.endpointProvider(s,r)},Hw=async(e,t,n)=>{var o;const r={},s=((o=t==null?void 0:t.getEndpointParameterInstructions)==null?void 0:o.call(t))||{};for(const[u,c]of Object.entries(s))switch(c.type){case"staticContextParams":r[u]=c.value;break;case"contextParams":r[u]=e[c.name];break;case"clientContextParams":case"builtInParams":r[u]=await Z6(c.name,u,n,c.type!=="builtInParams")();break;case"operationContextParams":r[u]=c.get(e);break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(c))}return Object.keys(s).length===0&&Object.assign(r,n),String(n.serviceId).toLowerCase()==="s3"&&await G6(r),r},J6=({config:e,instructions:t})=>(n,r)=>async s=>{var c,d,f;e.isCustomEndpoint&&BR(r,"ENDPOINT_OVERRIDE","N");const o=await zw(s.input,{getEndpointParameterInstructions(){return t}},{...e},r);r.endpointV2=o,r.authSchemes=(c=o.properties)==null?void 0:c.authSchemes;const u=(d=r.authSchemes)==null?void 0:d[0];if(u){r.signing_region=u.signingRegion,r.signing_service=u.signingName;const m=Fi(r),y=(f=m==null?void 0:m.selectedHttpAuthScheme)==null?void 0:f.httpAuthOption;y&&(y.signingProperties=Object.assign(y.signingProperties||{},{signing_region:u.signingRegion,signingRegion:u.signingRegion,signing_service:u.signingName,signingName:u.signingName,signingRegionSet:u.signingRegionSet},u.properties))}return n({...s})},X6={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:Mk.name},Gw=(e,t)=>({applyToStack:n=>{n.addRelativeTo(J6({config:e,instructions:t}),X6)}}),Y6=e=>{const t=e.tls??!0,{endpoint:n,useDualstackEndpoint:r,useFipsEndpoint:s}=e,o=n!=null?async()=>Lw(await ar(n)()):void 0,c=Object.assign(e,{endpoint:o,tls:t,isCustomEndpoint:!!n,useDualstackEndpoint:ar(r??!1),useFipsEndpoint:ar(s??!1)});let d;return c.serviceConfiguredEndpoint=async()=>(e.serviceId&&!d&&(d=$w(e.serviceId)),d),c};var Os;(function(e){e.STANDARD="standard",e.ADAPTIVE="adaptive"})(Os||(Os={}));const hu=3,Q6=Os.STANDARD,eP=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],tP=["TimeoutError","RequestTimeout","RequestTimeoutException"],nP=[500,502,503,504],rP=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],iP=["EHOSTUNREACH","ENETUNREACH","ENOTFOUND"],sP=e=>(e==null?void 0:e.$retryable)!==void 0,oP=e=>{var t;return(t=e.$metadata)==null?void 0:t.clockSkewCorrected},aP=e=>{const t=new Set(["Failed to fetch","NetworkError when attempting to fetch resource","The Internet connection appears to be offline","Load failed","Network request failed"]);return e&&e instanceof TypeError?t.has(e.message):!1},qw=e=>{var t,n;return((t=e.$metadata)==null?void 0:t.httpStatusCode)===429||eP.includes(e.name)||((n=e.$retryable)==null?void 0:n.throttling)==!0},zd=(e,t=0)=>{var n;return sP(e)||oP(e)||tP.includes(e.name)||rP.includes((e==null?void 0:e.code)||"")||iP.includes((e==null?void 0:e.code)||"")||nP.includes(((n=e.$metadata)==null?void 0:n.httpStatusCode)||0)||aP(e)||e.cause!==void 0&&t<=10&&zd(e.cause,t+1)},uP=e=>{var t;if(((t=e.$metadata)==null?void 0:t.httpStatusCode)!==void 0){const n=e.$metadata.httpStatusCode;return 500<=n&&n<=599&&!zd(e)}return!1},bu=class bu{constructor(t){P(this,"beta");P(this,"minCapacity");P(this,"minFillRate");P(this,"scaleConstant");P(this,"smooth");P(this,"currentCapacity",0);P(this,"enabled",!1);P(this,"lastMaxRate",0);P(this,"measuredTxRate",0);P(this,"requestCount",0);P(this,"fillRate");P(this,"lastThrottleTime");P(this,"lastTimestamp",0);P(this,"lastTxRateBucket");P(this,"maxCapacity");P(this,"timeWindow",0);this.beta=(t==null?void 0:t.beta)??.7,this.minCapacity=(t==null?void 0:t.minCapacity)??1,this.minFillRate=(t==null?void 0:t.minFillRate)??.5,this.scaleConstant=(t==null?void 0:t.scaleConstant)??.4,this.smooth=(t==null?void 0:t.smooth)??.8;const n=this.getCurrentTimeInSeconds();this.lastThrottleTime=n,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(t){if(this.enabled){if(this.refillTokenBucket(),t>this.currentCapacity){const n=(t-this.currentCapacity)/this.fillRate*1e3;await new Promise(r=>bu.setTimeoutFn(r,n))}this.currentCapacity=this.currentCapacity-t}}refillTokenBucket(){const t=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=t;return}const n=(t-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+n),this.lastTimestamp=t}updateClientSendingRate(t){let n;if(this.updateMeasuredRate(),qw(t)){const s=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=s,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),n=this.cubicThrottle(s),this.enableTokenBucket()}else this.calculateTimeWindow(),n=this.cubicSuccess(this.getCurrentTimeInSeconds());const r=Math.min(n,2*this.measuredTxRate);this.updateTokenBucketRate(r)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(t){return this.getPrecise(t*this.beta)}cubicSuccess(t){return this.getPrecise(this.scaleConstant*Math.pow(t-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(t){this.refillTokenBucket(),this.fillRate=Math.max(t,this.minFillRate),this.maxCapacity=Math.max(t,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){const t=this.getCurrentTimeInSeconds(),n=Math.floor(t*2)/2;if(this.requestCount++,n>this.lastTxRateBucket){const r=this.requestCount/(n-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(r*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=n}}getPrecise(t){return parseFloat(t.toFixed(8))}};P(bu,"setTimeoutFn",setTimeout);let zf=bu;const Hf=100,jw=20*1e3,cP=500,G0=500,lP=5,fP=10,dP=1,hP="amz-sdk-invocation-id",pP="amz-sdk-request",gP=()=>{let e=Hf;return{computeNextBackoffDelay:r=>Math.floor(Math.min(jw,Math.random()*2**r*e)),setDelayBase:r=>{e=r}}},q0=({retryDelay:e,retryCount:t,retryCost:n})=>({getRetryCount:()=>t,getRetryDelay:()=>Math.min(jw,e),getRetryCost:()=>n});class Ww{constructor(t){P(this,"maxAttempts");P(this,"mode",Os.STANDARD);P(this,"capacity",G0);P(this,"retryBackoffStrategy",gP());P(this,"maxAttemptsProvider");this.maxAttempts=t,this.maxAttemptsProvider=typeof t=="function"?t:async()=>t}async acquireInitialRetryToken(t){return q0({retryDelay:Hf,retryCount:0})}async refreshRetryTokenForRetry(t,n){const r=await this.getMaxAttempts();if(this.shouldRetry(t,n,r)){const s=n.errorType;this.retryBackoffStrategy.setDelayBase(s==="THROTTLING"?cP:Hf);const o=this.retryBackoffStrategy.computeNextBackoffDelay(t.getRetryCount()),u=n.retryAfterHint?Math.max(n.retryAfterHint.getTime()-Date.now()||0,o):o,c=this.getCapacityCost(s);return this.capacity-=c,q0({retryDelay:u,retryCount:t.getRetryCount()+1,retryCost:c})}throw new Error("No retry token available")}recordSuccess(t){this.capacity=Math.max(G0,this.capacity+(t.getRetryCost()??dP))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch{return console.warn(`Max attempts provider could not resolve. Using default of ${hu}`),hu}}shouldRetry(t,n,r){return t.getRetryCount()+1<r&&this.capacity>=this.getCapacityCost(n.errorType)&&this.isRetryableError(n.errorType)}getCapacityCost(t){return t==="TRANSIENT"?fP:lP}isRetryableError(t){return t==="THROTTLING"||t==="TRANSIENT"}}class mP{constructor(t,n){P(this,"maxAttemptsProvider");P(this,"rateLimiter");P(this,"standardRetryStrategy");P(this,"mode",Os.ADAPTIVE);this.maxAttemptsProvider=t;const{rateLimiter:r}=n??{};this.rateLimiter=r??new zf,this.standardRetryStrategy=new Ww(t)}async acquireInitialRetryToken(t){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(t)}async refreshRetryTokenForRetry(t,n){return this.rateLimiter.updateClientSendingRate(n),this.standardRetryStrategy.refreshRetryTokenForRetry(t,n)}recordSuccess(t){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(t)}}const yP=e=>e instanceof Error?e:e instanceof Object?Object.assign(new Error,e):typeof e=="string"?new Error(e):new Error(`AWS SDK error wrapper for ${e}`),DP=e=>{const{retryStrategy:t,retryMode:n,maxAttempts:r}=e,s=ar(r??hu);return Object.assign(e,{maxAttempts:s,retryStrategy:async()=>t||(await ar(n)()===Os.ADAPTIVE?new mP(s):new Ww(s))})},wP=e=>(e==null?void 0:e.body)instanceof ReadableStream,bP=e=>(t,n)=>async r=>{var u;let s=await e.retryStrategy();const o=await e.maxAttempts();if(EP(s)){s=s;let c=await s.acquireInitialRetryToken(n.partition_id),d=new Error,f=0,m=0;const{request:y}=r,w=bt.isInstance(y);for(w&&(y.headers[hP]=_d());;)try{w&&(y.headers[pP]=`attempt=${f+1}; max=${o}`);const{response:E,output:F}=await t(r);return s.recordSuccess(c),F.$metadata.attempts=f+1,F.$metadata.totalRetryDelay=m,{response:E,output:F}}catch(E){const F=vP(E);if(d=yP(E),w&&wP(y))throw(u=n.logger instanceof Pd?console:n.logger)==null||u.warn("An error was encountered in a non-retryable streaming request."),d;try{c=await s.refreshRetryTokenForRetry(c,F)}catch{throw d.$metadata||(d.$metadata={}),d.$metadata.attempts=f+1,d.$metadata.totalRetryDelay=m,d}f=c.getRetryCount();const I=c.getRetryDelay();m+=I,await new Promise(T=>setTimeout(T,I))}}else return s=s,s!=null&&s.mode&&(n.userAgent=[...n.userAgent||[],["cfg/retry-mode",s.mode]]),s.retry(t,r)},EP=e=>typeof e.acquireInitialRetryToken<"u"&&typeof e.refreshRetryTokenForRetry<"u"&&typeof e.recordSuccess<"u",vP=e=>{const t={error:e,errorType:SP(e)},n=AP(e.$response);return n&&(t.retryAfterHint=n),t},SP=e=>qw(e)?"THROTTLING":zd(e)?"TRANSIENT":uP(e)?"SERVER_ERROR":"CLIENT_ERROR",CP={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},xP=e=>({applyToStack:t=>{t.add(bP(e),CP)}}),AP=e=>{if(!ji.isInstance(e))return;const t=Object.keys(e.headers).find(o=>o.toLowerCase()==="retry-after");if(!t)return;const n=e.headers[t],r=Number(n);return Number.isNaN(r)?new Date(n):new Date(r*1e3)};class Hd{constructor(t){P(this,"sigv4aSigner");P(this,"sigv4Signer");P(this,"signerOptions");this.sigv4Signer=new F8(t),this.signerOptions=t}static sigv4aDependency(){return"none"}async sign(t,n={}){return n.signingRegion==="*"?this.getSigv4aSigner().sign(t,n):this.sigv4Signer.sign(t,n)}async signWithCredentials(t,n,r={}){if(r.signingRegion==="*")throw this.getSigv4aSigner(),new Error(`signWithCredentials with signingRegion '*' is only supported when using the CRT dependency @aws-sdk/signature-v4-crt. Please check whether you have installed the "@aws-sdk/signature-v4-crt" package explicitly. You must also register the package by calling [require("@aws-sdk/signature-v4-crt");] or an ESM equivalent such as [import "@aws-sdk/signature-v4-crt";]. For more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt`);return this.sigv4Signer.signWithCredentials(t,n,r)}async presign(t,n={}){if(n.signingRegion==="*")throw this.getSigv4aSigner(),new Error(`presign with signingRegion '*' is only supported when using the CRT dependency @aws-sdk/signature-v4-crt. Please check whether you have installed the "@aws-sdk/signature-v4-crt" package explicitly. You must also register the package by calling [require("@aws-sdk/signature-v4-crt");] or an ESM equivalent such as [import "@aws-sdk/signature-v4-crt";]. For more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt`);return this.sigv4Signer.presign(t,n)}async presignWithCredentials(t,n,r={}){if(r.signingRegion==="*")throw new Error("Method presignWithCredentials is not supported for [signingRegion=*].");return this.sigv4Signer.presignWithCredentials(t,n,r)}getSigv4aSigner(){if(!this.sigv4aSigner)throw this.signerOptions.runtime==="node"?new Error("Neither CRT nor JS SigV4a implementation is available. Please load either @aws-sdk/signature-v4-crt or @aws-sdk/signature-v4a. For more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt"):new Error("JS SigV4a implementation is not available or not a valid constructor. Please check whether you have installed the @aws-sdk/signature-v4a package explicitly. The CRT implementation is not available for browsers. You must also register the package by calling [require('@aws-sdk/signature-v4a');] or an ESM equivalent such as [import '@aws-sdk/signature-v4a';]. For more information please go to https://github.com/aws/aws-sdk-js-v3#using-javascript-non-crt-implementation-of-sigv4a");return this.sigv4aSigner}}const Kw=(e,t=!1)=>{if(t){for(const n of e.split("."))if(!Kw(n))return!1;return!0}return!(!zo(e)||e.length<3||e.length>63||e!==e.toLowerCase()||$d(e))},j0=":",FP="/",_P=e=>{const t=e.split(j0);if(t.length<6)return null;const[n,r,s,o,u,...c]=t;if(n!=="arn"||r===""||s===""||c.join(j0)==="")return null;const d=c.map(f=>f.split(FP)).flat();return{partition:r,service:s,region:o,accountId:u,resourceId:d}},IP=[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-east-2":{description:"Asia Pacific (Taipei)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"ap-southeast-6":{description:"Asia Pacific (New Zealand)"},"ap-southeast-7":{description:"Asia Pacific (Thailand)"},"aws-global":{description:"aws global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"mx-central-1":{description:"Mexico (Central)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"aws-cn global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-eusc",outputs:{dnsSuffix:"amazonaws.eu",dualStackDnsSuffix:"api.amazonwebservices.eu",implicitGlobalRegion:"eusc-de-east-1",name:"aws-eusc",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eusc\\-(de)\\-\\w+\\-\\d+$",regions:{"eusc-de-east-1":{description:"AWS European Sovereign Cloud (Germany)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"api.aws.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"aws-iso global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"api.aws.scloud",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"aws-iso-b global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"},"us-isob-west-1":{description:"US ISOB West"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"api.cloud-aws.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"aws-iso-e-global":{description:"aws-iso-e global region"},"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"api.aws.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{"aws-iso-f-global":{description:"aws-iso-f global region"},"us-isof-east-1":{description:"US ISOF EAST"},"us-isof-south-1":{description:"US ISOF SOUTH"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"aws-us-gov global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}}],BP={partitions:IP};let kP=BP;const RP=e=>{const{partitions:t}=kP;for(const r of t){const{regions:s,outputs:o}=r;for(const[u,c]of Object.entries(s))if(u===e)return{...o,...c}}for(const r of t){const{regionRegex:s,outputs:o}=r;if(new RegExp(s).test(e))return{...o}}const n=t.find(r=>r.id==="aws");if(!n)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...n.outputs}},Vw={isVirtualHostableS3Bucket:Kw,parseArn:_P,partition:RP};Oo.aws=Vw;const Gd="required",_="type",W="rules",N="conditions",L="fn",z="argv",pe="ref",Fe="assign",re="url",ie="properties",Xr="backend",$t="authSchemes",Ft="disableDoubleEncoding",_t="signingName",jt="signingRegion",se="headers",qd="signingRegionSet",TP=6,PP=!1,wr=!0,Un="isSet",wt="booleanEquals",ue="error",pu="aws.partition",Le="stringEquals",ot="getAttr",at="name",Ye="substring",W0="bucketSuffix",jd="parseURL",X="endpoint",K="tree",gu="aws.isVirtualHostableS3Bucket",mu="{url#scheme}://{Bucket}.{url#authority}{url#path}",_r="not",K0="accessPointSuffix",Za="{url#scheme}://{url#authority}{url#path}",Zw="hardwareType",Jw="regionPrefix",V0="bucketAliasSuffix",Gf="outpostId",Ji="isValidHostLabel",Wd="sigv4a",Mo="s3-outposts",Us="s3",Xw="{url#scheme}://{url#authority}{url#normalizedPath}{Bucket}",Yw="https://{Bucket}.s3-accelerate.{partitionResult#dnsSuffix}",Z0="https://{Bucket}.s3.{partitionResult#dnsSuffix}",Qw="aws.parseArn",eb="bucketArn",tb="arnType",yu="",Kd="s3-object-lambda",nb="accesspoint",Vd="accessPointName",J0="{url#scheme}://{accessPointName}-{bucketArn#accountId}.{url#authority}{url#path}",X0="mrapPartition",Y0="outpostType",Q0="arnPrefix",rb="{url#scheme}://{url#authority}{url#normalizedPath}{uri_encoded_bucket}",em="https://s3.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",tm="https://s3.{partitionResult#dnsSuffix}",gs={[Gd]:!1,[_]:"string"},ms={[Gd]:!0,default:!1,[_]:"boolean"},po={[Gd]:!1,[_]:"boolean"},Zn={[L]:wt,[z]:[{[pe]:"Accelerate"},!0]},tt={[L]:wt,[z]:[{[pe]:"UseFIPS"},!0]},Ze={[L]:wt,[z]:[{[pe]:"UseDualStack"},!0]},pt={[L]:Un,[z]:[{[pe]:"Endpoint"}]},ib={[L]:pu,[z]:[{[pe]:"Region"}],[Fe]:"partitionResult"},nm={[L]:Le,[z]:[{[L]:ot,[z]:[{[pe]:"partitionResult"},at]},"aws-cn"]},vo={[L]:Un,[z]:[{[pe]:"Bucket"}]},$e={[pe]:"Bucket"},rm={[N]:[Zn],[ue]:"S3Express does not support S3 Accelerate.",[_]:ue},im={[N]:[pt,{[L]:jd,[z]:[{[pe]:"Endpoint"}],[Fe]:"url"}],[W]:[{[N]:[{[L]:Un,[z]:[{[pe]:"DisableS3ExpressSessionAuth"}]},{[L]:wt,[z]:[{[pe]:"DisableS3ExpressSessionAuth"},!0]}],[W]:[{[N]:[{[L]:wt,[z]:[{[L]:ot,[z]:[{[pe]:"url"},"isIp"]},!0]}],[W]:[{[N]:[{[L]:"uriEncode",[z]:[$e],[Fe]:"uri_encoded_bucket"}],[W]:[{[X]:{[re]:"{url#scheme}://{url#authority}/{uri_encoded_bucket}{url#path}",[ie]:{[Xr]:"S3Express",[$t]:[{[Ft]:!0,[at]:"sigv4",[_t]:"s3express",[jt]:"{Region}"}]},[se]:{}},[_]:X}],[_]:K}],[_]:K},{[N]:[{[L]:gu,[z]:[$e,!1]}],[W]:[{[X]:{[re]:mu,[ie]:{[Xr]:"S3Express",[$t]:[{[Ft]:!0,[at]:"sigv4",[_t]:"s3express",[jt]:"{Region}"}]},[se]:{}},[_]:X}],[_]:K},{[ue]:"S3Express bucket name is not a valid virtual hostable name.",[_]:ue}],[_]:K},{[N]:[{[L]:wt,[z]:[{[L]:ot,[z]:[{[pe]:"url"},"isIp"]},!0]}],[W]:[{[N]:[{[L]:"uriEncode",[z]:[$e],[Fe]:"uri_encoded_bucket"}],[W]:[{[X]:{[re]:"{url#scheme}://{url#authority}/{uri_encoded_bucket}{url#path}",[ie]:{[Xr]:"S3Express",[$t]:[{[Ft]:!0,[at]:"sigv4-s3express",[_t]:"s3express",[jt]:"{Region}"}]},[se]:{}},[_]:X}],[_]:K}],[_]:K},{[N]:[{[L]:gu,[z]:[$e,!1]}],[W]:[{[X]:{[re]:mu,[ie]:{[Xr]:"S3Express",[$t]:[{[Ft]:!0,[at]:"sigv4-s3express",[_t]:"s3express",[jt]:"{Region}"}]},[se]:{}},[_]:X}],[_]:K},{[ue]:"S3Express bucket name is not a valid virtual hostable name.",[_]:ue}],[_]:K},cn={[L]:jd,[z]:[{[pe]:"Endpoint"}],[Fe]:"url"},Al={[L]:wt,[z]:[{[L]:ot,[z]:[{[pe]:"url"},"isIp"]},!0]},sb={[pe]:"url"},ob={[L]:"uriEncode",[z]:[$e],[Fe]:"uri_encoded_bucket"},Nn={[Xr]:"S3Express",[$t]:[{[Ft]:!0,[at]:"sigv4",[_t]:"s3express",[jt]:"{Region}"}]},Se={},ab={[L]:gu,[z]:[$e,!1]},sm={[ue]:"S3Express bucket name is not a valid virtual hostable name.",[_]:ue},om={[L]:Un,[z]:[{[pe]:"UseS3ExpressControlEndpoint"}]},am={[L]:wt,[z]:[{[pe]:"UseS3ExpressControlEndpoint"},!0]},xe={[L]:_r,[z]:[pt]},Ne={[L]:wt,[z]:[{[pe]:"UseDualStack"},!1]},Re={[L]:wt,[z]:[{[pe]:"UseFIPS"},!1]},Ga={[ue]:"Unrecognized S3Express bucket name format.",[_]:ue},um={[L]:_r,[z]:[vo]},cm={[pe]:Zw},lm={[N]:[xe],[ue]:"Expected a endpoint to be specified but no endpoint was found",[_]:ue},qa={[$t]:[{[Ft]:!0,[at]:Wd,[_t]:Mo,[qd]:["*"]},{[Ft]:!0,[at]:"sigv4",[_t]:Mo,[jt]:"{Region}"}]},Fl={[L]:wt,[z]:[{[pe]:"ForcePathStyle"},!1]},NP={[pe]:"ForcePathStyle"},xt={[L]:wt,[z]:[{[pe]:"Accelerate"},!1]},Pt={[L]:Le,[z]:[{[pe]:"Region"},"aws-global"]},Ot={[$t]:[{[Ft]:!0,[at]:"sigv4",[_t]:Us,[jt]:"us-east-1"}]},Ue={[L]:_r,[z]:[Pt]},Ut={[L]:wt,[z]:[{[pe]:"UseGlobalEndpoint"},!0]},fm={[re]:"https://{Bucket}.s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}",[ie]:{[$t]:[{[Ft]:!0,[at]:"sigv4",[_t]:Us,[jt]:"{Region}"}]},[se]:{}},It={[$t]:[{[Ft]:!0,[at]:"sigv4",[_t]:Us,[jt]:"{Region}"}]},Mt={[L]:wt,[z]:[{[pe]:"UseGlobalEndpoint"},!1]},dm={[re]:"https://{Bucket}.s3-fips.{Region}.{partitionResult#dnsSuffix}",[ie]:It,[se]:{}},hm={[re]:"https://{Bucket}.s3-accelerate.dualstack.{partitionResult#dnsSuffix}",[ie]:It,[se]:{}},pm={[re]:"https://{Bucket}.s3.dualstack.{Region}.{partitionResult#dnsSuffix}",[ie]:It,[se]:{}},_l={[L]:wt,[z]:[{[L]:ot,[z]:[sb,"isIp"]},!1]},Il={[re]:Xw,[ie]:It,[se]:{}},qf={[re]:mu,[ie]:It,[se]:{}},gm={[X]:qf,[_]:X},Bl={[re]:Yw,[ie]:It,[se]:{}},mm={[re]:"https://{Bucket}.s3.{Region}.{partitionResult#dnsSuffix}",[ie]:It,[se]:{}},ja={[ue]:"Invalid region: region was not a valid DNS name.",[_]:ue},Cn={[pe]:eb},ub={[pe]:tb},kl={[L]:ot,[z]:[Cn,"service"]},Zd={[pe]:Vd},ym={[N]:[Ze],[ue]:"S3 Object Lambda does not support Dual-stack",[_]:ue},Dm={[N]:[Zn],[ue]:"S3 Object Lambda does not support S3 Accelerate",[_]:ue},wm={[N]:[{[L]:Un,[z]:[{[pe]:"DisableAccessPoints"}]},{[L]:wt,[z]:[{[pe]:"DisableAccessPoints"},!0]}],[ue]:"Access points are not supported for this operation",[_]:ue},Rl={[N]:[{[L]:Un,[z]:[{[pe]:"UseArnRegion"}]},{[L]:wt,[z]:[{[pe]:"UseArnRegion"},!1]},{[L]:_r,[z]:[{[L]:Le,[z]:[{[L]:ot,[z]:[Cn,"region"]},"{Region}"]}]}],[ue]:"Invalid configuration: region from ARN `{bucketArn#region}` does not match client region `{Region}` and UseArnRegion is `false`",[_]:ue},cb={[L]:ot,[z]:[{[pe]:"bucketPartition"},at]},lb={[L]:ot,[z]:[Cn,"accountId"]},Tl={[$t]:[{[Ft]:!0,[at]:"sigv4",[_t]:Kd,[jt]:"{bucketArn#region}"}]},bm={[ue]:"Invalid ARN: The access point name may only contain a-z, A-Z, 0-9 and `-`. Found: `{accessPointName}`",[_]:ue},Pl={[ue]:"Invalid ARN: The account id may only contain a-z, A-Z, 0-9 and `-`. Found: `{bucketArn#accountId}`",[_]:ue},Nl={[ue]:"Invalid region in ARN: `{bucketArn#region}` (invalid DNS name)",[_]:ue},Ol={[ue]:"Client was configured for partition `{partitionResult#name}` but ARN (`{Bucket}`) has `{bucketPartition#name}`",[_]:ue},Em={[ue]:"Invalid ARN: The ARN may only contain a single resource component after `accesspoint`.",[_]:ue},vm={[ue]:"Invalid ARN: Expected a resource of the format `accesspoint:<accesspoint name>` but no name was provided",[_]:ue},go={[$t]:[{[Ft]:!0,[at]:"sigv4",[_t]:Us,[jt]:"{bucketArn#region}"}]},Sm={[$t]:[{[Ft]:!0,[at]:Wd,[_t]:Mo,[qd]:["*"]},{[Ft]:!0,[at]:"sigv4",[_t]:Mo,[jt]:"{bucketArn#region}"}]},Cm={[L]:Qw,[z]:[$e]},xm={[re]:"https://s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[ie]:It,[se]:{}},Am={[re]:"https://s3-fips.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[ie]:It,[se]:{}},Fm={[re]:"https://s3.dualstack.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[ie]:It,[se]:{}},Ul={[re]:rb,[ie]:It,[se]:{}},_m={[re]:"https://s3.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[ie]:It,[se]:{}},Im={[pe]:"UseObjectLambdaEndpoint"},Ml={[$t]:[{[Ft]:!0,[at]:"sigv4",[_t]:Kd,[jt]:"{Region}"}]},Bm={[re]:"https://s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}",[ie]:It,[se]:{}},km={[re]:"https://s3-fips.{Region}.{partitionResult#dnsSuffix}",[ie]:It,[se]:{}},Rm={[re]:"https://s3.dualstack.{Region}.{partitionResult#dnsSuffix}",[ie]:It,[se]:{}},$l={[re]:Za,[ie]:It,[se]:{}},Tm={[re]:"https://s3.{Region}.{partitionResult#dnsSuffix}",[ie]:It,[se]:{}},Ll=[{[pe]:"Region"}],OP=[{[pe]:"Endpoint"}],UP=[$e],zl=[Zn],ys=[pt,cn],Pm=[{[L]:Un,[z]:[{[pe]:"DisableS3ExpressSessionAuth"}]},{[L]:wt,[z]:[{[pe]:"DisableS3ExpressSessionAuth"},!0]}],MP=[ob],Hl=[ab],Vn=[ib],Gl=[tt,Ze],So=[tt,Ne],Co=[Re,Ze],xo=[Re,Ne],Nm=[{[L]:Ye,[z]:[$e,6,14,!0],[Fe]:"s3expressAvailabilityZoneId"},{[L]:Ye,[z]:[$e,14,16,!0],[Fe]:"s3expressAvailabilityZoneDelim"},{[L]:Le,[z]:[{[pe]:"s3expressAvailabilityZoneDelim"},"--"]}],br=[{[N]:[tt,Ze],[X]:{[re]:"https://{Bucket}.s3express-fips-{s3expressAvailabilityZoneId}.dualstack.{Region}.{partitionResult#dnsSuffix}",[ie]:Nn,[se]:{}},[_]:X},{[N]:So,[X]:{[re]:"https://{Bucket}.s3express-fips-{s3expressAvailabilityZoneId}.{Region}.{partitionResult#dnsSuffix}",[ie]:Nn,[se]:{}},[_]:X},{[N]:Co,[X]:{[re]:"https://{Bucket}.s3express-{s3expressAvailabilityZoneId}.dualstack.{Region}.{partitionResult#dnsSuffix}",[ie]:Nn,[se]:{}},[_]:X},{[N]:xo,[X]:{[re]:"https://{Bucket}.s3express-{s3expressAvailabilityZoneId}.{Region}.{partitionResult#dnsSuffix}",[ie]:Nn,[se]:{}},[_]:X}],Om=[{[L]:Ye,[z]:[$e,6,15,!0],[Fe]:"s3expressAvailabilityZoneId"},{[L]:Ye,[z]:[$e,15,17,!0],[Fe]:"s3expressAvailabilityZoneDelim"},{[L]:Le,[z]:[{[pe]:"s3expressAvailabilityZoneDelim"},"--"]}],Um=[{[L]:Ye,[z]:[$e,6,19,!0],[Fe]:"s3expressAvailabilityZoneId"},{[L]:Ye,[z]:[$e,19,21,!0],[Fe]:"s3expressAvailabilityZoneDelim"},{[L]:Le,[z]:[{[pe]:"s3expressAvailabilityZoneDelim"},"--"]}],Mm=[{[L]:Ye,[z]:[$e,6,20,!0],[Fe]:"s3expressAvailabilityZoneId"},{[L]:Ye,[z]:[$e,20,22,!0],[Fe]:"s3expressAvailabilityZoneDelim"},{[L]:Le,[z]:[{[pe]:"s3expressAvailabilityZoneDelim"},"--"]}],$m=[{[L]:Ye,[z]:[$e,6,26,!0],[Fe]:"s3expressAvailabilityZoneId"},{[L]:Ye,[z]:[$e,26,28,!0],[Fe]:"s3expressAvailabilityZoneDelim"},{[L]:Le,[z]:[{[pe]:"s3expressAvailabilityZoneDelim"},"--"]}],Er=[{[N]:[tt,Ze],[X]:{[re]:"https://{Bucket}.s3express-fips-{s3expressAvailabilityZoneId}.dualstack.{Region}.{partitionResult#dnsSuffix}",[ie]:{[Xr]:"S3Express",[$t]:[{[Ft]:!0,[at]:"sigv4-s3express",[_t]:"s3express",[jt]:"{Region}"}]},[se]:{}},[_]:X},{[N]:So,[X]:{[re]:"https://{Bucket}.s3express-fips-{s3expressAvailabilityZoneId}.{Region}.{partitionResult#dnsSuffix}",[ie]:{[Xr]:"S3Express",[$t]:[{[Ft]:!0,[at]:"sigv4-s3express",[_t]:"s3express",[jt]:"{Region}"}]},[se]:{}},[_]:X},{[N]:Co,[X]:{[re]:"https://{Bucket}.s3express-{s3expressAvailabilityZoneId}.dualstack.{Region}.{partitionResult#dnsSuffix}",[ie]:{[Xr]:"S3Express",[$t]:[{[Ft]:!0,[at]:"sigv4-s3express",[_t]:"s3express",[jt]:"{Region}"}]},[se]:{}},[_]:X},{[N]:xo,[X]:{[re]:"https://{Bucket}.s3express-{s3expressAvailabilityZoneId}.{Region}.{partitionResult#dnsSuffix}",[ie]:{[Xr]:"S3Express",[$t]:[{[Ft]:!0,[at]:"sigv4-s3express",[_t]:"s3express",[jt]:"{Region}"}]},[se]:{}},[_]:X}],Lm=[$e,0,7,!0],zm=[{[L]:Ye,[z]:[$e,7,15,!0],[Fe]:"s3expressAvailabilityZoneId"},{[L]:Ye,[z]:[$e,15,17,!0],[Fe]:"s3expressAvailabilityZoneDelim"},{[L]:Le,[z]:[{[pe]:"s3expressAvailabilityZoneDelim"},"--"]}],Hm=[{[L]:Ye,[z]:[$e,7,16,!0],[Fe]:"s3expressAvailabilityZoneId"},{[L]:Ye,[z]:[$e,16,18,!0],[Fe]:"s3expressAvailabilityZoneDelim"},{[L]:Le,[z]:[{[pe]:"s3expressAvailabilityZoneDelim"},"--"]}],Gm=[{[L]:Ye,[z]:[$e,7,20,!0],[Fe]:"s3expressAvailabilityZoneId"},{[L]:Ye,[z]:[$e,20,22,!0],[Fe]:"s3expressAvailabilityZoneDelim"},{[L]:Le,[z]:[{[pe]:"s3expressAvailabilityZoneDelim"},"--"]}],qm=[{[L]:Ye,[z]:[$e,7,21,!0],[Fe]:"s3expressAvailabilityZoneId"},{[L]:Ye,[z]:[$e,21,23,!0],[Fe]:"s3expressAvailabilityZoneDelim"},{[L]:Le,[z]:[{[pe]:"s3expressAvailabilityZoneDelim"},"--"]}],jm=[{[L]:Ye,[z]:[$e,7,27,!0],[Fe]:"s3expressAvailabilityZoneId"},{[L]:Ye,[z]:[$e,27,29,!0],[Fe]:"s3expressAvailabilityZoneDelim"},{[L]:Le,[z]:[{[pe]:"s3expressAvailabilityZoneDelim"},"--"]}],$P=[vo],Wm=[{[L]:Ji,[z]:[{[pe]:Gf},!1]}],Km=[{[L]:Le,[z]:[{[pe]:Jw},"beta"]}],LP=["*"],Vm=[{[L]:Ji,[z]:[{[pe]:"Region"},!1]}],pi=[{[L]:Le,[z]:[{[pe]:"Region"},"us-east-1"]}],ql=[{[L]:Le,[z]:[ub,nb]}],Zm=[{[L]:ot,[z]:[Cn,"resourceId[1]"],[Fe]:Vd},{[L]:_r,[z]:[{[L]:Le,[z]:[Zd,yu]}]}],zP=[Cn,"resourceId[1]"],Jm=[Ze],jl=[{[L]:_r,[z]:[{[L]:Le,[z]:[{[L]:ot,[z]:[Cn,"region"]},yu]}]}],Xm=[{[L]:_r,[z]:[{[L]:Un,[z]:[{[L]:ot,[z]:[Cn,"resourceId[2]"]}]}]}],HP=[Cn,"resourceId[2]"],Wl=[{[L]:pu,[z]:[{[L]:ot,[z]:[Cn,"region"]}],[Fe]:"bucketPartition"}],Ym=[{[L]:Le,[z]:[cb,{[L]:ot,[z]:[{[pe]:"partitionResult"},at]}]}],Kl=[{[L]:Ji,[z]:[{[L]:ot,[z]:[Cn,"region"]},!0]}],Vl=[{[L]:Ji,[z]:[lb,!1]}],Qm=[{[L]:Ji,[z]:[Zd,!1]}],Wa=[tt],ey=[{[L]:Ji,[z]:[{[pe]:"Region"},!0]}],GP={parameters:{Bucket:gs,Region:gs,UseFIPS:ms,UseDualStack:ms,Endpoint:gs,ForcePathStyle:ms,Accelerate:ms,UseGlobalEndpoint:ms,UseObjectLambdaEndpoint:po,Key:gs,Prefix:gs,CopySource:gs,DisableAccessPoints:po,DisableMultiRegionAccessPoints:ms,UseArnRegion:po,UseS3ExpressControlEndpoint:po,DisableS3ExpressSessionAuth:po},[W]:[{[N]:[{[L]:Un,[z]:Ll}],[W]:[{[N]:[Zn,tt],error:"Accelerate cannot be used with FIPS",[_]:ue},{[N]:[Ze,pt],error:"Cannot set dual-stack in combination with a custom endpoint.",[_]:ue},{[N]:[pt,tt],error:"A custom endpoint cannot be combined with FIPS",[_]:ue},{[N]:[pt,Zn],error:"A custom endpoint cannot be combined with S3 Accelerate",[_]:ue},{[N]:[tt,ib,nm],error:"Partition does not support FIPS",[_]:ue},{[N]:[vo,{[L]:Ye,[z]:[$e,0,TP,wr],[Fe]:W0},{[L]:Le,[z]:[{[pe]:W0},"--x-s3"]}],[W]:[rm,im,{[N]:[om,am],[W]:[{[N]:Vn,[W]:[{[N]:[ob,xe],[W]:[{[N]:Gl,endpoint:{[re]:"https://s3express-control-fips.dualstack.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[ie]:Nn,[se]:Se},[_]:X},{[N]:So,endpoint:{[re]:"https://s3express-control-fips.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[ie]:Nn,[se]:Se},[_]:X},{[N]:Co,endpoint:{[re]:"https://s3express-control.dualstack.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[ie]:Nn,[se]:Se},[_]:X},{[N]:xo,endpoint:{[re]:"https://s3express-control.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[ie]:Nn,[se]:Se},[_]:X}],[_]:K}],[_]:K}],[_]:K},{[N]:Hl,[W]:[{[N]:Vn,[W]:[{[N]:Pm,[W]:[{[N]:Nm,[W]:br,[_]:K},{[N]:Om,[W]:br,[_]:K},{[N]:Um,[W]:br,[_]:K},{[N]:Mm,[W]:br,[_]:K},{[N]:$m,[W]:br,[_]:K},Ga],[_]:K},{[N]:Nm,[W]:Er,[_]:K},{[N]:Om,[W]:Er,[_]:K},{[N]:Um,[W]:Er,[_]:K},{[N]:Mm,[W]:Er,[_]:K},{[N]:$m,[W]:Er,[_]:K},Ga],[_]:K}],[_]:K},sm],[_]:K},{[N]:[vo,{[L]:Ye,[z]:Lm,[Fe]:K0},{[L]:Le,[z]:[{[pe]:K0},"--xa-s3"]}],[W]:[rm,im,{[N]:Hl,[W]:[{[N]:Vn,[W]:[{[N]:Pm,[W]:[{[N]:zm,[W]:br,[_]:K},{[N]:Hm,[W]:br,[_]:K},{[N]:Gm,[W]:br,[_]:K},{[N]:qm,[W]:br,[_]:K},{[N]:jm,[W]:br,[_]:K},Ga],[_]:K},{[N]:zm,[W]:Er,[_]:K},{[N]:Hm,[W]:Er,[_]:K},{[N]:Gm,[W]:Er,[_]:K},{[N]:qm,[W]:Er,[_]:K},{[N]:jm,[W]:Er,[_]:K},Ga],[_]:K}],[_]:K},sm],[_]:K},{[N]:[um,om,am],[W]:[{[N]:Vn,[W]:[{[N]:ys,endpoint:{[re]:Za,[ie]:Nn,[se]:Se},[_]:X},{[N]:Gl,endpoint:{[re]:"https://s3express-control-fips.dualstack.{Region}.{partitionResult#dnsSuffix}",[ie]:Nn,[se]:Se},[_]:X},{[N]:So,endpoint:{[re]:"https://s3express-control-fips.{Region}.{partitionResult#dnsSuffix}",[ie]:Nn,[se]:Se},[_]:X},{[N]:Co,endpoint:{[re]:"https://s3express-control.dualstack.{Region}.{partitionResult#dnsSuffix}",[ie]:Nn,[se]:Se},[_]:X},{[N]:xo,endpoint:{[re]:"https://s3express-control.{Region}.{partitionResult#dnsSuffix}",[ie]:Nn,[se]:Se},[_]:X}],[_]:K}],[_]:K},{[N]:[vo,{[L]:Ye,[z]:[$e,49,50,wr],[Fe]:Zw},{[L]:Ye,[z]:[$e,8,12,wr],[Fe]:Jw},{[L]:Ye,[z]:Lm,[Fe]:V0},{[L]:Ye,[z]:[$e,32,49,wr],[Fe]:Gf},{[L]:pu,[z]:Ll,[Fe]:"regionPartition"},{[L]:Le,[z]:[{[pe]:V0},"--op-s3"]}],[W]:[{[N]:Wm,[W]:[{[N]:Hl,[W]:[{[N]:[{[L]:Le,[z]:[cm,"e"]}],[W]:[{[N]:Km,[W]:[lm,{[N]:ys,endpoint:{[re]:"https://{Bucket}.ec2.{url#authority}",[ie]:qa,[se]:Se},[_]:X}],[_]:K},{endpoint:{[re]:"https://{Bucket}.ec2.s3-outposts.{Region}.{regionPartition#dnsSuffix}",[ie]:qa,[se]:Se},[_]:X}],[_]:K},{[N]:[{[L]:Le,[z]:[cm,"o"]}],[W]:[{[N]:Km,[W]:[lm,{[N]:ys,endpoint:{[re]:"https://{Bucket}.op-{outpostId}.{url#authority}",[ie]:qa,[se]:Se},[_]:X}],[_]:K},{endpoint:{[re]:"https://{Bucket}.op-{outpostId}.s3-outposts.{Region}.{regionPartition#dnsSuffix}",[ie]:qa,[se]:Se},[_]:X}],[_]:K},{error:'Unrecognized hardware type: "Expected hardware type o or e but got {hardwareType}"',[_]:ue}],[_]:K},{error:"Invalid Outposts Bucket alias - it must be a valid bucket name.",[_]:ue}],[_]:K},{error:"Invalid ARN: The outpost Id must only contain a-z, A-Z, 0-9 and `-`.",[_]:ue}],[_]:K},{[N]:$P,[W]:[{[N]:[pt,{[L]:_r,[z]:[{[L]:Un,[z]:[{[L]:jd,[z]:OP}]}]}],error:"Custom endpoint `{Endpoint}` was not a valid URI",[_]:ue},{[N]:[Fl,ab],[W]:[{[N]:Vn,[W]:[{[N]:Vm,[W]:[{[N]:[Zn,nm],error:"S3 Accelerate cannot be used in this region",[_]:ue},{[N]:[Ze,tt,xt,xe,Pt],endpoint:{[re]:"https://{Bucket}.s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}",[ie]:Ot,[se]:Se},[_]:X},{[N]:[Ze,tt,xt,xe,Ue,Ut],[W]:[{endpoint:fm,[_]:X}],[_]:K},{[N]:[Ze,tt,xt,xe,Ue,Mt],endpoint:fm,[_]:X},{[N]:[Ne,tt,xt,xe,Pt],endpoint:{[re]:"https://{Bucket}.s3-fips.us-east-1.{partitionResult#dnsSuffix}",[ie]:Ot,[se]:Se},[_]:X},{[N]:[Ne,tt,xt,xe,Ue,Ut],[W]:[{endpoint:dm,[_]:X}],[_]:K},{[N]:[Ne,tt,xt,xe,Ue,Mt],endpoint:dm,[_]:X},{[N]:[Ze,Re,Zn,xe,Pt],endpoint:{[re]:"https://{Bucket}.s3-accelerate.dualstack.us-east-1.{partitionResult#dnsSuffix}",[ie]:Ot,[se]:Se},[_]:X},{[N]:[Ze,Re,Zn,xe,Ue,Ut],[W]:[{endpoint:hm,[_]:X}],[_]:K},{[N]:[Ze,Re,Zn,xe,Ue,Mt],endpoint:hm,[_]:X},{[N]:[Ze,Re,xt,xe,Pt],endpoint:{[re]:"https://{Bucket}.s3.dualstack.us-east-1.{partitionResult#dnsSuffix}",[ie]:Ot,[se]:Se},[_]:X},{[N]:[Ze,Re,xt,xe,Ue,Ut],[W]:[{endpoint:pm,[_]:X}],[_]:K},{[N]:[Ze,Re,xt,xe,Ue,Mt],endpoint:pm,[_]:X},{[N]:[Ne,Re,xt,pt,cn,Al,Pt],endpoint:{[re]:Xw,[ie]:Ot,[se]:Se},[_]:X},{[N]:[Ne,Re,xt,pt,cn,_l,Pt],endpoint:{[re]:mu,[ie]:Ot,[se]:Se},[_]:X},{[N]:[Ne,Re,xt,pt,cn,Al,Ue,Ut],[W]:[{[N]:pi,endpoint:Il,[_]:X},{endpoint:Il,[_]:X}],[_]:K},{[N]:[Ne,Re,xt,pt,cn,_l,Ue,Ut],[W]:[{[N]:pi,endpoint:qf,[_]:X},gm],[_]:K},{[N]:[Ne,Re,xt,pt,cn,Al,Ue,Mt],endpoint:Il,[_]:X},{[N]:[Ne,Re,xt,pt,cn,_l,Ue,Mt],endpoint:qf,[_]:X},{[N]:[Ne,Re,Zn,xe,Pt],endpoint:{[re]:Yw,[ie]:Ot,[se]:Se},[_]:X},{[N]:[Ne,Re,Zn,xe,Ue,Ut],[W]:[{[N]:pi,endpoint:Bl,[_]:X},{endpoint:Bl,[_]:X}],[_]:K},{[N]:[Ne,Re,Zn,xe,Ue,Mt],endpoint:Bl,[_]:X},{[N]:[Ne,Re,xt,xe,Pt],endpoint:{[re]:Z0,[ie]:Ot,[se]:Se},[_]:X},{[N]:[Ne,Re,xt,xe,Ue,Ut],[W]:[{[N]:pi,endpoint:{[re]:Z0,[ie]:It,[se]:Se},[_]:X},{endpoint:mm,[_]:X}],[_]:K},{[N]:[Ne,Re,xt,xe,Ue,Mt],endpoint:mm,[_]:X}],[_]:K},ja],[_]:K}],[_]:K},{[N]:[pt,cn,{[L]:Le,[z]:[{[L]:ot,[z]:[sb,"scheme"]},"http"]},{[L]:gu,[z]:[$e,wr]},Fl,Re,Ne,xt],[W]:[{[N]:Vn,[W]:[{[N]:Vm,[W]:[gm],[_]:K},ja],[_]:K}],[_]:K},{[N]:[Fl,{[L]:Qw,[z]:UP,[Fe]:eb}],[W]:[{[N]:[{[L]:ot,[z]:[Cn,"resourceId[0]"],[Fe]:tb},{[L]:_r,[z]:[{[L]:Le,[z]:[ub,yu]}]}],[W]:[{[N]:[{[L]:Le,[z]:[kl,Kd]}],[W]:[{[N]:ql,[W]:[{[N]:Zm,[W]:[ym,Dm,{[N]:jl,[W]:[wm,{[N]:Xm,[W]:[Rl,{[N]:Wl,[W]:[{[N]:Vn,[W]:[{[N]:Ym,[W]:[{[N]:Kl,[W]:[{[N]:[{[L]:Le,[z]:[lb,yu]}],error:"Invalid ARN: Missing account id",[_]:ue},{[N]:Vl,[W]:[{[N]:Qm,[W]:[{[N]:ys,endpoint:{[re]:J0,[ie]:Tl,[se]:Se},[_]:X},{[N]:Wa,endpoint:{[re]:"https://{accessPointName}-{bucketArn#accountId}.s3-object-lambda-fips.{bucketArn#region}.{bucketPartition#dnsSuffix}",[ie]:Tl,[se]:Se},[_]:X},{endpoint:{[re]:"https://{accessPointName}-{bucketArn#accountId}.s3-object-lambda.{bucketArn#region}.{bucketPartition#dnsSuffix}",[ie]:Tl,[se]:Se},[_]:X}],[_]:K},bm],[_]:K},Pl],[_]:K},Nl],[_]:K},Ol],[_]:K}],[_]:K}],[_]:K},Em],[_]:K},{error:"Invalid ARN: bucket ARN is missing a region",[_]:ue}],[_]:K},vm],[_]:K},{error:"Invalid ARN: Object Lambda ARNs only support `accesspoint` arn types, but found: `{arnType}`",[_]:ue}],[_]:K},{[N]:ql,[W]:[{[N]:Zm,[W]:[{[N]:jl,[W]:[{[N]:ql,[W]:[{[N]:jl,[W]:[wm,{[N]:Xm,[W]:[Rl,{[N]:Wl,[W]:[{[N]:Vn,[W]:[{[N]:[{[L]:Le,[z]:[cb,"{partitionResult#name}"]}],[W]:[{[N]:Kl,[W]:[{[N]:[{[L]:Le,[z]:[kl,Us]}],[W]:[{[N]:Vl,[W]:[{[N]:Qm,[W]:[{[N]:zl,error:"Access Points do not support S3 Accelerate",[_]:ue},{[N]:Gl,endpoint:{[re]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint-fips.dualstack.{bucketArn#region}.{bucketPartition#dnsSuffix}",[ie]:go,[se]:Se},[_]:X},{[N]:So,endpoint:{[re]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint-fips.{bucketArn#region}.{bucketPartition#dnsSuffix}",[ie]:go,[se]:Se},[_]:X},{[N]:Co,endpoint:{[re]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint.dualstack.{bucketArn#region}.{bucketPartition#dnsSuffix}",[ie]:go,[se]:Se},[_]:X},{[N]:[Re,Ne,pt,cn],endpoint:{[re]:J0,[ie]:go,[se]:Se},[_]:X},{[N]:xo,endpoint:{[re]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint.{bucketArn#region}.{bucketPartition#dnsSuffix}",[ie]:go,[se]:Se},[_]:X}],[_]:K},bm],[_]:K},Pl],[_]:K},{error:"Invalid ARN: The ARN was not for the S3 service, found: {bucketArn#service}",[_]:ue}],[_]:K},Nl],[_]:K},Ol],[_]:K}],[_]:K}],[_]:K},Em],[_]:K}],[_]:K}],[_]:K},{[N]:[{[L]:Ji,[z]:[Zd,wr]}],[W]:[{[N]:Jm,error:"S3 MRAP does not support dual-stack",[_]:ue},{[N]:Wa,error:"S3 MRAP does not support FIPS",[_]:ue},{[N]:zl,error:"S3 MRAP does not support S3 Accelerate",[_]:ue},{[N]:[{[L]:wt,[z]:[{[pe]:"DisableMultiRegionAccessPoints"},wr]}],error:"Invalid configuration: Multi-Region Access Point ARNs are disabled.",[_]:ue},{[N]:[{[L]:pu,[z]:Ll,[Fe]:X0}],[W]:[{[N]:[{[L]:Le,[z]:[{[L]:ot,[z]:[{[pe]:X0},at]},{[L]:ot,[z]:[Cn,"partition"]}]}],[W]:[{endpoint:{[re]:"https://{accessPointName}.accesspoint.s3-global.{mrapPartition#dnsSuffix}",[ie]:{[$t]:[{[Ft]:wr,name:Wd,[_t]:Us,[qd]:LP}]},[se]:Se},[_]:X}],[_]:K},{error:"Client was configured for partition `{mrapPartition#name}` but bucket referred to partition `{bucketArn#partition}`",[_]:ue}],[_]:K}],[_]:K},{error:"Invalid Access Point Name",[_]:ue}],[_]:K},vm],[_]:K},{[N]:[{[L]:Le,[z]:[kl,Mo]}],[W]:[{[N]:Jm,error:"S3 Outposts does not support Dual-stack",[_]:ue},{[N]:Wa,error:"S3 Outposts does not support FIPS",[_]:ue},{[N]:zl,error:"S3 Outposts does not support S3 Accelerate",[_]:ue},{[N]:[{[L]:Un,[z]:[{[L]:ot,[z]:[Cn,"resourceId[4]"]}]}],error:"Invalid Arn: Outpost Access Point ARN contains sub resources",[_]:ue},{[N]:[{[L]:ot,[z]:zP,[Fe]:Gf}],[W]:[{[N]:Wm,[W]:[Rl,{[N]:Wl,[W]:[{[N]:Vn,[W]:[{[N]:Ym,[W]:[{[N]:Kl,[W]:[{[N]:Vl,[W]:[{[N]:[{[L]:ot,[z]:HP,[Fe]:Y0}],[W]:[{[N]:[{[L]:ot,[z]:[Cn,"resourceId[3]"],[Fe]:Vd}],[W]:[{[N]:[{[L]:Le,[z]:[{[pe]:Y0},nb]}],[W]:[{[N]:ys,endpoint:{[re]:"https://{accessPointName}-{bucketArn#accountId}.{outpostId}.{url#authority}",[ie]:Sm,[se]:Se},[_]:X},{endpoint:{[re]:"https://{accessPointName}-{bucketArn#accountId}.{outpostId}.s3-outposts.{bucketArn#region}.{bucketPartition#dnsSuffix}",[ie]:Sm,[se]:Se},[_]:X}],[_]:K},{error:"Expected an outpost type `accesspoint`, found {outpostType}",[_]:ue}],[_]:K},{error:"Invalid ARN: expected an access point name",[_]:ue}],[_]:K},{error:"Invalid ARN: Expected a 4-component resource",[_]:ue}],[_]:K},Pl],[_]:K},Nl],[_]:K},Ol],[_]:K}],[_]:K}],[_]:K},{error:"Invalid ARN: The outpost Id may only contain a-z, A-Z, 0-9 and `-`. Found: `{outpostId}`",[_]:ue}],[_]:K},{error:"Invalid ARN: The Outpost Id was not set",[_]:ue}],[_]:K},{error:"Invalid ARN: Unrecognized format: {Bucket} (type: {arnType})",[_]:ue}],[_]:K},{error:"Invalid ARN: No ARN type specified",[_]:ue}],[_]:K},{[N]:[{[L]:Ye,[z]:[$e,0,4,PP],[Fe]:Q0},{[L]:Le,[z]:[{[pe]:Q0},"arn:"]},{[L]:_r,[z]:[{[L]:Un,[z]:[Cm]}]}],error:"Invalid ARN: `{Bucket}` was not a valid ARN",[_]:ue},{[N]:[{[L]:wt,[z]:[NP,wr]},Cm],error:"Path-style addressing cannot be used with ARN buckets",[_]:ue},{[N]:MP,[W]:[{[N]:Vn,[W]:[{[N]:[xt],[W]:[{[N]:[Ze,xe,tt,Pt],endpoint:{[re]:"https://s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[ie]:Ot,[se]:Se},[_]:X},{[N]:[Ze,xe,tt,Ue,Ut],[W]:[{endpoint:xm,[_]:X}],[_]:K},{[N]:[Ze,xe,tt,Ue,Mt],endpoint:xm,[_]:X},{[N]:[Ne,xe,tt,Pt],endpoint:{[re]:"https://s3-fips.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[ie]:Ot,[se]:Se},[_]:X},{[N]:[Ne,xe,tt,Ue,Ut],[W]:[{endpoint:Am,[_]:X}],[_]:K},{[N]:[Ne,xe,tt,Ue,Mt],endpoint:Am,[_]:X},{[N]:[Ze,xe,Re,Pt],endpoint:{[re]:"https://s3.dualstack.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[ie]:Ot,[se]:Se},[_]:X},{[N]:[Ze,xe,Re,Ue,Ut],[W]:[{endpoint:Fm,[_]:X}],[_]:K},{[N]:[Ze,xe,Re,Ue,Mt],endpoint:Fm,[_]:X},{[N]:[Ne,pt,cn,Re,Pt],endpoint:{[re]:rb,[ie]:Ot,[se]:Se},[_]:X},{[N]:[Ne,pt,cn,Re,Ue,Ut],[W]:[{[N]:pi,endpoint:Ul,[_]:X},{endpoint:Ul,[_]:X}],[_]:K},{[N]:[Ne,pt,cn,Re,Ue,Mt],endpoint:Ul,[_]:X},{[N]:[Ne,xe,Re,Pt],endpoint:{[re]:em,[ie]:Ot,[se]:Se},[_]:X},{[N]:[Ne,xe,Re,Ue,Ut],[W]:[{[N]:pi,endpoint:{[re]:em,[ie]:It,[se]:Se},[_]:X},{endpoint:_m,[_]:X}],[_]:K},{[N]:[Ne,xe,Re,Ue,Mt],endpoint:_m,[_]:X}],[_]:K},{error:"Path-style addressing cannot be used with S3 Accelerate",[_]:ue}],[_]:K}],[_]:K}],[_]:K},{[N]:[{[L]:Un,[z]:[Im]},{[L]:wt,[z]:[Im,wr]}],[W]:[{[N]:Vn,[W]:[{[N]:ey,[W]:[ym,Dm,{[N]:ys,endpoint:{[re]:Za,[ie]:Ml,[se]:Se},[_]:X},{[N]:Wa,endpoint:{[re]:"https://s3-object-lambda-fips.{Region}.{partitionResult#dnsSuffix}",[ie]:Ml,[se]:Se},[_]:X},{endpoint:{[re]:"https://s3-object-lambda.{Region}.{partitionResult#dnsSuffix}",[ie]:Ml,[se]:Se},[_]:X}],[_]:K},ja],[_]:K}],[_]:K},{[N]:[um],[W]:[{[N]:Vn,[W]:[{[N]:ey,[W]:[{[N]:[tt,Ze,xe,Pt],endpoint:{[re]:"https://s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}",[ie]:Ot,[se]:Se},[_]:X},{[N]:[tt,Ze,xe,Ue,Ut],[W]:[{endpoint:Bm,[_]:X}],[_]:K},{[N]:[tt,Ze,xe,Ue,Mt],endpoint:Bm,[_]:X},{[N]:[tt,Ne,xe,Pt],endpoint:{[re]:"https://s3-fips.us-east-1.{partitionResult#dnsSuffix}",[ie]:Ot,[se]:Se},[_]:X},{[N]:[tt,Ne,xe,Ue,Ut],[W]:[{endpoint:km,[_]:X}],[_]:K},{[N]:[tt,Ne,xe,Ue,Mt],endpoint:km,[_]:X},{[N]:[Re,Ze,xe,Pt],endpoint:{[re]:"https://s3.dualstack.us-east-1.{partitionResult#dnsSuffix}",[ie]:Ot,[se]:Se},[_]:X},{[N]:[Re,Ze,xe,Ue,Ut],[W]:[{endpoint:Rm,[_]:X}],[_]:K},{[N]:[Re,Ze,xe,Ue,Mt],endpoint:Rm,[_]:X},{[N]:[Re,Ne,pt,cn,Pt],endpoint:{[re]:Za,[ie]:Ot,[se]:Se},[_]:X},{[N]:[Re,Ne,pt,cn,Ue,Ut],[W]:[{[N]:pi,endpoint:$l,[_]:X},{endpoint:$l,[_]:X}],[_]:K},{[N]:[Re,Ne,pt,cn,Ue,Mt],endpoint:$l,[_]:X},{[N]:[Re,Ne,xe,Pt],endpoint:{[re]:tm,[ie]:Ot,[se]:Se},[_]:X},{[N]:[Re,Ne,xe,Ue,Ut],[W]:[{[N]:pi,endpoint:{[re]:tm,[ie]:It,[se]:Se},[_]:X},{endpoint:Tm,[_]:X}],[_]:K},{[N]:[Re,Ne,xe,Ue,Mt],endpoint:Tm,[_]:X}],[_]:K},ja],[_]:K}],[_]:K}],[_]:K},{error:"A region must be set when sending requests to S3.",[_]:ue}]},qP=GP,jP=new X8({size:50,params:["Accelerate","Bucket","DisableAccessPoints","DisableMultiRegionAccessPoints","DisableS3ExpressSessionAuth","Endpoint","ForcePathStyle","Region","UseArnRegion","UseDualStack","UseFIPS","UseGlobalEndpoint","UseObjectLambdaEndpoint","UseS3ExpressControlEndpoint"]}),fb=(e,t={})=>jP.get(e,()=>m6(qP,{endpointParams:e,logger:t.logger}));Oo.aws=Vw;const WP=e=>async(t,n,r)=>{var c,d,f;if(!r)throw new Error("Could not find `input` for `defaultEndpointRuleSetHttpAuthSchemeParametersProvider`");const s=await e(t,n,r),o=(f=(d=(c=Fi(n))==null?void 0:c.commandInstance)==null?void 0:d.constructor)==null?void 0:f.getEndpointParameterInstructions;if(!o)throw new Error(`getEndpointParameterInstructions() is not defined on '${n.commandName}'`);const u=await Hw(r,{getEndpointParameterInstructions:o},t);return Object.assign(s,u)},KP=async(e,t,n)=>({operation:Fi(t).operation,region:await ar(e.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()}),VP=WP(KP);function db(e){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"s3",region:e.region},propertiesExtractor:(t,n)=>({signingProperties:{config:t,context:n}})}}function hb(e){return{schemeId:"aws.auth#sigv4a",signingProperties:{name:"s3",region:e.region},propertiesExtractor:(t,n)=>({signingProperties:{config:t,context:n}})}}const ZP=(e,t,n)=>s=>{var d;const u=(d=e(s).properties)==null?void 0:d.authSchemes;if(!u)return t(s);const c=[];for(const f of u){const{name:m,properties:y={},...w}=f,E=m.toLowerCase();m!==E&&console.warn(`HttpAuthScheme has been normalized with lowercasing: '${m}' to '${E}'`);let F;if(E==="sigv4a"){F="aws.auth#sigv4a";const $=u.find(V=>{const H=V.name.toLowerCase();return H!=="sigv4a"&&H.startsWith("sigv4")});if(Hd.sigv4aDependency()==="none"&&$)continue}else if(E.startsWith("sigv4"))F="aws.auth#sigv4";else throw new Error(`Unknown HttpAuthScheme found in '@smithy.rules#endpointRuleSet': '${E}'`);const I=n[F];if(!I)throw new Error(`Could not find HttpAuthOption create function for '${F}'`);const T=I(s);T.schemeId=F,T.signingProperties={...T.signingProperties||{},...w,...y},c.push(T)}return c},JP=e=>{const t=[];switch(e.operation){default:t.push(db(e)),t.push(hb(e))}return t},XP=ZP(fb,JP,{"aws.auth#sigv4":db,"aws.auth#sigv4a":hb}),YP=e=>{const t=cT(e),n=UR(t);return Object.assign(n,{authSchemePreference:ar(e.authSchemePreference??[])})},QP=e=>Object.assign(e,{useFipsEndpoint:e.useFipsEndpoint??!1,useDualstackEndpoint:e.useDualstackEndpoint??!1,forcePathStyle:e.forcePathStyle??!1,useAccelerateEndpoint:e.useAccelerateEndpoint??!1,useGlobalEndpoint:e.useGlobalEndpoint??!1,disableMultiregionAccessPoints:e.disableMultiregionAccessPoints??!1,defaultSigningName:"s3",clientContextParams:e.clientContextParams??{}}),pb={ForcePathStyle:{type:"clientContextParams",name:"forcePathStyle"},UseArnRegion:{type:"clientContextParams",name:"useArnRegion"},DisableMultiRegionAccessPoints:{type:"clientContextParams",name:"disableMultiregionAccessPoints"},Accelerate:{type:"clientContextParams",name:"useAccelerateEndpoint"},DisableS3ExpressSessionAuth:{type:"clientContextParams",name:"disableS3ExpressSessionAuth"},UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}};class Lt extends Es{constructor(t){super(t),Object.setPrototypeOf(this,Lt.prototype)}}class Jd extends Lt{constructor(n){super({name:"NoSuchUpload",$fault:"client",...n});P(this,"name","NoSuchUpload");P(this,"$fault","client");Object.setPrototypeOf(this,Jd.prototype)}}class Xd extends Lt{constructor(n){super({name:"AccessDenied",$fault:"client",...n});P(this,"name","AccessDenied");P(this,"$fault","client");Object.setPrototypeOf(this,Xd.prototype)}}class Yd extends Lt{constructor(n){super({name:"ObjectNotInActiveTierError",$fault:"client",...n});P(this,"name","ObjectNotInActiveTierError");P(this,"$fault","client");Object.setPrototypeOf(this,Yd.prototype)}}class Qd extends Lt{constructor(n){super({name:"BucketAlreadyExists",$fault:"client",...n});P(this,"name","BucketAlreadyExists");P(this,"$fault","client");Object.setPrototypeOf(this,Qd.prototype)}}class eh extends Lt{constructor(n){super({name:"BucketAlreadyOwnedByYou",$fault:"client",...n});P(this,"name","BucketAlreadyOwnedByYou");P(this,"$fault","client");Object.setPrototypeOf(this,eh.prototype)}}class th extends Lt{constructor(n){super({name:"NoSuchBucket",$fault:"client",...n});P(this,"name","NoSuchBucket");P(this,"$fault","client");Object.setPrototypeOf(this,th.prototype)}}class nh extends Lt{constructor(n){super({name:"InvalidObjectState",$fault:"client",...n});P(this,"name","InvalidObjectState");P(this,"$fault","client");P(this,"StorageClass");P(this,"AccessTier");Object.setPrototypeOf(this,nh.prototype),this.StorageClass=n.StorageClass,this.AccessTier=n.AccessTier}}class rh extends Lt{constructor(n){super({name:"NoSuchKey",$fault:"client",...n});P(this,"name","NoSuchKey");P(this,"$fault","client");Object.setPrototypeOf(this,rh.prototype)}}class ih extends Lt{constructor(n){super({name:"NotFound",$fault:"client",...n});P(this,"name","NotFound");P(this,"$fault","client");Object.setPrototypeOf(this,ih.prototype)}}class sh extends Lt{constructor(n){super({name:"EncryptionTypeMismatch",$fault:"client",...n});P(this,"name","EncryptionTypeMismatch");P(this,"$fault","client");Object.setPrototypeOf(this,sh.prototype)}}class oh extends Lt{constructor(n){super({name:"InvalidRequest",$fault:"client",...n});P(this,"name","InvalidRequest");P(this,"$fault","client");Object.setPrototypeOf(this,oh.prototype)}}class ah extends Lt{constructor(n){super({name:"InvalidWriteOffset",$fault:"client",...n});P(this,"name","InvalidWriteOffset");P(this,"$fault","client");Object.setPrototypeOf(this,ah.prototype)}}class uh extends Lt{constructor(n){super({name:"TooManyParts",$fault:"client",...n});P(this,"name","TooManyParts");P(this,"$fault","client");Object.setPrototypeOf(this,uh.prototype)}}class ch extends Lt{constructor(n){super({name:"IdempotencyParameterMismatch",$fault:"client",...n});P(this,"name","IdempotencyParameterMismatch");P(this,"$fault","client");Object.setPrototypeOf(this,ch.prototype)}}class lh extends Lt{constructor(n){super({name:"ObjectAlreadyInActiveTierError",$fault:"client",...n});P(this,"name","ObjectAlreadyInActiveTierError");P(this,"$fault","client");Object.setPrototypeOf(this,lh.prototype)}}const eN="ACL",tN="AccessDenied",ty="AccessKeyId",nN="AccessTier",gb="Bucket",rN="BucketAlreadyExists",iN="BucketAlreadyOwnedByYou",Ru="BucketKeyEnabled",sN="Body",oN="ChecksumAlgorithm",aN="CacheControl",mb="ChecksumCRC32",yb="ChecksumCRC32C",Db="ChecksumCRC64NVME",uN="Cache-Control",cN="Content-Disposition",lN="ContentDisposition",fN="Content-Encoding",dN="ContentEncoding",hN="ContentLanguage",pN="Content-Language",gN="Content-Length",mN="ContentLength",yN="Content-MD5",DN="ContentMD5",wb="ChecksumSHA1",bb="ChecksumSHA256",wN="CreateSessionOutput",bN="CreateSessionResult",EN="CreateSessionRequest",vN="CreateSession",SN="ChecksumType",CN="Content-Type",xN="ContentType",ny="Credentials",jf="Expiration",AN="ExpectedBucketOwner",FN="EncryptionTypeMismatch",ry="ETag",iy="Expires",_N="GrantFullControl",IN="GrantRead",BN="GrantReadACP",kN="GrantWriteACP",RN="IfMatch",TN="If-Match",PN="IfNoneMatch",NN="If-None-Match",ON="InvalidObjectState",UN="IdempotencyParameterMismatch",MN="InvalidRequest",$N="InvalidWriteOffset",LN="Key",zN="Metadata",HN="NotFound",GN="NoSuchBucket",qN="NoSuchKey",jN="NoSuchUpload",WN="ObjectAlreadyInActiveTierError",KN="ObjectLockLegalHoldStatus",VN="ObjectLockMode",ZN="ObjectLockRetainUntilDate",JN="ObjectNotInActiveTierError",XN="PutObject",YN="PutObjectOutput",QN="PutObjectRequest",e4="RequestCharged",t4="RequestPayer",sy="SecretAccessKey",n4="StreamingBlob",Eb="StorageClass",r4="SessionCredentialValue",i4="SessionCredentials",s4="SessionMode",Tu="ServerSideEncryption",vb="SSECustomerAlgorithm",Sb="SSECustomerKey",Cb="SSECustomerKeyMD5",Ho="SSEKMSEncryptionContext",Go="SSEKMSKeyId",oy="SessionToken",o4="Size",a4="TooManyParts",u4="Tagging",c4="VersionId",l4="WriteOffsetBytes",f4="WebsiteRedirectLocation",dn="client",hn="error",xb="http",d4="httpChecksum",xn="httpError",he="httpHeader",h4="httpPrefixHeaders",p4="streaming",Ab="smithy.ts.sdk.synthetic.com.amazonaws.s3",vs="xmlName",g4="x-amz-acl",Fb="x-amz-checksum-crc32",_b="x-amz-checksum-crc32c",Ib="x-amz-checksum-crc64nvme",Bb="x-amz-checksum-sha1",kb="x-amz-checksum-sha256",m4="x-amz-create-session-mode",y4="x-amz-checksum-type",D4="x-amz-expiration",w4="x-amz-expected-bucket-owner",b4="x-amz-grant-full-control",E4="x-amz-grant-read",v4="x-amz-grant-read-acp",S4="x-amz-grant-write-acp",C4="x-amz-meta-",x4="x-amz-object-lock-legal-hold",A4="x-amz-object-lock-mode",F4="x-amz-object-lock-retain-until-date",_4="x-amz-object-size",I4="x-amz-request-charged",B4="x-amz-request-payer",k4="x-amz-storage-class",R4="x-amz-sdk-checksum-algorithm",Pu="x-amz-server-side-encryption",Nu="x-amz-server-side-encryption-aws-kms-key-id",Ou="x-amz-server-side-encryption-bucket-key-enabled",Uu="x-amz-server-side-encryption-context",Rb="x-amz-server-side-encryption-customer-algorithm",T4="x-amz-server-side-encryption-customer-key",Tb="x-amz-server-side-encryption-customer-key-MD5",P4="x-amz-tagging",N4="x-amz-version-id",O4="x-amz-write-offset-bytes",U4="x-amz-website-redirect-location",Ie="com.amazonaws.s3";var ay=[0,Ie,r4,8,0],M4=[0,Ie,Sb,8,0],Mu=[0,Ie,Ho,8,0],$u=[0,Ie,Go,8,0],$4=[0,Ie,n4,{[p4]:1},42],L4=[-3,Ie,tN,{[hn]:dn,[xn]:403},[],[]];Et.for(Ie).registerError(L4,Xd);var z4=[-3,Ie,rN,{[hn]:dn,[xn]:409},[],[]];Et.for(Ie).registerError(z4,Qd);var H4=[-3,Ie,iN,{[hn]:dn,[xn]:409},[],[]];Et.for(Ie).registerError(H4,eh);var G4=[3,Ie,wN,{[vs]:bN},[ny,Tu,Go,Ho,Ru],[[()=>iO,{[vs]:ny}],[0,{[he]:Pu}],[()=>$u,{[he]:Nu}],[()=>Mu,{[he]:Uu}],[2,{[he]:Ou}]],1],q4=[3,Ie,EN,0,[gb,s4,Tu,Go,Ho,Ru],[[0,1],[0,{[he]:m4}],[0,{[he]:Pu}],[()=>$u,{[he]:Nu}],[()=>Mu,{[he]:Uu}],[2,{[he]:Ou}]],1],j4=[-3,Ie,FN,{[hn]:dn,[xn]:400},[],[]];Et.for(Ie).registerError(j4,sh);var W4=[-3,Ie,UN,{[hn]:dn,[xn]:400},[],[]];Et.for(Ie).registerError(W4,ch);var K4=[-3,Ie,ON,{[hn]:dn,[xn]:403},[Eb,nN],[0,0]];Et.for(Ie).registerError(K4,nh);var V4=[-3,Ie,MN,{[hn]:dn,[xn]:400},[],[]];Et.for(Ie).registerError(V4,oh);var Z4=[-3,Ie,$N,{[hn]:dn,[xn]:400},[],[]];Et.for(Ie).registerError(Z4,ah);var J4=[-3,Ie,GN,{[hn]:dn,[xn]:404},[],[]];Et.for(Ie).registerError(J4,th);var X4=[-3,Ie,qN,{[hn]:dn,[xn]:404},[],[]];Et.for(Ie).registerError(X4,rh);var Y4=[-3,Ie,jN,{[hn]:dn,[xn]:404},[],[]];Et.for(Ie).registerError(Y4,Jd);var Q4=[-3,Ie,HN,{[hn]:dn},[],[]];Et.for(Ie).registerError(Q4,ih);var eO=[-3,Ie,WN,{[hn]:dn,[xn]:403},[],[]];Et.for(Ie).registerError(eO,lh);var tO=[-3,Ie,JN,{[hn]:dn,[xn]:403},[],[]];Et.for(Ie).registerError(tO,Yd);var nO=[3,Ie,YN,0,[jf,ry,mb,yb,Db,wb,bb,SN,Tu,c4,vb,Cb,Go,Ho,Ru,o4,e4],[[0,{[he]:D4}],[0,{[he]:ry}],[0,{[he]:Fb}],[0,{[he]:_b}],[0,{[he]:Ib}],[0,{[he]:Bb}],[0,{[he]:kb}],[0,{[he]:y4}],[0,{[he]:Pu}],[0,{[he]:N4}],[0,{[he]:Rb}],[0,{[he]:Tb}],[()=>$u,{[he]:Nu}],[()=>Mu,{[he]:Uu}],[2,{[he]:Ou}],[1,{[he]:_4}],[0,{[he]:I4}]]],rO=[3,Ie,QN,0,[gb,LN,eN,sN,aN,lN,dN,hN,mN,DN,xN,oN,mb,yb,Db,wb,bb,iy,RN,PN,_N,IN,BN,kN,l4,zN,Tu,Eb,f4,vb,Sb,Cb,Go,Ho,Ru,t4,u4,VN,ZN,KN,AN],[[0,1],[0,1],[0,{[he]:g4}],[()=>$4,16],[0,{[he]:uN}],[0,{[he]:cN}],[0,{[he]:fN}],[0,{[he]:pN}],[1,{[he]:gN}],[0,{[he]:yN}],[0,{[he]:CN}],[0,{[he]:R4}],[0,{[he]:Fb}],[0,{[he]:_b}],[0,{[he]:Ib}],[0,{[he]:Bb}],[0,{[he]:kb}],[4,{[he]:iy}],[0,{[he]:TN}],[0,{[he]:NN}],[0,{[he]:b4}],[0,{[he]:E4}],[0,{[he]:v4}],[0,{[he]:S4}],[1,{[he]:O4}],[128,{[h4]:C4}],[0,{[he]:Pu}],[0,{[he]:k4}],[0,{[he]:U4}],[0,{[he]:Rb}],[()=>M4,{[he]:T4}],[0,{[he]:Tb}],[()=>$u,{[he]:Nu}],[()=>Mu,{[he]:Uu}],[2,{[he]:Ou}],[0,{[he]:B4}],[0,{[he]:P4}],[0,{[he]:A4}],[5,{[he]:F4}],[0,{[he]:x4}],[0,{[he]:w4}]],2],iO=[3,Ie,i4,0,[ty,sy,oy,jf],[[0,{[vs]:ty}],[()=>ay,{[vs]:sy}],[()=>ay,{[vs]:oy}],[4,{[vs]:jf}]],4],sO=[-3,Ie,a4,{[hn]:dn,[xn]:400},[],[]];Et.for(Ie).registerError(sO,uh);var oO=[-3,Ab,"S3ServiceException",0,[],[]];Et.for(Ab).registerError(oO,Lt);var aO=[9,Ie,vN,{[xb]:["GET","/?session",200]},()=>q4,()=>G4],uO=[9,Ie,XN,{[d4]:"-",[xb]:["PUT","/{Key+}?x-id=PutObject",200]},()=>rO,()=>nO];class cO extends Td.classBuilder().ep({...pb,DisableS3ExpressSessionAuth:{type:"staticContextParams",value:!0},Bucket:{type:"contextParams",name:"Bucket"}}).m(function(t,n,r,s){return[Gw(r,t.getEndpointParameterInstructions()),Fw(r)]}).s("AmazonS3","CreateSession",{}).n("S3Client","CreateSessionCommand").sc(aO).build(){}const lO="3.983.0",fO={version:lO},dO=e=>new TextEncoder().encode(e);function uy(e){return typeof e=="string"?e.length===0:e.byteLength===0}var Pb={name:"SHA-1"},cy={name:"HMAC",hash:Pb},hO=new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]);const pO={};function bi(){return typeof window<"u"?window:typeof self<"u"?self:pO}var gO=function(){function e(t){this.toHash=new Uint8Array(0),t!==void 0&&(this.key=new Promise(function(n,r){bi().crypto.subtle.importKey("raw",ly(t),cy,!1,["sign"]).then(n,r)}),this.key.catch(function(){}))}return e.prototype.update=function(t){if(!uy(t)){var n=ly(t),r=new Uint8Array(this.toHash.byteLength+n.byteLength);r.set(this.toHash,0),r.set(n,this.toHash.byteLength),this.toHash=r}},e.prototype.digest=function(){var t=this;return this.key?this.key.then(function(n){return bi().crypto.subtle.sign(cy,n,t.toHash).then(function(r){return new Uint8Array(r)})}):uy(this.toHash)?Promise.resolve(hO):Promise.resolve().then(function(){return bi().crypto.subtle.digest(Pb,t.toHash)}).then(function(n){return Promise.resolve(new Uint8Array(n))})},e.prototype.reset=function(){this.toHash=new Uint8Array(0)},e}();function ly(e){return typeof e=="string"?dO(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}var mO=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function Nb(e){if(yO(e)&&typeof e.crypto.subtle=="object"){var t=e.crypto.subtle;return DO(t)}return!1}function yO(e){if(typeof e=="object"&&typeof e.crypto=="object"){var t=e.crypto.getRandomValues;return typeof t=="function"}return!1}function DO(e){return e&&mO.every(function(t){return typeof e[t]=="function"})}var wO=function(){function e(t){if(Nb(bi()))this.hash=new gO(t);else throw new Error("SHA1 not supported")}return e.prototype.update=function(t,n){this.hash.update(Ci(t))},e.prototype.digest=function(){return this.hash.digest()},e.prototype.reset=function(){this.hash.reset()},e}(),Ob={name:"SHA-256"},fy={name:"HMAC",hash:Ob},bO=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85]),EO=function(){function e(t){this.toHash=new Uint8Array(0),this.secret=t,this.reset()}return e.prototype.update=function(t){if(!No(t)){var n=Ci(t),r=new Uint8Array(this.toHash.byteLength+n.byteLength);r.set(this.toHash,0),r.set(n,this.toHash.byteLength),this.toHash=r}},e.prototype.digest=function(){var t=this;return this.key?this.key.then(function(n){return bi().crypto.subtle.sign(fy,n,t.toHash).then(function(r){return new Uint8Array(r)})}):No(this.toHash)?Promise.resolve(bO):Promise.resolve().then(function(){return bi().crypto.subtle.digest(Ob,t.toHash)}).then(function(n){return Promise.resolve(new Uint8Array(n))})},e.prototype.reset=function(){var t=this;this.toHash=new Uint8Array(0),this.secret&&this.secret!==void 0&&(this.key=new Promise(function(n,r){bi().crypto.subtle.importKey("raw",Ci(t.secret),fy,!1,["sign"]).then(n,r)}),this.key.catch(function(){}))},e}(),Xn=64,vO=32,SO=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),CO=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],xO=Math.pow(2,53)-1,Ja=function(){function e(){this.state=Int32Array.from(CO),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(t){if(this.finished)throw new Error("Attempted to update an already finished hash.");var n=0,r=t.byteLength;if(this.bytesHashed+=r,this.bytesHashed*8>xO)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;r>0;)this.buffer[this.bufferLength++]=t[n++],r--,this.bufferLength===Xn&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var t=this.bytesHashed*8,n=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),r=this.bufferLength;if(n.setUint8(this.bufferLength++,128),r%Xn>=Xn-8){for(var s=this.bufferLength;s<Xn;s++)n.setUint8(s,0);this.hashBuffer(),this.bufferLength=0}for(var s=this.bufferLength;s<Xn-8;s++)n.setUint8(s,0);n.setUint32(Xn-8,Math.floor(t/4294967296),!0),n.setUint32(Xn-4,t),this.hashBuffer(),this.finished=!0}for(var o=new Uint8Array(vO),s=0;s<8;s++)o[s*4]=this.state[s]>>>24&255,o[s*4+1]=this.state[s]>>>16&255,o[s*4+2]=this.state[s]>>>8&255,o[s*4+3]=this.state[s]>>>0&255;return o},e.prototype.hashBuffer=function(){for(var t=this,n=t.buffer,r=t.state,s=r[0],o=r[1],u=r[2],c=r[3],d=r[4],f=r[5],m=r[6],y=r[7],w=0;w<Xn;w++){if(w<16)this.temp[w]=(n[w*4]&255)<<24|(n[w*4+1]&255)<<16|(n[w*4+2]&255)<<8|n[w*4+3]&255;else{var E=this.temp[w-2],F=(E>>>17|E<<15)^(E>>>19|E<<13)^E>>>10;E=this.temp[w-15];var I=(E>>>7|E<<25)^(E>>>18|E<<14)^E>>>3;this.temp[w]=(F+this.temp[w-7]|0)+(I+this.temp[w-16]|0)}var T=(((d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7))+(d&f^~d&m)|0)+(y+(SO[w]+this.temp[w]|0)|0)|0,$=((s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+(s&o^s&u^o&u)|0;y=m,m=f,f=d,d=c+T|0,c=u,u=o,o=s,s=T+$|0}r[0]+=s,r[1]+=o,r[2]+=u,r[3]+=c,r[4]+=d,r[5]+=f,r[6]+=m,r[7]+=y},e}(),AO=function(){function e(t){this.secret=t,this.hash=new Ja,this.reset()}return e.prototype.update=function(t){if(!(No(t)||this.error))try{this.hash.update(Ci(t))}catch(n){this.error=n}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return Ud(this,void 0,void 0,function(){return Md(this,function(t){return[2,this.digestSync()]})})},e.prototype.reset=function(){if(this.hash=new Ja,this.secret){this.outer=new Ja;var t=FO(this.secret),n=new Uint8Array(Xn);n.set(t);for(var r=0;r<Xn;r++)t[r]^=54,n[r]^=92;this.hash.update(t),this.outer.update(n);for(var r=0;r<t.byteLength;r++)t[r]=0}},e}();function FO(e){var t=Ci(e);if(t.byteLength>Xn){var n=new Ja;n.update(t),t=n.digest()}var r=new Uint8Array(Xn);return r.set(t),r}var _O=function(){function e(t){Nb(bi())?this.hash=new EO(t):this.hash=new AO(t)}return e.prototype.update=function(t,n){this.hash.update(Ci(t))},e.prototype.digest=function(){return this.hash.digest()},e.prototype.reset=function(){this.hash.reset()},e}();const IO=({serviceId:e,clientVersion:t})=>async n=>{var E,F,I;const r=typeof window<"u"?window.navigator:void 0,s=(r==null?void 0:r.userAgent)??"",o=((E=r==null?void 0:r.userAgentData)==null?void 0:E.platform)??dy.os(s)??"other",u=void 0,c=((F=r==null?void 0:r.userAgentData)==null?void 0:F.brands)??[],d=c[c.length-1],f=(d==null?void 0:d.brand)??dy.browser(s)??"unknown",m=(d==null?void 0:d.version)??"unknown",y=[["aws-sdk-js",t],["ua","2.1"],[`os/${o}`,u],["lang/js"],["md/browser",`${f}_${m}`]];e&&y.push([`api/${e}`,t]);const w=await((I=n==null?void 0:n.userAgentAppId)==null?void 0:I.call(n));return w&&y.push([`app/${w}`]),y},dy={os(e){if(/iPhone|iPad|iPod/.test(e))return"iOS";if(/Macintosh|Mac OS X/.test(e))return"macOS";if(/Windows NT/.test(e))return"Windows";if(/Android/.test(e))return"Android";if(/Linux/.test(e))return"Linux"},browser(e){if(/EdgiOS|EdgA|Edg\//.test(e))return"Microsoft Edge";if(/Firefox\//.test(e))return"Firefox";if(/Chrome\//.test(e))return"Chrome";if(/Safari\//.test(e))return"Safari"}};class Ao{constructor(t){P(this,"bytes");if(this.bytes=t,t.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(t){if(t>9223372036854776e3||t<-9223372036854776e3)throw new Error(`${t} is too large (or, if negative, too small) to represent as an Int64`);const n=new Uint8Array(8);for(let r=7,s=Math.abs(Math.round(t));r>-1&&s>0;r--,s/=256)n[r]=s;return t<0&&hy(n),new Ao(n)}valueOf(){const t=this.bytes.slice(0),n=t[0]&128;return n&&hy(t),parseInt(Sn(t),16)*(n?-1:1)}toString(){return String(this.valueOf())}}function hy(e){for(let t=0;t<8;t++)e[t]^=255;for(let t=7;t>-1&&(e[t]++,e[t]===0);t--);}class BO{constructor(t,n){P(this,"toUtf8");P(this,"fromUtf8");this.toUtf8=t,this.fromUtf8=n}format(t){const n=[];for(const o of Object.keys(t)){const u=this.fromUtf8(o);n.push(Uint8Array.from([u.byteLength]),u,this.formatHeaderValue(t[o]))}const r=new Uint8Array(n.reduce((o,u)=>o+u.byteLength,0));let s=0;for(const o of n)r.set(o,s),s+=o.byteLength;return r}formatHeaderValue(t){switch(t.type){case"boolean":return Uint8Array.from([t.value?0:1]);case"byte":return Uint8Array.from([2,t.value]);case"short":const n=new DataView(new ArrayBuffer(3));return n.setUint8(0,3),n.setInt16(1,t.value,!1),new Uint8Array(n.buffer);case"integer":const r=new DataView(new ArrayBuffer(5));return r.setUint8(0,4),r.setInt32(1,t.value,!1),new Uint8Array(r.buffer);case"long":const s=new Uint8Array(9);return s[0]=5,s.set(t.value.bytes,1),s;case"binary":const o=new DataView(new ArrayBuffer(3+t.value.byteLength));o.setUint8(0,6),o.setUint16(1,t.value.byteLength,!1);const u=new Uint8Array(o.buffer);return u.set(t.value,3),u;case"string":const c=this.fromUtf8(t.value),d=new DataView(new ArrayBuffer(3+c.byteLength));d.setUint8(0,7),d.setUint16(1,c.byteLength,!1);const f=new Uint8Array(d.buffer);return f.set(c,3),f;case"timestamp":const m=new Uint8Array(9);return m[0]=8,m.set(Ao.fromNumber(t.value.valueOf()).bytes,1),m;case"uuid":if(!$O.test(t.value))throw new Error(`Invalid UUID received: ${t.value}`);const y=new Uint8Array(17);return y[0]=9,y.set(rw(t.value.replace(/\-/g,"")),1),y}}parse(t){const n={};let r=0;for(;r<t.byteLength;){const s=t.getUint8(r++),o=this.toUtf8(new Uint8Array(t.buffer,t.byteOffset+r,s));switch(r+=s,t.getUint8(r++)){case 0:n[o]={type:gy,value:!0};break;case 1:n[o]={type:gy,value:!1};break;case 2:n[o]={type:kO,value:t.getInt8(r++)};break;case 3:n[o]={type:RO,value:t.getInt16(r,!1)},r+=2;break;case 4:n[o]={type:TO,value:t.getInt32(r,!1)},r+=4;break;case 5:n[o]={type:PO,value:new Ao(new Uint8Array(t.buffer,t.byteOffset+r,8))},r+=8;break;case 6:const u=t.getUint16(r,!1);r+=2,n[o]={type:NO,value:new Uint8Array(t.buffer,t.byteOffset+r,u)},r+=u;break;case 7:const c=t.getUint16(r,!1);r+=2,n[o]={type:OO,value:this.toUtf8(new Uint8Array(t.buffer,t.byteOffset+r,c))},r+=c;break;case 8:n[o]={type:UO,value:new Date(new Ao(new Uint8Array(t.buffer,t.byteOffset+r,8)).valueOf())},r+=8;break;case 9:const d=new Uint8Array(t.buffer,t.byteOffset+r,16);r+=16,n[o]={type:MO,value:`${Sn(d.subarray(0,4))}-${Sn(d.subarray(4,6))}-${Sn(d.subarray(6,8))}-${Sn(d.subarray(8,10))}-${Sn(d.subarray(10))}`};break;default:throw new Error("Unrecognized header type tag")}}return n}}var py;(function(e){e[e.boolTrue=0]="boolTrue",e[e.boolFalse=1]="boolFalse",e[e.byte=2]="byte",e[e.short=3]="short",e[e.integer=4]="integer",e[e.long=5]="long",e[e.byteArray=6]="byteArray",e[e.string=7]="string",e[e.timestamp=8]="timestamp",e[e.uuid=9]="uuid"})(py||(py={}));const gy="boolean",kO="byte",RO="short",TO="integer",PO="long",NO="binary",OO="string",UO="timestamp",MO="uuid",$O=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/,Ub=4,mi=Ub*2,Li=4,LO=mi+Li*2;function zO({byteLength:e,byteOffset:t,buffer:n}){if(e<LO)throw new Error("Provided message too short to accommodate event stream message overhead");const r=new DataView(n,t,e),s=r.getUint32(0,!1);if(e!==s)throw new Error("Reported message length does not match received message length");const o=r.getUint32(Ub,!1),u=r.getUint32(mi,!1),c=r.getUint32(e-Li,!1),d=new fu().update(new Uint8Array(n,t,mi));if(u!==d.digest())throw new Error(`The prelude checksum specified in the message (${u}) does not match the calculated CRC32 checksum (${d.digest()})`);if(d.update(new Uint8Array(n,t+mi,e-(mi+Li))),c!==d.digest())throw new Error(`The message checksum (${d.digest()}) did not match the expected value of ${c}`);return{headers:new DataView(n,t+mi+Li,o),body:new Uint8Array(n,t+mi+Li+o,s-o-(mi+Li+Li))}}class HO{constructor(t,n){P(this,"headerMarshaller");P(this,"messageBuffer");P(this,"isEndOfStream");this.headerMarshaller=new BO(t,n),this.messageBuffer=[],this.isEndOfStream=!1}feed(t){this.messageBuffer.push(this.decode(t))}endOfStream(){this.isEndOfStream=!0}getMessage(){const t=this.messageBuffer.pop(),n=this.isEndOfStream;return{getMessage(){return t},isEndOfStream(){return n}}}getAvailableMessages(){const t=this.messageBuffer;this.messageBuffer=[];const n=this.isEndOfStream;return{getMessages(){return t},isEndOfStream(){return n}}}encode({headers:t,body:n}){const r=this.headerMarshaller.format(t),s=r.byteLength+n.byteLength+16,o=new Uint8Array(s),u=new DataView(o.buffer,o.byteOffset,o.byteLength),c=new fu;return u.setUint32(0,s,!1),u.setUint32(4,r.byteLength,!1),u.setUint32(8,c.update(o.subarray(0,8)).digest(),!1),o.set(r,12),o.set(n,r.byteLength+12),u.setUint32(s-4,c.update(o.subarray(8,s-4)).digest(),!1),o}decode(t){const{headers:n,body:r}=zO(t);return{headers:this.headerMarshaller.parse(n),body:r}}formatHeaders(t){return this.headerMarshaller.format(t)}}class GO{constructor(t){P(this,"options");this.options=t}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const t of this.options.inputStream)yield this.options.decoder.decode(t)}}class qO{constructor(t){P(this,"options");this.options=t}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const t of this.options.messageStream)yield this.options.encoder.encode(t);this.options.includeEndFrame&&(yield new Uint8Array(0))}}class jO{constructor(t){P(this,"options");this.options=t}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const t of this.options.messageStream){const n=await this.options.deserializer(t);n!==void 0&&(yield n)}}}class WO{constructor(t){P(this,"options");this.options=t}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const t of this.options.inputStream)yield this.options.serializer(t)}}function KO(e){let t=0,n=0,r=null,s=null;const o=c=>{if(typeof c!="number")throw new Error("Attempted to allocate an event message where size was not a number: "+c);t=c,n=4,r=new Uint8Array(c),new DataView(r.buffer).setUint32(0,c,!1)},u=async function*(){const c=e[Symbol.asyncIterator]();for(;;){const{value:d,done:f}=await c.next();if(f){if(t)if(t===n)yield r;else throw new Error("Truncated event message received.");else return;return}const m=d.length;let y=0;for(;y<m;){if(!r){const E=m-y;s||(s=new Uint8Array(4));const F=Math.min(4-n,E);if(s.set(d.slice(y,y+F),n),n+=F,y+=F,n<4)break;o(new DataView(s.buffer).getUint32(0,!1)),s=null}const w=Math.min(t-n,m-y);r.set(d.slice(y,y+w),n),n+=w,y+=w,t&&t===n&&(yield r,r=null,t=0,n=0)}}};return{[Symbol.asyncIterator]:u}}function VO(e,t){return async function(n){const{value:r}=n.headers[":message-type"];if(r==="error"){const s=new Error(n.headers[":error-message"].value||"UnknownError");throw s.name=n.headers[":error-code"].value,s}else if(r==="exception"){const s=n.headers[":exception-type"].value,o={[s]:n},u=await e(o);if(u.$unknown){const c=new Error(t(n.body));throw c.name=s,c}throw u[s]}else if(r==="event"){const s={[n.headers[":event-type"].value]:n},o=await e(s);return o.$unknown?void 0:o}else throw Error(`Unrecognizable event type: ${n.headers[":event-type"].value}`)}}let ZO=class{constructor({utf8Encoder:t,utf8Decoder:n}){P(this,"eventStreamCodec");P(this,"utfEncoder");this.eventStreamCodec=new HO(t,n),this.utfEncoder=t}deserialize(t,n){const r=KO(t);return new jO({messageStream:new GO({inputStream:r,decoder:this.eventStreamCodec}),deserializer:VO(n,this.utfEncoder)})}serialize(t,n){return new qO({messageStream:new WO({inputStream:t,serializer:n}),encoder:this.eventStreamCodec,includeEndFrame:!0})}};const JO=e=>({[Symbol.asyncIterator]:async function*(){const t=e.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n)return;yield r}}finally{t.releaseLock()}}}),XO=e=>{const t=e[Symbol.asyncIterator]();return new ReadableStream({async pull(n){const{done:r,value:s}=await t.next();if(r)return n.close();n.enqueue(s)}})};class YO{constructor({utf8Encoder:t,utf8Decoder:n}){P(this,"universalMarshaller");this.universalMarshaller=new ZO({utf8Decoder:n,utf8Encoder:t})}deserialize(t,n){const r=QO(t)?JO(t):t;return this.universalMarshaller.deserialize(r,n)}serialize(t,n){const r=this.universalMarshaller.serialize(t,n);return typeof ReadableStream=="function"?XO(r):r}}const QO=e=>typeof ReadableStream=="function"&&e instanceof ReadableStream,eU=e=>new YO(e);async function tU(e,t,n=1024*1024){const r=e.size;let s=0;for(;s<r;){const o=e.slice(s,Math.min(r,s+n));t(new Uint8Array(await o.arrayBuffer())),s+=o.size}}const nU=async function(t,n){const r=new t;return await tU(n,s=>{r.update(s)}),r.digest()},rU=e=>()=>Promise.reject(e),gi=64,iU=16,sU=[1732584193,4023233417,2562383102,271733878];class oU{constructor(){P(this,"state");P(this,"buffer");P(this,"bufferLength");P(this,"bytesHashed");P(this,"finished");this.reset()}update(t){if(aU(t))return;if(this.finished)throw new Error("Attempted to update an already finished hash.");const n=uU(t);let r=0,{byteLength:s}=n;for(this.bytesHashed+=s;s>0;)this.buffer.setUint8(this.bufferLength++,n[r++]),s--,this.bufferLength===gi&&(this.hashBuffer(),this.bufferLength=0)}async digest(){if(!this.finished){const{buffer:n,bufferLength:r,bytesHashed:s}=this,o=s*8;if(n.setUint8(this.bufferLength++,128),r%gi>=gi-8){for(let u=this.bufferLength;u<gi;u++)n.setUint8(u,0);this.hashBuffer(),this.bufferLength=0}for(let u=this.bufferLength;u<gi-8;u++)n.setUint8(u,0);n.setUint32(gi-8,o>>>0,!0),n.setUint32(gi-4,Math.floor(o/4294967296),!0),this.hashBuffer(),this.finished=!0}const t=new DataView(new ArrayBuffer(iU));for(let n=0;n<4;n++)t.setUint32(n*4,this.state[n],!0);return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}hashBuffer(){const{buffer:t,state:n}=this;let r=n[0],s=n[1],o=n[2],u=n[3];r=Xt(r,s,o,u,t.getUint32(0,!0),7,3614090360),u=Xt(u,r,s,o,t.getUint32(4,!0),12,3905402710),o=Xt(o,u,r,s,t.getUint32(8,!0),17,606105819),s=Xt(s,o,u,r,t.getUint32(12,!0),22,3250441966),r=Xt(r,s,o,u,t.getUint32(16,!0),7,4118548399),u=Xt(u,r,s,o,t.getUint32(20,!0),12,1200080426),o=Xt(o,u,r,s,t.getUint32(24,!0),17,2821735955),s=Xt(s,o,u,r,t.getUint32(28,!0),22,4249261313),r=Xt(r,s,o,u,t.getUint32(32,!0),7,1770035416),u=Xt(u,r,s,o,t.getUint32(36,!0),12,2336552879),o=Xt(o,u,r,s,t.getUint32(40,!0),17,4294925233),s=Xt(s,o,u,r,t.getUint32(44,!0),22,2304563134),r=Xt(r,s,o,u,t.getUint32(48,!0),7,1804603682),u=Xt(u,r,s,o,t.getUint32(52,!0),12,4254626195),o=Xt(o,u,r,s,t.getUint32(56,!0),17,2792965006),s=Xt(s,o,u,r,t.getUint32(60,!0),22,1236535329),r=Yt(r,s,o,u,t.getUint32(4,!0),5,4129170786),u=Yt(u,r,s,o,t.getUint32(24,!0),9,3225465664),o=Yt(o,u,r,s,t.getUint32(44,!0),14,643717713),s=Yt(s,o,u,r,t.getUint32(0,!0),20,3921069994),r=Yt(r,s,o,u,t.getUint32(20,!0),5,3593408605),u=Yt(u,r,s,o,t.getUint32(40,!0),9,38016083),o=Yt(o,u,r,s,t.getUint32(60,!0),14,3634488961),s=Yt(s,o,u,r,t.getUint32(16,!0),20,3889429448),r=Yt(r,s,o,u,t.getUint32(36,!0),5,568446438),u=Yt(u,r,s,o,t.getUint32(56,!0),9,3275163606),o=Yt(o,u,r,s,t.getUint32(12,!0),14,4107603335),s=Yt(s,o,u,r,t.getUint32(32,!0),20,1163531501),r=Yt(r,s,o,u,t.getUint32(52,!0),5,2850285829),u=Yt(u,r,s,o,t.getUint32(8,!0),9,4243563512),o=Yt(o,u,r,s,t.getUint32(28,!0),14,1735328473),s=Yt(s,o,u,r,t.getUint32(48,!0),20,2368359562),r=Qt(r,s,o,u,t.getUint32(20,!0),4,4294588738),u=Qt(u,r,s,o,t.getUint32(32,!0),11,2272392833),o=Qt(o,u,r,s,t.getUint32(44,!0),16,1839030562),s=Qt(s,o,u,r,t.getUint32(56,!0),23,4259657740),r=Qt(r,s,o,u,t.getUint32(4,!0),4,2763975236),u=Qt(u,r,s,o,t.getUint32(16,!0),11,1272893353),o=Qt(o,u,r,s,t.getUint32(28,!0),16,4139469664),s=Qt(s,o,u,r,t.getUint32(40,!0),23,3200236656),r=Qt(r,s,o,u,t.getUint32(52,!0),4,681279174),u=Qt(u,r,s,o,t.getUint32(0,!0),11,3936430074),o=Qt(o,u,r,s,t.getUint32(12,!0),16,3572445317),s=Qt(s,o,u,r,t.getUint32(24,!0),23,76029189),r=Qt(r,s,o,u,t.getUint32(36,!0),4,3654602809),u=Qt(u,r,s,o,t.getUint32(48,!0),11,3873151461),o=Qt(o,u,r,s,t.getUint32(60,!0),16,530742520),s=Qt(s,o,u,r,t.getUint32(8,!0),23,3299628645),r=en(r,s,o,u,t.getUint32(0,!0),6,4096336452),u=en(u,r,s,o,t.getUint32(28,!0),10,1126891415),o=en(o,u,r,s,t.getUint32(56,!0),15,2878612391),s=en(s,o,u,r,t.getUint32(20,!0),21,4237533241),r=en(r,s,o,u,t.getUint32(48,!0),6,1700485571),u=en(u,r,s,o,t.getUint32(12,!0),10,2399980690),o=en(o,u,r,s,t.getUint32(40,!0),15,4293915773),s=en(s,o,u,r,t.getUint32(4,!0),21,2240044497),r=en(r,s,o,u,t.getUint32(32,!0),6,1873313359),u=en(u,r,s,o,t.getUint32(60,!0),10,4264355552),o=en(o,u,r,s,t.getUint32(24,!0),15,2734768916),s=en(s,o,u,r,t.getUint32(52,!0),21,1309151649),r=en(r,s,o,u,t.getUint32(16,!0),6,4149444226),u=en(u,r,s,o,t.getUint32(44,!0),10,3174756917),o=en(o,u,r,s,t.getUint32(8,!0),15,718787259),s=en(s,o,u,r,t.getUint32(36,!0),21,3951481745),n[0]=r+n[0]&4294967295,n[1]=s+n[1]&4294967295,n[2]=o+n[2]&4294967295,n[3]=u+n[3]&4294967295}reset(){this.state=Uint32Array.from(sU),this.buffer=new DataView(new ArrayBuffer(gi)),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}}function Lu(e,t,n,r,s,o){return t=(t+e&4294967295)+(r+o&4294967295)&4294967295,(t<<s|t>>>32-s)+n&4294967295}function Xt(e,t,n,r,s,o,u){return Lu(t&n|~t&r,e,t,s,o,u)}function Yt(e,t,n,r,s,o,u){return Lu(t&r|n&~r,e,t,s,o,u)}function Qt(e,t,n,r,s,o,u){return Lu(t^n^r,e,t,s,o,u)}function en(e,t,n,r,s,o,u){return Lu(n^(t|~r),e,t,s,o,u)}function aU(e){return typeof e=="string"?e.length===0:e.byteLength===0}function uU(e){return typeof e=="string"?Yr(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}const cU=["in-region","cross-region","mobile","standard","legacy"],lU=({defaultsMode:e}={})=>OR(async()=>{const t=typeof e=="function"?await e():e;switch(t==null?void 0:t.toLowerCase()){case"auto":return Promise.resolve(fU()?"mobile":"standard");case"mobile":case"in-region":case"cross-region":case"standard":case"legacy":return Promise.resolve(t==null?void 0:t.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw new Error(`Invalid parameter for "defaultsMode", expect ${cU.join(", ")}, got ${t}`)}}),fU=()=>{var t;const e=window==null?void 0:window.navigator;if(e!=null&&e.connection){const{effectiveType:n,rtt:r,downlink:s}=e==null?void 0:e.connection;if(typeof n=="string"&&n!=="4g"||Number(r)>100||Number(s)<10)return!0}return((t=e==null?void 0:e.userAgentData)==null?void 0:t.mobile)||typeof(e==null?void 0:e.maxTouchPoints)=="number"&&(e==null?void 0:e.maxTouchPoints)>1},dU=e=>({apiVersion:"2006-03-01",base64Decoder:(e==null?void 0:e.base64Decoder)??Ps,base64Encoder:(e==null?void 0:e.base64Encoder)??Wi,disableHostPrefix:(e==null?void 0:e.disableHostPrefix)??!1,endpointProvider:(e==null?void 0:e.endpointProvider)??fb,extensions:(e==null?void 0:e.extensions)??[],getAwsChunkedEncodingStream:(e==null?void 0:e.getAwsChunkedEncodingStream)??Qk,httpAuthSchemeProvider:(e==null?void 0:e.httpAuthSchemeProvider)??XP,httpAuthSchemes:(e==null?void 0:e.httpAuthSchemes)??[{schemeId:"aws.auth#sigv4",identityProvider:t=>t.getIdentityProvider("aws.auth#sigv4"),signer:new XD},{schemeId:"aws.auth#sigv4a",identityProvider:t=>t.getIdentityProvider("aws.auth#sigv4a"),signer:new Rk}],logger:(e==null?void 0:e.logger)??new Pd,protocol:(e==null?void 0:e.protocol)??kT,protocolSettings:(e==null?void 0:e.protocolSettings)??{defaultNamespace:"com.amazonaws.s3",xmlNamespace:"http://s3.amazonaws.com/doc/2006-03-01/",version:"2006-03-01",serviceTarget:"AmazonS3"},sdkStreamMixin:(e==null?void 0:e.sdkStreamMixin)??iw,serviceId:(e==null?void 0:e.serviceId)??"S3",signerConstructor:(e==null?void 0:e.signerConstructor)??Hd,signingEscapePath:(e==null?void 0:e.signingEscapePath)??!1,urlParser:(e==null?void 0:e.urlParser)??du,useArnRegion:(e==null?void 0:e.useArnRegion)??void 0,utf8Decoder:(e==null?void 0:e.utf8Decoder)??Yr,utf8Encoder:(e==null?void 0:e.utf8Encoder)??Zi}),hU=e=>{const t=lU(e),n=()=>t().then(gT),r=dU(e);return{...r,...e,runtime:"browser",defaultsMode:t,bodyLengthChecker:(e==null?void 0:e.bodyLengthChecker)??dT,credentialDefaultProvider:(e==null?void 0:e.credentialDefaultProvider)??(s=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:(e==null?void 0:e.defaultUserAgentProvider)??IO({serviceId:r.serviceId,clientVersion:fO.version}),eventStreamSerdeProvider:(e==null?void 0:e.eventStreamSerdeProvider)??eU,maxAttempts:(e==null?void 0:e.maxAttempts)??hu,md5:(e==null?void 0:e.md5)??oU,region:(e==null?void 0:e.region)??rU("Region is missing"),requestHandler:Fd.create((e==null?void 0:e.requestHandler)??n),retryMode:(e==null?void 0:e.retryMode)??(async()=>(await n()).retryMode||Q6),sha1:(e==null?void 0:e.sha1)??wO,sha256:(e==null?void 0:e.sha256)??_O,streamCollector:(e==null?void 0:e.streamCollector)??tw,streamHasher:(e==null?void 0:e.streamHasher)??nU,useDualstackEndpoint:(e==null?void 0:e.useDualstackEndpoint)??(()=>Promise.resolve(P6)),useFipsEndpoint:(e==null?void 0:e.useFipsEndpoint)??(()=>Promise.resolve(N6))}},pU=e=>({setRegion(t){e.region=t},region(){return e.region}}),gU=e=>({region:e.region()}),mU=e=>{const t=e.httpAuthSchemes;let n=e.httpAuthSchemeProvider,r=e.credentials;return{setHttpAuthScheme(s){const o=t.findIndex(u=>u.schemeId===s.schemeId);o===-1?t.push(s):t.splice(o,1,s)},httpAuthSchemes(){return t},setHttpAuthSchemeProvider(s){n=s},httpAuthSchemeProvider(){return n},setCredentials(s){r=s},credentials(){return r}}},yU=e=>({httpAuthSchemes:e.httpAuthSchemes(),httpAuthSchemeProvider:e.httpAuthSchemeProvider(),credentials:e.credentials()}),DU=(e,t)=>{const n=Object.assign(pU(e),bT(e),vk(e),mU(e));return t.forEach(r=>r.configure(n)),Object.assign(e,gU(n),ET(n),Sk(n),yU(n))};class wU extends hT{constructor(...[n]){const r=hU(n||{});super(r);P(this,"config");this.initConfig=r;const s=QP(r),o=J8(s),u=i8(o),c=DP(u),d=M6(c),f=d,m=Y6(f),y=$6(m),w=YP(y),E=O8(w,{session:[()=>this,cO]}),F=DU(E,(n==null?void 0:n.extensions)||[]);this.config=F,this.middlewareStack.use(fR(this.config)),this.middlewareStack.use(T6(this.config)),this.middlewareStack.use(xP(this.config)),this.middlewareStack.use(H6(this.config)),this.middlewareStack.use(a8(this.config)),this.middlewareStack.use(l8(this.config)),this.middlewareStack.use(h8(this.config)),this.middlewareStack.use(Uk(this.config,{httpAuthSchemeParametersProvider:VP,identityProviderConfigProvider:async I=>new kR({"aws.auth#sigv4":I.credentials,"aws.auth#sigv4a":I.credentials})})),this.middlewareStack.use(Hk(this.config)),this.middlewareStack.use(K8(this.config)),this.middlewareStack.use(Fk(this.config)),this.middlewareStack.use(S8(this.config)),this.middlewareStack.use(B8(this.config)),this.middlewareStack.use(N8(this.config))}destroy(){super.destroy()}}function bU(e){return t=>async n=>{const r={...n.input},s=[{target:"SSECustomerKey",hash:"SSECustomerKeyMD5"},{target:"CopySourceSSECustomerKey",hash:"CopySourceSSECustomerKeyMD5"}];for(const o of s){const u=r[o.target];if(u){let c;typeof u=="string"?SU(u,e)?c=e.base64Decoder(u):(c=e.utf8Decoder(u),r[o.target]=e.base64Encoder(c)):(c=ArrayBuffer.isView(u)?new Uint8Array(u.buffer,u.byteOffset,u.byteLength):new Uint8Array(u),r[o.target]=e.base64Encoder(c));const d=new e.md5;d.update(c),r[o.hash]=e.base64Encoder(await d.digest())}}return t({...n,input:r})}}const EU={name:"ssecMiddleware",step:"initialize",tags:["SSE"],override:!0},vU=e=>({applyToStack:t=>{t.add(bU(e),EU)}});function SU(e,t){if(!/^(?:[A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e))return!1;try{return t.base64Decoder(e).length===32}catch{return!1}}class CU extends Td.classBuilder().ep({...pb,Bucket:{type:"contextParams",name:"Bucket"},Key:{type:"contextParams",name:"Key"}}).m(function(t,n,r,s){return[Gw(r,t.getEndpointParameterInstructions()),r8(r,{requestAlgorithmMember:{httpHeader:"x-amz-sdk-checksum-algorithm",name:"ChecksumAlgorithm"},requestChecksumRequired:!1}),D8(),Fw(r),vU(r)]}).s("AmazonS3","PutObject",{}).n("S3Client","PutObjectCommand").sc(uO).build(){}function xU(e){const{port:t,query:n}=e;let{protocol:r,path:s,hostname:o}=e;r&&r.slice(-1)!==":"&&(r+=":"),t&&(o+=`:${t}`),s&&s.charAt(0)!=="/"&&(s=`/${s}`);let u=n?ew(n):"";u&&u[0]!=="?"&&(u=`?${u}`);let c="";if(e.username!=null||e.password!=null){const f=e.username??"",m=e.password??"";c=`${f}:${m}@`}let d="";return e.fragment&&(d=`#${e.fragment}`),`${r}//${c}${o}${s}${u}${d}`}const AU="UNSIGNED-PAYLOAD",FU="X-Amz-Content-Sha256";class my{constructor(t){P(this,"signer");const n={service:t.signingName||t.service||"s3",uriEscapePath:t.uriEscapePath||!1,applyChecksum:t.applyChecksum||!1,...t};this.signer=new Hd(n)}presign(t,{unsignableHeaders:n=new Set,hoistableHeaders:r=new Set,unhoistableHeaders:s=new Set,...o}={}){return this.prepareRequest(t,{unsignableHeaders:n,unhoistableHeaders:s,hoistableHeaders:r}),this.signer.presign(t,{expiresIn:900,unsignableHeaders:n,unhoistableHeaders:s,...o})}presignWithCredentials(t,n,{unsignableHeaders:r=new Set,hoistableHeaders:s=new Set,unhoistableHeaders:o=new Set,...u}={}){return this.prepareRequest(t,{unsignableHeaders:r,unhoistableHeaders:o,hoistableHeaders:s}),this.signer.presignWithCredentials(t,n,{expiresIn:900,unsignableHeaders:r,unhoistableHeaders:o,...u})}prepareRequest(t,{unsignableHeaders:n=new Set,unhoistableHeaders:r=new Set,hoistableHeaders:s=new Set}={}){n.add("content-type"),Object.keys(t.headers).map(d=>d.toLowerCase()).filter(d=>d.startsWith("x-amz-server-side-encryption")).forEach(d=>{s.has(d)||r.add(d)}),t.headers[FU]=AU;const o=t.headers.host,u=t.port,c=`${t.hostname}${t.port!=null?":"+u:""}`;(!o||o===t.hostname&&t.port!=null)&&(t.headers.host=c)}}const _U=async(e,t,n={})=>{var y,w,E;let r,s;if(typeof e.config.endpointProvider=="function"){const I=(w=(y=(await zw(t.input,t.constructor,e.config)).properties)==null?void 0:y.authSchemes)==null?void 0:w[0];(I==null?void 0:I.name)==="sigv4a"?s=(E=I==null?void 0:I.signingRegionSet)==null?void 0:E.join(","):s=I==null?void 0:I.signingRegion,r=new my({...e.config,signingName:I==null?void 0:I.signingName,region:async()=>s})}else r=new my(e.config);const o=(F,I)=>async T=>{const{request:$}=T;if(!bt.isInstance($))throw new Error("Request to be presigned is not an valid HTTP request.");delete $.headers["amz-sdk-invocation-id"],delete $.headers["amz-sdk-request"],delete $.headers["x-amz-user-agent"];let V;const H={...n,signingRegion:n.signingRegion??I.signing_region??s,signingService:n.signingService??I.signing_service};return I.s3ExpressIdentity?V=await r.presignWithCredentials($,I.s3ExpressIdentity,H):V=await r.presign($,H),{response:{},output:{$metadata:{httpStatusCode:200},presigned:V}}},u="presignInterceptMiddleware",c=e.middlewareStack.clone();c.addRelativeTo(o,{name:u,relation:"before",toMiddleware:"awsAuthMiddleware",override:!0});const d=t.resolveMiddleware(c,e.config,{}),{output:f}=await d({input:t.input}),{presigned:m}=f;return xU(m)},IU=fn("storageApi",!1),BU=async e=>{Ki({app:"storage",path:"/all"},t=>{e(kU(t))})};function kU(e){return"credentials"in e?{type:"storageCredentialsChanged",...e}:"configuration"in e?{type:"storageCongfigurationChanged",...e}:"setCurrentBucket"in e?{type:"storageCurrentBucketChanged",...e}:"addBucket"in e?{type:"storageBucketAdded",...e}:"removeBucket"in e?{type:"storageBucketRemoved",...e}:"setEndpoint"in e?{type:"storageEndpointChanged",...e}:"setAccessKeyId"in e?{type:"storageAccessKeyIdChanged",...e}:"setSecretAccessKey"in e?{type:"storageSecretAccessKeyChanged",...e}:"setRegion"in e?{type:"storageRegionChanged",...e}:"toggleService"in e?{type:"storageServiceToggled",...e}:"setPresignedUrl"in e?{type:"storagePresignedUrlChanged",...e}:{type:"storageEventUnknown",data:e}}const Mb=async()=>(await Ve({app:"storage",path:"/configuration"}))["storage-update"].configuration,$b=async()=>(await Ve({app:"storage",path:"/credentials"}))["storage-update"].credentials,RU="https://memex.tlon.network",TU={"image/jpeg":".jpg","image/jpg":".jpg","image/png":".png","image/gif":".gif","image/webp":".webp","image/heic":".heic","image/heif":".heif"};function PU(e){return TU[e.toLowerCase()]||".jpg"}function yy(e){return!!(e!=null&&e.accessKeyId&&(e!=null&&e.endpoint)&&(e!=null&&e.secretAccessKey))}async function NU(e){const[t,n]=await Promise.all([Mb(),$b()]),r=e.contentType||e.blob.type||"application/octet-stream",s=PU(r),o=e.fileName||`upload${s}`,u=cr(),c=`${Rs(u)}/${Rs(nn("da",ur.fromUnix(Date.now())))}-${o}`;if(IU.log("uploading file",{fileKey:c,contentType:r,size:e.blob.size}),CD()&&(t.service==="presigned-url"||!yy(n))){const{hostedUrl:$,uploadUrl:V}=await UU({contentLength:e.blob.size,contentType:r,fileName:c});return await fetch(V,{method:"PUT",body:e.blob,headers:{"Cache-Control":"public, max-age=3600","Content-Type":r}}).then(H=>{if(!H.ok)throw new Error(`Upload failed: ${H.status}`)}),{url:$}}if(!yy(n))throw new Error("No storage credentials configured");const m=new URL(OU(n.endpoint)),y=new wU({endpoint:{protocol:m.protocol.slice(0,-1),hostname:m.host,path:m.pathname||"/"},region:t.region||"us-east-1",credentials:{accessKeyId:n.accessKeyId,secretAccessKey:n.secretAccessKey},forcePathStyle:!0}),w={"Content-Type":r,"Cache-Control":"public, max-age=3600","x-amz-acl":"public-read"},E=new CU({Bucket:t.currentBucket,Key:c,ContentType:w["Content-Type"],CacheControl:w["Cache-Control"],ACL:"public-read"}),F=await _U(y,E,{expiresIn:3600,signableHeaders:new Set(Object.keys(w))}),I=F.includes("digitaloceanspaces.com");return await fetch(F,{method:"PUT",body:e.blob,headers:I?w:void 0}).then($=>{if(!$.ok)throw new Error(`Upload failed: ${$.status}`)}),{url:t.publicUrlBase?new URL(c,t.publicUrlBase).toString():F.split("?")[0]}}function OU(e){return e.match(/https?:\/\//)?e:`https://${e}`}async function UU(e){const t=cr(),n=await Ve({app:"genuine",path:"/secret"}),r=`${RU}/v1/${Rs(t)}/upload`,s=await fetch(r,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:n,...e})});if(!s.ok)throw new Error(`Memex upload request failed: ${s.status}`);const o=await s.json();if(!(o!=null&&o.url)||!(o!=null&&o.filePath))throw new Error("Invalid response from Memex");return{hostedUrl:o.filePath,uploadUrl:o.url}}const MU=async e=>{const t=await Ve({app:"vitals",path:`/ship/${e}`});return Lb(t)},$U=async(e,t)=>{let n=!1;const r=await Ki({app:"vitals",path:`/status/${e}`},(s,o)=>{if(n)return;t(Lb(s))&&o&&(n=!0,xD(o))});return fe({app:"vitals",mark:"run-check",json:e}),r},Lb=e=>"complete"in e.status?{complete:!0,status:e.status.complete,timestamp:e.timestamp}:{complete:!1,status:e.status.pending},LU=3*1e3,Wf="~zod/personal-invite-link";function zU(e){return{tag:"groups-0",fields:{...e}}}async function zb(e,t){return fe({app:"reel",mark:"reel-describe",json:{token:e,metadata:t}})}async function HU(e){return await fe({app:"grouper",mark:"grouper-enable",json:e})}async function Hb(){try{const e=await Qr({app:"reel",path:`/v1/id-link/${Wf}`},LU,void 0,{tag:"checkExistingUserInviteLink"});return e||null}catch{return null}}async function GU(e){const t=cr();await fe({app:"grouper",mark:"grouper-enable",json:Wf}),await zb(Wf,zU({inviterUserId:t,inviterNickname:(e==null?void 0:e.nickname)??"",inviterAvatarImage:(e==null?void 0:e.avatarImage)??"",inviterColor:(e==null?void 0:e.color)??"",inviteType:"user",invitedGroupId:""}));const n=await Hb();if(!n)throw new Error("Failed to get invite link from reel");return n}const Vr=fn("metagrabApi",!1);async function qU(e){try{const t=nn("uw",Y.fromCord(e).number);Vr.log("encoded",{url:e,encodedUrl:t});const n=await AD(`/apps/groups/~/metagrab/${t}`,{method:"GET",mode:"cors"},1e4);if(Vr.log("metagrab response",n),n.status!==200)return Vr.trackError(Ke.ErrorFetchLinkMetadata,{message:`bad metagrab response: ${n.status}`,response:n}),{type:"error",reason:"bad response"};const r=jU(e,n);return r.type==="error"?Vr.trackError(Ke.ErrorFetchLinkMetadata,{message:`metagrab error: ${r.reason}`,response:n,parsedResponse:r}):Vr.trackEvent(Ke.FetchLinkMetadata),r}catch(t){return Vr.trackError(Ke.ErrorFetchLinkMetadata,t),{type:"error",reason:"unknown error"}}}function jU(e,t){var r,s,o,u;const{result:n}=t;if(!n)return{type:"redirect"};if(typeof n=="string")return Vr.error(`link preview error: ${n}`),{type:"error",reason:n};if(n.type==="page"){const{site_icon:c,site_name:d,title:f,image:m,description:y}=n,w=(r=c==null?void 0:c[0])==null?void 0:r.value,E=(s=d==null?void 0:d[0])==null?void 0:s.value,F=(o=f==null?void 0:f[0])==null?void 0:o.value,I=(u=y==null?void 0:y[0])==null?void 0:u.value,T=WU(e,m??[]),$={type:"page",url:e,siteIconUrl:w,siteName:E,title:F,description:I,previewImageUrl:T.url,previewImageHeight:T.height,previewImageWidth:T.width};return Vr.log("parsed page metadata",$),$}return n.type==="file"?{type:"file",url:e,mime:n.mime,isImage:n.mime.startsWith("image/")}:{type:"error",reason:"unknown"}}function Dy(e,t){var n;return(n=t.find(r=>{var s;return(s=r.attributes)!=null&&s.secure_url||!("attributes"in r)?!0:!e.startsWith(r.value)}))==null?void 0:n.value}function WU(e,t){var c,d,f,m,y;const n=Dy(e,t.filter(w=>w.namespace==="twitter"&&w.key==="image")),r=t.filter(w=>w.namespace==="og"&&w.key==="image"),s=Dy(e,r),o=(d=(c=r.find(w=>{var E;return(E=w.attributes)==null?void 0:E.height}))==null?void 0:c.attributes)==null?void 0:d.height,u=(m=(f=r.find(w=>{var E;return(E=w.attributes)==null?void 0:E.width}))==null?void 0:f.attributes)==null?void 0:m.width;return{url:s||n||((y=t[0])==null?void 0:y.value),height:o,width:u}}async function KU(e){try{const t=Ei(),n=await fetch(`${t.INVITE_SERVICE_ENDPOINT}/linkPreview`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e})});if(!n.ok)throw new Error(`fallback link meta bad response: ${n.status}`);const r=await n.json();if(!r||typeof r!="object")throw new Error("fallback link meta payload invalid");return{type:"page",url:e,siteIconUrl:r.siteIconUrl||"",siteName:r.siteName||"",title:r.title||"",description:r.description||"",previewImageUrl:r.previewImageUrl||""}}catch(t){return console.log("fallback no good",t),Vr.trackError("Failed to get fallback link metadata response",t),{type:"error",reason:"unknown error"}}}async function VU(e){const t=await s_(),n=nn("da",ur.fromUnix(e)),r=await Ve({app:"groups-ui",path:`/v7/changes/${n}`}),s=await Promise.race([t,JU(500)]);return{...ZU(r),...s}}function ZU(e){const t=Cd(e.groups,!0),n=Object.entries(e.channels).flatMap(([d,f])=>f?To(d,f).posts:[]),r=Object.entries(e.channels).reduce((d,[f,m])=>(m===null&&d.push(f),d),[]),s=Object.entries(e.chat).flatMap(([d,f])=>f?To(d,f).posts:[]),o=[...n,...s],u=Object.entries(e.contacts).filter(([d,f])=>f).map(([d,f])=>ZD(d,f)),c=zs(e.activity);return{groups:t,posts:o,contacts:u,unreads:c,deletedChannelIds:r}}async function JU(e){return new Promise(t=>setTimeout(()=>t({nodeBusyStatus:"unknown"}),e))}var Gb={},zu={};zu.byteLength=QU;zu.toByteArray=tM;zu.fromByteArray=iM;var Sr=[],Jn=[],XU=typeof Uint8Array<"u"?Uint8Array:Array,Zl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Ds=0,YU=Zl.length;Ds<YU;++Ds)Sr[Ds]=Zl[Ds],Jn[Zl.charCodeAt(Ds)]=Ds;Jn[45]=62;Jn[95]=63;function qb(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");n===-1&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function QU(e){var t=qb(e),n=t[0],r=t[1];return(n+r)*3/4-r}function eM(e,t,n){return(t+n)*3/4-n}function tM(e){var t,n=qb(e),r=n[0],s=n[1],o=new XU(eM(e,r,s)),u=0,c=s>0?r-4:r,d;for(d=0;d<c;d+=4)t=Jn[e.charCodeAt(d)]<<18|Jn[e.charCodeAt(d+1)]<<12|Jn[e.charCodeAt(d+2)]<<6|Jn[e.charCodeAt(d+3)],o[u++]=t>>16&255,o[u++]=t>>8&255,o[u++]=t&255;return s===2&&(t=Jn[e.charCodeAt(d)]<<2|Jn[e.charCodeAt(d+1)]>>4,o[u++]=t&255),s===1&&(t=Jn[e.charCodeAt(d)]<<10|Jn[e.charCodeAt(d+1)]<<4|Jn[e.charCodeAt(d+2)]>>2,o[u++]=t>>8&255,o[u++]=t&255),o}function nM(e){return Sr[e>>18&63]+Sr[e>>12&63]+Sr[e>>6&63]+Sr[e&63]}function rM(e,t,n){for(var r,s=[],o=t;o<n;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(e[o+2]&255),s.push(nM(r));return s.join("")}function iM(e){for(var t,n=e.length,r=n%3,s=[],o=16383,u=0,c=n-r;u<c;u+=o)s.push(rM(e,u,u+o>c?c:u+o));return r===1?(t=e[n-1],s.push(Sr[t>>2]+Sr[t<<4&63]+"==")):r===2&&(t=(e[n-2]<<8)+e[n-1],s.push(Sr[t>>10]+Sr[t>>4&63]+Sr[t<<2&63]+"=")),s.join("")}var fh={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */fh.read=function(e,t,n,r,s){var o,u,c=s*8-r-1,d=(1<<c)-1,f=d>>1,m=-7,y=n?s-1:0,w=n?-1:1,E=e[t+y];for(y+=w,o=E&(1<<-m)-1,E>>=-m,m+=c;m>0;o=o*256+e[t+y],y+=w,m-=8);for(u=o&(1<<-m)-1,o>>=-m,m+=r;m>0;u=u*256+e[t+y],y+=w,m-=8);if(o===0)o=1-f;else{if(o===d)return u?NaN:(E?-1:1)*(1/0);u=u+Math.pow(2,r),o=o-f}return(E?-1:1)*u*Math.pow(2,o-r)};fh.write=function(e,t,n,r,s,o){var u,c,d,f=o*8-s-1,m=(1<<f)-1,y=m>>1,w=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,E=r?0:o-1,F=r?1:-1,I=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(c=isNaN(t)?1:0,u=m):(u=Math.floor(Math.log(t)/Math.LN2),t*(d=Math.pow(2,-u))<1&&(u--,d*=2),u+y>=1?t+=w/d:t+=w*Math.pow(2,1-y),t*d>=2&&(u++,d/=2),u+y>=m?(c=0,u=m):u+y>=1?(c=(t*d-1)*Math.pow(2,s),u=u+y):(c=t*Math.pow(2,y-1)*Math.pow(2,s),u=0));s>=8;e[n+E]=c&255,E+=F,c/=256,s-=8);for(u=u<<s|c,f+=s;f>0;e[n+E]=u&255,E+=F,u/=256,f-=8);e[n+E-F]|=I*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){const t=zu,n=fh,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=c,e.SlowBuffer=V,e.INSPECT_MAX_BYTES=50;const s=2147483647;e.kMaxLength=s,c.TYPED_ARRAY_SUPPORT=o(),!c.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{const g=new Uint8Array(1),h={foo:function(){return 42}};return Object.setPrototypeOf(h,Uint8Array.prototype),Object.setPrototypeOf(g,h),g.foo()===42}catch{return!1}}Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}});function u(g){if(g>s)throw new RangeError('The value "'+g+'" is invalid for option "size"');const h=new Uint8Array(g);return Object.setPrototypeOf(h,c.prototype),h}function c(g,h,p){if(typeof g=="number"){if(typeof h=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return y(g)}return d(g,h,p)}c.poolSize=8192;function d(g,h,p){if(typeof g=="string")return w(g,h);if(ArrayBuffer.isView(g))return F(g);if(g==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof g);if(kt(g,ArrayBuffer)||g&&kt(g.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(kt(g,SharedArrayBuffer)||g&&kt(g.buffer,SharedArrayBuffer)))return I(g,h,p);if(typeof g=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const v=g.valueOf&&g.valueOf();if(v!=null&&v!==g)return c.from(v,h,p);const C=T(g);if(C)return C;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof g[Symbol.toPrimitive]=="function")return c.from(g[Symbol.toPrimitive]("string"),h,p);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof g)}c.from=function(g,h,p){return d(g,h,p)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array);function f(g){if(typeof g!="number")throw new TypeError('"size" argument must be of type number');if(g<0)throw new RangeError('The value "'+g+'" is invalid for option "size"')}function m(g,h,p){return f(g),g<=0?u(g):h!==void 0?typeof p=="string"?u(g).fill(h,p):u(g).fill(h):u(g)}c.alloc=function(g,h,p){return m(g,h,p)};function y(g){return f(g),u(g<0?0:$(g)|0)}c.allocUnsafe=function(g){return y(g)},c.allocUnsafeSlow=function(g){return y(g)};function w(g,h){if((typeof h!="string"||h==="")&&(h="utf8"),!c.isEncoding(h))throw new TypeError("Unknown encoding: "+h);const p=H(g,h)|0;let v=u(p);const C=v.write(g,h);return C!==p&&(v=v.slice(0,C)),v}function E(g){const h=g.length<0?0:$(g.length)|0,p=u(h);for(let v=0;v<h;v+=1)p[v]=g[v]&255;return p}function F(g){if(kt(g,Uint8Array)){const h=new Uint8Array(g);return I(h.buffer,h.byteOffset,h.byteLength)}return E(g)}function I(g,h,p){if(h<0||g.byteLength<h)throw new RangeError('"offset" is outside of buffer bounds');if(g.byteLength<h+(p||0))throw new RangeError('"length" is outside of buffer bounds');let v;return h===void 0&&p===void 0?v=new Uint8Array(g):p===void 0?v=new Uint8Array(g,h):v=new Uint8Array(g,h,p),Object.setPrototypeOf(v,c.prototype),v}function T(g){if(c.isBuffer(g)){const h=$(g.length)|0,p=u(h);return p.length===0||g.copy(p,0,0,h),p}if(g.length!==void 0)return typeof g.length!="number"||gr(g.length)?u(0):E(g);if(g.type==="Buffer"&&Array.isArray(g.data))return E(g.data)}function $(g){if(g>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return g|0}function V(g){return+g!=g&&(g=0),c.alloc(+g)}c.isBuffer=function(h){return h!=null&&h._isBuffer===!0&&h!==c.prototype},c.compare=function(h,p){if(kt(h,Uint8Array)&&(h=c.from(h,h.offset,h.byteLength)),kt(p,Uint8Array)&&(p=c.from(p,p.offset,p.byteLength)),!c.isBuffer(h)||!c.isBuffer(p))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(h===p)return 0;let v=h.length,C=p.length;for(let B=0,R=Math.min(v,C);B<R;++B)if(h[B]!==p[B]){v=h[B],C=p[B];break}return v<C?-1:C<v?1:0},c.isEncoding=function(h){switch(String(h).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(h,p){if(!Array.isArray(h))throw new TypeError('"list" argument must be an Array of Buffers');if(h.length===0)return c.alloc(0);let v;if(p===void 0)for(p=0,v=0;v<h.length;++v)p+=h[v].length;const C=c.allocUnsafe(p);let B=0;for(v=0;v<h.length;++v){let R=h[v];if(kt(R,Uint8Array))B+R.length>C.length?(c.isBuffer(R)||(R=c.from(R)),R.copy(C,B)):Uint8Array.prototype.set.call(C,R,B);else if(c.isBuffer(R))R.copy(C,B);else throw new TypeError('"list" argument must be an Array of Buffers');B+=R.length}return C};function H(g,h){if(c.isBuffer(g))return g.length;if(ArrayBuffer.isView(g)||kt(g,ArrayBuffer))return g.byteLength;if(typeof g!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof g);const p=g.length,v=arguments.length>2&&arguments[2]===!0;if(!v&&p===0)return 0;let C=!1;for(;;)switch(h){case"ascii":case"latin1":case"binary":return p;case"utf8":case"utf-8":return rn(g).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return p*2;case"hex":return p>>>1;case"base64":return mn(g).length;default:if(C)return v?-1:rn(g).length;h=(""+h).toLowerCase(),C=!0}}c.byteLength=H;function Q(g,h,p){let v=!1;if((h===void 0||h<0)&&(h=0),h>this.length||((p===void 0||p>this.length)&&(p=this.length),p<=0)||(p>>>=0,h>>>=0,p<=h))return"";for(g||(g="utf8");;)switch(g){case"hex":return tr(this,h,p);case"utf8":case"utf-8":return ni(this,h,p);case"ascii":return er(this,h,p);case"latin1":case"binary":return An(this,h,p);case"base64":return Hs(this,h,p);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return pn(this,h,p);default:if(v)throw new TypeError("Unknown encoding: "+g);g=(g+"").toLowerCase(),v=!0}}c.prototype._isBuffer=!0;function te(g,h,p){const v=g[h];g[h]=g[p],g[p]=v}c.prototype.swap16=function(){const h=this.length;if(h%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let p=0;p<h;p+=2)te(this,p,p+1);return this},c.prototype.swap32=function(){const h=this.length;if(h%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let p=0;p<h;p+=4)te(this,p,p+3),te(this,p+1,p+2);return this},c.prototype.swap64=function(){const h=this.length;if(h%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let p=0;p<h;p+=8)te(this,p,p+7),te(this,p+1,p+6),te(this,p+2,p+5),te(this,p+3,p+4);return this},c.prototype.toString=function(){const h=this.length;return h===0?"":arguments.length===0?ni(this,0,h):Q.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(h){if(!c.isBuffer(h))throw new TypeError("Argument must be a Buffer");return this===h?!0:c.compare(this,h)===0},c.prototype.inspect=function(){let h="";const p=e.INSPECT_MAX_BYTES;return h=this.toString("hex",0,p).replace(/(.{2})/g,"$1 ").trim(),this.length>p&&(h+=" ... "),"<Buffer "+h+">"},r&&(c.prototype[r]=c.prototype.inspect),c.prototype.compare=function(h,p,v,C,B){if(kt(h,Uint8Array)&&(h=c.from(h,h.offset,h.byteLength)),!c.isBuffer(h))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof h);if(p===void 0&&(p=0),v===void 0&&(v=h?h.length:0),C===void 0&&(C=0),B===void 0&&(B=this.length),p<0||v>h.length||C<0||B>this.length)throw new RangeError("out of range index");if(C>=B&&p>=v)return 0;if(C>=B)return-1;if(p>=v)return 1;if(p>>>=0,v>>>=0,C>>>=0,B>>>=0,this===h)return 0;let R=B-C,q=v-p;const ae=Math.min(R,q),de=this.slice(C,B),ce=h.slice(p,v);for(let me=0;me<ae;++me)if(de[me]!==ce[me]){R=de[me],q=ce[me];break}return R<q?-1:q<R?1:0};function ge(g,h,p,v,C){if(g.length===0)return-1;if(typeof p=="string"?(v=p,p=0):p>2147483647?p=2147483647:p<-2147483648&&(p=-2147483648),p=+p,gr(p)&&(p=C?0:g.length-1),p<0&&(p=g.length+p),p>=g.length){if(C)return-1;p=g.length-1}else if(p<0)if(C)p=0;else return-1;if(typeof h=="string"&&(h=c.from(h,v)),c.isBuffer(h))return h.length===0?-1:De(g,h,p,v,C);if(typeof h=="number")return h=h&255,typeof Uint8Array.prototype.indexOf=="function"?C?Uint8Array.prototype.indexOf.call(g,h,p):Uint8Array.prototype.lastIndexOf.call(g,h,p):De(g,[h],p,v,C);throw new TypeError("val must be string, number or Buffer")}function De(g,h,p,v,C){let B=1,R=g.length,q=h.length;if(v!==void 0&&(v=String(v).toLowerCase(),v==="ucs2"||v==="ucs-2"||v==="utf16le"||v==="utf-16le")){if(g.length<2||h.length<2)return-1;B=2,R/=2,q/=2,p/=2}function ae(ce,me){return B===1?ce[me]:ce.readUInt16BE(me*B)}let de;if(C){let ce=-1;for(de=p;de<R;de++)if(ae(g,de)===ae(h,ce===-1?0:de-ce)){if(ce===-1&&(ce=de),de-ce+1===q)return ce*B}else ce!==-1&&(de-=de-ce),ce=-1}else for(p+q>R&&(p=R-q),de=p;de>=0;de--){let ce=!0;for(let me=0;me<q;me++)if(ae(g,de+me)!==ae(h,me)){ce=!1;break}if(ce)return de}return-1}c.prototype.includes=function(h,p,v){return this.indexOf(h,p,v)!==-1},c.prototype.indexOf=function(h,p,v){return ge(this,h,p,v,!0)},c.prototype.lastIndexOf=function(h,p,v){return ge(this,h,p,v,!1)};function rt(g,h,p,v){p=Number(p)||0;const C=g.length-p;v?(v=Number(v),v>C&&(v=C)):v=C;const B=h.length;v>B/2&&(v=B/2);let R;for(R=0;R<v;++R){const q=parseInt(h.substr(R*2,2),16);if(gr(q))return R;g[p+R]=q}return R}function Je(g,h,p,v){return Bt(rn(h,g.length-p),g,p,v)}function fr(g,h,p,v){return Bt(Ii(h),g,p,v)}function Xi(g,h,p,v){return Bt(mn(h),g,p,v)}function ti(g,h,p,v){return Bt(js(h,g.length-p),g,p,v)}c.prototype.write=function(h,p,v,C){if(p===void 0)C="utf8",v=this.length,p=0;else if(v===void 0&&typeof p=="string")C=p,v=this.length,p=0;else if(isFinite(p))p=p>>>0,isFinite(v)?(v=v>>>0,C===void 0&&(C="utf8")):(C=v,v=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const B=this.length-p;if((v===void 0||v>B)&&(v=B),h.length>0&&(v<0||p<0)||p>this.length)throw new RangeError("Attempt to write outside buffer bounds");C||(C="utf8");let R=!1;for(;;)switch(C){case"hex":return rt(this,h,p,v);case"utf8":case"utf-8":return Je(this,h,p,v);case"ascii":case"latin1":case"binary":return fr(this,h,p,v);case"base64":return Xi(this,h,p,v);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ti(this,h,p,v);default:if(R)throw new TypeError("Unknown encoding: "+C);C=(""+C).toLowerCase(),R=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Hs(g,h,p){return h===0&&p===g.length?t.fromByteArray(g):t.fromByteArray(g.slice(h,p))}function ni(g,h,p){p=Math.min(g.length,p);const v=[];let C=h;for(;C<p;){const B=g[C];let R=null,q=B>239?4:B>223?3:B>191?2:1;if(C+q<=p){let ae,de,ce,me;switch(q){case 1:B<128&&(R=B);break;case 2:ae=g[C+1],(ae&192)===128&&(me=(B&31)<<6|ae&63,me>127&&(R=me));break;case 3:ae=g[C+1],de=g[C+2],(ae&192)===128&&(de&192)===128&&(me=(B&15)<<12|(ae&63)<<6|de&63,me>2047&&(me<55296||me>57343)&&(R=me));break;case 4:ae=g[C+1],de=g[C+2],ce=g[C+3],(ae&192)===128&&(de&192)===128&&(ce&192)===128&&(me=(B&15)<<18|(ae&63)<<12|(de&63)<<6|ce&63,me>65535&&me<1114112&&(R=me))}}R===null?(R=65533,q=1):R>65535&&(R-=65536,v.push(R>>>10&1023|55296),R=56320|R&1023),v.push(R),C+=q}return Gs(v)}const _i=4096;function Gs(g){const h=g.length;if(h<=_i)return String.fromCharCode.apply(String,g);let p="",v=0;for(;v<h;)p+=String.fromCharCode.apply(String,g.slice(v,v+=_i));return p}function er(g,h,p){let v="";p=Math.min(g.length,p);for(let C=h;C<p;++C)v+=String.fromCharCode(g[C]&127);return v}function An(g,h,p){let v="";p=Math.min(g.length,p);for(let C=h;C<p;++C)v+=String.fromCharCode(g[C]);return v}function tr(g,h,p){const v=g.length;(!h||h<0)&&(h=0),(!p||p<0||p>v)&&(p=v);let C="";for(let B=h;B<p;++B)C+=be[g[B]];return C}function pn(g,h,p){const v=g.slice(h,p);let C="";for(let B=0;B<v.length-1;B+=2)C+=String.fromCharCode(v[B]+v[B+1]*256);return C}c.prototype.slice=function(h,p){const v=this.length;h=~~h,p=p===void 0?v:~~p,h<0?(h+=v,h<0&&(h=0)):h>v&&(h=v),p<0?(p+=v,p<0&&(p=0)):p>v&&(p=v),p<h&&(p=h);const C=this.subarray(h,p);return Object.setPrototypeOf(C,c.prototype),C};function He(g,h,p){if(g%1!==0||g<0)throw new RangeError("offset is not uint");if(g+h>p)throw new RangeError("Trying to access beyond buffer length")}c.prototype.readUintLE=c.prototype.readUIntLE=function(h,p,v){h=h>>>0,p=p>>>0,v||He(h,p,this.length);let C=this[h],B=1,R=0;for(;++R<p&&(B*=256);)C+=this[h+R]*B;return C},c.prototype.readUintBE=c.prototype.readUIntBE=function(h,p,v){h=h>>>0,p=p>>>0,v||He(h,p,this.length);let C=this[h+--p],B=1;for(;p>0&&(B*=256);)C+=this[h+--p]*B;return C},c.prototype.readUint8=c.prototype.readUInt8=function(h,p){return h=h>>>0,p||He(h,1,this.length),this[h]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(h,p){return h=h>>>0,p||He(h,2,this.length),this[h]|this[h+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(h,p){return h=h>>>0,p||He(h,2,this.length),this[h]<<8|this[h+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(h,p){return h=h>>>0,p||He(h,4,this.length),(this[h]|this[h+1]<<8|this[h+2]<<16)+this[h+3]*16777216},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(h,p){return h=h>>>0,p||He(h,4,this.length),this[h]*16777216+(this[h+1]<<16|this[h+2]<<8|this[h+3])},c.prototype.readBigUInt64LE=ut(function(h){h=h>>>0,Fn(h,"offset");const p=this[h],v=this[h+7];(p===void 0||v===void 0)&&Ct(h,this.length-8);const C=p+this[++h]*2**8+this[++h]*2**16+this[++h]*2**24,B=this[++h]+this[++h]*2**8+this[++h]*2**16+v*2**24;return BigInt(C)+(BigInt(B)<<BigInt(32))}),c.prototype.readBigUInt64BE=ut(function(h){h=h>>>0,Fn(h,"offset");const p=this[h],v=this[h+7];(p===void 0||v===void 0)&&Ct(h,this.length-8);const C=p*2**24+this[++h]*2**16+this[++h]*2**8+this[++h],B=this[++h]*2**24+this[++h]*2**16+this[++h]*2**8+v;return(BigInt(C)<<BigInt(32))+BigInt(B)}),c.prototype.readIntLE=function(h,p,v){h=h>>>0,p=p>>>0,v||He(h,p,this.length);let C=this[h],B=1,R=0;for(;++R<p&&(B*=256);)C+=this[h+R]*B;return B*=128,C>=B&&(C-=Math.pow(2,8*p)),C},c.prototype.readIntBE=function(h,p,v){h=h>>>0,p=p>>>0,v||He(h,p,this.length);let C=p,B=1,R=this[h+--C];for(;C>0&&(B*=256);)R+=this[h+--C]*B;return B*=128,R>=B&&(R-=Math.pow(2,8*p)),R},c.prototype.readInt8=function(h,p){return h=h>>>0,p||He(h,1,this.length),this[h]&128?(255-this[h]+1)*-1:this[h]},c.prototype.readInt16LE=function(h,p){h=h>>>0,p||He(h,2,this.length);const v=this[h]|this[h+1]<<8;return v&32768?v|4294901760:v},c.prototype.readInt16BE=function(h,p){h=h>>>0,p||He(h,2,this.length);const v=this[h+1]|this[h]<<8;return v&32768?v|4294901760:v},c.prototype.readInt32LE=function(h,p){return h=h>>>0,p||He(h,4,this.length),this[h]|this[h+1]<<8|this[h+2]<<16|this[h+3]<<24},c.prototype.readInt32BE=function(h,p){return h=h>>>0,p||He(h,4,this.length),this[h]<<24|this[h+1]<<16|this[h+2]<<8|this[h+3]},c.prototype.readBigInt64LE=ut(function(h){h=h>>>0,Fn(h,"offset");const p=this[h],v=this[h+7];(p===void 0||v===void 0)&&Ct(h,this.length-8);const C=this[h+4]+this[h+5]*2**8+this[h+6]*2**16+(v<<24);return(BigInt(C)<<BigInt(32))+BigInt(p+this[++h]*2**8+this[++h]*2**16+this[++h]*2**24)}),c.prototype.readBigInt64BE=ut(function(h){h=h>>>0,Fn(h,"offset");const p=this[h],v=this[h+7];(p===void 0||v===void 0)&&Ct(h,this.length-8);const C=(p<<24)+this[++h]*2**16+this[++h]*2**8+this[++h];return(BigInt(C)<<BigInt(32))+BigInt(this[++h]*2**24+this[++h]*2**16+this[++h]*2**8+v)}),c.prototype.readFloatLE=function(h,p){return h=h>>>0,p||He(h,4,this.length),n.read(this,h,!0,23,4)},c.prototype.readFloatBE=function(h,p){return h=h>>>0,p||He(h,4,this.length),n.read(this,h,!1,23,4)},c.prototype.readDoubleLE=function(h,p){return h=h>>>0,p||He(h,8,this.length),n.read(this,h,!0,52,8)},c.prototype.readDoubleBE=function(h,p){return h=h>>>0,p||He(h,8,this.length),n.read(this,h,!1,52,8)};function St(g,h,p,v,C,B){if(!c.isBuffer(g))throw new TypeError('"buffer" argument must be a Buffer instance');if(h>C||h<B)throw new RangeError('"value" argument is out of bounds');if(p+v>g.length)throw new RangeError("Index out of range")}c.prototype.writeUintLE=c.prototype.writeUIntLE=function(h,p,v,C){if(h=+h,p=p>>>0,v=v>>>0,!C){const q=Math.pow(2,8*v)-1;St(this,h,p,v,q,0)}let B=1,R=0;for(this[p]=h&255;++R<v&&(B*=256);)this[p+R]=h/B&255;return p+v},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(h,p,v,C){if(h=+h,p=p>>>0,v=v>>>0,!C){const q=Math.pow(2,8*v)-1;St(this,h,p,v,q,0)}let B=v-1,R=1;for(this[p+B]=h&255;--B>=0&&(R*=256);)this[p+B]=h/R&255;return p+v},c.prototype.writeUint8=c.prototype.writeUInt8=function(h,p,v){return h=+h,p=p>>>0,v||St(this,h,p,1,255,0),this[p]=h&255,p+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(h,p,v){return h=+h,p=p>>>0,v||St(this,h,p,2,65535,0),this[p]=h&255,this[p+1]=h>>>8,p+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(h,p,v){return h=+h,p=p>>>0,v||St(this,h,p,2,65535,0),this[p]=h>>>8,this[p+1]=h&255,p+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(h,p,v){return h=+h,p=p>>>0,v||St(this,h,p,4,4294967295,0),this[p+3]=h>>>24,this[p+2]=h>>>16,this[p+1]=h>>>8,this[p]=h&255,p+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(h,p,v){return h=+h,p=p>>>0,v||St(this,h,p,4,4294967295,0),this[p]=h>>>24,this[p+1]=h>>>16,this[p+2]=h>>>8,this[p+3]=h&255,p+4};function gn(g,h,p,v,C){pr(h,v,C,g,p,7);let B=Number(h&BigInt(4294967295));g[p++]=B,B=B>>8,g[p++]=B,B=B>>8,g[p++]=B,B=B>>8,g[p++]=B;let R=Number(h>>BigInt(32)&BigInt(4294967295));return g[p++]=R,R=R>>8,g[p++]=R,R=R>>8,g[p++]=R,R=R>>8,g[p++]=R,p}function dr(g,h,p,v,C){pr(h,v,C,g,p,7);let B=Number(h&BigInt(4294967295));g[p+7]=B,B=B>>8,g[p+6]=B,B=B>>8,g[p+5]=B,B=B>>8,g[p+4]=B;let R=Number(h>>BigInt(32)&BigInt(4294967295));return g[p+3]=R,R=R>>8,g[p+2]=R,R=R>>8,g[p+1]=R,R=R>>8,g[p]=R,p+8}c.prototype.writeBigUInt64LE=ut(function(h,p=0){return gn(this,h,p,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeBigUInt64BE=ut(function(h,p=0){return dr(this,h,p,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeIntLE=function(h,p,v,C){if(h=+h,p=p>>>0,!C){const ae=Math.pow(2,8*v-1);St(this,h,p,v,ae-1,-ae)}let B=0,R=1,q=0;for(this[p]=h&255;++B<v&&(R*=256);)h<0&&q===0&&this[p+B-1]!==0&&(q=1),this[p+B]=(h/R>>0)-q&255;return p+v},c.prototype.writeIntBE=function(h,p,v,C){if(h=+h,p=p>>>0,!C){const ae=Math.pow(2,8*v-1);St(this,h,p,v,ae-1,-ae)}let B=v-1,R=1,q=0;for(this[p+B]=h&255;--B>=0&&(R*=256);)h<0&&q===0&&this[p+B+1]!==0&&(q=1),this[p+B]=(h/R>>0)-q&255;return p+v},c.prototype.writeInt8=function(h,p,v){return h=+h,p=p>>>0,v||St(this,h,p,1,127,-128),h<0&&(h=255+h+1),this[p]=h&255,p+1},c.prototype.writeInt16LE=function(h,p,v){return h=+h,p=p>>>0,v||St(this,h,p,2,32767,-32768),this[p]=h&255,this[p+1]=h>>>8,p+2},c.prototype.writeInt16BE=function(h,p,v){return h=+h,p=p>>>0,v||St(this,h,p,2,32767,-32768),this[p]=h>>>8,this[p+1]=h&255,p+2},c.prototype.writeInt32LE=function(h,p,v){return h=+h,p=p>>>0,v||St(this,h,p,4,2147483647,-2147483648),this[p]=h&255,this[p+1]=h>>>8,this[p+2]=h>>>16,this[p+3]=h>>>24,p+4},c.prototype.writeInt32BE=function(h,p,v){return h=+h,p=p>>>0,v||St(this,h,p,4,2147483647,-2147483648),h<0&&(h=4294967295+h+1),this[p]=h>>>24,this[p+1]=h>>>16,this[p+2]=h>>>8,this[p+3]=h&255,p+4},c.prototype.writeBigInt64LE=ut(function(h,p=0){return gn(this,h,p,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),c.prototype.writeBigInt64BE=ut(function(h,p=0){return dr(this,h,p,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function zt(g,h,p,v,C,B){if(p+v>g.length)throw new RangeError("Index out of range");if(p<0)throw new RangeError("Index out of range")}function hr(g,h,p,v,C){return h=+h,p=p>>>0,C||zt(g,h,p,4),n.write(g,h,p,v,23,4),p+4}c.prototype.writeFloatLE=function(h,p,v){return hr(this,h,p,!0,v)},c.prototype.writeFloatBE=function(h,p,v){return hr(this,h,p,!1,v)};function ri(g,h,p,v,C){return h=+h,p=p>>>0,C||zt(g,h,p,8),n.write(g,h,p,v,52,8),p+8}c.prototype.writeDoubleLE=function(h,p,v){return ri(this,h,p,!0,v)},c.prototype.writeDoubleBE=function(h,p,v){return ri(this,h,p,!1,v)},c.prototype.copy=function(h,p,v,C){if(!c.isBuffer(h))throw new TypeError("argument should be a Buffer");if(v||(v=0),!C&&C!==0&&(C=this.length),p>=h.length&&(p=h.length),p||(p=0),C>0&&C<v&&(C=v),C===v||h.length===0||this.length===0)return 0;if(p<0)throw new RangeError("targetStart out of bounds");if(v<0||v>=this.length)throw new RangeError("Index out of range");if(C<0)throw new RangeError("sourceEnd out of bounds");C>this.length&&(C=this.length),h.length-p<C-v&&(C=h.length-p+v);const B=C-v;return this===h&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(p,v,C):Uint8Array.prototype.set.call(h,this.subarray(v,C),p),B},c.prototype.fill=function(h,p,v,C){if(typeof h=="string"){if(typeof p=="string"?(C=p,p=0,v=this.length):typeof v=="string"&&(C=v,v=this.length),C!==void 0&&typeof C!="string")throw new TypeError("encoding must be a string");if(typeof C=="string"&&!c.isEncoding(C))throw new TypeError("Unknown encoding: "+C);if(h.length===1){const R=h.charCodeAt(0);(C==="utf8"&&R<128||C==="latin1")&&(h=R)}}else typeof h=="number"?h=h&255:typeof h=="boolean"&&(h=Number(h));if(p<0||this.length<p||this.length<v)throw new RangeError("Out of range index");if(v<=p)return this;p=p>>>0,v=v===void 0?this.length:v>>>0,h||(h=0);let B;if(typeof h=="number")for(B=p;B<v;++B)this[B]=h;else{const R=c.isBuffer(h)?h:c.from(h,C),q=R.length;if(q===0)throw new TypeError('The value "'+h+'" is invalid for argument "value"');for(B=0;B<v-p;++B)this[B+p]=R[B%q]}return this};const Wt={};function nr(g,h,p){Wt[g]=class extends p{constructor(){super(),Object.defineProperty(this,"message",{value:h.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${g}]`,this.stack,delete this.name}get code(){return g}set code(C){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:C,writable:!0})}toString(){return`${this.name} [${g}]: ${this.message}`}}}nr("ERR_BUFFER_OUT_OF_BOUNDS",function(g){return g?`${g} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),nr("ERR_INVALID_ARG_TYPE",function(g,h){return`The "${g}" argument must be of type number. Received type ${typeof h}`},TypeError),nr("ERR_OUT_OF_RANGE",function(g,h,p){let v=`The value of "${g}" is out of range.`,C=p;return Number.isInteger(p)&&Math.abs(p)>2**32?C=Rr(String(p)):typeof p=="bigint"&&(C=String(p),(p>BigInt(2)**BigInt(32)||p<-(BigInt(2)**BigInt(32)))&&(C=Rr(C)),C+="n"),v+=` It must be ${h}. Received ${C}`,v},RangeError);function Rr(g){let h="",p=g.length;const v=g[0]==="-"?1:0;for(;p>=v+4;p-=3)h=`_${g.slice(p-3,p)}${h}`;return`${g.slice(0,p)}${h}`}function Tr(g,h,p){Fn(h,"offset"),(g[h]===void 0||g[h+p]===void 0)&&Ct(h,g.length-(p+1))}function pr(g,h,p,v,C,B){if(g>p||g<h){const R=typeof h=="bigint"?"n":"";let q;throw h===0||h===BigInt(0)?q=`>= 0${R} and < 2${R} ** ${(B+1)*8}${R}`:q=`>= -(2${R} ** ${(B+1)*8-1}${R}) and < 2 ** ${(B+1)*8-1}${R}`,new Wt.ERR_OUT_OF_RANGE("value",q,g)}Tr(v,C,B)}function Fn(g,h){if(typeof g!="number")throw new Wt.ERR_INVALID_ARG_TYPE(h,"number",g)}function Ct(g,h,p){throw Math.floor(g)!==g?(Fn(g,p),new Wt.ERR_OUT_OF_RANGE("offset","an integer",g)):h<0?new Wt.ERR_BUFFER_OUT_OF_BOUNDS:new Wt.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${h}`,g)}const Pr=/[^+/0-9A-Za-z-_]/g;function qs(g){if(g=g.split("=")[0],g=g.trim().replace(Pr,""),g.length<2)return"";for(;g.length%4!==0;)g=g+"=";return g}function rn(g,h){h=h||1/0;let p;const v=g.length;let C=null;const B=[];for(let R=0;R<v;++R){if(p=g.charCodeAt(R),p>55295&&p<57344){if(!C){if(p>56319){(h-=3)>-1&&B.push(239,191,189);continue}else if(R+1===v){(h-=3)>-1&&B.push(239,191,189);continue}C=p;continue}if(p<56320){(h-=3)>-1&&B.push(239,191,189),C=p;continue}p=(C-55296<<10|p-56320)+65536}else C&&(h-=3)>-1&&B.push(239,191,189);if(C=null,p<128){if((h-=1)<0)break;B.push(p)}else if(p<2048){if((h-=2)<0)break;B.push(p>>6|192,p&63|128)}else if(p<65536){if((h-=3)<0)break;B.push(p>>12|224,p>>6&63|128,p&63|128)}else if(p<1114112){if((h-=4)<0)break;B.push(p>>18|240,p>>12&63|128,p>>6&63|128,p&63|128)}else throw new Error("Invalid code point")}return B}function Ii(g){const h=[];for(let p=0;p<g.length;++p)h.push(g.charCodeAt(p)&255);return h}function js(g,h){let p,v,C;const B=[];for(let R=0;R<g.length&&!((h-=2)<0);++R)p=g.charCodeAt(R),v=p>>8,C=p%256,B.push(C),B.push(v);return B}function mn(g){return t.toByteArray(qs(g))}function Bt(g,h,p,v){let C;for(C=0;C<v&&!(C+p>=h.length||C>=g.length);++C)h[C+p]=g[C];return C}function kt(g,h){return g instanceof h||g!=null&&g.constructor!=null&&g.constructor.name!=null&&g.constructor.name===h.name}function gr(g){return g!==g}const be=function(){const g="0123456789abcdef",h=new Array(256);for(let p=0;p<16;++p){const v=p*16;for(let C=0;C<16;++C)h[v+C]=g[p]+g[C]}return h}();function ut(g){return typeof BigInt>"u"?S:g}function S(){throw new Error("BigInt not supported")}})(Gb);const mo=fn("hostingApi",!1);class Xa extends Error{constructor(n,r,s=!0){super(n);P(this,"details");P(this,"shouldTrack");this.name="HostingError",this.details=r,this.shouldTrack=s}}const sM=409,oM=409,aM=429,uM=[sM,oM,aM],jb=async(e,t)=>{const n=Ei(),r={...t};n.API_AUTH_USERNAME&&n.API_AUTH_PASSWORD&&(r.headers={Authorization:`Basic ${Gb.Buffer.from(`${n.API_AUTH_USERNAME}:${n.API_AUTH_PASSWORD}`).toString("base64")}`,...r.headers}),wy()&&console.debug("Request:",e);const o=(await R_.getValue()).replace(" HttpOnly;",""),u=new AbortController,c=setTimeout(()=>u.abort(),15e3),d=await fetch(`${n.API_URL}${e}`,{...r,credentials:"include",signal:u.signal,headers:{...r.headers,Cookie:o}});return clearTimeout(c),d},ei=async(e,t)=>{const n=performance.now();let r=null;try{r=await jb(e,t)}catch(c){const d=new Xa(c.name&&c.name==="AbortError"?"Request timed out":"Unknown error occurred",{method:(t==null?void 0:t.method)??"GET",path:e,status:null});throw mo.trackEvent(Ke.UnexpectedHostingError,{details:d.details,errorMessage:d.message,errorStack:d.stack}),d}const s=performance.now(),o=await r.text();let u={message:"Empty response"};try{u=JSON.parse(o)}catch{const d=new Xa("Failed to parse response",{method:(t==null?void 0:t.method)??"GET",path:e,status:r.status,responseText:o});throw mo.trackEvent(Ke.UnexpectedHostingError,{details:d.details,errorMessage:d.message,errorStack:d.stack}),d}if(!r.ok){const c=new Xa("message"in u?u.message:"An unknown error has occurred.",{method:(t==null?void 0:t.method)??"GET",path:e,status:r.status}),d=uM.includes(c.details.status??0)?Ke.ExpectedHostingError:Ke.UnexpectedHostingError;throw mo.trackEvent(d,{details:c.details,errorMessage:c.message,errorStack:c.stack}),c}try{const c=Number(((s-n)/1e3).toFixed(2));mo.trackEvent("Hosting Request Analytics",{path:e.split("?")[0],method:(t==null?void 0:t.method)??"GET",durationSeconds:c})}catch(c){mo.trackError("Failed to Capture Hosting Request Analytics",{errorMessage:c.toString()})}return u},cM=async(e,t)=>await jb(e,t),lM=async()=>{const e=await T_.getValue(),t=await cM(`/v1/users/${e}`);return t.status===401?"expired":t.status>=200&&t.status<300?"ok":"unknown"},fM=async e=>ei(`/v1/sign-up?${new URLSearchParams(e)}`),dM=async(e,t)=>ei(`/v1/users/${e}/request-phone-verify`,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}),hM=async(e,t)=>ei(`/v1/users/${e}/check-phone-verify`,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}),pM=async e=>ei(`/v1/users/${e}/reservable-ships`),gM=async(e,t)=>ei(`/v1/users/${e}/reserve-ship`,{method:"POST",body:JSON.stringify({ship:t}),headers:{"Content-Type":"application/json"}}),mM=async e=>ei(`/v1/users/${e}/allocate-reserved-ship`,{method:"PATCH"}),yM=async e=>await ei(`/v1/ships/${e}`),DM=async e=>ei(`/v1/ships/${e}/network`),wM=async e=>ei(`/v1/ships/${e}/resume`,{method:"PATCH"}),bM="https://openrouter.ai/api/v1/chat/completions",EM=`Summarize this software development technical conversation concisely. Each message shows the author's user ID.

Instructions:
- Keep summary under 200 words
- Use bullet points
- Preserve technical terms, ship names (~zod, ~bus), and code exactly
- Focus on key points and decisions

Conversation:

[CONVERSATION]

Format:
TOPIC: [one sentence]
KEY POINTS: [3-5 bullets]
TECHNICAL DETAILS: [code/errors if present]
DECISIONS: [if any]
ACTION ITEMS: [if any]`;async function vM({messageText:e}){var n;const t=Ei();if(!t.OPENROUTER_API_KEY||t.OPENROUTER_API_KEY.length===0)throw new Error("OPENROUTER_API_KEY is not configured. Please set either OPENROUTER_API_KEY (native/mobile) or VITE_OPENROUTER_API_KEY (web) environment variable.");try{const r=EM.replace("[CONVERSATION]",e),s=await fetch(bM,{method:"POST",headers:{Authorization:`Bearer ${t.OPENROUTER_API_KEY}`,"HTTP-Referer":"https://tlon.io","X-Title":"Tlon Messenger","Content-Type":"application/json"},body:JSON.stringify({model:"amazon/nova-2-lite-v1:free",messages:[{role:"user",content:r}],temperature:.3,max_tokens:900})});if(!s.ok){const c=await s.text();let d=null;try{d=JSON.parse(c)}catch{}if(s.status===429)throw new Error("AI provider is rate-limited. Please try again in a few moments.");const f=new Error(`OpenRouter API error: ${s.status} - ${c}`);throw f.responseStatus=s.status,f.responseText=c,f.responseData=d,f.responseHeaders=Object.fromEntries(s.headers.entries()),f}const o=await s.json();if(!o.choices||o.choices.length===0){const c=new Error("No response from OpenRouter API");throw c.responseData=o,c}const u=(n=o.choices[0].message)==null?void 0:n.content;if(!u){const c=new Error("Empty summary received from OpenRouter API");throw c.responseData=o,c}return{summary:u}}catch(r){console.error("Error summarizing message:",r);const s={message:r instanceof Error?r.message:"Unknown error occurred",name:r instanceof Error?r.name:"UnknownError",stack:r instanceof Error?r.stack:void 0};if(r&&typeof r=="object"){const o=r;o.responseStatus&&(s.responseStatus=o.responseStatus),o.responseText&&(s.responseText=o.responseText),o.responseData&&(s.responseData=o.responseData),o.responseHeaders&&(s.responseHeaders=o.responseHeaders)}return{summary:"",error:s.message,errorDetails:s}}}async function SM(){return[]}class CM{constructor({marshaller:t,serializer:n,deserializer:r,serdeContext:s,defaultContentType:o}){P(this,"marshaller");P(this,"serializer");P(this,"deserializer");P(this,"serdeContext");P(this,"defaultContentType");this.marshaller=t,this.serializer=n,this.deserializer=r,this.serdeContext=s,this.defaultContentType=o}async serializeEventStream({eventStream:t,requestSchema:n,initialRequest:r}){const s=this.marshaller,o=n.getEventStreamMember(),u=n.getMemberSchema(o),c=this.serializer,d=this.defaultContentType,f=Symbol("initialRequestMarker"),m={async*[Symbol.asyncIterator](){if(r){const y={":event-type":{type:"string",value:"initial-request"},":message-type":{type:"string",value:"event"},":content-type":{type:"string",value:d}};c.write(n,r);const w=c.flush();yield{[f]:!0,headers:y,body:w}}for await(const y of t)yield y}};return s.serialize(m,y=>{if(y[f])return{headers:y.headers,body:y.body};const w=Object.keys(y).find(V=>V!=="__type")??"",{additionalHeaders:E,body:F,eventType:I,explicitPayloadContentType:T}=this.writeEventBody(w,u,y);return{headers:{":event-type":{type:"string",value:I},":message-type":{type:"string",value:"event"},":content-type":{type:"string",value:T??d},...E},body:F}})}async deserializeEventStream({response:t,responseSchema:n,initialResponseContainer:r}){var w;const s=this.marshaller,o=n.getEventStreamMember(),c=n.getMemberSchema(o).getMemberSchemas(),d=Symbol("initialResponseMarker"),f=s.deserialize(t.body,async E=>{var T,$;const F=Object.keys(E).find(V=>V!=="__type")??"",I=E[F].body;if(F==="initial-response"){const V=await this.deserializer.read(n,I);return delete V[o],{[d]:!0,...V}}else if(F in c){const V=c[F];if(V.isStructSchema()){const H={};let Q=!1;for(const[te,ge]of V.structIterator()){const{eventHeader:De,eventPayload:rt}=ge.getMergedTraits();if(Q=Q||!!(De||rt),rt)ge.isBlobSchema()?H[te]=I:ge.isStringSchema()?H[te]=(((T=this.serdeContext)==null?void 0:T.utf8Encoder)??Zi)(I):ge.isStructSchema()&&(H[te]=await this.deserializer.read(ge,I));else if(De){const Je=($=E[F].headers[te])==null?void 0:$.value;Je!=null&&(ge.isNumericSchema()?Je&&typeof Je=="object"&&"bytes"in Je?H[te]=BigInt(Je.toString()):H[te]=Number(Je):H[te]=Je)}}if(Q)return{[F]:H};if(I.byteLength===0)return{[F]:{}}}return{[F]:await this.deserializer.read(V,I)}}else return{$unknown:E}}),m=f[Symbol.asyncIterator](),y=await m.next();if(y.done)return f;if((w=y.value)!=null&&w[d]){if(!n)throw new Error("@smithy::core/protocols - initial-response event encountered in event stream but no response schema given.");for(const[E,F]of Object.entries(y.value))r[E]=F}return{async*[Symbol.asyncIterator](){var E;for((E=y==null?void 0:y.value)!=null&&E[d]||(yield y.value);;){const{done:F,value:I}=await m.next();if(F)break;yield I}}}}writeEventBody(t,n,r){var w;const s=this.serializer;let o=t,u=null,c;const d=n.getSchema()[4].includes(t),f={};if(d){const E=n.getMemberSchema(t);if(E.isStructSchema()){for(const[F,I]of E.structIterator()){const{eventHeader:T,eventPayload:$}=I.getMergedTraits();if($)u=F;else if(T){const V=r[t][F];let H="binary";I.isNumericSchema()?(-2)**31<=V&&V<=2**31-1?H="integer":H="long":I.isTimestampSchema()?H="timestamp":I.isStringSchema()?H="string":I.isBooleanSchema()&&(H="boolean"),V!=null&&(f[F]={type:H,value:V},delete r[t][F])}}if(u!==null){const F=E.getMemberSchema(u);F.isBlobSchema()?c="application/octet-stream":F.isStringSchema()&&(c="text/plain"),s.write(F,r[t][u])}else s.write(E,r[t])}else throw new Error("@smithy/core/event-streams - non-struct member not supported in event stream union.")}else{const[E,F]=r[t];o=E,s.write(15,F)}const m=s.flush();return{body:typeof m=="string"?(((w=this.serdeContext)==null?void 0:w.utf8Decoder)??Yr)(m):m,eventType:o,explicitPayloadContentType:c,additionalHeaders:f}}}const xM=Object.freeze(Object.defineProperty({__proto__:null,EventStreamSerde:CM},Symbol.toStringTag,{value:"Module"}));exports.ACTIVITY_SOURCE_PAGESIZE=yd;exports.AuthError=vi;exports.BASE_UNREADS_SINGLETON_KEY=gd;exports.BadResponseError=Ls;exports.CollectionRendererId=Dd;exports.DraftInputId=wd;exports.HostingError=Xa;exports.PostContentRendererId=bd;exports.SETTINGS_SINGLETON_KEY=ID;exports.TimeoutError=sd;exports.Urbit=ko;exports.acceptGroupJoin=nB;exports.addChannelToGroup=_B;exports.addChannelToNavSection=FB;exports.addChannelWriters=XI;exports.addContactSuggestions=uk;exports.addGroupRole=RB;exports.addMembersToRole=NB;exports.addNavSection=CB;exports.addReaction=CI;exports.allCollectionRenderers=UD;exports.allContentRenderers=$D;exports.allDraftInputs=MD;exports.allocateReservedShip=mM;exports.banUsersFromGroup=uB;exports.cancelGroupJoin=iB;exports.checkAttestedSignature=nk;exports.checkConnectionStatus=$U;exports.checkExistingUserInviteLink=Hb;exports.checkIsNodeBusy=i_;exports.checkNest=rd;exports.checkPhoneVerify=hM;exports.client=zi;exports.configureClient=n_;exports.configureConstants=FF;exports.createChannel=MI;exports.createDevLogger=fn;exports.createGroup=wB;exports.createGroupDm=cI;exports.createInviteLink=zb;exports.createNewGroupDefaultChannel=jI;exports.createPersonalInviteLink=GU;exports.deleteChannel=BB;exports.deleteGroup=SB;exports.deleteGroupRole=TB;exports.deleteNavSection=xB;exports.deletePost=kI;exports.deleteReply=RI;exports.desig=Rs;exports.discoverContacts=rk;exports.editPost=yI;exports.enableGroup=HU;exports.fetchChangesSince=VU;exports.findGroupsHostedBy=DB;exports.getAppInfo=bk;exports.getCanonicalPostId=Ge;exports.getChangedPosts=SI;exports.getChannelHooksPreview=JI;exports.getChannelIdType=Cu;exports.getChannelPosts=bI;exports.getChannelPreview=mB;exports.getChannelType=$o;exports.getConstants=Ei;exports.getContacts=sk;exports.getCurrentUserId=cr;exports.getCurrentUserIsHosted=CD;exports.getFallbackLinkMetadata=KU;exports.getGroup=bB;exports.getGroupAndChannelUnreads=J_;exports.getGroupPreview=yB;exports.getGroups=EB;exports.getHiddenDMPosts=BI;exports.getHiddenPosts=II;exports.getHostingAvailability=fM;exports.getHostingHeartBeat=lM;exports.getInitData=WB;exports.getInitialActivity=Q_;exports.getInitialPosts=wI;exports.getLandscapeAuthCookie=SD;exports.getLastConnectionStatus=MU;exports.getLatestPosts=vI;exports.getLinkMetadata=qU;exports.getPagedActivityByBucket=tI;exports.getPinnedItems=eB;exports.getPostInfoFromWer=z_;exports.getPostReference=pI;exports.getPostWithReplies=TI;exports.getReservableShips=pM;exports.getSettings=mk;exports.getShip=yM;exports.getShipAccessCode=DM;exports.getStorageConfiguration=Mb;exports.getStorageCredentials=$b;exports.getSystemContacts=SM;exports.getTextContent=U3;exports.getThreadUnreadsByChannel=X_;exports.getVolumeSettings=Y_;exports.hidePost=LD;exports.inviteGroupMembers=sB;exports.isChannelId=S3;exports.isDmChannelId=Qn;exports.isGroupChannelId=Ai;exports.isGroupDmChannelId=Br;exports.isOpenRouterConfigured=_F;exports.joinChannel=ZI;exports.kickUsersFromGroup=aB;exports.leaveChannel=VI;exports.leaveGroup=lB;exports.markChatRead=uI;exports.nestToFlag=mD;exports.pinItem=gB;exports.poke=fe;exports.pokeNoun=od;exports.preSig=yD;exports.rejectGroupJoin=rB;exports.removeChannelWriters=YI;exports.removeContactSuggestion=ak;exports.removeMembersFromRole=OB;exports.removeReaction=xI;exports.reportPost=_I;exports.request=AD;exports.requestGroupInvitation=fB;exports.requestPhoneVerify=dM;exports.rescindGroupInvitationRequest=oB;exports.reserveShip=gM;exports.respondToDMInvite=lI;exports.resumeShip=wM;exports.scry=Ve;exports.scryNoun=o_;exports.searchChannel=WI;exports.sendPost=mI;exports.sendReply=DI;exports.setOrder=KI;exports.setSetting=gk;exports.setupChannelFromTemplate=LI;exports.showPost=AI;exports.subscribe=Ki;exports.subscribeOnce=Qr;exports.subscribeToActivity=sI;exports.subscribeToChannelsUpdates=zI;exports.subscribeToLanyardUpdates=tk;exports.subscribeToSettings=Ek;exports.subscribeToStorageUpdates=BU;exports.summarizeMessage=vM;exports.syncUserProfiles=ck;exports.thread=ad;exports.toContentReference=Sd;exports.udToDate=$s;exports.unbanUsersFromGroup=cB;exports.unpinItem=pB;exports.unsubscribe=xD;exports.updateChannel=IB;exports.updateChannelMeta=$I;exports.updateContactMetadata=lk;exports.updateDMMeta=fI;exports.updateGroupMeta=vB;exports.updateGroupNavigation=kB;exports.updateGroupPrivacy=dB;exports.updateGroupRole=PB;exports.updateNavSection=AB;exports.uploadFile=NU;exports.whomIsDm=id;exports.whomIsMultiDm=wD;
//# sourceMappingURL=index.cjs.map
