import { Poke } from '../http-api';
import { ContentReference } from '../domain';
import { ClubAction, DmAction, Story, WritDelta } from '../urbit';

import * as db from '../db';
import * as ub from '../urbit';
export type Cursor = string | Date;
export type PostContent = (ub.Verse | ContentReference)[] | null;
export type PostContentAndFlags = [PostContent, db.PostFlags | null];
export declare function chatAction(whom: string, id: string, delta: WritDelta): Poke<DmAction | ClubAction>;
export declare function getPostReference({ channelId, postId, replyId, }: {
    channelId: string;
    postId: string;
    replyId?: string;
}): Promise<db.Post>;
export declare const sendPost: ({ channelId, authorId, sentAt, content, blob, metadata, }: {
    channelId: string;
    authorId: string;
    sentAt: number;
    content: ub.Story;
    blob?: string;
    metadata?: db.PostMetadata;
}) => Promise<void>;
export declare const editPost: ({ channelId, postId, authorId, sentAt, content, parentId, metadata, blob, }: {
    channelId: string;
    postId: string;
    authorId: string;
    sentAt: number;
    content: ub.Story;
    parentId?: string;
    metadata?: db.PostMetadata;
    blob?: string;
}) => Promise<void>;
export declare const sendReply: ({ channelId, parentId, parentAuthor, content, sentAt, authorId, }: {
    authorId: string;
    channelId: string;
    parentId: string;
    parentAuthor: string;
    content: ub.Story;
    sentAt: number;
}) => Promise<void>;
export interface GetSequencedPostsOptions {
    channelId: string;
    start: number;
    end: number;
    includeReplies?: boolean;
}
export declare const getSequencedChannelPosts: (options: GetSequencedPostsOptions) => Promise<{
    posts: db.Post[];
    newestSequenceNum: number;
}>;
export type GetChannelPostsOptions = {
    channelId: string;
    count?: number;
    includeReplies?: boolean;
    mode: 'older' | 'newer' | 'around' | 'newest';
    cursor?: Cursor;
    sequenceBoundary?: number | null;
};
export interface GetChannelPostsResponse {
    older?: string | null;
    newer?: string | null;
    posts: db.Post[];
    deletedPosts?: db.Post[];
    totalPosts?: number;
}
export declare const getInitialPosts: (config: {
    channelCount: number;
    postCount: number;
}) => Promise<db.Post[]>;
export declare const getChannelPosts: ({ channelId, cursor, mode, count, includeReplies, sequenceBoundary, }: GetChannelPostsOptions) => Promise<{
    posts: db.Post[];
    numStubs: number;
    numDeletes: number;
    newestSequenceNum: any;
    older?: string | null;
    newer?: string | null;
    deletedPosts?: db.Post[];
    totalPosts?: number;
}>;
export declare function fillSequenceGaps(responsePosts: db.Post[], config: {
    upperBound: number | null;
    lowerBound: number | null;
}): {
    posts: db.Post[];
    numStubs: number;
};
export type PostWithUpdateTime = {
    channelId: string;
    updatedAt: number;
    latestPost: db.Post;
};
export type GetLatestPostsResponse = PostWithUpdateTime[];
export declare const getLatestPosts: ({ afterCursor, count, }: {
    afterCursor?: Cursor;
    count?: number;
}) => Promise<GetLatestPostsResponse>;
export interface GetChangedPostsOptions {
    channelId: string;
    startCursor: Cursor;
    endCursor: Cursor;
    afterTime: Date;
}
export type GetChangedPostsResponse = GetChannelPostsResponse;
export declare const getChangedPosts: ({ channelId, startCursor, endCursor, afterTime, }: GetChangedPostsOptions) => Promise<GetChangedPostsResponse>;
export declare function addReaction({ channelId, postId, emoji, our, postAuthor, parentAuthorId, parentId, }: {
    channelId: string;
    postId: string;
    emoji: string;
    our: string;
    postAuthor: string;
    parentAuthorId?: string;
    parentId?: string;
}): Promise<void>;
export declare function removeReaction({ channelId, postId, our, postAuthor, parentId, parentAuthorId, }: {
    channelId: string;
    postId: string;
    our: string;
    postAuthor: string;
    parentId?: string;
    parentAuthorId?: string;
}): Promise<number>;
export declare function showPost(post: db.Post): Promise<number>;
export declare function hidePost(post: db.Post): Promise<number>;
export declare const toClientHiddenPosts: (hiddenPostIds: string[]) => string[];
export declare function reportPost(currentUserId: string, groupId: string, channelId: string, post: db.Post): Promise<number>;
export declare const getHiddenPosts: () => Promise<string[]>;
export declare const getHiddenDMPosts: () => Promise<string[]>;
export declare function deletePost(channelId: string, postId: string, authorId: string): Promise<number>;
export declare function deleteReply(params: {
    channelId: string;
    parentId: string;
    parentAuthorId: string;
    postId: string;
    authorId: string;
}): Promise<number>;
export declare const getPostWithReplies: ({ postId, channelId, authorId, }: {
    postId: string;
    channelId: string;
    authorId: string;
}) => Promise<db.Post>;
export interface DeletedPost {
    id: string;
    channelId: string;
}
export declare function toPagedPostsData(channelId: string, data: ub.PagedPosts | ub.PagedWrits): GetChannelPostsResponse;
export declare function toPostsData(channelId: string, posts: ub.Posts | ub.Writs | Record<string, ub.Reply>): {
    posts: db.Post[];
    deletedPosts: db.Post[];
};
export declare function toPostData(channelId: string, post: ub.Post | ub.PostTombstone | ub.Writ | ub.PostDataResponse): db.Post;
export declare function toReplyMeta(meta?: ub.ReplyMeta | null): db.ReplyMeta | null;
export declare function toPostReplyData(channelId: string, postId: string, reply: ub.Reply | ub.WritReply | ub.PostTombstone): db.Post;
export declare function toSequenceStubPost({ channelId, type, sequenceNum, sentAt, }: {
    channelId: string;
    type: db.PostType;
    sequenceNum: number;
    sentAt?: number;
}): db.Post;
export declare function toPostContent(story?: ub.Story): PostContentAndFlags;
export declare function toUrbitStory(content: PostContent): Story;
export declare function toContentReference(cite: ub.Cite): ContentReference | null;
export declare function contentReferenceToCite(reference: ContentReference): ub.Cite;
export declare function getContentImages(postId: string, content?: ub.Story | null): db.PostImage[];
export declare function toReactionsData(reacts: Record<string, ub.React>, postId: string): db.Reaction[];
//# sourceMappingURL=postsApi.d.ts.map