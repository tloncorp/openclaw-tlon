import type { IncomingMessage } from "node:http";
import type { WebSocket } from "ws";
import type { createSubsystemLogger } from "../../../logging/subsystem.js";
import type { ResolvedGatewayAuth } from "../../auth.js";
import type { GatewayRequestContext, GatewayRequestHandlers } from "../../server-methods/types.js";
import type { GatewayWsClient } from "../ws-types.js";
type SubsystemLogger = ReturnType<typeof createSubsystemLogger>;
export declare function attachGatewayWsMessageHandler(params: {
    socket: WebSocket;
    upgradeReq: IncomingMessage;
    connId: string;
    remoteAddr?: string;
    forwardedFor?: string;
    realIp?: string;
    requestHost?: string;
    requestOrigin?: string;
    requestUserAgent?: string;
    canvasHostUrl?: string;
    connectNonce: string;
    resolvedAuth: ResolvedGatewayAuth;
    gatewayMethods: string[];
    events: string[];
    extraHandlers: GatewayRequestHandlers;
    buildRequestContext: () => GatewayRequestContext;
    send: (obj: unknown) => void;
    close: (code?: number, reason?: string) => void;
    isClosed: () => boolean;
    clearHandshakeTimer: () => void;
    getClient: () => GatewayWsClient | null;
    setClient: (next: GatewayWsClient) => void;
    setHandshakeState: (state: "pending" | "connected" | "failed") => void;
    setCloseCause: (cause: string, meta?: Record<string, unknown>) => void;
    setLastFrameMeta: (meta: {
        type?: string;
        method?: string;
        id?: string;
    }) => void;
    logGateway: SubsystemLogger;
    logHealth: SubsystemLogger;
    logWsControl: SubsystemLogger;
}): void;
export {};
