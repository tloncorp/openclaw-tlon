FROM node:24-bookworm-slim

RUN apt-get update && apt-get install -y git curl && rm -rf /var/lib/apt/lists/*

# Install OpenClaw globally (pinned to avoid dependency bugs in latest)
RUN npm install -g openclaw@2026.2.9

# Create workspace
WORKDIR /workspace

COPY entrypoint.ci.sh /usr/local/bin/entrypoint.sh
RUN chmod +x /usr/local/bin/entrypoint.sh

EXPOSE 18789

ENTRYPOINT ["/usr/local/bin/entrypoint.sh"]
